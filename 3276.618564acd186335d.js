"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[3276,5398],{52540:(re,$,b)=>{b.d($,{z:()=>U});var m=b(39921);class U{constructor(A,L){this._storage=new m.WJ,this.id="",this.name="",this.size=0,this._storage.maxSize=A,this._storage.register(this),L&&this._storage.registerRemoveFunc("",L)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(A,L,P=1){this._storage.put(this,A,L,P,1)}pop(A){return this._storage.pop(this,A)}get(A){return this._storage.get(this,A)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(A){this._storage.maxSize=A}resetHitRate(){}}},39921:(re,$,b)=>{b.d($,{WJ:()=>P,Xq:()=>L});var A,j,m=b(43029);(j=A||(A={}))[j.ALL=0]="ALL",j[j.SOME=1]="SOME";class L{constructor(_,u,c){this.name=_,this._storage=u,this.id=z+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),c&&(this._storage.registerRemoveFunc(this.id,c),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(_){return this._storage.getSize(this,_)}resetHitRate(){this._hit=this._miss=0}put(_,u,c,g=0){this._storage.put(this,_,u,c,g)}pop(_){const u=this._storage.pop(this,_);return void 0===u?++this._miss:++this._hit,u}get(_){const u=this._storage.get(this,_);return void 0===u?++this._miss:++this._hit,u}peek(_){return this._storage.peek(this,_)}updateSize(_,u,c){this._storage.updateSize(this,_,u,c)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class P{get size(){return this._size}constructor(_=10485760){this._maxSize=_,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new m.Z,this._users=new m.Z}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(_){this._users.push(_)}deregister(_){this._users.removeUnordered(_)}registerRemoveFunc(_,u){this._removeFuncs.push([_,u])}deregisterRemoveFunc(_){this._removeFuncs.filterInPlace(u=>u[0]!==_)}get maxSize(){return this._maxSize}set maxSize(_){this._maxSize=Math.max(_,-1),this._checkSize()}getSize(_,u){return this._db.get(_.id+u)?.size??0}put(_,u,c,g,R){const y=this._db.get(u=_.id+u);if(y&&(this._size-=y.size,_.size-=y.size,this._db.delete(u),y.entry!==c&&this._notifyRemove(u,y.entry,y.size,A.ALL)),g>this._maxSize)return void this._notifyRemove(u,c,g,A.ALL);if(void 0===c)return void console.warn("Refusing to cache undefined entry ");if(!g||g<0)return console.warn(`Refusing to cache entry with size ${g} for key ${u}`),void this._notifyRemove(u,c,0,A.ALL);const T=1+Math.max(R,-4)- -3;this._db.set(u,new F(c,g,T)),this._size+=g,_.size+=g,this._checkSize()}updateSize(_,u,c,g){const R=this._db.get(u=_.id+u);if(R&&R.entry===c){for(this._size-=R.size,_.size-=R.size;g>this._maxSize;){const y=this._notifyRemove(u,c,g,A.SOME);if(!(null!=y&&y>0))return void this._db.delete(u);g=y}R.size=g,this._size+=g,_.size+=g,this._checkSize()}}pop(_,u){const c=this._db.get(u=_.id+u);if(c)return this._size-=c.size,_.size-=c.size,this._db.delete(u),++this._hit,c.entry;++this._miss}get(_,u){const c=this._db.get(u=_.id+u);if(void 0!==c)return this._db.delete(u),c.lives=c.lifetime,this._db.set(u,c),++this._hit,c.entry;++this._miss}peek(_,u){const c=this._db.get(_.id+u);return c?++this._hit:++this._miss,c?.entry}get performanceInfo(){const _={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},u={},c=new Array;this._db.forEach((y,T)=>{const p=y.lifetime;c[p]=(c[p]||0)+y.size,this._users.forAll(f=>{const{id:a,name:S}=f;T.startsWith(a)&&(u[S]=(u[S]||0)+y.size)})});const g={};this._users.forAll(y=>{const T=y.name;"hitRate"in y&&"number"==typeof y.hitRate&&!isNaN(y.hitRate)&&y.hitRate>0?(u[T]=u[T]||0,g[T]=Math.round(100*y.hitRate)+"%"):g[T]="0%"});const R=Object.keys(u);R.sort((y,T)=>u[T]-u[y]),R.forEach(y=>_[y]=Math.round(u[y]/2**20)+"MB / "+g[y]);for(let y=c.length-1;y>=0;--y){const T=c[y];T&&(_["Priority "+(y+-3-1)]=Math.round(T/this._size*100)+"%")}return _}resetStats(){this._hit=this._miss=0,this._users.forAll(_=>_.resetHitRate())}clear(_){const u=_.id;this._db.forEach((c,g)=>{g.startsWith(u)&&(this._size-=c.size,this._db.delete(g),this._notifyRemove(g,c.entry,c.size,A.ALL))}),_.size=0}clearAll(){this._db.forEach((_,u)=>this._notifyRemove(u,_.entry,_.size,A.ALL)),this._users.forAll(_=>_.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(_,u,c,g){let R;return this._removeFuncs.some(y=>{if(_.startsWith(y[0])){const T=y[1](u,g,c);return"number"==typeof T&&(R=T),!0}return!1}),R}_checkSize(){this._users.forAll(_=>this._checkSizeLimits(_)),this._checkSizeLimits()}_checkSizeLimits(_){const u=_??this;if(u.maxSize<0||u.size<=u.maxSize)return;const c=_?.id;let g=!0;for(;g;){g=!1;for(const[R,y]of this._db)if(0===y.lifetime&&(!c||R.startsWith(c))){if(this._purgeItem(R,y,_),u.size<=.9*u.maxSize)return;g||=this._db.has(R)}}for(const[R,y]of this._db)if((!c||R.startsWith(c))&&(this._purgeItem(R,y,_),u.size<=.9*u.maxSize))return}_purgeItem(_,u,c=this._users.find(g=>_.startsWith(g.id))){if(this._db.delete(_),u.lives<=1){this._size-=u.size,c&&(c.size-=u.size);const g=this._notifyRemove(_,u.entry,u.size,A.SOME);null!=g&&g>0&&(this._size+=g,c&&(c.size+=g),u.lives=u.lifetime,u.size=g,this._db.set(_,u))}else--u.lives,this._db.set(_,u)}}let z=0;class F{constructor(_,u,c){this.entry=_,this.size=u,this.lifetime=c,this.lives=c}}},657:(re,$,b)=>{b.d($,{$c:()=>R,Hg:()=>y,jW:()=>u,uD:()=>c});var m=b(73514),U=b(83944),D=b(49301);const A=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function L(p){return p instanceof m.Z}function P(p){return p instanceof U.Z?Object.keys(p.items):L(p)?(0,D.vw)(p).keys():p?Object.keys(p):[]}function z(p,f){return p instanceof U.Z?p.items[f]:p[f]}function j(p){return p?p.declaredClass:null}function _(p,f){const a=p.diff;if(a&&"function"==typeof a)return a(p,f);const S=P(p),I=P(f);if(0===S.length&&0===I.length)return;if(!S.length||!I.length||function F(p,f){return!(!Array.isArray(p)||!Array.isArray(f))&&p.length!==f.length}(p,f))return{type:"complete",oldValue:p,newValue:f};const O=I.filter(H=>!S.includes(H)),C=S.filter(H=>!I.includes(H)),v=S.filter(H=>I.includes(H)&&z(p,H)!==z(f,H)).concat(O,C).sort(),K=j(p);if(K&&A.has(K)&&v.length)return{type:"complete",oldValue:p,newValue:f};let X;const ne=L(p)&&L(f);for(const H of v){const V=z(p,H),h=z(f,H);let E;if((ne||"function"!=typeof V&&"function"!=typeof h)&&V!==h&&(null!=V||null!=h)){if(a&&a[H]&&"function"==typeof a[H])E=a[H]?.(V,h);else if(V instanceof Date&&h instanceof Date){if(V.getTime()===h.getTime())continue;E={type:"complete",oldValue:V,newValue:h}}else E="object"==typeof V&&"object"==typeof h&&j(V)===j(h)?_(V,h):{type:"complete",oldValue:V,newValue:h};null!=E&&(null!=X?X.diff[H]=E:X={type:"partial",diff:{[H]:E}})}}return X}function u(p,f){return c(p,f)}function c(p,f){if(null==p)return!1;const a=f.split(".");let S=p;for(const I of a){if("complete"===S.type)return!0;if("partial"!==S.type)return!1;{const O=S.diff[I];if(!O)return!1;S=O}}return!0}function R(p,f){if(!p)return!1;if("partial"===p.type){const a=Object.keys(p.diff);return 1===a.length&&a[0]===f}return!1}function y(p,f){if("function"!=typeof p&&"function"!=typeof f&&(null!=p||null!=f))return null==p||null==f||"object"==typeof p&&"object"==typeof f&&j(p)!==j(f)?{type:"complete",oldValue:p,newValue:f}:_(p,f)}},15398:(re,$,b)=>{b.d($,{A4:()=>D,L9:()=>A,yV:()=>U});var m=b(25037);class U{}function D(P){return P instanceof m.ld?P===U.instance:"unknown"===P?.toString().toLowerCase()}function A(P){return D(P)?U.instance:P}U.instance=new m.vF("Etc/UTC")},66398:(re,$,b)=>{function U(l){return l?{originPosition:"upper-left"===l.originPosition?"upperLeft":"lower-left"===l.originPosition?"lowerLeft":l.originPosition,scale:l.tolerance?[l.tolerance,l.tolerance,1,1]:[1,1,1,1],translate:null!=l.extent?[l.extent.xmin,l.extent.ymax,l.extent.zmin??0,l.extent.mmin??0]:[0,0,0,0]}:null}function A(l){if(function D(l){return"lowerLeft"===l.originPosition&&4===l.scale.length&&4===l.translate.length}(l))return l;const{originPosition:s,scale:i,translate:d}=l,M=i[1]??1;return{originPosition:"lowerLeft",scale:[i[0]??1,"lowerLeft"===s?M:-M,i[2]??1,i[3]??1],translate:[d[0]??0,d[1]??0,d[2]??0,d[3]??0]}}function p({scale:l,translate:s},i){return i*l[0]+s[0]}function f({scale:l,translate:s},i){return i*l[1]+s[1]}function a({scale:l,translate:s},i){return(i??0)*l[2]+s[2]}function S({scale:l,translate:s},i){return i?i*l[3]+s[3]:0}function I(l,s){return l&&s?K:l&&!s?C:!l&&s?v:O}b.d($,{G6:()=>_e,Ie:()=>pe,J9:()=>ae,RF:()=>J,U1:()=>ce,vY:()=>U}),b(40637);const O=(l,s)=>{const i=new Array(s.length);if(!s.length)return i;const d=s[0];let x=p(l,d[0]),M=f(l,d[1]);i[0]=[x,M];const{scale:w,originPosition:N}=l,G=w[0],Q="lowerLeft"===N?w[1]:-w[1];for(let W=1;W<s.length;W++){const[Y,q]=s[W];x+=G*Y,M+=Q*q,i[W]=[x,M]}return i},C=(l,s)=>{const i=new Array(s.length);if(!s.length)return i;const d=s[0];let x=p(l,d[0]),M=f(l,d[1]);i[0]=[x,M,a(l,d[2])];const{scale:w,originPosition:N}=l,G=w[0],Q="lowerLeft"===N?w[1]:-w[1];for(let W=1;W<s.length;W++){const[Y,q,ee]=s[W];x+=G*Y,M+=Q*q,i[W]=[x,M,a(l,ee)]}return i},v=(l,s)=>{const i=new Array(s.length);if(!s.length)return i;const d=s[0];let x=p(l,d[0]),M=f(l,d[1]);i[0]=[x,M,S(l,d[2])];const{scale:w,originPosition:N}=l,G=w[0],Q="lowerLeft"===N?w[1]:-w[1];for(let W=1;W<s.length;W++){const[Y,q,ee]=s[W];x+=G*Y,M+=Q*q,i[W]=[x,M,S(l,ee)]}return i},K=(l,s)=>{const i=new Array(s.length);if(!s.length)return i;const d=s[0];let x=p(l,d[0]),M=f(l,d[1]);i[0]=[x,M,a(l,d[2]),S(l,d[3])];const{scale:w,originPosition:N}=l,G=w[0],Q="lowerLeft"===N?w[1]:-w[1];for(let W=1;W<s.length;W++){const[Y,q,ee,oe]=s[W];x+=G*Y,M+=Q*q,i[W]=[x,M,a(l,ee),S(l,oe)]}return i};function X(l,s,i){const d=new Array(i.length);for(let x=0;x<i.length;x++)d[x]=s(l,i[x]);return d}function J(l,s,i){const d=A(l);return s.x=function L({scale:l,translate:s},i){return Math.round((i-s[0])/l[0])}(d,i.x),s.y=function P({scale:l,translate:s},i){return Math.round((i-s[1])/l[1])}(d,i.y),null!=i.z&&(s.z=function z({scale:l,translate:s},i){return Math.round(((i??0)-s[2])/l[2])}(d,i.z)),null!=i.m&&(s.m=function F({scale:l,translate:s},i){return i?Math.round((i-s[3])/l[3]):0}(d,i.m)),s}function ae(l,s,i,d=i?.hasZ??!1,x=i?.hasM??!1){if(null!=i){const M=A(l);s.points=I(d,x)(M,i.points),s.hasZ=d,s.hasM=x}return s}function ce(l,s,i,d=null!=i?.z,x=null!=i?.m){if(null==i)return s;const M=A(l);return s.x=p(M,i.x),s.y=f(M,i.y),d&&(s.z=a(M,i.z)),x&&(s.m=S(M,i.m)),s}function pe(l,s,i,d=i?.hasZ??!1,x=i?.hasM??!1){if(null!=i){const M=A(l);s.rings=X(M,I(d,x),i.rings),s.hasZ=d,s.hasM=x}return s}function _e(l,s,i,d=i?.hasZ??!1,x=i?.hasM??!1){if(null!=i){const M=A(l);s.paths=X(M,I(d,x),i.paths),s.hasZ=d,s.hasM=x}return s}},40100:(re,$,b)=>{b.d($,{Z:()=>g});var m=b(57964),U=b(89317),D=b(4703),A=b(8611),L=b(15398),P=b(85295),z=b(764),F=b(25037);const c=new Map;class g{static fromJSON(a){return new g(a.fields,a.timeZoneByFieldName)}static fromLayer(a){return new g(a.fields??[],p(a))}static fromLayerJSON(a){return new g(a.fields??[],p(a))}constructor(a=[],S){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=a||[],this._timeZoneByFieldName=S?new Map(S):null;const I=[];for(const O of this.fields){const C=O?.name,v=y(C);if(C&&v){const K=R(C);this._fieldsMap.set(C,O),this._fieldsMap.set(K,O),this._normalizedFieldsMap.set(v,O),I.push(`${K}:${O.type}:${this._timeZoneByFieldName?.get(C)}`),(0,P.y2)(O)?(this.dateFields.push(O),this._dateFieldsSet.add(O)):(0,P.H7)(O)&&(this._numericFieldsSet.add(O),this.numericFields.push(O)),(0,P.Dl)(O)||(0,P.Se)(O)||(O.editable=null==O.editable||!!O.editable,O.nullable=null==O.nullable||!!O.nullable)}}I.sort(),this.uid=I.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const a of this.fields)(0,P.Dl)(a)||(0,P.Se)(a)||a.nullable||void 0!==(0,P.os)(a)||this._requiredFields.push(a)}return this._requiredFields}equals(a){return this.uid===a?.uid}has(a){return null!=this.get(a)}get(a){if(!a)return;let S=this._fieldsMap.get(a);return S||(S=this._fieldsMap.get(R(a))??this._normalizedFieldsMap.get(y(a)),S&&this._fieldsMap.set(a,S),S)}getTimeZone(a){const S=this.get(a&&"string"!=typeof a?a.name:a);return S?this._timeZoneByFieldName?this._timeZoneByFieldName.get(S.name):"date"===S.type||"esriFieldTypeDate"===S.type?(D.Z.getLogger("esri.layers.support.FieldsIndex").error(new m.Z("getTimeZone:no-timezone-information",`no time zone information for field '${S.name}'`)),z.pt):T.has(S.type)?z._4:null:null}getLuxonTimeZone(a){const S=this.getTimeZone(a);return S?S===z._4?L.yV.instance:S===z.pt?F.Qf.utcInstance:(0,A.s1)(c,S,()=>F.vF.create(S)):null}isDateField(a){return this._dateFieldsSet.has(this.get(a))}isTimeOnlyField(a){return(0,P.sX)(this.get(a))}isNumericField(a){return this._numericFieldsSet.has(this.get(a))}normalizeFieldName(a){return this.get(a)?.name??void 0}toJSON(){return{fields:this.fields.map(a=>(0,U.AK)(a)?a.toJSON():a),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function R(f){return f.trim().toLowerCase()}function y(f){return(0,P.q6)(f)?.toLowerCase()??""}const T=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function p(f){const a=new Map;if(!f.fields)return a;const S=!0===f.datesInUnknownTimezone,{timeInfo:I,editFieldsInfo:O}=f,C=(I?"startField"in I?I.startField:I.startTimeField:"")??"",v=(I?"endField"in I?I.endField:I.endTimeField:"")??"",K=function u(f){return"dateFieldsTimeZone"in f}(f)?f.dateFieldsTimeZone??null:f.dateFieldsTimeReference?(0,z.Jv)(f.dateFieldsTimeReference):null,X=O?function j(f){return"timeZone"in f}(O)?O.timeZone??K:O.dateFieldsTimeReference?(0,z.Jv)(O.dateFieldsTimeReference):K??z.pt:null,ne=I?function _(f){return"timeZone"in f}(I)?I.timeZone??K:I.timeReference?(0,z.Jv)(I.timeReference):K:null,H=new Map([[R(O?.creationDateField??""),X],[R(O?.editDateField??""),X],[R(C),ne],[R(v),ne]]);for(const{name:V,type:h}of f.fields)if(T.has(h))a.set(V,z._4);else if("date"!==h&&"esriFieldTypeDate"!==h)a.set(V,null);else if(S)a.set(V,z._4);else{const E=H.get(R(V??""))??K;a.set(V,E)}return a}},46637:(re,$,b)=>{b.d($,{H3:()=>f,QI:()=>c,U4:()=>j,Yh:()=>R});var m=b(50484),U=b(89317),D=b(80543),z=(b(14007),b(4703),b(65311),b(21070)),F=b(10141);let j=class extends U.wq{constructor(){super(...arguments),this.nodesPerPage=null,this.rootIndex=0,this.lodSelectionMetricType=null}};(0,m._)([(0,D.Cb)({type:Number})],j.prototype,"nodesPerPage",void 0),(0,m._)([(0,D.Cb)({type:Number})],j.prototype,"rootIndex",void 0),(0,m._)([(0,D.Cb)({type:String})],j.prototype,"lodSelectionMetricType",void 0),j=(0,m._)([(0,F.j)("esri.layers.support.I3SLayerDefinitions.I3SNodePageDefinition")],j);let _=class extends U.wq{constructor(){super(...arguments),this.factor=1}};(0,m._)([(0,D.Cb)({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],_.prototype,"id",void 0),(0,m._)([(0,D.Cb)({type:Number})],_.prototype,"factor",void 0),_=(0,m._)([(0,F.j)("esri.layers.support.I3SLayerDefinitions.I3SMaterialTexture")],_);let u=class extends U.wq{constructor(){super(...arguments),this.baseColorFactor=[1,1,1,1],this.baseColorTexture=null,this.metallicRoughnessTexture=null,this.metallicFactor=1,this.roughnessFactor=1}};(0,m._)([(0,D.Cb)({type:[Number]})],u.prototype,"baseColorFactor",void 0),(0,m._)([(0,D.Cb)({type:_})],u.prototype,"baseColorTexture",void 0),(0,m._)([(0,D.Cb)({type:_})],u.prototype,"metallicRoughnessTexture",void 0),(0,m._)([(0,D.Cb)({type:Number})],u.prototype,"metallicFactor",void 0),(0,m._)([(0,D.Cb)({type:Number})],u.prototype,"roughnessFactor",void 0),u=(0,m._)([(0,F.j)("esri.layers.support.I3SLayerDefinitions.I3SMaterialPBRMetallicRoughness")],u);let c=class extends U.wq{constructor(){super(...arguments),this.alphaMode="opaque",this.alphaCutoff=.25,this.doubleSided=!1,this.cullFace="none",this.normalTexture=null,this.occlusionTexture=null,this.emissiveTexture=null,this.emissiveFactor=null,this.pbrMetallicRoughness=null}};(0,m._)([(0,z.J)({opaque:"opaque",mask:"mask",blend:"blend"})],c.prototype,"alphaMode",void 0),(0,m._)([(0,D.Cb)({type:Number})],c.prototype,"alphaCutoff",void 0),(0,m._)([(0,D.Cb)({type:Boolean})],c.prototype,"doubleSided",void 0),(0,m._)([(0,z.J)({none:"none",back:"back",front:"front"})],c.prototype,"cullFace",void 0),(0,m._)([(0,D.Cb)({type:_})],c.prototype,"normalTexture",void 0),(0,m._)([(0,D.Cb)({type:_})],c.prototype,"occlusionTexture",void 0),(0,m._)([(0,D.Cb)({type:_})],c.prototype,"emissiveTexture",void 0),(0,m._)([(0,D.Cb)({type:[Number]})],c.prototype,"emissiveFactor",void 0),(0,m._)([(0,D.Cb)({type:u})],c.prototype,"pbrMetallicRoughness",void 0),c=(0,m._)([(0,F.j)("esri.layers.support.I3SLayerDefinitions.I3SMaterialDefinition")],c);let g=class extends U.wq{};(0,m._)([(0,D.Cb)({type:String,json:{read:{source:["name","index"],reader:(a,S)=>a??`${S.index}`}}})],g.prototype,"name",void 0),(0,m._)([(0,z.J)({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2",ktx2:"ktx2",basis:"basis"})],g.prototype,"format",void 0),g=(0,m._)([(0,F.j)("esri.layers.support.I3SLayerDefinitions.I3STextureFormat")],g);let R=class extends U.wq{constructor(){super(...arguments),this.atlas=!1}};(0,m._)([(0,D.Cb)({type:[g]})],R.prototype,"formats",void 0),(0,m._)([(0,D.Cb)({type:Boolean})],R.prototype,"atlas",void 0),R=(0,m._)([(0,F.j)("esri.layers.support.I3SLayerDefinitions.I3STextureSetDefinition")],R);let y=class extends U.wq{};(0,m._)([(0,z.J)({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],y.prototype,"type",void 0),(0,m._)([(0,D.Cb)({type:Number})],y.prototype,"component",void 0),y=(0,m._)([(0,F.j)("esri.layers.support.I3SLayerDefinitions.I3SGeometryAttribute")],y);let T=class extends U.wq{};(0,m._)([(0,z.J)({draco:"draco"})],T.prototype,"encoding",void 0),(0,m._)([(0,D.Cb)({type:[String]})],T.prototype,"attributes",void 0),T=(0,m._)([(0,F.j)("esri.layers.support.I3SLayerDefinitions.I3SGeometryCompressedAttributes")],T);let p=class extends U.wq{constructor(){super(...arguments),this.offset=0}};(0,m._)([(0,D.Cb)({type:Number})],p.prototype,"offset",void 0),(0,m._)([(0,D.Cb)({type:y})],p.prototype,"position",void 0),(0,m._)([(0,D.Cb)({type:y})],p.prototype,"normal",void 0),(0,m._)([(0,D.Cb)({type:y})],p.prototype,"uv0",void 0),(0,m._)([(0,D.Cb)({type:y})],p.prototype,"color",void 0),(0,m._)([(0,D.Cb)({type:y})],p.prototype,"uvRegion",void 0),(0,m._)([(0,D.Cb)({type:y})],p.prototype,"featureId",void 0),(0,m._)([(0,D.Cb)({type:y})],p.prototype,"faceRange",void 0),(0,m._)([(0,D.Cb)({type:T})],p.prototype,"compressedAttributes",void 0),p=(0,m._)([(0,F.j)("esri.layers.support.I3SLayerDefinitions.I3SGeometryBuffer")],p);let f=class extends U.wq{};(0,m._)([(0,z.J)({triangle:"triangle"})],f.prototype,"topology",void 0),(0,m._)([(0,D.Cb)()],f.prototype,"geometryBuffers",void 0),f=(0,m._)([(0,F.j)("esri.layers.support.I3SLayerDefinitions.I3SGeometryDefinition")],f)},63724:(re,$,b)=>{b.d($,{w:()=>j});var m=b(15861),U=b(26152),D=b(66476),A=b(57964),L=b(79412),P=b(89713),z=b(61018),F=b(27835);function j(I,O){return _.apply(this,arguments)}function _(){return _=(0,m.Z)(function*(I,O){const C=(0,P.Qc)(I);if(!C)throw new A.Z("invalid-url","Invalid scene service url");const v={...O,sceneServerUrl:C.url.path,layerId:C.sublayer??void 0};if(v.sceneLayerItem??=(yield function u(I){return c.apply(this,arguments)}(v)),null==v.sceneLayerItem)return p(v.sceneServerUrl.replace("/SceneServer","/FeatureServer"),v);const K=yield function a(I){return S.apply(this,arguments)}(v);if(!K?.url)throw new A.Z("related-service-not-found","Could not find feature service through portal item relationship");v.featureServiceItem=K;const X=yield p(K.url,v);return X.portalItem=K,X}),_.apply(this,arguments)}function c(){return c=(0,m.Z)(function*(I){const O=(yield g(I)).serviceItemId;if(!O)return null;const C=new F.default({id:O,apiKey:I.apiKey}),v=yield function y(I){return T.apply(this,arguments)}(I);null!=v&&(C.portal=new z.Z({url:v}));try{return C.load({signal:I.signal})}catch(K){return(0,L.r9)(K),null}}),c.apply(this,arguments)}function g(I){return R.apply(this,arguments)}function R(){return(R=(0,m.Z)(function*(I){if(I.rootDocument)return I.rootDocument;const O={query:{f:"json",...I.customParameters,token:I.apiKey},responseType:"json",signal:I.signal};try{const C=yield(0,D.Z)(I.sceneServerUrl,O);I.rootDocument=C.data}catch{I.rootDocument={}}return I.rootDocument})).apply(this,arguments)}function T(){return(T=(0,m.Z)(function*(I){const O=U.id?.findServerInfo(I.sceneServerUrl);if(O?.owningSystemUrl)return O.owningSystemUrl;const C=I.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const v=(yield(0,D.Z)(C,{query:{f:"json"},responseType:"json",signal:I.signal})).data.owningSystemUrl;if(v)return v}catch(v){(0,L.r9)(v)}return null})).apply(this,arguments)}function p(I,O){return f.apply(this,arguments)}function f(){return(f=(0,m.Z)(function*(I,O){const C=(0,P.Qc)(I);if(!C)throw new A.Z("invalid-feature-service-url","Invalid feature service url");const v=C.url.path,K=O.layerId;if(null==K)return{serverUrl:v};const X=g(O),ne=O.featureServiceItem?yield O.featureServiceItem.fetchData("json"):null,H=(ne?.layers?.[0]||ne?.tables?.[0])?.customParameters,V=J=>{const se={query:{f:"json",...H},responseType:"json",authMode:J,signal:O.signal};return(0,D.Z)(v,se)},h=V("anonymous").catch(()=>V("no-prompt")),[E,Z]=yield Promise.all([h,X]),B=Z?.layers,k=E.data&&E.data.layers;if(!Array.isArray(k))throw new Error("expected layers array");if(Array.isArray(B)){for(let J=0;J<Math.min(B.length,k.length);J++)if(B[J].id===K)return{serverUrl:v,layerId:k[J].id}}else if(null!=K&&K<k.length)return{serverUrl:v,layerId:k[K].id};throw new Error("could not find matching associated sublayer")})).apply(this,arguments)}function S(){return(S=(0,m.Z)(function*({sceneLayerItem:I,signal:O}){if(!I)return null;try{const C=(yield I.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:O})).find(K=>"Feature Service"===K.type)||null;if(!C)return null;const v=new F.default({portal:C.portal,id:C.id});return yield v.load(),v}catch(C){return(0,L.r9)(C),null}})).apply(this,arguments)}},36297:(re,$,b)=>{b.d($,{C:()=>m});const m={analytics:{supportsCacheHint:!1},attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1,supportsCacheHint:!1,supportsResize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsAsyncApplyEdits:!1,zDefault:void 0},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsCompactGeometry:!1,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsStatistics:!1,tileMaxRecordCount:0}}},56761:(re,$,b)=>{b.d($,{UG:()=>u,UO:()=>y,YI:()=>R,dI:()=>T,el:()=>O,hV:()=>g,z7:()=>c});var m=b(72578);const U="__begin__",D="__end__",A=new RegExp(U,"ig"),L=new RegExp(D,"ig"),P=new RegExp("^"+U,"i"),z=new RegExp(D+"$","i"),F='"',j=F+" + ",_=" + "+F;function u(C){return C.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function c(C){return C.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function g(C){const v={expression:"",type:"none"};return C.labelExpressionInfo?C.labelExpressionInfo.value?(v.expression=C.labelExpressionInfo.value,v.type="conventional"):C.labelExpressionInfo.expression&&(v.expression=C.labelExpressionInfo.expression,v.type="arcade"):null!=C.labelExpression&&(v.expression=u(C.labelExpression),v.type="conventional"),v}function R(C){const v=g(C);if(!v)return null;switch(v.type){case"conventional":return T(v.expression);case"arcade":return v.expression}return null}function y(C){const v=g(C);if(!v)return null;switch(v.type){case"conventional":return function f(C){return C?.match(p)?.[1].trim()||null}(v.expression);case"arcade":return O(v.expression)}return null}function T(C){let v;return C?(v=(0,m.gx)(C,K=>U+'$feature["'+K+'"]'+D),v=P.test(v)?v.replace(P,""):F+v,v=z.test(v)?v.replace(z,""):v+F,v=v.replaceAll(A,j).replaceAll(L,_)):v='""',v}const p=/^\s*\{([^}]+)\}\s*$/i,a=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,S=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,I=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function O(C){if(!C)return null;let v=a.exec(C)||S.exec(C);return v?v[1]||v[3]:(v=I.exec(C),v?v[2]:null)}},96043:(re,$,b)=>{b.d($,{AJ:()=>z,If:()=>_,k0:()=>P,uI:()=>j,ul:()=>L,wx:()=>u});var m=b(55117),U=b(55768),D=b(5710),A=b(23515);const L=2.4;function P(c){return(0,U.Wz)(c*L)}function z(c){return(0,U.F2)(c)/L}function F(c,g,R,y){let{color:T,ratio:p}=g,{color:f,ratio:a}=R;a===p&&(1===a?p-=1e-6:a+=1e-6);const S=(0,m.uZ)((y-p)/(a-p),0,1);(0,D.l)(c,T.toArray(),f.toArray(),S)}function j(c){const R=new Uint8ClampedArray(2048);if((c=c.filter(({ratio:a})=>a>=0&&a<=1).sort((a,S)=>a.ratio-S.ratio).map(({color:a,ratio:S})=>({color:a,ratio:Math.max(S,.001)}))).length<1)return R;let y=c[0],T=c[0],p=1;const f=(0,A.Ue)();for(let a=0;a<512;a++){const S=(a+.5)/512;for(;S>T.ratio&&p<c.length;)y=T,T=c[p++];F(f,y,T,S),R.set(f,4*a)}return R}function _(c,g,R){const y=Math.sqrt(c**2+g**2)/R;return y>1?0:3/(Math.PI*R**2)*(1-y**2)**2}function u(c){return"function"==typeof c?c:c?g=>+g[c]:()=>1}},43688:(re,$,b)=>{b.d($,{LR:()=>X,Uy:()=>C,VW:()=>P,Wb:()=>v,fm:()=>ne,kf:()=>K}),b(49602);var U=b(1678);function P(h,E){return function A(h,E){return E?.mode?E.mode:function D(h){return h?H:V}(h).mode}(null!=h&&h.hasZ,E)}function C(h,E,Z){return Z&&Z.mode!==E?`${h} only support ${E} elevation mode`:null}function v(h,E,Z){return Z?.mode===E?`${h} do not support ${E} elevation mode`:null}function K(h,E){return null!=E?.featureExpressionInfo&&"0"!==E.featureExpressionInfo.expression?`${h} do not support featureExpressionInfo`:null}function X(h,E){E&&h.warn(".elevationInfo=",E)}function ne(h){return(h?.offset??0)*(0,U.Z7)(h?.unit)}const H={mode:"absolute-height",offset:0},V={mode:"on-the-ground",offset:null}},96696:(re,$,b)=>{b.d($,{V5:()=>L,e7:()=>D});var m=b(15861),U=b(85295);function D(z){return A.apply(this,arguments)}function A(){return(A=(0,m.Z)(function*(z,F=z.popupTemplate){if(null==F)return[];const j=yield F.getRequiredFields(z.fieldsIndex),{lastEditInfoEnabled:_}=F,{objectIdField:u,typeIdField:c,globalIdField:g,relationships:R}=z;if(j.includes("*"))return["*"];const y=_?(0,U.CH)(z):[],T=(0,U.Q0)(z.fieldsIndex,[...j,...y]);return c&&T.push(c),T&&u&&z.fieldsIndex?.has(u)&&!T.includes(u)&&T.push(u),T&&g&&z.fieldsIndex?.has(g)&&!T.includes(g)&&T.push(g),R&&R.forEach(p=>{const{keyField:f}=p;T&&f&&z.fieldsIndex?.has(f)&&!T.includes(f)&&T.push(f)}),T})).apply(this,arguments)}function L(z,F){return z.popupTemplate?z.popupTemplate:null!=F&&F.defaultPopupTemplateEnabled&&null!=z.defaultPopupTemplate?z.defaultPopupTemplate:null}}}]);