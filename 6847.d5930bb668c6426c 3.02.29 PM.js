"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[6847,318,5398,9005],{52540:(te,V,s)=>{s.d(V,{z:()=>P});var S=s(39921);class P{constructor(F,w){this._storage=new S.WJ,this.id="",this.name="",this.size=0,this._storage.maxSize=F,this._storage.register(this),w&&this._storage.registerRemoveFunc("",w)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(F,w,x=1){this._storage.put(this,F,w,x,1)}pop(F){return this._storage.pop(this,F)}get(F){return this._storage.get(this,F)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(F){this._storage.maxSize=F}resetHitRate(){}}},39921:(te,V,s)=>{s.d(V,{WJ:()=>x,Xq:()=>w});var F,G,S=s(43029);(G=F||(F={}))[G.ALL=0]="ALL",G[G.SOME=1]="SOME";class w{constructor(h,p,E){this.name=h,this._storage=p,this.id=b+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),E&&(this._storage.registerRemoveFunc(this.id,E),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(h){return this._storage.getSize(this,h)}resetHitRate(){this._hit=this._miss=0}put(h,p,E,O=0){this._storage.put(this,h,p,E,O)}pop(h){const p=this._storage.pop(this,h);return void 0===p?++this._miss:++this._hit,p}get(h){const p=this._storage.get(this,h);return void 0===p?++this._miss:++this._hit,p}peek(h){return this._storage.peek(this,h)}updateSize(h,p,E){this._storage.updateSize(this,h,p,E)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class x{get size(){return this._size}constructor(h=10485760){this._maxSize=h,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new S.Z,this._users=new S.Z}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(h){this._users.push(h)}deregister(h){this._users.removeUnordered(h)}registerRemoveFunc(h,p){this._removeFuncs.push([h,p])}deregisterRemoveFunc(h){this._removeFuncs.filterInPlace(p=>p[0]!==h)}get maxSize(){return this._maxSize}set maxSize(h){this._maxSize=Math.max(h,-1),this._checkSize()}getSize(h,p){return this._db.get(h.id+p)?.size??0}put(h,p,E,O,W){const R=this._db.get(p=h.id+p);if(R&&(this._size-=R.size,h.size-=R.size,this._db.delete(p),R.entry!==E&&this._notifyRemove(p,R.entry,R.size,F.ALL)),O>this._maxSize)return void this._notifyRemove(p,E,O,F.ALL);if(void 0===E)return void console.warn("Refusing to cache undefined entry ");if(!O||O<0)return console.warn(`Refusing to cache entry with size ${O} for key ${p}`),void this._notifyRemove(p,E,0,F.ALL);const _=1+Math.max(W,-4)- -3;this._db.set(p,new $(E,O,_)),this._size+=O,h.size+=O,this._checkSize()}updateSize(h,p,E,O){const W=this._db.get(p=h.id+p);if(W&&W.entry===E){for(this._size-=W.size,h.size-=W.size;O>this._maxSize;){const R=this._notifyRemove(p,E,O,F.SOME);if(!(null!=R&&R>0))return void this._db.delete(p);O=R}W.size=O,this._size+=O,h.size+=O,this._checkSize()}}pop(h,p){const E=this._db.get(p=h.id+p);if(E)return this._size-=E.size,h.size-=E.size,this._db.delete(p),++this._hit,E.entry;++this._miss}get(h,p){const E=this._db.get(p=h.id+p);if(void 0!==E)return this._db.delete(p),E.lives=E.lifetime,this._db.set(p,E),++this._hit,E.entry;++this._miss}peek(h,p){const E=this._db.get(h.id+p);return E?++this._hit:++this._miss,E?.entry}get performanceInfo(){const h={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},p={},E=new Array;this._db.forEach((R,_)=>{const c=R.lifetime;E[c]=(E[c]||0)+R.size,this._users.forAll(d=>{const{id:f,name:m}=d;_.startsWith(f)&&(p[m]=(p[m]||0)+R.size)})});const O={};this._users.forAll(R=>{const _=R.name;"hitRate"in R&&"number"==typeof R.hitRate&&!isNaN(R.hitRate)&&R.hitRate>0?(p[_]=p[_]||0,O[_]=Math.round(100*R.hitRate)+"%"):O[_]="0%"});const W=Object.keys(p);W.sort((R,_)=>p[_]-p[R]),W.forEach(R=>h[R]=Math.round(p[R]/2**20)+"MB / "+O[R]);for(let R=E.length-1;R>=0;--R){const _=E[R];_&&(h["Priority "+(R+-3-1)]=Math.round(_/this._size*100)+"%")}return h}resetStats(){this._hit=this._miss=0,this._users.forAll(h=>h.resetHitRate())}clear(h){const p=h.id;this._db.forEach((E,O)=>{O.startsWith(p)&&(this._size-=E.size,this._db.delete(O),this._notifyRemove(O,E.entry,E.size,F.ALL))}),h.size=0}clearAll(){this._db.forEach((h,p)=>this._notifyRemove(p,h.entry,h.size,F.ALL)),this._users.forAll(h=>h.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(h,p,E,O){let W;return this._removeFuncs.some(R=>{if(h.startsWith(R[0])){const _=R[1](p,O,E);return"number"==typeof _&&(W=_),!0}return!1}),W}_checkSize(){this._users.forAll(h=>this._checkSizeLimits(h)),this._checkSizeLimits()}_checkSizeLimits(h){const p=h??this;if(p.maxSize<0||p.size<=p.maxSize)return;const E=h?.id;let O=!0;for(;O;){O=!1;for(const[W,R]of this._db)if(0===R.lifetime&&(!E||W.startsWith(E))){if(this._purgeItem(W,R,h),p.size<=.9*p.maxSize)return;O||=this._db.has(W)}}for(const[W,R]of this._db)if((!E||W.startsWith(E))&&(this._purgeItem(W,R,h),p.size<=.9*p.maxSize))return}_purgeItem(h,p,E=this._users.find(O=>h.startsWith(O.id))){if(this._db.delete(h),p.lives<=1){this._size-=p.size,E&&(E.size-=p.size);const O=this._notifyRemove(h,p.entry,p.size,F.SOME);null!=O&&O>0&&(this._size+=O,E&&(E.size+=O),p.lives=p.lifetime,p.size=O,this._db.set(h,p))}else--p.lives,this._db.set(h,p)}}let b=0;class ${constructor(h,p,E){this.entry=h,this.size=p,this.lifetime=E,this.lives=E}}},657:(te,V,s)=>{s.d(V,{$c:()=>W,Hg:()=>R,jW:()=>p,uD:()=>E});var S=s(73514),P=s(83944),Q=s(49301);const F=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function w(c){return c instanceof S.Z}function x(c){return c instanceof P.Z?Object.keys(c.items):w(c)?(0,Q.vw)(c).keys():c?Object.keys(c):[]}function b(c,d){return c instanceof P.Z?c.items[d]:c[d]}function G(c){return c?c.declaredClass:null}function h(c,d){const f=c.diff;if(f&&"function"==typeof f)return f(c,d);const m=x(c),T=x(d);if(0===m.length&&0===T.length)return;if(!m.length||!T.length||function $(c,d){return!(!Array.isArray(c)||!Array.isArray(d))&&c.length!==d.length}(c,d))return{type:"complete",oldValue:c,newValue:d};const D=T.filter(C=>!m.includes(C)),y=m.filter(C=>!T.includes(C)),M=m.filter(C=>T.includes(C)&&b(c,C)!==b(d,C)).concat(D,y).sort(),L=G(c);if(L&&F.has(L)&&M.length)return{type:"complete",oldValue:c,newValue:d};let U;const Z=w(c)&&w(d);for(const C of M){const u=b(c,C),g=b(d,C);let A;if((Z||"function"!=typeof u&&"function"!=typeof g)&&u!==g&&(null!=u||null!=g)){if(f&&f[C]&&"function"==typeof f[C])A=f[C]?.(u,g);else if(u instanceof Date&&g instanceof Date){if(u.getTime()===g.getTime())continue;A={type:"complete",oldValue:u,newValue:g}}else A="object"==typeof u&&"object"==typeof g&&G(u)===G(g)?h(u,g):{type:"complete",oldValue:u,newValue:g};null!=A&&(null!=U?U.diff[C]=A:U={type:"partial",diff:{[C]:A}})}}return U}function p(c,d){return E(c,d)}function E(c,d){if(null==c)return!1;const f=d.split(".");let m=c;for(const T of f){if("complete"===m.type)return!0;if("partial"!==m.type)return!1;{const D=m.diff[T];if(!D)return!1;m=D}}return!0}function W(c,d){if(!c)return!1;if("partial"===c.type){const f=Object.keys(c.diff);return 1===f.length&&f[0]===d}return!1}function R(c,d){if("function"!=typeof c&&"function"!=typeof d&&(null!=c||null!=d))return null==c||null==d||"object"==typeof c&&"object"==typeof d&&G(c)!==G(d)?{type:"complete",oldValue:c,newValue:d}:h(c,d)}},15398:(te,V,s)=>{s.d(V,{A4:()=>Q,L9:()=>F,yV:()=>P});var S=s(25037);class P{}function Q(x){return x instanceof S.ld?x===P.instance:"unknown"===x?.toString().toLowerCase()}function F(x){return Q(x)?P.instance:x}P.instance=new S.vF("Etc/UTC")},66398:(te,V,s)=>{function P(l){return l?{originPosition:"upper-left"===l.originPosition?"upperLeft":"lower-left"===l.originPosition?"lowerLeft":l.originPosition,scale:l.tolerance?[l.tolerance,l.tolerance,1,1]:[1,1,1,1],translate:null!=l.extent?[l.extent.xmin,l.extent.ymax,l.extent.zmin??0,l.extent.mmin??0]:[0,0,0,0]}:null}function F(l){if(function Q(l){return"lowerLeft"===l.originPosition&&4===l.scale.length&&4===l.translate.length}(l))return l;const{originPosition:i,scale:a,translate:v}=l,B=a[1]??1;return{originPosition:"lowerLeft",scale:[a[0]??1,"lowerLeft"===i?B:-B,a[2]??1,a[3]??1],translate:[v[0]??0,v[1]??0,v[2]??0,v[3]??0]}}function c({scale:l,translate:i},a){return a*l[0]+i[0]}function d({scale:l,translate:i},a){return a*l[1]+i[1]}function f({scale:l,translate:i},a){return(a??0)*l[2]+i[2]}function m({scale:l,translate:i},a){return a?a*l[3]+i[3]:0}function T(l,i){return l&&i?L:l&&!i?y:!l&&i?M:D}s.d(V,{G6:()=>_e,Ie:()=>he,J9:()=>de,RF:()=>ie,U1:()=>ae,vY:()=>P}),s(40637);const D=(l,i)=>{const a=new Array(i.length);if(!i.length)return a;const v=i[0];let j=c(l,v[0]),B=d(l,v[1]);a[0]=[j,B];const{scale:J,originPosition:Y}=l,N=J[0],q="lowerLeft"===Y?J[1]:-J[1];for(let I=1;I<i.length;I++){const[K,H]=i[I];j+=N*K,B+=q*H,a[I]=[j,B]}return a},y=(l,i)=>{const a=new Array(i.length);if(!i.length)return a;const v=i[0];let j=c(l,v[0]),B=d(l,v[1]);a[0]=[j,B,f(l,v[2])];const{scale:J,originPosition:Y}=l,N=J[0],q="lowerLeft"===Y?J[1]:-J[1];for(let I=1;I<i.length;I++){const[K,H,X]=i[I];j+=N*K,B+=q*H,a[I]=[j,B,f(l,X)]}return a},M=(l,i)=>{const a=new Array(i.length);if(!i.length)return a;const v=i[0];let j=c(l,v[0]),B=d(l,v[1]);a[0]=[j,B,m(l,v[2])];const{scale:J,originPosition:Y}=l,N=J[0],q="lowerLeft"===Y?J[1]:-J[1];for(let I=1;I<i.length;I++){const[K,H,X]=i[I];j+=N*K,B+=q*H,a[I]=[j,B,m(l,X)]}return a},L=(l,i)=>{const a=new Array(i.length);if(!i.length)return a;const v=i[0];let j=c(l,v[0]),B=d(l,v[1]);a[0]=[j,B,f(l,v[2]),m(l,v[3])];const{scale:J,originPosition:Y}=l,N=J[0],q="lowerLeft"===Y?J[1]:-J[1];for(let I=1;I<i.length;I++){const[K,H,X,re]=i[I];j+=N*K,B+=q*H,a[I]=[j,B,f(l,X),m(l,re)]}return a};function U(l,i,a){const v=new Array(a.length);for(let j=0;j<a.length;j++)v[j]=i(l,a[j]);return v}function ie(l,i,a){const v=F(l);return i.x=function w({scale:l,translate:i},a){return Math.round((a-i[0])/l[0])}(v,a.x),i.y=function x({scale:l,translate:i},a){return Math.round((a-i[1])/l[1])}(v,a.y),null!=a.z&&(i.z=function b({scale:l,translate:i},a){return Math.round(((a??0)-i[2])/l[2])}(v,a.z)),null!=a.m&&(i.m=function $({scale:l,translate:i},a){return a?Math.round((a-i[3])/l[3]):0}(v,a.m)),i}function de(l,i,a,v=a?.hasZ??!1,j=a?.hasM??!1){if(null!=a){const B=F(l);i.points=T(v,j)(B,a.points),i.hasZ=v,i.hasM=j}return i}function ae(l,i,a,v=null!=a?.z,j=null!=a?.m){if(null==a)return i;const B=F(l);return i.x=c(B,a.x),i.y=d(B,a.y),v&&(i.z=f(B,a.z)),j&&(i.m=m(B,a.m)),i}function he(l,i,a,v=a?.hasZ??!1,j=a?.hasM??!1){if(null!=a){const B=F(l);i.rings=U(B,T(v,j),a.rings),i.hasZ=v,i.hasM=j}return i}function _e(l,i,a,v=a?.hasZ??!1,j=a?.hasM??!1){if(null!=a){const B=F(l);i.paths=U(B,T(v,j),a.paths),i.hasZ=v,i.hasM=j}return i}},36019:(te,V,s)=>{s.r(V),s.d(V,{default:()=>q});var S=s(15861),P=s(50484),F=(s(2189),s(62691)),W=(s(36699),s(12610),s(53722),s(82752),s(28999),s(38748),s(50923),s(42212),s(91963),s(41007)),R=s(3233),_=s(80543),m=(s(14007),s(4703),s(65311),s(10141)),T=s(31709),D=s(95060),y=s(57964),M=s(67016),L=s(72578),U=s(62871),Z=s(93792),C=s(43814);let u=class extends M.Z{constructor(){super(...arguments),this.featureDefinition=null,this.type="ogc-feature"}load(I){return this.addResolvingPromise(this._loadOGCServices(this.layer,I)),this.when()}getSource(){const{featureDefinition:{collection:I,layerDefinition:K,spatialReference:H,supportedCrs:X},layer:{apiKey:re,customParameters:oe,effectiveMaxRecordCount:se}}=this;return{type:"ogc-source",collection:I,layerDefinition:K,maxRecordCount:se,queryParameters:{apiKey:re,customParameters:oe},spatialReference:H,supportedCrs:X}}queryExtent(I,K={}){return null}queryFeatureCount(I,K={}){return null}queryFeatures(I,K={}){return this.queryFeaturesJSON(I,K).then(H=>Z.Z.fromJSON(H))}queryFeaturesJSON(I,K={}){const H=this.getSource();return this.load(K).then(()=>(0,U.yN)(H,I,K))}queryObjectIds(I,K={}){return null}serviceSupportsSpatialReference(I){return!(!I.isWGS84&&!I.isWebMercator&&!this.featureDefinition.supportedCrs[I.wkid])}_conformsToType(I,K){const H=new RegExp(`^${(0,L.Qs)(K)}$`,"i");return I.conformsTo.some(X=>H.test(X))??!1}_getCapabilities(I,K){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:I},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},query:{maxRecordCount:K,maxRecordCountFactor:void 0,standardMaxRecordCount:void 0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,supportsSqlExpression:!1,tileMaxRecordCount:void 0},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUploadWithItemId:!1,supportsUpdateWithoutM:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}_getMaxRecordCount(I){const K=I?.components?.parameters;return K?.limit?.schema?.maximum??K?.limitFeatures?.schema?.maximum}_getStorageSpatialReference(I){const H=(0,U.d)(I.storageCrs??U.$9);return null==H?C.Z.WGS84:new C.Z({wkid:H})}_getSupportedSpatialReferences(I,K){const H="#/crs",X=I.crs??[U.$9],re=X.includes(H)?X.filter(se=>se!==H).concat(K.crs??[]):X,oe=/^http:\/\/www\.opengis.net\/def\/crs\/epsg\/.*\/3785$/i;return re.filter(se=>!oe.test(se))}_loadOGCServices(I,K){var H=this;return(0,S.Z)(function*(){const X=null!=K?K.signal:null,{apiKey:re,collectionId:oe,customParameters:se,fields:Oe,geometryType:De,hasZ:Ce,objectIdField:Ie,timeInfo:Re,url:Te}=I,Se={fields:Oe?.map(ue=>ue.toJSON()),geometryType:T.P.toJSON(De),hasZ:Ce??!1,objectIdField:Ie,timeInfo:Re?.toJSON()},ce={apiKey:re,customParameters:se,signal:X},fe=yield(0,U.gp)(Te,ce),[ve,Me]=yield Promise.all([(0,U.G4)(fe,ce),(0,U.j)(fe,ce)]);if(!H._conformsToType(ve,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson"))throw new y.Z("ogc-feature-layer:no-geojson-support","Server does not support geojson");const pe=Me.collections.find(({id:ue})=>ue===oe);if(!pe)throw new y.Z("ogc-feature-layer:collection-not-found","Server does not contain the named collection");const Le=H._conformsToType(ve,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30")?yield(0,U.eS)(fe,ce):null,Pe=yield(0,U.w9)(pe,Se,ce),Ae=H._getMaxRecordCount(Le),je=H._getCapabilities(Pe.hasZ,Ae),xe=H._getStorageSpatialReference(pe).toJSON(),Ue=H._getSupportedSpatialReferences(pe,Me),Fe=new RegExp(`^${(0,L.Qs)(U.Lu)}`,"i"),me={};for(const ue of Ue){const ye=(0,U.d)(ue);null!=ye&&(me[ye]||(me[ye]=ue.replace(Fe,"")))}H.featureDefinition={capabilities:je,collection:pe,layerDefinition:Pe,spatialReference:xe,supportedCrs:me}})()}};(0,P._)([(0,_.Cb)()],u.prototype,"featureDefinition",void 0),(0,P._)([(0,_.Cb)({constructOnly:!0})],u.prototype,"layer",void 0),(0,P._)([(0,_.Cb)()],u.prototype,"type",void 0),u=(0,P._)([(0,m.j)("esri.layers.graphics.sources.OGCFeatureSource")],u);var g=s(29674),A=s(19855),z=s(27426),ee=s(12621),k=s(78601),ie=s(80099),le=s(32250),ne=s(70509),ge=s(25836),Ee=s(29717),de=s(12522),ae=s(56956),he=s(50243),_e=s(81247),l=s(27969),i=s(85295),a=s(40591),v=s(75421),j=s(91866),B=s(33331),J=s(26894);const Y=(0,l.v)();let N=class extends((0,g.V)((0,z.N)((0,k.M)((0,ee.b)((0,A.h7)((0,le.c)((0,de.n)((0,Ee.M)((0,ie.q)((0,ne.I)((0,ge.Q)((0,R.R)(D.Z))))))))))))){constructor(I){super(I),this.capabilities=null,this.collectionId=null,this.copyright=null,this.description=null,this.displayField=null,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelingInfo=null,this.labelsVisible=!0,this.legendEnabled=!0,this.maxRecordCount=null,this.objectIdField=null,this.operationalLayerType="OGCFeatureLayer",this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new u({layer:this}),this.spatialReference=null,this.title=null,this.type="ogc-feature",this.typeIdField=null,this.types=null,this.url=null}destroy(){this.source?.destroy()}load(I){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["OGCFeatureServer"]},I).then(()=>this._fetchService(I))),this.when()}get defaultPopupTemplate(){return this.createPopupTemplate()}get effectiveMaxRecordCount(){return this.maxRecordCount??this.capabilities?.query.maxRecordCount??5e3}get isTable(){return this.loaded&&null==this.geometryType}set renderer(I){(0,i.YN)(I,this.fieldsIndex),this._set("renderer",I)}on(I,K){return super.on(I,K)}createPopupTemplate(I){return(0,B.eZ)(this,I)}createQuery(){return new j.Z}getField(I){return this.fieldsIndex.get(I)}getFieldDomain(I,K){let H,X=!1;const re=K?.feature?.attributes,oe=this.typeIdField&&re?.[this.typeIdField];return null!=oe&&this.types&&(X=this.types.some(se=>se.id==oe&&(H=se.domains?.[I],"inherited"===H?.type&&(H=this._getLayerDomain(I)),!0))),X||H||(H=this._getLayerDomain(I)),H}queryFeatures(I,K){return this.load().then(()=>this.source.queryFeatures(j.Z.from(I)||this.createQuery(),K)).then(H=>(H?.features?.forEach(X=>{X.layer=X.sourceLayer=this}),H))}serviceSupportsSpatialReference(I){return this.source?.serviceSupportsSpatialReference(I)??!1}_fetchService(I){var K=this;return(0,S.Z)(function*(){yield K.source.load(I),K.read(K.source.featureDefinition,{origin:"service"}),(0,i.YN)(K.renderer,K.fieldsIndex),(0,i.UF)(K.timeInfo,K.fieldsIndex)})()}_getLayerDomain(I){if(!this.fields)return null;for(const K of this.fields)if(K.name===I&&K.domain)return K.domain;return null}};(0,P._)([(0,_.Cb)({readOnly:!0,json:{origins:{service:{read:!0}}}})],N.prototype,"capabilities",void 0),(0,P._)([(0,_.Cb)({type:String,json:{write:!0}})],N.prototype,"collectionId",void 0),(0,P._)([(0,_.Cb)({type:String})],N.prototype,"copyright",void 0),(0,P._)([(0,_.Cb)({readOnly:!0})],N.prototype,"defaultPopupTemplate",null),(0,P._)([(0,_.Cb)({readOnly:!0,type:String,json:{origins:{service:{name:"collection.description"}}}})],N.prototype,"description",void 0),(0,P._)([(0,_.Cb)({type:String})],N.prototype,"displayField",void 0),(0,P._)([(0,_.Cb)({type:Number})],N.prototype,"effectiveMaxRecordCount",null),(0,P._)([(0,_.Cb)(ae.PV)],N.prototype,"elevationInfo",void 0),(0,P._)([(0,_.Cb)({type:[_e.Z],json:{origins:{service:{name:"layerDefinition.fields"}}}})],N.prototype,"fields",void 0),(0,P._)([(0,_.Cb)(Y.fieldsIndex)],N.prototype,"fieldsIndex",void 0),(0,P._)([(0,_.Cb)({readOnly:!0,type:J.Z,json:{origins:{service:{name:"layerDefinition.extent"}}}})],N.prototype,"fullExtent",void 0),(0,P._)([(0,_.Cb)({type:T.M.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:T.M.read}}}}})],N.prototype,"geometryType",void 0),(0,P._)([(0,_.Cb)({type:Boolean,json:{origins:{service:{name:"layerDefinition.hasZ"}}}})],N.prototype,"hasZ",void 0),(0,P._)([(0,_.Cb)({type:Boolean,readOnly:!0})],N.prototype,"isTable",null),(0,P._)([(0,_.Cb)({type:[a.Z],json:{origins:{"web-document":{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:v.r},write:!0}}}})],N.prototype,"labelingInfo",void 0),(0,P._)([(0,_.Cb)(ae.iR)],N.prototype,"labelsVisible",void 0),(0,P._)([(0,_.Cb)(ae.rn)],N.prototype,"legendEnabled",void 0),(0,P._)([(0,_.Cb)({type:Number})],N.prototype,"maxRecordCount",void 0),(0,P._)([(0,_.Cb)({type:String,json:{origins:{service:{name:"layerDefinition.objectIdField"}}}})],N.prototype,"objectIdField",void 0),(0,P._)([(0,_.Cb)({type:["OGCFeatureLayer"]})],N.prototype,"operationalLayerType",void 0),(0,P._)([(0,_.Cb)(ae.C_)],N.prototype,"popupEnabled",void 0),(0,P._)([(0,_.Cb)({type:F.Z,json:{name:"popupInfo",write:!0}})],N.prototype,"popupTemplate",void 0),(0,P._)([(0,_.Cb)({types:W.A,json:{origins:{service:{name:"layerDefinition.drawingInfo.renderer",write:!1},"web-scene":{types:W.o,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:!0}})],N.prototype,"renderer",null),(0,P._)([(0,_.Cb)(ae.YI)],N.prototype,"screenSizePerspectiveEnabled",void 0),(0,P._)([(0,_.Cb)({readOnly:!0})],N.prototype,"source",void 0),(0,P._)([(0,_.Cb)({readOnly:!0,type:C.Z,json:{origins:{service:{read:!0}}}})],N.prototype,"spatialReference",void 0),(0,P._)([(0,_.Cb)({type:String,json:{write:{enabled:!0,ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"collection.title"}}}})],N.prototype,"title",void 0),(0,P._)([(0,_.Cb)({readOnly:!0,json:{read:!1}})],N.prototype,"type",void 0),(0,P._)([(0,_.Cb)({type:String,readOnly:!0})],N.prototype,"typeIdField",void 0),(0,P._)([(0,_.Cb)({type:[he.Z]})],N.prototype,"types",void 0),(0,P._)([(0,_.Cb)(ae.HQ)],N.prototype,"url",void 0),N=(0,P._)([(0,m.j)("esri.layers.OGCFeatureLayer")],N);const q=N},85559:(te,V,s)=>{s.d(V,{g:()=>S});const S={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},29674:(te,V,s)=>{s.d(V,{V:()=>$});var S=s(50484),P=s(80543),x=(s(14007),s(4703),s(65311),s(10141));const $=G=>{let h=class extends G{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):function b(G){return"portalItem"in G}(this)?this.portalItem?.apiKey:null}set apiKey(p){null!=p?this._override("apiKey",p):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return(0,S._)([(0,P.Cb)({type:String})],h.prototype,"apiKey",null),h=(0,S._)([(0,x.j)("esri.layers.mixins.APIKeyMixin")],h),h}},27426:(te,V,s)=>{s.d(V,{N:()=>b});var S=s(50484),P=s(80543),x=(s(14007),s(4703),s(65311),s(10141));const b=$=>{let G=class extends ${constructor(){super(...arguments),this.customParameters=null}};return(0,S._)([(0,P.Cb)({type:Object,json:{write:{overridePolicy:h=>({enabled:!!(h&&Object.keys(h).length>0)})}}})],G.prototype,"customParameters",void 0),G=(0,S._)([(0,x.j)("esri.layers.mixins.CustomParametersMixin")],G),G}},32250:(te,V,s)=>{s.d(V,{c:()=>E,l:()=>p});var S=s(50484),P=s(71763),Q=s(80543),b=(s(14007),s(4703),s(65311),s(10141)),$=s(35469);const p={type:[$.Z],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:function G(O,W,R){if(!O)return null;const _=O.find(d=>!!d.field);if(!_)return null;const c=new $.Z;return c.read(_,R),[c]}},write:{writer:function h(O,W,R,_){const c=O.find(d=>!!d.field);c&&(0,P.RB)(R,[c.toJSON()],W)}}}},E=O=>{let W=class extends O{constructor(){super(...arguments),this.orderBy=null}};return(0,S._)([(0,Q.Cb)(p)],W.prototype,"orderBy",void 0),W=(0,S._)([(0,b.j)("esri.layers.mixins.OrderedLayer")],W),W}},70509:(te,V,s)=>{s.d(V,{I:()=>y});var S=s(15861),P=s(50484),Q=s(11931),F=s(26152),w=s(66476),x=s(37636),b=s(57964),$=s(4703),G=s(51172),h=s(79412),p=s(6785),E=s(80543),R=(s(14007),s(65311),s(62185)),_=s(10141),c=s(7547),d=s(85971),f=s(61018),m=s(27835),T=s(57437),D=s(50318);const y=L=>{let U=class extends L{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,G.SC)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(Z){Z!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",Z))}readPortalItem(Z,C,u){if(C.itemId)return new m.default({id:C.itemId,portal:u?.portal})}writePortalItem(Z,C){Z?.id&&(C.itemId=Z.id)}loadFromPortal(Z,C){var u=this;return(0,S.Z)(function*(){if(u.portalItem?.id)try{const{load:g}=yield Promise.all([s.e(2772),s.e(8592),s.e(6964)]).then(s.bind(s,36964));return(0,h.k_)(C),yield g({instance:u,supportedTypes:Z.supportedTypes,validateItem:Z.validateItem,supportsData:Z.supportsData,layerModuleTypeMap:Z.layerModuleTypeMap},C)}catch(g){throw(0,h.D_)(g)||$.Z.getLogger(u).warn(`Failed to load layer (${u.title}, ${u.id}) portal item (${u.portalItem.id})\n  ${g}`),g}})()}finishLoadEditablePortalLayer(Z){var C=this;return(0,S.Z)(function*(){C._set("userHasEditingPrivileges",yield C._fetchUserHasEditingPrivileges(Z).catch(u=>((0,h.r9)(u),!0)))})()}setUserPrivileges(Z,C){var u=this;return(0,S.Z)(function*(){if(!Q.default.userPrivilegesApplied)return u.finishLoadEditablePortalLayer(C);if(u.url)try{const{features:{edit:g,fullEdit:A},content:{updateItem:z}}=yield u._fetchUserPrivileges(Z,C);u._set("userHasEditingPrivileges",g),u._set("userHasFullEditingPrivileges",A),u._set("userHasUpdateItemPrivileges",z)}catch(g){(0,h.r9)(g)}})()}_fetchUserPrivileges(Z,C){var u=this;return(0,S.Z)(function*(){let g=u.portalItem;if(!Z||!g||!g.loaded||g.sourceUrl)return u._fetchFallbackUserPrivileges(C);const A=Z===g.id;if(A&&g.portal.user)return(0,D.Ss)(g);let z,ee;if(A)z=g.portal.url;else try{z=yield(0,d.oP)(u.url,C)}catch(ne){(0,h.r9)(ne)}if(!z||!(0,p.Zo)(z,g.portal.url))return u._fetchFallbackUserPrivileges(C);try{const ne=null!=C?C.signal:null;ee=yield F.id?.getCredential(`${z}/sharing`,{prompt:!1,signal:ne})}catch(ne){(0,h.r9)(ne)}if(!ee)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(A?yield g.reload():(g=new m.default({id:Z,portal:{url:z}}),yield g.load(C)),g.portal.user)return(0,D.Ss)(g)}catch(ne){(0,h.r9)(ne)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_fetchFallbackUserPrivileges(Z){var C=this;return(0,S.Z)(function*(){let u=!0;try{u=yield C._fetchUserHasEditingPrivileges(Z)}catch(g){(0,h.r9)(g)}return{features:{edit:u,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(Z){var C=this;return(0,S.Z)(function*(){const u=C.url?F.id?.findCredential(C.url):null;if(!u)return!0;const g=M.credential===u?M.user:yield C._fetchEditingUser(Z);return M.credential=u,M.user=g,null==g?.privileges||g.privileges.includes("features:user:edit")})()}_fetchEditingUser(Z){var C=this;return(0,S.Z)(function*(){const u=C.portalItem?.portal?.user;if(u)return u;const g=F.id?.findServerInfo(C.url??"");if(!g?.owningSystemUrl)return null;const A=`${g.owningSystemUrl}/sharing/rest`,z=f.Z.getDefault();if(z&&z.loaded&&(0,p.Fv)(z.restUrl)===(0,p.Fv)(A))return z.user;const ee=`${A}/community/self`,k=null!=Z?Z.signal:null,ie=yield(0,x.q6)((0,w.Z)(ee,{authMode:"no-prompt",query:{f:"json"},signal:k}));return ie.ok?T.Z.fromJSON(ie.value.data):null})()}read(Z,C){C&&(C.layer=this),super.read(Z,C)}write(Z,C){const u=C?.portal,g=this.portalItem?.id&&(this.portalItem.portal||f.Z.getDefault());return u&&g&&!(0,p.tm)(g.restUrl,u.restUrl)?(C.messages&&C.messages.push(new b.Z("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(Z,{...C,layer:this})}};return(0,P._)([(0,E.Cb)({type:m.default})],U.prototype,"portalItem",null),(0,P._)([(0,R.r)("web-document","portalItem",["itemId"])],U.prototype,"readPortalItem",null),(0,P._)([(0,c.c)("web-document","portalItem",{itemId:{type:String}})],U.prototype,"writePortalItem",null),(0,P._)([(0,E.Cb)({clonable:!1})],U.prototype,"resourceReferences",void 0),(0,P._)([(0,E.Cb)({type:Boolean,readOnly:!0})],U.prototype,"userHasEditingPrivileges",void 0),(0,P._)([(0,E.Cb)({type:Boolean,readOnly:!0})],U.prototype,"userHasFullEditingPrivileges",void 0),(0,P._)([(0,E.Cb)({type:Boolean,readOnly:!0})],U.prototype,"userHasUpdateItemPrivileges",void 0),U=(0,P._)([(0,_.j)("esri.layers.mixins.PortalLayer")],U),U},M={credential:null,user:null}},25836:(te,V,s)=>{s.d(V,{Q:()=>C});var S=s(15861),P=s(50484),F=(s(14007),s(4703)),w=s(79412),x=s(80543),b=s(73018),G=(s(65311),s(10141)),h=s(76215),p=s(83944),R=(s(37636),s(57964),s(12926),s(43571));const _=new p.Z,c=new WeakMap;function T(u,g){return Number.isFinite(u)&&Number.isFinite(g)?g<=0?u:T(g,u%g):0}let D=0,y=0;function M(){const u=Date.now();let g=!1;for(const A of _){const z=A.deref();z?z.refreshInterval&&u-(c.get(z)??0)+5>=6e4*z.refreshInterval&&(c.set(z,u),z.refresh(u)):g=!0}if(g)for(let A=_.length-1;A>=0;A--)_.at(A).deref()||_.removeAt(A)}(0,R.EH)(()=>{const u=Date.now();let g=0;for(const A of _){const z=A.deref();z&&(g=T(Math.round(6e4*z.refreshInterval),g),z.refreshInterval?c.get(z)||c.set(z,u):c.delete(z))}if(g!==y){if(y=g,clearInterval(D),0===y)return void(D=0);D=setInterval(M,y)}});const C=u=>{let g=class extends u{constructor(...A){super(...A),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,w.Ds)(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||function d(u){(function m(u){return null!=u&&"object"==typeof u&&"refreshInterval"in u&&"refresh"in u})(u)&&_.push(new WeakRef(u))}(this)},()=>{})}destroy(){!function f(u){const g=_.find(A=>A.deref()===u);g&&_.remove(g)}(this)}castRefreshInterval(A){return A>=.1?A:A<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(A=Date.now()){(0,w.R8)(this._debounceHasDataChanged()).then(z=>{z&&this._set("refreshTimestamp",A),this.emit("refresh",{dataChanged:z})},z=>{F.Z.getLogger(this).error(z),this.emit("refresh",{dataChanged:!1,error:z})})}hasDataChanged(){return(0,S.Z)(function*(){return!0})()}get test(){}};return(0,P._)([(0,x.Cb)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:h.C}}}}})],g.prototype,"refreshInterval",void 0),(0,P._)([(0,b.p)("refreshInterval")],g.prototype,"castRefreshInterval",null),(0,P._)([(0,x.Cb)({readOnly:!0})],g.prototype,"refreshTimestamp",void 0),(0,P._)([(0,x.Cb)({readOnly:!0})],g.prototype,"refreshParameters",null),g=(0,P._)([(0,G.j)("esri.layers.mixins.RefreshableLayer")],g),g}},30457:(te,V,s)=>{s.d(V,{Z:()=>E});var S=s(50484),P=s(25387),Q=s(84303),F=s(89317),w=s(80543),G=(s(14007),s(4703),s(65311),s(10141));const h=new Q.X({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let p=class extends((0,P.J)(F.wq)){constructor(O){super(O),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};(0,S._)([(0,w.Cb)({json:{write:!0}})],p.prototype,"name",void 0),(0,S._)([(0,w.Cb)({json:{write:!0}})],p.prototype,"description",void 0),(0,S._)([(0,w.Cb)({json:{read:h.read,write:h.write}})],p.prototype,"drawingTool",void 0),(0,S._)([(0,w.Cb)({json:{write:!0}})],p.prototype,"prototype",void 0),(0,S._)([(0,w.Cb)({json:{write:!0}})],p.prototype,"thumbnail",void 0),p=(0,S._)([(0,G.j)("esri.layers.support.FeatureTemplate")],p);const E=p},50243:(te,V,s)=>{s.d(V,{Z:()=>W});var S=s(50484),P=s(25387),Q=s(89317),F=s(80543),$=(s(14007),s(4703),s(65311),s(62185)),G=s(10141),h=s(7547),p=s(59300),E=s(30457);let O=class extends((0,P.J)(Q.wq)){constructor(R){super(R),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(R){const _={};for(const c of Object.keys(R))_[c]=(0,p.im)(R[c]);return _}writeDomains(R,_){const c={};for(const d of Object.keys(R))R[d]&&(c[d]=R[d]?.toJSON());_.domains=c}};(0,S._)([(0,F.Cb)({json:{write:!0}})],O.prototype,"id",void 0),(0,S._)([(0,F.Cb)({json:{write:!0}})],O.prototype,"name",void 0),(0,S._)([(0,F.Cb)({json:{write:!0}})],O.prototype,"domains",void 0),(0,S._)([(0,$.r)("domains")],O.prototype,"readDomains",null),(0,S._)([(0,h.c)("domains")],O.prototype,"writeDomains",null),(0,S._)([(0,F.Cb)({type:[E.Z],json:{write:!0}})],O.prototype,"templates",void 0),O=(0,S._)([(0,G.j)("esri.layers.support.FeatureType")],O);const W=O},40100:(te,V,s)=>{s.d(V,{Z:()=>O});var S=s(57964),P=s(89317),Q=s(4703),F=s(8611),w=s(15398),x=s(85295),b=s(764),$=s(25037);const E=new Map;class O{static fromJSON(f){return new O(f.fields,f.timeZoneByFieldName)}static fromLayer(f){return new O(f.fields??[],c(f))}static fromLayerJSON(f){return new O(f.fields??[],c(f))}constructor(f=[],m){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=f||[],this._timeZoneByFieldName=m?new Map(m):null;const T=[];for(const D of this.fields){const y=D?.name,M=R(y);if(y&&M){const L=W(y);this._fieldsMap.set(y,D),this._fieldsMap.set(L,D),this._normalizedFieldsMap.set(M,D),T.push(`${L}:${D.type}:${this._timeZoneByFieldName?.get(y)}`),(0,x.y2)(D)?(this.dateFields.push(D),this._dateFieldsSet.add(D)):(0,x.H7)(D)&&(this._numericFieldsSet.add(D),this.numericFields.push(D)),(0,x.Dl)(D)||(0,x.Se)(D)||(D.editable=null==D.editable||!!D.editable,D.nullable=null==D.nullable||!!D.nullable)}}T.sort(),this.uid=T.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const f of this.fields)(0,x.Dl)(f)||(0,x.Se)(f)||f.nullable||void 0!==(0,x.os)(f)||this._requiredFields.push(f)}return this._requiredFields}equals(f){return this.uid===f?.uid}has(f){return null!=this.get(f)}get(f){if(!f)return;let m=this._fieldsMap.get(f);return m||(m=this._fieldsMap.get(W(f))??this._normalizedFieldsMap.get(R(f)),m&&this._fieldsMap.set(f,m),m)}getTimeZone(f){const m=this.get(f&&"string"!=typeof f?f.name:f);return m?this._timeZoneByFieldName?this._timeZoneByFieldName.get(m.name):"date"===m.type||"esriFieldTypeDate"===m.type?(Q.Z.getLogger("esri.layers.support.FieldsIndex").error(new S.Z("getTimeZone:no-timezone-information",`no time zone information for field '${m.name}'`)),b.pt):_.has(m.type)?b._4:null:null}getLuxonTimeZone(f){const m=this.getTimeZone(f);return m?m===b._4?w.yV.instance:m===b.pt?$.Qf.utcInstance:(0,F.s1)(E,m,()=>$.vF.create(m)):null}isDateField(f){return this._dateFieldsSet.has(this.get(f))}isTimeOnlyField(f){return(0,x.sX)(this.get(f))}isNumericField(f){return this._numericFieldsSet.has(this.get(f))}normalizeFieldName(f){return this.get(f)?.name??void 0}toJSON(){return{fields:this.fields.map(f=>(0,P.AK)(f)?f.toJSON():f),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function W(d){return d.trim().toLowerCase()}function R(d){return(0,x.q6)(d)?.toLowerCase()??""}const _=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function c(d){const f=new Map;if(!d.fields)return f;const m=!0===d.datesInUnknownTimezone,{timeInfo:T,editFieldsInfo:D}=d,y=(T?"startField"in T?T.startField:T.startTimeField:"")??"",M=(T?"endField"in T?T.endField:T.endTimeField:"")??"",L=function p(d){return"dateFieldsTimeZone"in d}(d)?d.dateFieldsTimeZone??null:d.dateFieldsTimeReference?(0,b.Jv)(d.dateFieldsTimeReference):null,U=D?function G(d){return"timeZone"in d}(D)?D.timeZone??L:D.dateFieldsTimeReference?(0,b.Jv)(D.dateFieldsTimeReference):L??b.pt:null,Z=T?function h(d){return"timeZone"in d}(T)?T.timeZone??L:T.timeReference?(0,b.Jv)(T.timeReference):L:null,C=new Map([[W(D?.creationDateField??""),U],[W(D?.editDateField??""),U],[W(y),Z],[W(M),Z]]);for(const{name:u,type:g}of d.fields)if(_.has(g))f.set(u,b._4);else if("date"!==g&&"esriFieldTypeDate"!==g)f.set(u,null);else if(m)f.set(u,b._4);else{const A=C.get(W(u??""))??L;f.set(u,A)}return f}},35469:(te,V,s)=>{s.d(V,{Z:()=>E});var G,S=s(50484),P=s(84303),Q=s(89317),F=s(80543),$=(s(14007),s(4703),s(65311),s(10141));const h=new P.X({asc:"ascending",desc:"descending"});let p=G=class extends Q.wq{constructor(O){super(O),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new G({field:this.field,valueExpression:this.valueExpression,order:this.order})}};(0,S._)([(0,F.Cb)({type:String,json:{write:!0}})],p.prototype,"field",void 0),(0,S._)([(0,F.Cb)({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],p.prototype,"valueExpression",void 0),(0,S._)([(0,F.Cb)({type:h.apiValues,json:{type:h.jsonValues,read:h.read,write:h.write}})],p.prototype,"order",void 0),p=G=(0,S._)([(0,$.j)("esri.layers.support.OrderByInfo")],p);const E=p},56761:(te,V,s)=>{s.d(V,{UG:()=>p,UO:()=>R,YI:()=>W,dI:()=>_,el:()=>D,hV:()=>O,z7:()=>E});var S=s(72578);const P="__begin__",Q="__end__",F=new RegExp(P,"ig"),w=new RegExp(Q,"ig"),x=new RegExp("^"+P,"i"),b=new RegExp(Q+"$","i"),$='"',G=$+" + ",h=" + "+$;function p(y){return y.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function E(y){return y.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function O(y){const M={expression:"",type:"none"};return y.labelExpressionInfo?y.labelExpressionInfo.value?(M.expression=y.labelExpressionInfo.value,M.type="conventional"):y.labelExpressionInfo.expression&&(M.expression=y.labelExpressionInfo.expression,M.type="arcade"):null!=y.labelExpression&&(M.expression=p(y.labelExpression),M.type="conventional"),M}function W(y){const M=O(y);if(!M)return null;switch(M.type){case"conventional":return _(M.expression);case"arcade":return M.expression}return null}function R(y){const M=O(y);if(!M)return null;switch(M.type){case"conventional":return function d(y){return y?.match(c)?.[1].trim()||null}(M.expression);case"arcade":return D(M.expression)}return null}function _(y){let M;return y?(M=(0,S.gx)(y,L=>P+'$feature["'+L+'"]'+Q),M=x.test(M)?M.replace(x,""):$+M,M=b.test(M)?M.replace(b,""):M+$,M=M.replaceAll(F,G).replaceAll(w,h)):M='""',M}const c=/^\s*\{([^}]+)\}\s*$/i,f=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,m=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,T=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function D(y){if(!y)return null;let M=f.exec(y)||m.exec(y);return M?M[1]||M[3]:(M=T.exec(y),M?M[2]:null)}},50318:(te,V,s)=>{s.d(V,{$o:()=>E,Fj:()=>G,IW:()=>p,Ss:()=>R,_$:()=>$,ck:()=>h,hz:()=>W,qj:()=>b});var S=s(15861),P=s(83821),Q=s(43814),F=s(48230);function x(){return(x=(0,S.Z)(function*(_){const c=_.spatialReference;if(c.isWGS84)return _.clone();if(c.isWebMercator)return(0,F.Sx)(_);const d=Q.Z.WGS84;return yield(0,P.initializeProjection)(c,d),(0,P.project)(_,d)})).apply(this,arguments)}function b(_,c){if(!$(_,c)){const d=_.typeKeywords;d?d.push(c):_.typeKeywords=[c]}}function $(_,c){return!!_.typeKeywords?.includes(c)}function G(_){return $(_,W.HOSTED_SERVICE)}function h(_,c){const d=_.typeKeywords;if(d){const f=d.indexOf(c);f>-1&&d.splice(f,1)}}function p(_,c,d){d?b(_,c):h(_,c)}function E(_){return O.apply(this,arguments)}function O(){return O=(0,S.Z)(function*(_){const c=_.clone().normalize();let d;if(c.length>1)for(const f of c)d?f.width>d.width&&(d=f):d=f;else d=c[0];return function w(_){return x.apply(this,arguments)}(d)}),O.apply(this,arguments)}const W={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function R(_){const{portal:c,isOrgItem:d,itemControl:f}=_,m=c.user?.privileges;let T=!m||m.includes("features:user:edit"),D=!!d&&!!m?.includes("features:user:fullEdit");const y="update"===f||"admin"===f;return y?D=T=!0:D&&(T=!0),{features:{edit:T,fullEdit:D},content:{updateItem:y}}}},96043:(te,V,s)=>{s.d(V,{AJ:()=>b,If:()=>h,k0:()=>x,uI:()=>G,ul:()=>w,wx:()=>p});var S=s(55117),P=s(55768),Q=s(5710),F=s(23515);const w=2.4;function x(E){return(0,P.Wz)(E*w)}function b(E){return(0,P.F2)(E)/w}function $(E,O,W,R){let{color:_,ratio:c}=O,{color:d,ratio:f}=W;f===c&&(1===f?c-=1e-6:f+=1e-6);const m=(0,S.uZ)((R-c)/(f-c),0,1);(0,Q.l)(E,_.toArray(),d.toArray(),m)}function G(E){const W=new Uint8ClampedArray(2048);if((E=E.filter(({ratio:f})=>f>=0&&f<=1).sort((f,m)=>f.ratio-m.ratio).map(({color:f,ratio:m})=>({color:f,ratio:Math.max(m,.001)}))).length<1)return W;let R=E[0],_=E[0],c=1;const d=(0,F.Ue)();for(let f=0;f<512;f++){const m=(f+.5)/512;for(;m>_.ratio&&c<E.length;)R=_,_=E[c++];$(d,R,_,m),W.set(d,4*f)}return W}function h(E,O,W){const R=Math.sqrt(E**2+O**2)/W;return R>1?0:3/(Math.PI*W**2)*(1-R**2)**2}function p(E){return"function"==typeof E?E:E?O=>+O[E]:()=>1}},93792:(te,V,s)=>{s.d(V,{Z:()=>f});var _,S=s(50484),P=s(2189),Q=s(35458),F=s(84303),w=s(89317),x=s(34222),b=s(80543),h=(s(14007),s(4703),s(62185)),p=s(10141),E=s(7547),O=s(43814),W=s(40637),R=s(81247);const c=new F.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let d=_=class extends w.wq{constructor(m){super(m),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(m,T){const D=O.Z.fromJSON(T.spatialReference),y=[];for(let M=0;M<m.length;M++){const L=m[M],U=Q.Z.fromJSON(L),Z=L.geometry?.spatialReference;null==U.geometry||Z||(U.geometry.spatialReference=D);const C=L.aggregateGeometries,u=U.aggregateGeometries;if(C&&null!=u)for(const g in u){const A=u[g],z=C[g],ee=z?.spatialReference;null==A||ee||(A.spatialReference=D)}y.push(U)}return y}writeGeometryType(m,T,D,y){if(m)return void c.write(m,T,D,y);const{features:M}=this;if(M)for(const L of M)if(null!=L?.geometry)return void c.write(L.geometry.type,T,D,y)}readQueryGeometry(m,T){if(!m)return null;const D=!!m.spatialReference,y=(0,W.im)(m);return y&&!D&&T.spatialReference&&(y.spatialReference=O.Z.fromJSON(T.spatialReference)),y}writeSpatialReference(m,T){if(m)return void(T.spatialReference=m.toJSON());const{features:D}=this;if(D)for(const y of D)if(y&&null!=y.geometry&&y.geometry.spatialReference)return void(T.spatialReference=y.geometry.spatialReference.toJSON())}clone(){return new _(this.cloneProperties())}cloneProperties(){return(0,x.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(m){const T=this.write();if(T.features&&Array.isArray(m)&&m.length>0)for(let D=0;D<T.features.length;D++){const y=T.features[D];if(y.geometry){const M=m?.[D];y.geometry=M?.toJSON()||y.geometry}}return T}quantize(m){const{scale:[T,D],translate:[y,M]}=m,Z=this.features,C=this._getQuantizationFunction(this.geometryType,u=>Math.round((u-y)/T),u=>Math.round((M-u)/D));for(let u=0,g=Z.length;u<g;u++)C?.(Z[u].geometry)||(Z.splice(u,1),u--,g--);return this.transform=m,this}unquantize(){const{geometryType:m,features:T,transform:D}=this;if(!D)return this;const{translate:[y,M],scale:[L,U]}=D;let u=null,g=null;if(this.hasZ&&null!=D?.scale?.[2]){const{translate:[,,z],scale:[,,ee]}=D;u=k=>k*ee+z}if(this.hasM&&null!=D?.scale?.[3]){const{translate:[,,,z],scale:[,,,ee]}=D;g=k=>null==k?k:k*ee+z}const A=this._getHydrationFunction(m,z=>z*L+y,z=>M-z*U,u,g);for(const{geometry:z}of T)null!=z&&A&&A(z);return this.transform=null,this}_quantizePoints(m,T,D){let y,M;const L=[];for(let U=0,Z=m.length;U<Z;U++){const C=m[U];if(U>0){const u=T(C[0]),g=D(C[1]);u===y&&g===M||(L.push([u-y,g-M]),y=u,M=g)}else y=T(C[0]),M=D(C[1]),L.push([y,M])}return L.length>0?L:null}_getQuantizationFunction(m,T,D){return"point"===m?y=>(y.x=T(y.x),y.y=D(y.y),y):"polyline"===m||"polygon"===m?y=>{const M=(0,W.oU)(y)?y.rings:y.paths,L=[];for(let U=0,Z=M.length;U<Z;U++){const u=this._quantizePoints(M[U],T,D);u&&L.push(u)}return L.length>0?((0,W.oU)(y)?y.rings=L:y.paths=L,y):null}:"multipoint"===m?y=>{const M=this._quantizePoints(y.points,T,D);return M&&M.length>0?(y.points=M,y):null}:"extent"===m?y=>y:null}_getHydrationFunction(m,T,D,y,M){return"point"===m?L=>{L.x=T(L.x),L.y=D(L.y),y&&(L.z=y(L.z))}:"polyline"===m||"polygon"===m?L=>{const U=(0,W.oU)(L)?L.rings:L.paths;let Z,C;for(let u=0,g=U.length;u<g;u++){const A=U[u];for(let z=0,ee=A.length;z<ee;z++){const k=A[z];z>0?(Z+=k[0],C+=k[1]):(Z=k[0],C=k[1]),k[0]=T(Z),k[1]=D(C)}}if(y&&M)for(let u=0,g=U.length;u<g;u++){const A=U[u];for(let z=0,ee=A.length;z<ee;z++){const k=A[z];k[2]=y(k[2]),k[3]=M(k[3])}}else if(y)for(let u=0,g=U.length;u<g;u++){const A=U[u];for(let z=0,ee=A.length;z<ee;z++){const k=A[z];k[2]=y(k[2])}}else if(M)for(let u=0,g=U.length;u<g;u++){const A=U[u];for(let z=0,ee=A.length;z<ee;z++){const k=A[z];k[2]=M(k[2])}}}:"extent"===m?L=>{L.xmin=T(L.xmin),L.ymin=D(L.ymin),L.xmax=T(L.xmax),L.ymax=D(L.ymax),y&&null!=L.zmax&&null!=L.zmin&&(L.zmax=y(L.zmax),L.zmin=y(L.zmin)),M&&null!=L.mmax&&null!=L.mmin&&(L.mmax=M(L.mmax),L.mmin=M(L.mmin))}:"multipoint"===m?L=>{const U=L.points;let Z,C;for(let u=0,g=U.length;u<g;u++){const A=U[u];u>0?(Z+=A[0],C+=A[1]):(Z=A[0],C=A[1]),A[0]=T(Z),A[1]=D(C)}if(y&&M)for(let u=0,g=U.length;u<g;u++){const A=U[u];A[2]=y(A[2]),A[3]=M(A[3])}else if(y)for(let u=0,g=U.length;u<g;u++){const A=U[u];A[2]=y(A[2])}else if(M)for(let u=0,g=U.length;u<g;u++){const A=U[u];A[2]=M(A[2])}}:null}};(0,S._)([(0,b.Cb)({type:String,json:{write:!0}})],d.prototype,"displayFieldName",void 0),(0,S._)([(0,b.Cb)({type:Boolean,json:{write:{overridePolicy:m=>({enabled:m})}}})],d.prototype,"exceededTransferLimit",void 0),(0,S._)([(0,b.Cb)({type:[Q.Z],json:{write:!0}})],d.prototype,"features",void 0),(0,S._)([(0,h.r)("features")],d.prototype,"readFeatures",null),(0,S._)([(0,b.Cb)({type:[R.Z],json:{write:!0}})],d.prototype,"fields",void 0),(0,S._)([(0,b.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:c.read}}})],d.prototype,"geometryType",void 0),(0,S._)([(0,E.c)("geometryType")],d.prototype,"writeGeometryType",null),(0,S._)([(0,b.Cb)({type:Boolean,json:{write:{overridePolicy:m=>({enabled:m})}}})],d.prototype,"hasM",void 0),(0,S._)([(0,b.Cb)({type:Boolean,json:{write:{overridePolicy:m=>({enabled:m})}}})],d.prototype,"hasZ",void 0),(0,S._)([(0,b.Cb)({types:P.qM,json:{write:!0}})],d.prototype,"queryGeometry",void 0),(0,S._)([(0,h.r)("queryGeometry")],d.prototype,"readQueryGeometry",null),(0,S._)([(0,b.Cb)({type:O.Z,json:{write:!0}})],d.prototype,"spatialReference",void 0),(0,S._)([(0,E.c)("spatialReference")],d.prototype,"writeSpatialReference",null),(0,S._)([(0,b.Cb)({json:{write:!0}})],d.prototype,"transform",void 0),d=_=(0,S._)([(0,p.j)("esri.rest.support.FeatureSet")],d),d.prototype.toJSON.isDefaultToJSON=!0;const f=d}}]);