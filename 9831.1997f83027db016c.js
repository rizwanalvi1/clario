"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[9831],{5710:(J,N,f)=>{f.d(N,{a:()=>a,b:()=>h,c:()=>z,e:()=>s,f:()=>L,g:()=>l,i:()=>Q,j:()=>I,l:()=>M,n:()=>Y,s:()=>R,t:()=>D});var F=f(89612);function z(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function R(e,t,i,x,d){return e[0]=t,e[1]=i,e[2]=x,e[3]=d,e}function L(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e}function K(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}function w(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e}function X(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e}function h(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e}function B(e,t){const i=t[0]-e[0],x=t[1]-e[1],d=t[2]-e[2],P=t[3]-e[3];return Math.sqrt(i*i+x*x+d*d+P*P)}function A(e,t){const i=t[0]-e[0],x=t[1]-e[1],d=t[2]-e[2],P=t[3]-e[3];return i*i+x*x+d*d+P*P}function Q(e){const t=e[0],i=e[1],x=e[2],d=e[3];return Math.sqrt(t*t+i*i+x*x+d*d)}function I(e){const t=e[0],i=e[1],x=e[2],d=e[3];return t*t+i*i+x*x+d*d}function Y(e,t){const i=t[0],x=t[1],d=t[2],P=t[3];let C=i*i+x*x+d*d+P*P;return C>0&&(C=1/Math.sqrt(C),e[0]=i*C,e[1]=x*C,e[2]=d*C,e[3]=P*C),e}function l(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function M(e,t,i,x){const d=t[0],P=t[1],C=t[2],$=t[3];return e[0]=d+x*(i[0]-d),e[1]=P+x*(i[1]-P),e[2]=C+x*(i[2]-C),e[3]=$+x*(i[3]-$),e}function D(e,t,i){const x=t[0],d=t[1],P=t[2],C=t[3];return e[0]=i[0]*x+i[4]*d+i[8]*P+i[12]*C,e[1]=i[1]*x+i[5]*d+i[9]*P+i[13]*C,e[2]=i[2]*x+i[6]*d+i[10]*P+i[14]*C,e[3]=i[3]*x+i[7]*d+i[11]*P+i[15]*C,e}function a(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function s(e,t){const i=e[0],x=e[1],d=e[2],P=e[3],C=t[0],$=t[1],G=t[2],H=t[3],V=(0,F.bn)();return Math.abs(i-C)<=V*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(x-$)<=V*Math.max(1,Math.abs(x),Math.abs($))&&Math.abs(d-G)<=V*Math.max(1,Math.abs(d),Math.abs(G))&&Math.abs(P-H)<=V*Math.max(1,Math.abs(P),Math.abs(H))}Object.freeze(Object.defineProperty({__proto__:null,add:L,ceil:function j(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},copy:z,copyVec3:function v(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},dist:B,distance:B,div:X,divide:X,dot:l,equals:s,exactEquals:a,floor:function c(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},inverse:function W(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},len:Q,length:Q,lerp:M,max:function E(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e},min:function y(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e},mul:w,multiply:w,negate:function O(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},normalize:Y,random:function b(e,t){const i=F.FD;let x,d,P,C,$,G;t=t||1;do{x=2*i()-1,d=2*i()-1,$=x*x+d*d}while($>=1);do{P=2*i()-1,C=2*i()-1,G=P*P+C*C}while(G>=1);const H=Math.sqrt((1-$)/G);return e[0]=t*x,e[1]=t*d,e[2]=t*P*H,e[3]=t*C*H,e},round:function T(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},scale:h,scaleAndAdd:function p(e,t,i,x){return e[0]=t[0]+i[0]*x,e[1]=t[1]+i[1]*x,e[2]=t[2]+i[2]*x,e[3]=t[3]+i[3]*x,e},set:R,sqrDist:A,sqrLen:I,squaredDistance:A,squaredLength:I,str:function U(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},sub:K,subtract:K,transformMat4:D,transformQuat:function S(e,t,i){const x=t[0],d=t[1],P=t[2],C=i[0],$=i[1],G=i[2],H=i[3],V=H*x+$*P-G*d,q=H*d+G*x-C*P,k=H*P+C*d-$*x,ee=-C*x-$*d-G*P;return e[0]=V*H+ee*-C+q*-G-k*-$,e[1]=q*H+ee*-$+k*-C-V*-G,e[2]=k*H+ee*-G+V*-$-q*-C,e[3]=t[3],e}},Symbol.toStringTag,{value:"Module"}))},51310:(J,N,f)=>{function F(c){return null!=L(c)||null!=R(c)}function z(c){return K.test(c)}function v(c){return L(c)??R(c)}function R(c){const y=new Date(c);return function w(c,y){if(Number.isNaN(c.getTime()))return!1;let E=!0;if(j&&/\d+\W*$/.test(y)){const T=y.match(/[a-zA-Z]{2,}/);if(T){let h=!1,p=0;for(;!h&&p<=T.length;)h=!X.test(T[p]),p++;E=!h}}return E}(y,c)?Number.isNaN(y.getTime())?null:y.getTime()-6e4*y.getTimezoneOffset():null}function L(c){const y=K.exec(c);if(!y?.groups)return null;const E=y.groups,T=+E.year,h=+E.month-1,p=+E.day,B=+(E.hours??"0"),A=+(E.minutes??"0"),Q=+(E.seconds??"0");if(B>23||A>59||Q>59)return null;const I=E.ms??"0",O=I?+I.padEnd(3,"0").substring(0,3):0;let W;return W=E.isUTC||!E.offsetSign?Date.UTC(T,h,p,B,A,Q,O):6e4*("+"===E.offsetSign?-1:1)*(60*+E.offsetHours+ +E.offsetMinutes)+Date.UTC(T,h,p,B,A,Q,O),Number.isNaN(W)?null:W}f.d(N,{mu:()=>z,of:()=>F,sG:()=>v});const K=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,X=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,j=!Number.isNaN(new Date("technology 10").getTime())},23515:(J,N,f)=>{function F(){return[0,0,0,0]}function v(I,O,W,Y){return[I,O,W,Y]}function w(){return v(1,1,1,1)}function X(){return v(1,0,0,0)}function j(){return v(0,1,0,0)}function c(){return v(0,0,1,0)}function y(){return v(0,0,0,1)}f.d(N,{Ue:()=>F,al:()=>v});const T=w(),h=X(),p=j(),B=c(),A=y();Object.freeze(Object.defineProperty({__proto__:null,ONES:T,UNIT_W:A,UNIT_X:h,UNIT_Y:p,UNIT_Z:B,ZEROS:[0,0,0,0],clone:function z(I){return[I[0],I[1],I[2],I[3]]},create:F,createView:function L(I,O){return new Float64Array(I,O,4)},fromArray:function R(I,O=[0,0,0,0]){const W=Math.min(4,I.length);for(let Y=0;Y<W;++Y)O[Y]=I[Y];return O},fromValues:v,ones:w,unitW:y,unitX:X,unitY:j,unitZ:c,zeros:function K(){return[0,0,0,0]}},Symbol.toStringTag,{value:"Module"}))},26540:(J,N,f)=>{f.d(N,{Q:()=>L});var F=f(57678),v=(f(14007),f(43029)),R=f(4758);class L{constructor(s=9,n){this._compareMinX=E,this._compareMinY=T,this._toBBox=r=>r,this._maxEntries=Math.max(4,s||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),n&&("function"==typeof n?this._toBBox=n:this._initFormat(n)),this.clear()}destroy(){this.clear(),W.prune(),Y.prune(),l.prune(),M.prune()}all(s){w(this._data,s)}search(s,n){let r=this._data;const _=this._toBBox;if(I(s,r))for(W.clear();r;){for(let o=0,g=r.children.length;o<g;o++){const u=r.children[o],m=r.leaf?_(u):u;I(s,m)&&(r.leaf?n(u):Q(s,m)?w(u,n):W.push(u))}r=W.pop()}}collides(s){let n=this._data;const r=this._toBBox;if(!I(s,n))return!1;for(W.clear();n;){for(let _=0,o=n.children.length;_<o;_++){const g=n.children[_],u=n.leaf?r(g):g;if(I(s,u)){if(n.leaf||Q(s,u))return!0;W.push(g)}}n=W.pop()}return!1}load(s){if(!s.length)return this;if(s.length<this._minEntries){for(let r=0,_=s.length;r<_;r++)this.insert(s[r]);return this}let n=this._build(s.slice(0,s.length),0,s.length-1,0);if(this._data.children.length)if(this._data.height===n.height)this._splitRoot(this._data,n);else{if(this._data.height<n.height){const r=this._data;this._data=n,n=r}this._insert(n,this._data.height-n.height-1,!0)}else this._data=n;return this}insert(s){return s&&this._insert(s,this._data.height-1),this}clear(){return this._data=new S([]),this}remove(s){if(!s)return this;let n,r=this._data,_=null,o=0,g=!1;const u=this._toBBox(s);for(l.clear(),M.clear();r||l.length>0;){if(r||(r=l.pop(),_=l.data[l.length-1],o=M.pop()??0,g=!0),r.leaf&&(n=(0,F.cq)(r.children,s,r.children.length,r.indexHint),-1!==n))return r.children.splice(n,1),l.push(r),this._condense(l),this;g||r.leaf||!Q(r,u)?_?(o++,r=_.children[o],g=!1):r=null:(l.push(r),M.push(o),o=0,_=r,r=r.children[0])}return this}toJSON(){return this._data}fromJSON(s){return this._data=s,this}_build(s,n,r,_){const o=r-n+1;let g=this._maxEntries;if(o<=g){const e=new S(s.slice(n,r+1));return j(e,this._toBBox),e}_||(_=Math.ceil(Math.log(o)/Math.log(g)),g=Math.ceil(o/g**(_-1)));const u=new U([]);u.height=_;const m=Math.ceil(o/g),Z=m*Math.ceil(Math.sqrt(g));O(s,n,r,Z,this._compareMinX);for(let e=n;e<=r;e+=Z){const t=Math.min(e+Z-1,r);O(s,e,t,m,this._compareMinY);for(let i=e;i<=t;i+=m){const x=Math.min(i+m-1,t);u.children.push(this._build(s,i,x,_-1))}}return j(u,this._toBBox),u}_insert(s,n,r){const o=r?s:(0,this._toBBox)(s);l.clear();const g=function K(a,s,n,r){for(;r.push(s),!0!==s.leaf&&r.length-1!==n;){let _,o=1/0,g=1/0;for(let u=0,m=s.children.length;u<m;u++){const Z=s.children[u],e=h(Z),t=B(a,Z)-e;t<g?(g=t,o=e<o?e:o,_=Z):t===g&&e<o&&(o=e,_=Z)}s=_||s.children[0]}return s}(o,this._data,n,l);for(g.children.push(s),y(g,o);n>=0&&l.data[n].children.length>this._maxEntries;)this._split(l,n),n--;!function X(a,s,n){for(let r=n;r>=0;r--)y(s.data[r],a)}(o,l,n)}_split(s,n){const r=s.data[n],_=r.children.length,o=this._minEntries;this._chooseSplitAxis(r,o,_);const g=this._chooseSplitIndex(r,o,_);if(!g)return;const u=r.children.splice(g,r.children.length-g),m=r.leaf?new S(u):new U(u);m.height=r.height,j(r,this._toBBox),j(m,this._toBBox),n?s.data[n-1].children.push(m):this._splitRoot(r,m)}_splitRoot(s,n){this._data=new U([s,n]),this._data.height=s.height+1,j(this._data,this._toBBox)}_chooseSplitIndex(s,n,r){let _,o,g;_=o=1/0;for(let u=n;u<=r-n;u++){const m=c(s,0,u,this._toBBox),Z=c(s,u,r,this._toBBox),e=A(m,Z),t=h(m)+h(Z);e<_?(_=e,g=u,o=t<o?t:o):e===_&&t<o&&(o=t,g=u)}return g}_chooseSplitAxis(s,n,r){const _=s.leaf?this._compareMinX:E,o=s.leaf?this._compareMinY:T;this._allDistMargin(s,n,r,_)<this._allDistMargin(s,n,r,o)&&s.children.sort(_)}_allDistMargin(s,n,r,_){s.children.sort(_);const o=this._toBBox,g=c(s,0,n,o),u=c(s,r-n,r,o);let m=p(g)+p(u);for(let Z=n;Z<r-n;Z++){const e=s.children[Z];y(g,s.leaf?o(e):e),m+=p(g)}for(let Z=r-n-1;Z>=n;Z--){const e=s.children[Z];y(u,s.leaf?o(e):e),m+=p(u)}return m}_condense(s){for(let n=s.length-1;n>=0;n--){const r=s.data[n];if(0===r.children.length)if(n>0){const _=s.data[n-1],o=_.children;o.splice((0,F.cq)(o,r,o.length,_.indexHint),1)}else this.clear();else j(r,this._toBBox)}}_initFormat(s){const n=["return a"," - b",";"];this._compareMinX=new Function("a","b",n.join(s[0])),this._compareMinY=new Function("a","b",n.join(s[1])),this._toBBox=new Function("a","return {minX: a"+s[0]+", minY: a"+s[1]+", maxX: a"+s[2]+", maxY: a"+s[3]+"};")}}function w(a,s){let n=a;for(Y.clear();n;){if(!0===n.leaf)for(const r of n.children)s(r);else Y.pushArray(n.children);n=Y.pop()??null}}function j(a,s){c(a,0,a.children.length,s,a)}function c(a,s,n,r,_){_||(_=new S([])),_.minX=1/0,_.minY=1/0,_.maxX=-1/0,_.maxY=-1/0;for(let o,g=s;g<n;g++)o=a.children[g],y(_,a.leaf?r(o):o);return _}function y(a,s){a.minX=Math.min(a.minX,s.minX),a.minY=Math.min(a.minY,s.minY),a.maxX=Math.max(a.maxX,s.maxX),a.maxY=Math.max(a.maxY,s.maxY)}function E(a,s){return a.minX-s.minX}function T(a,s){return a.minY-s.minY}function h(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function p(a){return a.maxX-a.minX+(a.maxY-a.minY)}function B(a,s){return(Math.max(s.maxX,a.maxX)-Math.min(s.minX,a.minX))*(Math.max(s.maxY,a.maxY)-Math.min(s.minY,a.minY))}function A(a,s){const n=Math.max(a.minX,s.minX),r=Math.max(a.minY,s.minY),_=Math.min(a.maxX,s.maxX),o=Math.min(a.maxY,s.maxY);return Math.max(0,_-n)*Math.max(0,o-r)}function Q(a,s){return a.minX<=s.minX&&a.minY<=s.minY&&s.maxX<=a.maxX&&s.maxY<=a.maxY}function I(a,s){return s.minX<=a.maxX&&s.minY<=a.maxY&&s.maxX>=a.minX&&s.maxY>=a.minY}function O(a,s,n,r,_){const o=[s,n];for(;o.length;){const g=o.pop(),u=o.pop();if(g-u<=r)continue;const m=u+Math.ceil((g-u)/r/2)*r;(0,R.q)(a,m,u,g,_),o.push(u,m,m,g)}}const W=new v.Z,Y=new v.Z,l=new v.Z,M=new v.Z({deallocator:void 0});class b{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class D extends b{constructor(){super(...arguments),this.height=1,this.indexHint=new F.SO}}class S extends D{constructor(s){super(),this.children=s,this.leaf=!0}}class U extends D{constructor(s){super(),this.children=s,this.leaf=!1}}},46872:(J,N,f)=>{f.d(N,{H:()=>X});var F=f(14007),z=f(26540),v=f(45425);const L={minX:0,minY:0,maxX:0,maxY:0};class X{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new z.Q(9,(0,F.Z)("esri-csp-restrictions")?c=>({minX:c[0],minY:c[1],maxX:c[2],maxY:c[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const c=new Array(this._idByBounds.size);let y=0;this._idByBounds.forEach((E,T)=>{c[y++]=T}),this._indexInvalid=!1,this._index.clear(),this._index.load(c)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(c=>this._idByBounds.has(c))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const c=(0,v.cS)();for(const y of this._boundsById.values())y&&(c[0]=Math.min(y[0],c[0]),c[1]=Math.min(y[1],c[1]),c[2]=Math.max(y[2],c[2]),c[3]=Math.max(y[3],c[3]));return c}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(c){const y=this._boundsById.get(c);this._boundsById.delete(c),y&&(this._idByBounds.delete(y),this._indexInvalid||this._index.remove(y))}forEachInBounds(c,y){this._loadIndex(),function w(j,c,y){(function K(j){L.minX=j[0],L.minY=j[1],L.maxX=j[2],L.maxY=j[3]})(c),j.search(L,y)}(this._index,c,E=>y(this._idByBounds.get(E)))}get(c){return this._boundsById.get(c)}has(c){return this._boundsById.has(c)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(c,y){if(!this._indexInvalid){const E=this._boundsById.get(c);E&&(this._index.remove(E),this._idByBounds.delete(E))}this._boundsById.set(c,y),y&&(this._idByBounds.set(y,c),this._indexInvalid||(this._boundsToLoad.push(y),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},84726:(J,N,f)=>{f.d(N,{Z:()=>E});var F=f(57678),z=f(57964),v=f(88278),R=f(4703),L=f(27048),K=f(45425),w=f(10842),X=f(46872),j=f(29085),c=f(14309);const y=(0,L.Ue)();class E{constructor(h){this.geometryInfo=h,this._boundsStore=new X.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new v.Z,this.featureAdapter=c.n}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let h=0;return this._featuresById.forEach(p=>{null!=p.geometry&&p.geometry.coords&&(h+=p.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:h/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(h){if(null==this.fullBounds)return null;const[p,B,A,Q]=this.fullBounds;return{xmin:p,ymin:B,xmax:A,ymax:Q,spatialReference:(0,j.S2)(h)}}add(h){this._add(h),this._emitChanged()}addMany(h){for(const p of h)this._add(p);this._emitChanged()}upsertMany(h){const p=h.map(B=>this._upsert(B));return this._emitChanged(),p.filter(F.pC)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(h){const p=this._featuresById.get(h);return p?(this._remove(p),this._emitChanged(),p):null}removeManyById(h){this._boundsStore.invalidateIndex();for(const p of h){const B=this._featuresById.get(p);B&&this._remove(B)}this._emitChanged()}forEachBounds(h,p){for(const B of h){const A=this._boundsStore.get(B.objectId);A&&p((0,L.JR)(y,A))}}getFeature(h){return this._featuresById.get(h)}has(h){return this._featuresById.has(h)}forEach(h){this._featuresById.forEach(p=>h(p))}forEachInBounds(h,p){this._boundsStore.forEachInBounds(h,B=>{p(this._featuresById.get(B))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let h=!1;this._featuresById.forEach((p,B)=>{this._markedIds.has(B)||(h=!0,this._remove(p))}),this._markedIds.clear(),h&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(h){if(!h)return;const p=h.objectId;if(null==p)return void R.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new z.Z("featurestore:invalid-feature","feature id is missing",{feature:h}));const B=this._featuresById.get(p);let A;if(this._markedIds.add(p),B?(h.displayId=B.displayId,A=this._boundsStore.get(p),this._boundsStore.delete(p)):null!=this.onFeatureAdd&&this.onFeatureAdd(h),!h.geometry?.coords?.length)return this._boundsStore.set(p,null),void this._featuresById.set(p,h);A=(0,w.$)(A??(0,K.Ue)(),h.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=A&&this._boundsStore.set(p,A),this._featuresById.set(p,h)}_upsert(h){const p=h?.objectId;if(null==p)return R.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new z.Z("featurestore:invalid-feature","feature id is missing",{feature:h})),null;const B=this._featuresById.get(p);if(!B)return this._add(h),h;this._markedIds.add(p);const{geometry:A,attributes:Q}=h;for(const I in Q)B.attributes[I]=Q[I];return A&&(B.geometry=A,this._boundsStore.set(p,(0,w.$)((0,K.Ue)(),A,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),B}_remove(h){null!=this.onFeatureRemove&&this.onFeatureRemove(h);const p=h.objectId;return this._markedIds.delete(p),this._boundsStore.delete(p),this._featuresById.delete(p),h}}},86915:(J,N,f)=>{f.r(N),f.d(N,{default:()=>W});var F=f(15861),z=f(57964),v=f(40637),R=f(33721),L=f(10842),K=f(64761),w=f(84726),X=f(58829),j=f(48238),c=f(60324),y=f(42726),E=f(40100),T=f(51217),h=f(85295),p=f(764);const B=R.YU,A={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:R.YU},Q={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};function O(Y){return(0,v.wp)(Y)?null!=Y.m:!!Y.hasM}class W{constructor(){this._queryEngine=null,this._nextObjectId=null}destroy(){this._queryEngine?.destroy(),this._queryEngine=this._createDefaultAttributes=null}load(l){var M=this;return(0,F.Z)(function*(){const b=[],{features:D}=l,S=M._inferLayerProperties(D,l.fields),U=l.fields||[],a=null!=l.hasM?l.hasM:!!S.hasM,s=null!=l.hasZ?l.hasZ:!!S.hasZ,n=!l.spatialReference&&!S.spatialReference,r=n?B:l.spatialReference||S.spatialReference,_=n?A:null,o=l.geometryType||S.geometryType,g=!o;let u=l.objectIdField||S.objectIdField,m=l.timeInfo;const Z=new E.Z(U);if(!g&&(n&&b.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"}),!o))throw new z.Z("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!u)throw new z.Z("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");if(S.objectIdField&&u!==S.objectIdField&&(b.push({name:"feature-layer:duplicated-oid-field",message:`Provided objectIdField "${u}" doesn't match the field name "${S.objectIdField}", found in the provided fields`}),u=S.objectIdField),u&&!S.objectIdField){const d=Z.get(u);d?(u=d.name,d.type="esriFieldTypeOID",d.editable=!1,d.nullable=!1):U.unshift({alias:u,name:u,type:"esriFieldTypeOID",editable:!1,nullable:!1})}for(const d of U){if(null==d.name&&(d.name=d.alias),null==d.alias&&(d.alias=d.name),!d.name)throw new z.Z("feature-layer:invalid-field-name","field name is missing",{field:d});if(d.name===u&&(d.type="esriFieldTypeOID"),!T.v.jsonValues.includes(d.type))throw new z.Z("feature-layer:invalid-field-type",`invalid type for field "${d.name}"`,{field:d});null==d.length&&(d.length=(0,h.ZR)(d))}const e={};for(const d of U)if("esriFieldTypeOID"!==d.type&&"esriFieldTypeGlobalID"!==d.type){const P=(0,h.os)(d);void 0!==P&&(e[d.name]=P)}if(m){if(m.startTimeField){const d=Z.get(m.startTimeField);d?(m.startTimeField=d.name,d.type="esriFieldTypeDate"):m.startTimeField=null}if(m.endTimeField){const d=Z.get(m.endTimeField);d?(m.endTimeField=d.name,d.type="esriFieldTypeDate"):m.endTimeField=null}if(m.trackIdField){const d=Z.get(m.trackIdField);d?m.trackIdField=d.name:(m.trackIdField=null,b.push({name:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:m}}))}m.startTimeField||m.endTimeField||(b.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:m}}),m=null)}const t=Z.dateFields.length?{timeZoneIANA:l.dateFieldsTimeZone??p.pt}:null;M._createDefaultAttributes=(0,c.Dm)(e,u);const i={warnings:b,featureErrors:[],layerDefinition:{...Q,drawingInfo:(0,c.bU)(o),templates:(0,c.Hq)(e),extent:_,geometryType:o,objectIdField:u,fields:U,hasZ:s,hasM:a,timeInfo:m,dateFieldsTimeReference:t},assignedObjectIds:{}};if(M._queryEngine=new j.q({fieldsIndex:E.Z.fromLayerJSON({fields:U,timeInfo:m,dateFieldsTimeReference:t}),geometryType:o,hasM:a,hasZ:s,objectIdField:u,spatialReference:r,featureStore:new w.Z({geometryType:o,hasM:a,hasZ:s}),timeInfo:m,cacheSpatialQueries:!0}),!D?.length)return M._nextObjectId=K.X,i;const x=(0,K.S)(u,D);return M._nextObjectId=x+1,yield(0,X._W)(D,r),M._loadInitialFeatures(i,D)})()}applyEdits(l){var M=this;return(0,F.Z)(function*(){const{spatialReference:b,geometryType:D}=M._queryEngine;return yield Promise.all([(0,y.b)(b,D),(0,X._W)(l.adds,b),(0,X._W)(l.updates,b)]),M._applyEdits(l)})()}queryFeatures(l,M={}){return this._queryEngine.executeQuery(l,M.signal)}queryFeatureCount(l,M={}){return this._queryEngine.executeQueryForCount(l,M.signal)}queryObjectIds(l,M={}){return this._queryEngine.executeQueryForIds(l,M.signal)}queryExtent(l,M={}){return this._queryEngine.executeQueryForExtent(l,M.signal)}querySnapping(l,M={}){return this._queryEngine.executeQueryForSnapping(l,M.signal)}_inferLayerProperties(l,M){let b,D,S=null,U=null,a=null;for(const s of l){const n=s.geometry;if(null!=n&&(S||(S=(0,v.Ji)(n)),U||(U=n.spatialReference),null==b&&(b=(0,v.wp)(Y=n)?null!=Y.z:!!Y.hasZ),null==D&&(D=O(n)),S&&U&&null!=b&&null!=D))break}var Y;if(M&&M.length){let s=null;M.some(n=>{const r="esriFieldTypeOID"===n.type,_=!n.type&&n.name&&"objectid"===n.name.toLowerCase();return s=n,r||_})&&(a=s.name)}return{geometryType:S,spatialReference:U,objectIdField:a,hasM:D,hasZ:b}}_loadInitialFeatures(l,M){var b=this;return(0,F.Z)(function*(){const{geometryType:D,hasM:S,hasZ:U,objectIdField:a,spatialReference:s,featureStore:n,fieldsIndex:r}=b._queryEngine,_=[];for(const u of M){if(null!=u.uid&&(l.assignedObjectIds[u.uid]=-1),u.geometry&&D!==(0,v.Ji)(u.geometry)){l.featureErrors.push((0,y.av)("Incorrect geometry type."));continue}const m=b._createDefaultAttributes(),Z=(0,y.O0)(r,m,u.attributes,!0);Z?l.featureErrors.push(Z):(b._assignObjectId(m,u.attributes,!0),u.attributes=m,null!=u.uid&&(l.assignedObjectIds[u.uid]=u.attributes[a]),null!=u.geometry&&(u.geometry=(0,X.iV)(u.geometry,u.geometry.spatialReference,s)),_.push(u))}n.addMany((0,L.Yn)([],_,D,U,S,a));const{fullExtent:o,timeExtent:g}=yield b._queryEngine.fetchRecomputedExtents();if(l.layerDefinition.extent=o,g){const{start:u,end:m}=g;l.layerDefinition.timeInfo.timeExtent=[u,m]}return l})()}_applyEdits(l){var M=this;return(0,F.Z)(function*(){const{adds:b,updates:D,deletes:S}=l,U={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(b?.length&&M._applyAddEdits(U,b),D?.length&&M._applyUpdateEdits(U,D),S?.length){for(const n of S)U.deleteResults.push((0,y.d1)(n));M._queryEngine.featureStore.removeManyById(S)}const{fullExtent:a,timeExtent:s}=yield M._queryEngine.fetchRecomputedExtents();return{extent:a,timeExtent:s,featureEditResults:U}})()}_applyAddEdits(l,M){const{addResults:b}=l,{geometryType:D,hasM:S,hasZ:U,objectIdField:a,spatialReference:s,featureStore:n,fieldsIndex:r}=this._queryEngine,_=[];for(const o of M){if(o.geometry&&D!==(0,v.Ji)(o.geometry)){b.push((0,y.av)("Incorrect geometry type."));continue}const g=this._createDefaultAttributes(),u=(0,y.O0)(r,g,o.attributes);if(u)b.push(u);else{if(this._assignObjectId(g,o.attributes),o.attributes=g,null!=o.uid&&(l.uidToObjectId[o.uid]=o.attributes[a]),null!=o.geometry){const m=o.geometry.spatialReference??s;o.geometry=(0,X.iV)((0,y.og)(o.geometry,m),m,s)}_.push(o),b.push((0,y.d1)(o.attributes[a]))}}n.addMany((0,L.Yn)([],_,D,U,S,a))}_applyUpdateEdits({updateResults:l},M){const{geometryType:b,hasM:D,hasZ:S,objectIdField:U,spatialReference:a,featureStore:s,fieldsIndex:n}=this._queryEngine;for(const r of M){const{attributes:_,geometry:o}=r,g=_?.[U];if(null==g){l.push((0,y.av)(`Identifier field ${U} missing`));continue}if(!s.has(g)){l.push((0,y.av)(`Feature with object id ${g} missing`));continue}const u=(0,L.EI)(s.getFeature(g),b,S,D);if(null!=o){if(b!==(0,v.Ji)(o)){l.push((0,y.av)("Incorrect geometry type."));continue}const m=o.spatialReference??a;u.geometry=(0,X.iV)((0,y.og)(o,m),m,a)}if(_){const m=(0,y.O0)(n,u.attributes,_);if(m){l.push(m);continue}}s.add((0,L.XA)(u,b,S,D,U)),l.push((0,y.d1)(g))}}_assignObjectId(l,M,b=!1){const D=this._queryEngine.objectIdField;l[D]=b&&M&&isFinite(M[D])?M[D]:this._nextObjectId++}}},60324:(J,N,f)=>{f.d(N,{Dm:()=>X,Hq:()=>c,MS:()=>y,bU:()=>L});var F=f(14007),z=f(34222),v=f(85559),R=f(19579);function L(E){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===E||"esriGeometryMultipoint"===E?R.I4:"esriGeometryPolyline"===E?R.ET:R.lF}}}const K=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let w=1;function X(E,T){if((0,F.Z)("esri-csp-restrictions"))return()=>({[T]:null,...E});try{let h=`this${j(T)} = null;`;for(const B in E)h+=`this${j(B)} = ${JSON.stringify(E[B])};`;const p=new Function(`\n      return class AttributesClass$${w++} {\n        constructor() {\n          ${h};\n        }\n      }\n    `)();return()=>new p}catch{return()=>({[T]:null,...E})}}function j(E){return K.test(E)?`.${E}`:`["${E}"]`}function c(E={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,z.d9)(E)}}]}function y(E,T){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:E},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:T,supportsDelete:T,supportsEditing:T,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:T,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:v.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:T,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},42726:(J,N,f)=>{f.d(N,{O0:()=>y,av:()=>w,b:()=>A,d1:()=>j,og:()=>h});var F=f(15861),z=f(51310),v=f(33721),R=f(85295);class L{constructor(){this.code=null,this.description=null}}class K{constructor(O){this.error=new L,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=O}}function w(I){return new K(I)}class X{constructor(O){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=O}}function j(I){return new X(I)}const c=new Set;function y(I,O,W,Y=!1){c.clear();for(const l in W){const M=I.get(l);if(!M)continue;const b=E(M,W[l]);if(c.add(M.name),M&&(Y||M.editable)){const D=(0,R.Qc)(M,b);if(D)return w((0,R.vP)(D,M,b));O[M.name]=b}}for(const l of I?.requiredFields??[])if(!c.has(l.name))return w(`missing required field "${l.name}"`);return null}function E(I,O){let W=O;return(0,R.H7)(I)&&"string"==typeof O?W=parseFloat(O):(0,R.qN)(I)&&null!=O&&"string"!=typeof O?W=String(O):(0,R.y2)(I)&&"string"==typeof O&&(W=(0,z.sG)(O)),(0,R.Pz)(W)}let T;function h(I,O){if(!I||!(0,v.JY)(O))return I;if("rings"in I||"paths"in I){if(null==T)throw new TypeError("geometry engine not loaded");return T.simplify(O,I)}return I}function B(){return(B=(0,F.Z)(function*(){return null==T&&(T=yield Promise.all([f.e(9465),f.e(8592),f.e(7545)]).then(f.bind(f,49574))),T})).apply(this,arguments)}function A(I,O){return Q.apply(this,arguments)}function Q(){return Q=(0,F.Z)(function*(I,O){!(0,v.JY)(I)||"esriGeometryPolygon"!==O&&"esriGeometryPolyline"!==O||(yield function p(){return B.apply(this,arguments)}())}),Q.apply(this,arguments)}},19579:(J,N,f)=>{f.d(N,{ET:()=>R,I4:()=>v,SQ:()=>F,X1:()=>z,eG:()=>w,lF:()=>L,lj:()=>j,qP:()=>K,wW:()=>X});const F=[252,146,31,255],z=[153,153,153,255],v={type:"esriSMS",style:"esriSMSCircle",size:6,color:F,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},R={type:"esriSLS",style:"esriSLSSolid",width:.75,color:F},L={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},K={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},w={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},X={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},j={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}}}]);