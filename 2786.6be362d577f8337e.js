"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[2786,5398],{95539:(le,$,l)=>{l.d($,{Z:()=>C});var b=l(50484),m=l(25387),G=l(89317),S=l(51431),A=l(80543),B=(l(14007),l(4703),l(65311),l(21070)),v=l(10141),y=l(81238);let d=class extends((0,m.J)(G.wq)){constructor(F){super(F),this.unit="milliseconds",this.value=0}toMilliseconds(){return(0,S.rJ)(this.value,this.unit,"milliseconds")}};(0,b._)([(0,B.J)(y.v,{nonNullable:!0})],d.prototype,"unit",void 0),(0,b._)([(0,A.Cb)({type:Number,json:{write:!0},nonNullable:!0})],d.prototype,"value",void 0),d=(0,b._)([(0,v.j)("esri.TimeInterval")],d);const C=d},52540:(le,$,l)=>{l.d($,{z:()=>m});var b=l(39921);class m{constructor(S,A){this._storage=new b.WJ,this.id="",this.name="",this.size=0,this._storage.maxSize=S,this._storage.register(this),A&&this._storage.registerRemoveFunc("",A)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(S,A,I=1){this._storage.put(this,S,A,I,1)}pop(S){return this._storage.pop(this,S)}get(S){return this._storage.get(this,S)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(S){this._storage.maxSize=S}resetHitRate(){}}},39921:(le,$,l)=>{l.d($,{WJ:()=>I,Xq:()=>A});var S,B,b=l(43029);(B=S||(S={}))[B.ALL=0]="ALL",B[B.SOME=1]="SOME";class A{constructor(v,y,d){this.name=v,this._storage=y,this.id=x+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),d&&(this._storage.registerRemoveFunc(this.id,d),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(v){return this._storage.getSize(this,v)}resetHitRate(){this._hit=this._miss=0}put(v,y,d,C=0){this._storage.put(this,v,y,d,C)}pop(v){const y=this._storage.pop(this,v);return void 0===y?++this._miss:++this._hit,y}get(v){const y=this._storage.get(this,v);return void 0===y?++this._miss:++this._hit,y}peek(v){return this._storage.peek(this,v)}updateSize(v,y,d){this._storage.updateSize(this,v,y,d)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class I{get size(){return this._size}constructor(v=10485760){this._maxSize=v,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new b.Z,this._users=new b.Z}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(v){this._users.push(v)}deregister(v){this._users.removeUnordered(v)}registerRemoveFunc(v,y){this._removeFuncs.push([v,y])}deregisterRemoveFunc(v){this._removeFuncs.filterInPlace(y=>y[0]!==v)}get maxSize(){return this._maxSize}set maxSize(v){this._maxSize=Math.max(v,-1),this._checkSize()}getSize(v,y){return this._db.get(v.id+y)?.size??0}put(v,y,d,C,F){const E=this._db.get(y=v.id+y);if(E&&(this._size-=E.size,v.size-=E.size,this._db.delete(y),E.entry!==d&&this._notifyRemove(y,E.entry,E.size,S.ALL)),C>this._maxSize)return void this._notifyRemove(y,d,C,S.ALL);if(void 0===d)return void console.warn("Refusing to cache undefined entry ");if(!C||C<0)return console.warn(`Refusing to cache entry with size ${C} for key ${y}`),void this._notifyRemove(y,d,0,S.ALL);const L=1+Math.max(F,-4)- -3;this._db.set(y,new N(d,C,L)),this._size+=C,v.size+=C,this._checkSize()}updateSize(v,y,d,C){const F=this._db.get(y=v.id+y);if(F&&F.entry===d){for(this._size-=F.size,v.size-=F.size;C>this._maxSize;){const E=this._notifyRemove(y,d,C,S.SOME);if(!(null!=E&&E>0))return void this._db.delete(y);C=E}F.size=C,this._size+=C,v.size+=C,this._checkSize()}}pop(v,y){const d=this._db.get(y=v.id+y);if(d)return this._size-=d.size,v.size-=d.size,this._db.delete(y),++this._hit,d.entry;++this._miss}get(v,y){const d=this._db.get(y=v.id+y);if(void 0!==d)return this._db.delete(y),d.lives=d.lifetime,this._db.set(y,d),++this._hit,d.entry;++this._miss}peek(v,y){const d=this._db.get(v.id+y);return d?++this._hit:++this._miss,d?.entry}get performanceInfo(){const v={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},y={},d=new Array;this._db.forEach((E,L)=>{const c=E.lifetime;d[c]=(d[c]||0)+E.size,this._users.forAll(f=>{const{id:p,name:T}=f;L.startsWith(p)&&(y[T]=(y[T]||0)+E.size)})});const C={};this._users.forAll(E=>{const L=E.name;"hitRate"in E&&"number"==typeof E.hitRate&&!isNaN(E.hitRate)&&E.hitRate>0?(y[L]=y[L]||0,C[L]=Math.round(100*E.hitRate)+"%"):C[L]="0%"});const F=Object.keys(y);F.sort((E,L)=>y[L]-y[E]),F.forEach(E=>v[E]=Math.round(y[E]/2**20)+"MB / "+C[E]);for(let E=d.length-1;E>=0;--E){const L=d[E];L&&(v["Priority "+(E+-3-1)]=Math.round(L/this._size*100)+"%")}return v}resetStats(){this._hit=this._miss=0,this._users.forAll(v=>v.resetHitRate())}clear(v){const y=v.id;this._db.forEach((d,C)=>{C.startsWith(y)&&(this._size-=d.size,this._db.delete(C),this._notifyRemove(C,d.entry,d.size,S.ALL))}),v.size=0}clearAll(){this._db.forEach((v,y)=>this._notifyRemove(y,v.entry,v.size,S.ALL)),this._users.forAll(v=>v.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(v,y,d,C){let F;return this._removeFuncs.some(E=>{if(v.startsWith(E[0])){const L=E[1](y,C,d);return"number"==typeof L&&(F=L),!0}return!1}),F}_checkSize(){this._users.forAll(v=>this._checkSizeLimits(v)),this._checkSizeLimits()}_checkSizeLimits(v){const y=v??this;if(y.maxSize<0||y.size<=y.maxSize)return;const d=v?.id;let C=!0;for(;C;){C=!1;for(const[F,E]of this._db)if(0===E.lifetime&&(!d||F.startsWith(d))){if(this._purgeItem(F,E,v),y.size<=.9*y.maxSize)return;C||=this._db.has(F)}}for(const[F,E]of this._db)if((!d||F.startsWith(d))&&(this._purgeItem(F,E,v),y.size<=.9*y.maxSize))return}_purgeItem(v,y,d=this._users.find(C=>v.startsWith(C.id))){if(this._db.delete(v),y.lives<=1){this._size-=y.size,d&&(d.size-=y.size);const C=this._notifyRemove(v,y.entry,y.size,S.SOME);null!=C&&C>0&&(this._size+=C,d&&(d.size+=C),y.lives=y.lifetime,y.size=C,this._db.set(v,y))}else--y.lives,this._db.set(v,y)}}let x=0;class N{constructor(v,y,d){this.entry=v,this.size=y,this.lifetime=d,this.lives=d}}},657:(le,$,l)=>{l.d($,{$c:()=>F,Hg:()=>E,jW:()=>y,uD:()=>d});var b=l(73514),m=l(83944),G=l(49301);const S=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function A(c){return c instanceof b.Z}function I(c){return c instanceof m.Z?Object.keys(c.items):A(c)?(0,G.vw)(c).keys():c?Object.keys(c):[]}function x(c,f){return c instanceof m.Z?c.items[f]:c[f]}function B(c){return c?c.declaredClass:null}function v(c,f){const p=c.diff;if(p&&"function"==typeof p)return p(c,f);const T=I(c),z=I(f);if(0===T.length&&0===z.length)return;if(!T.length||!z.length||function N(c,f){return!(!Array.isArray(c)||!Array.isArray(f))&&c.length!==f.length}(c,f))return{type:"complete",oldValue:c,newValue:f};const Z=z.filter(Q=>!T.includes(Q)),w=T.filter(Q=>!z.includes(Q)),D=T.filter(Q=>z.includes(Q)&&x(c,Q)!==x(f,Q)).concat(Z,w).sort(),ie=B(c);if(ie&&S.has(ie)&&D.length)return{type:"complete",oldValue:c,newValue:f};let ae;const ye=A(c)&&A(f);for(const Q of D){const X=x(c,Q),re=x(f,Q);let ne;if((ye||"function"!=typeof X&&"function"!=typeof re)&&X!==re&&(null!=X||null!=re)){if(p&&p[Q]&&"function"==typeof p[Q])ne=p[Q]?.(X,re);else if(X instanceof Date&&re instanceof Date){if(X.getTime()===re.getTime())continue;ne={type:"complete",oldValue:X,newValue:re}}else ne="object"==typeof X&&"object"==typeof re&&B(X)===B(re)?v(X,re):{type:"complete",oldValue:X,newValue:re};null!=ne&&(null!=ae?ae.diff[Q]=ne:ae={type:"partial",diff:{[Q]:ne}})}}return ae}function y(c,f){return d(c,f)}function d(c,f){if(null==c)return!1;const p=f.split(".");let T=c;for(const z of p){if("complete"===T.type)return!0;if("partial"!==T.type)return!1;{const Z=T.diff[z];if(!Z)return!1;T=Z}}return!0}function F(c,f){if(!c)return!1;if("partial"===c.type){const p=Object.keys(c.diff);return 1===p.length&&p[0]===f}return!1}function E(c,f){if("function"!=typeof c&&"function"!=typeof f&&(null!=c||null!=f))return null==c||null==f||"object"==typeof c&&"object"==typeof f&&B(c)!==B(f)?{type:"complete",oldValue:c,newValue:f}:v(c,f)}},15398:(le,$,l)=>{l.d($,{A4:()=>G,L9:()=>S,yV:()=>m});var b=l(25037);class m{}function G(I){return I instanceof b.ld?I===m.instance:"unknown"===I?.toString().toLowerCase()}function S(I){return G(I)?m.instance:I}m.instance=new b.vF("Etc/UTC")},66398:(le,$,l)=>{function m(u){return u?{originPosition:"upper-left"===u.originPosition?"upperLeft":"lower-left"===u.originPosition?"lowerLeft":u.originPosition,scale:u.tolerance?[u.tolerance,u.tolerance,1,1]:[1,1,1,1],translate:null!=u.extent?[u.extent.xmin,u.extent.ymax,u.extent.zmin??0,u.extent.mmin??0]:[0,0,0,0]}:null}function S(u){if(function G(u){return"lowerLeft"===u.originPosition&&4===u.scale.length&&4===u.translate.length}(u))return u;const{originPosition:i,scale:a,translate:_}=u,M=a[1]??1;return{originPosition:"lowerLeft",scale:[a[0]??1,"lowerLeft"===i?M:-M,a[2]??1,a[3]??1],translate:[_[0]??0,_[1]??0,_[2]??0,_[3]??0]}}function c({scale:u,translate:i},a){return a*u[0]+i[0]}function f({scale:u,translate:i},a){return a*u[1]+i[1]}function p({scale:u,translate:i},a){return(a??0)*u[2]+i[2]}function T({scale:u,translate:i},a){return a?a*u[3]+i[3]:0}function z(u,i){return u&&i?ie:u&&!i?w:!u&&i?D:Z}l.d($,{G6:()=>De,Ie:()=>Ee,J9:()=>Ue,RF:()=>Ce,U1:()=>xe,vY:()=>m}),l(40637);const Z=(u,i)=>{const a=new Array(i.length);if(!i.length)return a;const _=i[0];let O=c(u,_[0]),M=f(u,_[1]);a[0]=[O,M];const{scale:j,originPosition:W}=u,J=j[0],Y="lowerLeft"===W?j[1]:-j[1];for(let K=1;K<i.length;K++){const[H,q]=i[K];O+=J*H,M+=Y*q,a[K]=[O,M]}return a},w=(u,i)=>{const a=new Array(i.length);if(!i.length)return a;const _=i[0];let O=c(u,_[0]),M=f(u,_[1]);a[0]=[O,M,p(u,_[2])];const{scale:j,originPosition:W}=u,J=j[0],Y="lowerLeft"===W?j[1]:-j[1];for(let K=1;K<i.length;K++){const[H,q,k]=i[K];O+=J*H,M+=Y*q,a[K]=[O,M,p(u,k)]}return a},D=(u,i)=>{const a=new Array(i.length);if(!i.length)return a;const _=i[0];let O=c(u,_[0]),M=f(u,_[1]);a[0]=[O,M,T(u,_[2])];const{scale:j,originPosition:W}=u,J=j[0],Y="lowerLeft"===W?j[1]:-j[1];for(let K=1;K<i.length;K++){const[H,q,k]=i[K];O+=J*H,M+=Y*q,a[K]=[O,M,T(u,k)]}return a},ie=(u,i)=>{const a=new Array(i.length);if(!i.length)return a;const _=i[0];let O=c(u,_[0]),M=f(u,_[1]);a[0]=[O,M,p(u,_[2]),T(u,_[3])];const{scale:j,originPosition:W}=u,J=j[0],Y="lowerLeft"===W?j[1]:-j[1];for(let K=1;K<i.length;K++){const[H,q,k,pe]=i[K];O+=J*H,M+=Y*q,a[K]=[O,M,p(u,k),T(u,pe)]}return a};function ae(u,i,a){const _=new Array(a.length);for(let O=0;O<a.length;O++)_[O]=i(u,a[O]);return _}function Ce(u,i,a){const _=S(u);return i.x=function A({scale:u,translate:i},a){return Math.round((a-i[0])/u[0])}(_,a.x),i.y=function I({scale:u,translate:i},a){return Math.round((a-i[1])/u[1])}(_,a.y),null!=a.z&&(i.z=function x({scale:u,translate:i},a){return Math.round(((a??0)-i[2])/u[2])}(_,a.z)),null!=a.m&&(i.m=function N({scale:u,translate:i},a){return a?Math.round((a-i[3])/u[3]):0}(_,a.m)),i}function Ue(u,i,a,_=a?.hasZ??!1,O=a?.hasM??!1){if(null!=a){const M=S(u);i.points=z(_,O)(M,a.points),i.hasZ=_,i.hasM=O}return i}function xe(u,i,a,_=null!=a?.z,O=null!=a?.m){if(null==a)return i;const M=S(u);return i.x=c(M,a.x),i.y=f(M,a.y),_&&(i.z=p(M,a.z)),O&&(i.m=T(M,a.m)),i}function Ee(u,i,a,_=a?.hasZ??!1,O=a?.hasM??!1){if(null!=a){const M=S(u);i.rings=ae(M,z(_,O),a.rings),i.hasZ=_,i.hasM=O}return i}function De(u,i,a,_=a?.hasZ??!1,O=a?.hasM??!1){if(null!=a){const M=S(u);i.paths=ae(M,z(_,O),a.paths),i.hasZ=_,i.hasM=O}return i}},46663:(le,$,l)=>{l.r($),l.d($,{default:()=>Qe});var b=l(15861),m=l(50484),G=l(25387),S=l(83944),A=l(57964),I=l(30352),x=l(3233),N=l(79412),B=l(77675),v=l(38955),y=l(6785),d=l(80543),F=(l(14007),l(4703)),L=(l(65311),l(62185)),c=l(10141),f=l(95060),p=l(29674),T=l(4257),z=l(19855),Z=l(27426),w=l(92344),D=l(87906),ie=l(80099),ae=l(70509),ye=l(25836),Q=l(29717),X=l(12522),re=l(89713),ne=l(56956),se=l(78818),Me=l(27969),ve=l(85295),Ce=l(62691),Fe=l(36699),xe=(l(12610),l(53722),l(82752),l(28999),l(38748)),Ee=l(50923),De=l(42212),i=(l(91963),l(84373)),a=l(34222),_=l(67016),O=l(71763),M=l(7547),j=l(50106),W=l(63167),J=l(30457),Y=l(40591),K=l(75421),H=l(91866),q=l(33331),k=l(26981);const pe={key:"type",base:xe.Z,errorContext:"renderer",typeMap:{simple:Ee.Z,"unique-value":De.Z,"class-breaks":Fe.Z}},_e=(0,Me.v)(),ge=(0,j.d)({types:pe});let We=0;function be(s){const h=s.json.write;return"object"==typeof h?h.ignoreOrigin=!0:s.json.write={ignoreOrigin:!0},s}function Ve(s){switch(s){case"point":case"multipoint":return k.xA.clone();case"polyline":return k.CJ.clone();case"polygon":case"multipatch":return k.z3.clone();default:return null}}function Ze(s,h){return null==s?null:h.subtypes?.find(g=>g.code===s)}function Ge(s,h){let g=null;switch(h.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":g="point";break;case"esriGeometryPolyline":g="line";break;case"esriGeometryPolygon":case"esriGeometryMultiPatch":g="polygon";break;default:g=null}const P={},U=Ze(s,h);if(null!=U){const{defaultValues:V}=U;for(const te in V)P[te]=V[te]}return P[h.subtypeField]=s,new J.Z({name:"New Feature",drawingTool:g,prototype:{attributes:P}})}let R=class extends((0,x.R)((0,G.J)((0,i.IG)(_.Z)))){constructor(s){super(s),this.charts=null,this.editingEnabled=!0,this.fieldOverrides=null,this.fieldsIndex=null,this.formTemplate=null,this.id=`${Date.now().toString(16)}-subtype-sublayer-${We++}`,this.type="subtype-sublayer",this.labelsVisible=!0,this.labelingInfo=null,this.layerType="ArcGISFeatureLayer",this.legendEnabled=!0,this.listMode="show",this.minScale=0,this.maxScale=0,this.opacity=1,this.parent=null,this.popupEnabled=!0,this.popupTemplate=null,this.subtypeCode=null,this.templates=null,this.title=null,this.visible=!0}load(s){return(0,ve.YN)(this.renderer,this.fieldsIndex),Promise.resolve(this)}get capabilities(){return this.parent?.capabilities}get effectiveCapabilities(){return this.parent?.effectiveCapabilities}get effectiveEditingEnabled(){const{parent:s}=this;return s?s.effectiveEditingEnabled&&this.editingEnabled:this.editingEnabled}get elevationInfo(){return this.parent?.elevationInfo}writeFieldOverrides(s,h,g){const{fields:P,parent:U}=this;let V;if(P){V=[];let te=0;P.forEach(({name:oe,alias:he,editable:Oe,visible:Ie})=>{if(!Ie)return;const ue=U?.fields?.find(Le=>Le.name===oe);if(!ue)return;const ce={name:oe};let me=!1;he!==ue.alias&&(ce.alias=he,me=!0),Oe!==ue.editable&&(ce.editable=Oe,me=!0),V.push(ce),me&&te++}),0===te&&V.length===P.length&&(V=null)}else V=(0,a.d9)(s);V?.length&&(0,O.RB)(g,V,h)}get fields(){const{parent:s,fieldOverrides:h,subtypeCode:g}=this,P=s?.fields;if(!s||!P?.length)return null;const{subtypes:U,subtypeField:V}=s,te=U?.find(Ie=>Ie.code===g),oe=te?.defaultValues,he=te?.domains,Oe=[];for(const Ie of P){const ue=Ie.clone(),{name:ce}=ue,me=h?.find(Se=>Se.name===ce);if(ue.visible=!h||!!me,me){const{alias:Se,editable:Xe}=me;Se&&(ue.alias=Se),!1===Xe&&(ue.editable=!1)}ue.defaultValue=ce===V?g:oe?.[ce]??null;const je=he?.[ce]??null;ue.domain=ce===V?null:je?"inherited"===je.type?ue.domain:je.clone():null,Oe.push(ue)}return Oe}get floorInfo(){return this.parent?.floorInfo}get geometryType(){return this.parent?.geometryType}get effectiveScaleRange(){const{minScale:s,maxScale:h}=this;return{minScale:s,maxScale:h}}get objectIdField(){return this.parent||F.Z.getLogger(this).error(fe("objectIdField")),this.parent?.objectIdField}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(s){(0,ve.YN)(s,this.fieldsIndex),this._override("renderer",s)}get renderer(){if(this._isOverridden("renderer"))return this._get("renderer");const{parent:s}=this;return s&&!s.isTable&&"mesh"!==s.geometryType?function Ke(s){return new Ee.Z({symbol:Ve(s)})}(s.geometryType):null}readRendererFromService(s,h,g){if("Table"===h.type)return null;const P=h.drawingInfo?.renderer,U=ge(P,h,g);let V;const{subtypeCode:te}=this;if(null!=te&&function $e(s,h){return!(!h||"unique-value"!==s?.type||null==s.field||s.field.toLowerCase()!==h.toLowerCase()||s.field2||s.field3||s.valueExpression)}(U,h.subtypeField)){const oe=U.uniqueValueInfos?.find(({value:he})=>(he="number"==typeof he?String(he):he)===String(te));oe&&(V=new Ee.Z({symbol:oe.symbol}))}else"simple"!==U?.type||U.visualVariables?.length||(V=U);return V}readRenderer(s,h,g){const P=h?.layerDefinition?.drawingInfo?.renderer;return P?P.visualVariables?.some(V=>"rotationInfo"!==V.type)?void 0:ge(P,h,g)||void 0:void 0}get spatialReference(){return this.parent?.spatialReference}get subtypeField(){return this.parent?.subtypeField}readTemplatesFromService(s,h){return[Ge(this.subtypeCode,h)]}readTitleFromService(s,h){const g=Ze(this.subtypeCode,h);return null!=g?g.name:null}get url(){return this.parent?.url}get userHasUpdateItemPrivileges(){return!!this.parent?.userHasUpdateItemPrivileges}addAttachment(s,h){var g=this;return(0,b.Z)(function*(){const{parent:P}=g;if(!P)throw fe("addAttachment");if(s.getAttribute(P.subtypeField)!==g.subtypeCode)throw new A.Z("subtype-sublayer:addAttachment","The feature provided does not belong to this SubtypeSublayer");return P.addAttachment(s,h)})()}updateAttachment(s,h,g){var P=this;return(0,b.Z)(function*(){const{parent:U}=P;if(!U)throw fe("updateAttachment");if(s.getAttribute(U.subtypeField)!==P.subtypeCode)throw new A.Z("subtype-sublayer:updateAttachment","The feature provided does not belong to this SubtypeSublayer");return U.updateAttachment(s,h,g)})()}deleteAttachments(s,h){var g=this;return(0,b.Z)(function*(){const{parent:P}=g;if(!P)throw fe("deleteAttachments");if(s.getAttribute(P.subtypeField)!==g.subtypeCode)throw new A.Z("subtype-sublayer:deleteAttachments","The feature provided does not belong to this SubtypeSublayer");return P.deleteAttachments(s,h)})()}applyEdits(s,h){var g=this;return(0,b.Z)(function*(){if(!g.parent)throw fe("applyEdits");return g.parent.applyEdits(s,h)})()}createPopupTemplate(s){let h=this;const{parent:g,fields:P,title:U}=this;if(g){const{displayField:V,editFieldsInfo:te,objectIdField:oe}=g;h={displayField:V,editFieldsInfo:te,fields:P,objectIdField:oe,title:U}}return(0,q.eZ)(h,s)}createQuery(){if(!this.parent)throw fe("createQuery");const s=(0,se.rP)(this.parent);return s.where=(0,v._)(`${this.parent.subtypeField}=${this.subtypeCode}`,this.parent.definitionExpression),s}getField(s){return this.fieldsIndex.get(s)}getFieldDomain(s){return this._getLayerDomain(s)}queryAttachments(s,h){var g=this;return(0,b.Z)(function*(){const P=yield g.load();if(!P.parent)throw fe("queryAttachments");const U=s.clone();return U.where=ze(U.where,P.parent.subtypeField,P.subtypeCode),P.parent.queryAttachments(s,h)})()}queryFeatures(s,h){var g=this;return(0,b.Z)(function*(){const P=yield g.load();if(!P.parent)throw fe("queryFeatures");const U=H.Z.from(s)??P.createQuery();return null!=s&&(U.where=ze(U.where,P.parent.subtypeField,P.subtypeCode)),P.parent.queryFeatures(U,h)})()}_getLayerDomain(s){const h=this.fieldsIndex.get(s);return h?h.domain:null}};(0,m._)([(0,d.Cb)({readOnly:!0,json:{read:!1}})],R.prototype,"capabilities",null),(0,m._)([(0,d.Cb)({readOnly:!0,json:{read:!1}})],R.prototype,"effectiveCapabilities",null),(0,m._)([(0,d.Cb)({json:{write:{ignoreOrigin:!0}}})],R.prototype,"charts",void 0),(0,m._)([(0,d.Cb)({type:Boolean,nonNullable:!0,json:{name:"enableEditing",write:{ignoreOrigin:!0}}})],R.prototype,"editingEnabled",void 0),(0,m._)([(0,d.Cb)({type:Boolean,readOnly:!0})],R.prototype,"effectiveEditingEnabled",null),(0,m._)([(0,d.Cb)({readOnly:!0,json:{read:!1}})],R.prototype,"elevationInfo",null),(0,m._)([(0,d.Cb)({json:{name:"layerDefinition.fieldOverrides",origins:{service:{read:!1}},write:{ignoreOrigin:!0,allowNull:!0}}})],R.prototype,"fieldOverrides",void 0),(0,m._)([(0,M.c)("fieldOverrides")],R.prototype,"writeFieldOverrides",null),(0,m._)([(0,d.Cb)({..._e.fields,readOnly:!0,json:{read:!1}})],R.prototype,"fields",null),(0,m._)([(0,d.Cb)(_e.fieldsIndex)],R.prototype,"fieldsIndex",void 0),(0,m._)([(0,d.Cb)({readOnly:!0,json:{read:!1}})],R.prototype,"floorInfo",null),(0,m._)([(0,d.Cb)({type:W.Z,json:{name:"formInfo",write:{ignoreOrigin:!0}}})],R.prototype,"formTemplate",void 0),(0,m._)([(0,d.Cb)({type:String,clonable:!1,readOnly:!0,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],R.prototype,"id",void 0),(0,m._)([(0,d.Cb)({readOnly:!0,json:{read:!1}})],R.prototype,"geometryType",null),(0,m._)([(0,d.Cb)({readOnly:!0,json:{read:!1}})],R.prototype,"type",void 0),(0,m._)([(0,d.Cb)(be((0,a.d9)(ne.iR)))],R.prototype,"labelsVisible",void 0),(0,m._)([(0,d.Cb)({type:[Y.Z],json:{name:"layerDefinition.drawingInfo.labelingInfo",origins:{service:{read:!1}},read:{reader:K.r},write:{ignoreOrigin:!0}}})],R.prototype,"labelingInfo",void 0),(0,m._)([(0,d.Cb)({type:["ArcGISFeatureLayer"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],R.prototype,"layerType",void 0),(0,m._)([(0,d.Cb)(be((0,a.d9)(ne.rn)))],R.prototype,"legendEnabled",void 0),(0,m._)([(0,d.Cb)({type:["show","hide"]})],R.prototype,"listMode",void 0),(0,m._)([(0,d.Cb)((()=>{const s=(0,a.d9)(ne.rO);return s.json.origins.service.read=!1,be(s)})())],R.prototype,"minScale",void 0),(0,m._)([(0,d.Cb)((()=>{const s=(0,a.d9)(ne.u1);return s.json.origins.service.read=!1,be(s)})())],R.prototype,"maxScale",void 0),(0,m._)([(0,d.Cb)({readOnly:!0})],R.prototype,"effectiveScaleRange",null),(0,m._)([(0,d.Cb)({readOnly:!0,json:{read:!1}})],R.prototype,"objectIdField",null),(0,m._)([(0,d.Cb)({type:Number,range:{min:0,max:1},nonNullable:!0,json:{write:{ignoreOrigin:!0}}})],R.prototype,"opacity",void 0),(0,m._)([(0,d.Cb)({clonable:!1})],R.prototype,"parent",void 0),(0,m._)([(0,d.Cb)(be((0,a.d9)(ne.C_)))],R.prototype,"popupEnabled",void 0),(0,m._)([(0,d.Cb)({type:Ce.Z,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],R.prototype,"popupTemplate",void 0),(0,m._)([(0,d.Cb)({readOnly:!0})],R.prototype,"defaultPopupTemplate",null),(0,m._)([(0,d.Cb)({types:pe,json:{write:{target:"layerDefinition.drawingInfo.renderer",ignoreOrigin:!0}}})],R.prototype,"renderer",null),(0,m._)([(0,L.r)("service","renderer",["drawingInfo.renderer","subtypeField","type"])],R.prototype,"readRendererFromService",null),(0,m._)([(0,L.r)("renderer",["layerDefinition.drawingInfo.renderer"])],R.prototype,"readRenderer",null),(0,m._)([(0,d.Cb)({readOnly:!0,json:{read:!1}})],R.prototype,"spatialReference",null),(0,m._)([(0,d.Cb)({type:Number,json:{origins:{service:{read:!1}},write:{ignoreOrigin:!0}}})],R.prototype,"subtypeCode",void 0),(0,m._)([(0,d.Cb)({readOnly:!0,json:{read:!1}})],R.prototype,"subtypeField",null),(0,m._)([(0,d.Cb)({type:[J.Z],json:{name:"layerDefinition.templates",write:{ignoreOrigin:!0}}})],R.prototype,"templates",void 0),(0,m._)([(0,L.r)("service","templates",["geometryType","subtypeField","subtypes","type"])],R.prototype,"readTemplatesFromService",null),(0,m._)([(0,d.Cb)({type:String,json:{write:{ignoreOrigin:!0}}})],R.prototype,"title",void 0),(0,m._)([(0,L.r)("service","title",["subtypes"])],R.prototype,"readTitleFromService",null),(0,m._)([(0,d.Cb)({readOnly:!0,json:{read:!1}})],R.prototype,"url",null),(0,m._)([(0,d.Cb)({readOnly:!0})],R.prototype,"userHasUpdateItemPrivileges",null),(0,m._)([(0,d.Cb)({type:Boolean,nonNullable:!0,json:{name:"visibility",write:{ignoreOrigin:!0}}})],R.prototype,"visible",void 0),R=(0,m._)([(0,c.j)("esri.layers.support.SubtypeSublayer")],R);const ze=(s,h,g)=>{const P=new RegExp(`${h}\\s*=\\s*\\d+`),U=`${h}=${g}`,V=s??"";return P.test(V)?V.replace(P,U):(0,v._)(U,V)},fe=s=>new A.Z(`This sublayer must have a parent SubtypeGroupLayer in order to use ${s}`),Te=R;var Je=l(97403),He=l(83739),Pe=l(84735);const de="SubtypeGroupLayer";function we(s,h){return new A.Z("layer:unsupported",`Layer (${s.title}, ${s.id}) of type '${s.declaredClass}' ${h}`,{layer:s})}const Ae=(0,Me.v)();let ee=class extends((0,D.B)((0,w.o1)((0,z.h7)((0,X.n)((0,Q.M)((0,ye.Q)((0,T.Y)((0,ie.q)((0,ae.I)((0,x.R)((0,Z.N)((0,p.V)((0,G.J)(f.Z)))))))))))))){constructor(...s){var h;super(...s),h=this,this._sublayerLookup=new Map,this.fields=null,this.fieldsIndex=null,this.outFields=null,this.sublayers=new(S.Z.ofType(Te)),this.supportedSourceTypes=new Set(["Feature Layer"]),this.timeInfo=null,this.title="Layer",this.type="subtype-group",this._debouncedSaveOperations=(0,N.Ds)(function(){var g=(0,b.Z)(function*(P,U,V){const{save:te,saveAs:oe}=yield Promise.all([l.e(8592),l.e(2046)]).then(l.bind(l,69484));switch(P){case Pe.x.SAVE:return te(h,U);case Pe.x.SAVE_AS:return oe(h,V,U)}});return function(P,U,V){return g.apply(this,arguments)}}()),this.addHandles((0,B.YP)(()=>this.sublayers,(g,P)=>this._handleSublayersChange(g,P),B.Z_))}destroy(){this.source?.destroy()}normalizeCtorArgs(s,h){return"string"==typeof s?{url:s,...h}:s}load(s){var h=this;const g=null!=s?s.signal:null,P=this.loadFromPortal({supportedTypes:["Feature Service"]},s).catch(N.r9).then((0,b.Z)(function*(){if(!h.url)throw new A.Z("subtype-grouplayer:missing-url-or-source","SubtypeGroupLayer must be created with either a url or a portal item");if(null==h.layerId)throw new A.Z("subtype-grouplayer:missing-layerid","layerId is required for a SubtypeGroupLayer created with url");return h._initLayerProperties(yield h.createGraphicsSource(g))})).then(()=>(0,se.nU)(this,"load",s));return this.addResolvingPromise(P),Promise.resolve(this)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){return this.loaded&&null!=this.capabilities&&this.capabilities.operations.supportsEditing&&this.userHasEditingPrivileges}get effectiveEditingEnabled(){return(0,se.sX)(this)}get parsedUrl(){const s=(0,y.mN)(this.url);return null!=s&&null!=this.layerId&&(s.path=(0,y.v_)(s.path,this.layerId.toString())),s}set source(s){this._get("source")!==s&&this._set("source",s)}readTitleFromService(s,{name:h}){return this.url?(0,re.a7)(this.url,h):h}addAttachment(s,h){var g=this;return(0,b.Z)(function*(){return(0,se.JD)(g,s,h,de)})()}updateAttachment(s,h,g){var P=this;return(0,b.Z)(function*(){return(0,se.Y5)(P,s,h,g,de)})()}applyEdits(s,h){var g=this;return(0,b.Z)(function*(){return(0,se.Jj)(g,s,h)})()}on(s,h){return super.on(s,h)}createGraphicsSource(s){var h=this;return(0,b.Z)(function*(){const{default:g}=yield(0,N.Hl)(Promise.all([l.e(2008),l.e(2784),l.e(9211),l.e(5365),l.e(5508)]).then(l.bind(l,95365)),s);return new g({layer:h,supportedSourceTypes:h.supportedSourceTypes}).load({signal:s})})()}createQuery(){const s=(0,se.rP)(this),h=this.sublayers.map(g=>g.subtypeCode);return s.where=(0,v._)(`${this.subtypeField} IN (${h.join(",")})`,this.definitionExpression),s}deleteAttachments(s,h){var g=this;return(0,b.Z)(function*(){return(0,se.FV)(g,s,h,de)})()}fetchRecomputedExtents(s){var h=this;return(0,b.Z)(function*(){return(0,se.Ci)(h,s,de)})()}findSublayerForFeature(s){const h=this.fieldsIndex.get(this.subtypeField);return this.findSublayerForSubtypeCode(s.attributes[h.name])}findSublayerForSubtypeCode(s){return this._sublayerLookup.get(s)}getFieldDomain(s,h){return this._getLayerDomain(s)}getField(s){return this.fieldsIndex.get(s)}loadAll(){return(0,I.G)(this,s=>{s(this.sublayers)})}queryAttachments(s,h){var g=this;return(0,b.Z)(function*(){return(0,se.SU)(g,s,h,de)})()}queryFeatures(s,h){var g=this;return(0,b.Z)(function*(){const P=yield g.load(),U=H.Z.from(s)??P.createQuery(),V=U.outFields??[];V.includes(g.subtypeField)||(V.push(g.subtypeField),U.outFields=V);const te=yield P.source.queryFeatures(U,h);if(te?.features)for(const oe of te.features)oe.layer=oe.sourceLayer=g.findSublayerForFeature(oe);return te})()}queryObjectIds(s,h){var g=this;return(0,b.Z)(function*(){return(0,se.tD)(g,s,h,de)})()}queryFeatureCount(s,h){var g=this;return(0,b.Z)(function*(){return(0,se.VG)(g,s,h,de)})()}queryExtent(s,h){var g=this;return(0,b.Z)(function*(){return(0,se.KE)(g,s,h,de)})()}queryRelatedFeatures(s,h){var g=this;return(0,b.Z)(function*(){return(0,se.kp)(g,s,h,de)})()}queryRelatedFeaturesCount(s,h){var g=this;return(0,b.Z)(function*(){return(0,se.C9)(g,s,h,de)})()}save(s){var h=this;return(0,b.Z)(function*(){return h._debouncedSaveOperations(Pe.x.SAVE,s)})()}saveAs(s,h){var g=this;return(0,b.Z)(function*(){return g._debouncedSaveOperations(Pe.x.SAVE_AS,h,s)})()}write(s,h){const{origin:g,layerContainerType:P,messages:U}=h;if(this.isTable){if("web-scene"===g||"web-map"===g&&"tables"!==P)return U?.push(we(this,"using a table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&"web-map"===g&&"tables"===P)return U?.push(we(this,"using a non-table source cannot be written to tables in web maps")),null;return this.sublayers?.length?super.write(s,h):(U?.push(new A.Z("web-document-write:invalid-property",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' has invalid value for 'sublayers' property. 'sublayers' collection should contain at least one sublayer`,{layer:this})),null)}serviceSupportsSpatialReference(s){return!!this.loaded&&(0,He.D)(this,s)}_getLayerDomain(s){const h=this.fieldsIndex.get(s);return h?h.domain:null}_initLayerProperties(s){var h=this;return(0,b.Z)(function*(){h._set("source",s);const{sourceJSON:g}=s;if(g&&(h.sourceJSON=g,h.read(g,{origin:"service",url:h.parsedUrl})),!h.subtypes?.length)throw new A.Z("subtype-grouplayer:missing-subtypes","SubtypeGroupLayer must be created using a layer with subtypes");h._verifyFields(),(0,ve.UF)(h.timeInfo,h.fieldsIndex)})()}hasDataChanged(){var s=this;return(0,b.Z)(function*(){return(0,se.gG)(s)})()}_verifyFields(){const s=this.parsedUrl?.path??"undefined";this.objectIdField||console.log("SubtypeGroupLayer: 'objectIdField' property is not defined (url: "+s+")"),this.isTable||-1!==s.search(/\/FeatureServer\//i)||this.fields?.some(h=>"geometry"===h.type)||console.log("SubtypeGroupLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+s+")")}_handleSublayersChange(s,h){h&&(h.forEach(g=>{g.parent=null}),this.removeHandles("sublayers-owner"),this._sublayerLookup.clear()),s&&(s.forEach(g=>{g.parent=this,this._sublayerLookup.set(g.subtypeCode,g)}),this.addHandles([s.on("after-add",({item:g})=>{g.parent=this,this._sublayerLookup.set(g.subtypeCode,g)}),s.on("after-remove",({item:g})=>{g.parent=null,this._sublayerLookup.delete(g.subtypeCode)})],"sublayers-owner"))}};(0,m._)([(0,d.Cb)({readOnly:!0})],ee.prototype,"createQueryVersion",null),(0,m._)([(0,d.Cb)({readOnly:!0})],ee.prototype,"editingEnabled",null),(0,m._)([(0,d.Cb)({readOnly:!0})],ee.prototype,"effectiveEditingEnabled",null),(0,m._)([(0,d.Cb)({...Ae.fields,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],ee.prototype,"fields",void 0),(0,m._)([(0,d.Cb)(Ae.fieldsIndex)],ee.prototype,"fieldsIndex",void 0),(0,m._)([(0,d.Cb)(ne.id)],ee.prototype,"id",void 0),(0,m._)([(0,d.Cb)({type:["show","hide","hide-children"],json:{origins:{"portal-item":{read:!1,write:!1}}}})],ee.prototype,"listMode",void 0),(0,m._)([(0,d.Cb)({value:"SubtypeGroupLayer",type:["SubtypeGroupLayer"],json:{origins:{"portal-item":{name:"layerType",write:{enabled:!0,ignoreOrigin:!0}}}}})],ee.prototype,"operationalLayerType",void 0),(0,m._)([(0,d.Cb)(Ae.outFields)],ee.prototype,"outFields",void 0),(0,m._)([(0,d.Cb)({readOnly:!0})],ee.prototype,"parsedUrl",null),(0,m._)([(0,d.Cb)({clonable:!1})],ee.prototype,"source",null),(0,m._)([(0,d.Cb)({type:S.Z.ofType(Te),json:{origins:{service:{read:{source:"subtypes",reader:(s,h,g)=>{const P=s.map(({code:U})=>{const V=new Te({subtypeCode:U});return V.read(h,g),V});return new(S.Z.ofType(Te))(P)}}}},name:"layers",write:{ignoreOrigin:!0}}})],ee.prototype,"sublayers",void 0),(0,m._)([(0,d.Cb)({type:Je.Z})],ee.prototype,"timeInfo",void 0),(0,m._)([(0,d.Cb)({json:{origins:{"portal-item":{write:{enabled:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}}}})],ee.prototype,"title",void 0),(0,m._)([(0,L.r)("service","title",["name"])],ee.prototype,"readTitleFromService",null),(0,m._)([(0,d.Cb)({json:{read:!1}})],ee.prototype,"type",void 0),ee=(0,m._)([(0,c.j)("esri.layers.SubtypeGroupLayer")],ee);const Qe=ee},12522:(le,$,l)=>{l.d($,{I:()=>F,n:()=>E});var b=l(50484),m=l(34411),G=l(95539),S=l(80543),N=(l(14007),l(4703),l(65311),l(62185)),B=l(10141),v=l(76215),y=l(85295),d=l(97403),C=l(81238);const F={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:v.C}}},E=L=>{let c=class extends L{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(f,p){const T=p.timeInfo.exportOptions;if(!T)return null;const z=T.timeOffset,Z=C.v.fromJSON(T.timeOffsetUnits);return z&&Z?new G.Z({value:z,unit:Z}):null}set timeInfo(f){(0,y.UF)(f,this.fieldsIndex),this._set("timeInfo",f)}};return(0,b._)([(0,S.Cb)({type:m.Z,json:{write:!1}})],c.prototype,"timeExtent",void 0),(0,b._)([(0,S.Cb)({type:G.Z})],c.prototype,"timeOffset",void 0),(0,b._)([(0,N.r)("service","timeOffset",["timeInfo.exportOptions"])],c.prototype,"readOffset",null),(0,b._)([(0,S.Cb)({value:null,type:d.Z,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],c.prototype,"timeInfo",null),(0,b._)([(0,S.Cb)(F)],c.prototype,"useViewTime",void 0),c=(0,b._)([(0,B.j)("esri.layers.mixins.TemporalLayer")],c),c}},40100:(le,$,l)=>{l.d($,{Z:()=>C});var b=l(57964),m=l(89317),G=l(4703),S=l(8611),A=l(15398),I=l(85295),x=l(764),N=l(25037);const d=new Map;class C{static fromJSON(p){return new C(p.fields,p.timeZoneByFieldName)}static fromLayer(p){return new C(p.fields??[],c(p))}static fromLayerJSON(p){return new C(p.fields??[],c(p))}constructor(p=[],T){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=p||[],this._timeZoneByFieldName=T?new Map(T):null;const z=[];for(const Z of this.fields){const w=Z?.name,D=E(w);if(w&&D){const ie=F(w);this._fieldsMap.set(w,Z),this._fieldsMap.set(ie,Z),this._normalizedFieldsMap.set(D,Z),z.push(`${ie}:${Z.type}:${this._timeZoneByFieldName?.get(w)}`),(0,I.y2)(Z)?(this.dateFields.push(Z),this._dateFieldsSet.add(Z)):(0,I.H7)(Z)&&(this._numericFieldsSet.add(Z),this.numericFields.push(Z)),(0,I.Dl)(Z)||(0,I.Se)(Z)||(Z.editable=null==Z.editable||!!Z.editable,Z.nullable=null==Z.nullable||!!Z.nullable)}}z.sort(),this.uid=z.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const p of this.fields)(0,I.Dl)(p)||(0,I.Se)(p)||p.nullable||void 0!==(0,I.os)(p)||this._requiredFields.push(p)}return this._requiredFields}equals(p){return this.uid===p?.uid}has(p){return null!=this.get(p)}get(p){if(!p)return;let T=this._fieldsMap.get(p);return T||(T=this._fieldsMap.get(F(p))??this._normalizedFieldsMap.get(E(p)),T&&this._fieldsMap.set(p,T),T)}getTimeZone(p){const T=this.get(p&&"string"!=typeof p?p.name:p);return T?this._timeZoneByFieldName?this._timeZoneByFieldName.get(T.name):"date"===T.type||"esriFieldTypeDate"===T.type?(G.Z.getLogger("esri.layers.support.FieldsIndex").error(new b.Z("getTimeZone:no-timezone-information",`no time zone information for field '${T.name}'`)),x.pt):L.has(T.type)?x._4:null:null}getLuxonTimeZone(p){const T=this.getTimeZone(p);return T?T===x._4?A.yV.instance:T===x.pt?N.Qf.utcInstance:(0,S.s1)(d,T,()=>N.vF.create(T)):null}isDateField(p){return this._dateFieldsSet.has(this.get(p))}isTimeOnlyField(p){return(0,I.sX)(this.get(p))}isNumericField(p){return this._numericFieldsSet.has(this.get(p))}normalizeFieldName(p){return this.get(p)?.name??void 0}toJSON(){return{fields:this.fields.map(p=>(0,m.AK)(p)?p.toJSON():p),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function F(f){return f.trim().toLowerCase()}function E(f){return(0,I.q6)(f)?.toLowerCase()??""}const L=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function c(f){const p=new Map;if(!f.fields)return p;const T=!0===f.datesInUnknownTimezone,{timeInfo:z,editFieldsInfo:Z}=f,w=(z?"startField"in z?z.startField:z.startTimeField:"")??"",D=(z?"endField"in z?z.endField:z.endTimeField:"")??"",ie=function y(f){return"dateFieldsTimeZone"in f}(f)?f.dateFieldsTimeZone??null:f.dateFieldsTimeReference?(0,x.Jv)(f.dateFieldsTimeReference):null,ae=Z?function B(f){return"timeZone"in f}(Z)?Z.timeZone??ie:Z.dateFieldsTimeReference?(0,x.Jv)(Z.dateFieldsTimeReference):ie??x.pt:null,ye=z?function v(f){return"timeZone"in f}(z)?z.timeZone??ie:z.timeReference?(0,x.Jv)(z.timeReference):ie:null,Q=new Map([[F(Z?.creationDateField??""),ae],[F(Z?.editDateField??""),ae],[F(w),ye],[F(D),ye]]);for(const{name:X,type:re}of f.fields)if(L.has(re))p.set(X,x._4);else if("date"!==re&&"esriFieldTypeDate"!==re)p.set(X,null);else if(T)p.set(X,x._4);else{const ne=Q.get(F(X??""))??ie;p.set(X,ne)}return p}},97403:(le,$,l)=>{l.d($,{Z:()=>L});var b=l(50484),m=l(34411),G=l(95539),S=l(25387),A=l(89317),I=l(80543),v=(l(14007),l(4703),l(65311),l(62185)),y=l(10141),d=l(7547),C=l(764);function F(c,f){return G.Z.fromJSON({value:c,unit:f})}let E=class extends((0,S.J)(A.wq)){constructor(c){super(c),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(c,f){return f.timeExtent&&Array.isArray(f.timeExtent)&&2===f.timeExtent.length?m.Z.fromArray(f.timeExtent):null}writeFullTimeExtent(c,f){f.timeExtent=null!=c?.start&&null!=c.end?c.toArray():null}readInterval(c,f){return f.timeInterval&&f.timeIntervalUnits?F(f.timeInterval,f.timeIntervalUnits):f.defaultTimeInterval&&f.defaultTimeIntervalUnits?F(f.defaultTimeInterval,f.defaultTimeIntervalUnits):null}writeInterval(c,f){f.timeInterval=c?.toJSON().value??null,f.timeIntervalUnits=c?.toJSON().unit??null}};(0,b._)([(0,I.Cb)({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],E.prototype,"cumulative",void 0),(0,b._)([(0,I.Cb)({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],E.prototype,"endField",void 0),(0,b._)([(0,I.Cb)({type:m.Z,json:{write:{enabled:!0,allowNull:!0}}})],E.prototype,"fullTimeExtent",void 0),(0,b._)([(0,v.r)("fullTimeExtent",["timeExtent"])],E.prototype,"readFullTimeExtent",null),(0,b._)([(0,d.c)("fullTimeExtent")],E.prototype,"writeFullTimeExtent",null),(0,b._)([(0,I.Cb)({type:Boolean,json:{write:!0}})],E.prototype,"hasLiveData",void 0),(0,b._)([(0,I.Cb)({type:G.Z,json:{write:{enabled:!0,allowNull:!0}}})],E.prototype,"interval",void 0),(0,b._)([(0,v.r)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],E.prototype,"readInterval",null),(0,b._)([(0,d.c)("interval")],E.prototype,"writeInterval",null),(0,b._)([(0,I.Cb)({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],E.prototype,"startField",void 0),(0,b._)([(0,I.Cb)((0,C.mi)("timeReference",!0))],E.prototype,"timeZone",void 0),(0,b._)([(0,I.Cb)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],E.prototype,"trackIdField",void 0),(0,b._)([(0,I.Cb)({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],E.prototype,"useTime",void 0),(0,b._)([(0,I.Cb)({type:[Date],json:{read:!1}})],E.prototype,"stops",void 0),E=(0,b._)([(0,y.j)("esri.layers.support.TimeInfo")],E);const L=E},27969:(le,$,l)=>{l.d($,{v:()=>I});var b=l(14007),m=l(4703),G=l(81247),S=l(40100),A=l(85295);function I(){return{fields:{type:[G.Z],value:null,set:function(x){if(x&&(0,b.Z)("big-integer-warning-enabled")){const N=x.filter(B=>"big-integer"===B.type||"oid"===B.type&&(B.length||0)>=8);if(N.length){const B=N.map(v=>`'${v.name}'`).join(", ");m.Z.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${B}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",x)}},fieldsIndex:{readOnly:!0,get(){return S.Z.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(x){this._userOutFields=x,this.notifyChange("outFields")},get:function(){const x=this._userOutFields;if(!x?.length)return null;if(x.includes("*"))return["*"];if(!this.fields)return x;for(const N of x)this.fieldsIndex?.has(N)||m.Z.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${N} found in outFields`,{layer:this,outFields:x});return(0,A.Q0)(this.fieldsIndex,x)}}}}},56761:(le,$,l)=>{l.d($,{UG:()=>y,UO:()=>E,YI:()=>F,dI:()=>L,el:()=>Z,hV:()=>C,z7:()=>d});var b=l(72578);const m="__begin__",G="__end__",S=new RegExp(m,"ig"),A=new RegExp(G,"ig"),I=new RegExp("^"+m,"i"),x=new RegExp(G+"$","i"),N='"',B=N+" + ",v=" + "+N;function y(w){return w.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function d(w){return w.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function C(w){const D={expression:"",type:"none"};return w.labelExpressionInfo?w.labelExpressionInfo.value?(D.expression=w.labelExpressionInfo.value,D.type="conventional"):w.labelExpressionInfo.expression&&(D.expression=w.labelExpressionInfo.expression,D.type="arcade"):null!=w.labelExpression&&(D.expression=y(w.labelExpression),D.type="conventional"),D}function F(w){const D=C(w);if(!D)return null;switch(D.type){case"conventional":return L(D.expression);case"arcade":return D.expression}return null}function E(w){const D=C(w);if(!D)return null;switch(D.type){case"conventional":return function f(w){return w?.match(c)?.[1].trim()||null}(D.expression);case"arcade":return Z(D.expression)}return null}function L(w){let D;return w?(D=(0,b.gx)(w,ie=>m+'$feature["'+ie+'"]'+G),D=I.test(D)?D.replace(I,""):N+D,D=x.test(D)?D.replace(x,""):D+N,D=D.replaceAll(S,B).replaceAll(A,v)):D='""',D}const c=/^\s*\{([^}]+)\}\s*$/i,p=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,T=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,z=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function Z(w){if(!w)return null;let D=p.exec(w)||T.exec(w);return D?D[1]||D[3]:(D=z.exec(w),D?D[2]:null)}},81238:(le,$,l)=>{l.d($,{v:()=>m});const m=(0,l(84303).w)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0})},96043:(le,$,l)=>{l.d($,{AJ:()=>x,If:()=>v,k0:()=>I,uI:()=>B,ul:()=>A,wx:()=>y});var b=l(55117),m=l(55768),G=l(5710),S=l(23515);const A=2.4;function I(d){return(0,m.Wz)(d*A)}function x(d){return(0,m.F2)(d)/A}function N(d,C,F,E){let{color:L,ratio:c}=C,{color:f,ratio:p}=F;p===c&&(1===p?c-=1e-6:p+=1e-6);const T=(0,b.uZ)((E-c)/(p-c),0,1);(0,G.l)(d,L.toArray(),f.toArray(),T)}function B(d){const F=new Uint8ClampedArray(2048);if((d=d.filter(({ratio:p})=>p>=0&&p<=1).sort((p,T)=>p.ratio-T.ratio).map(({color:p,ratio:T})=>({color:p,ratio:Math.max(T,.001)}))).length<1)return F;let E=d[0],L=d[0],c=1;const f=(0,S.Ue)();for(let p=0;p<512;p++){const T=(p+.5)/512;for(;T>L.ratio&&c<d.length;)E=L,L=d[c++];N(f,E,L,T),F.set(f,4*p)}return F}function v(d,C,F){const E=Math.sqrt(d**2+C**2)/F;return E>1?0:3/(Math.PI*F**2)*(1-E**2)**2}function y(d){return"function"==typeof d?d:d?C=>+C[d]:()=>1}},84735:(le,$,l)=>{var b,m;l.d($,{x:()=>b}),(m=b||(b={}))[m.SAVE=0]="SAVE",m[m.SAVE_AS=1]="SAVE_AS"}}]);