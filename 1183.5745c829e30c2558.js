"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[1183],{52540:(W,j,c)=>{c.d(j,{z:()=>T});var S=c(39921);class T{constructor(O,L){this._storage=new S.WJ,this.id="",this.name="",this.size=0,this._storage.maxSize=O,this._storage.register(this),L&&this._storage.registerRemoveFunc("",L)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(O,L,C=1){this._storage.put(this,O,L,C,1)}pop(O){return this._storage.pop(this,O)}get(O){return this._storage.get(this,O)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(O){this._storage.maxSize=O}resetHitRate(){}}},39921:(W,j,c)=>{c.d(j,{WJ:()=>C,Xq:()=>L});var O,D,S=c(43029);(D=O||(O={}))[D.ALL=0]="ALL",D[D.SOME=1]="SOME";class L{constructor(i,e,r){this.name=i,this._storage=e,this.id=A+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),r&&(this._storage.registerRemoveFunc(this.id,r),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(i){return this._storage.getSize(this,i)}resetHitRate(){this._hit=this._miss=0}put(i,e,r,_=0){this._storage.put(this,i,e,r,_)}pop(i){const e=this._storage.pop(this,i);return void 0===e?++this._miss:++this._hit,e}get(i){const e=this._storage.get(this,i);return void 0===e?++this._miss:++this._hit,e}peek(i){return this._storage.peek(this,i)}updateSize(i,e,r){this._storage.updateSize(this,i,e,r)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class C{get size(){return this._size}constructor(i=10485760){this._maxSize=i,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new S.Z,this._users=new S.Z}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(i){this._users.push(i)}deregister(i){this._users.removeUnordered(i)}registerRemoveFunc(i,e){this._removeFuncs.push([i,e])}deregisterRemoveFunc(i){this._removeFuncs.filterInPlace(e=>e[0]!==i)}get maxSize(){return this._maxSize}set maxSize(i){this._maxSize=Math.max(i,-1),this._checkSize()}getSize(i,e){return this._db.get(i.id+e)?.size??0}put(i,e,r,_,g){const h=this._db.get(e=i.id+e);if(h&&(this._size-=h.size,i.size-=h.size,this._db.delete(e),h.entry!==r&&this._notifyRemove(e,h.entry,h.size,O.ALL)),_>this._maxSize)return void this._notifyRemove(e,r,_,O.ALL);if(void 0===r)return void console.warn("Refusing to cache undefined entry ");if(!_||_<0)return console.warn(`Refusing to cache entry with size ${_} for key ${e}`),void this._notifyRemove(e,r,0,O.ALL);const v=1+Math.max(g,-4)- -3;this._db.set(e,new b(r,_,v)),this._size+=_,i.size+=_,this._checkSize()}updateSize(i,e,r,_){const g=this._db.get(e=i.id+e);if(g&&g.entry===r){for(this._size-=g.size,i.size-=g.size;_>this._maxSize;){const h=this._notifyRemove(e,r,_,O.SOME);if(!(null!=h&&h>0))return void this._db.delete(e);_=h}g.size=_,this._size+=_,i.size+=_,this._checkSize()}}pop(i,e){const r=this._db.get(e=i.id+e);if(r)return this._size-=r.size,i.size-=r.size,this._db.delete(e),++this._hit,r.entry;++this._miss}get(i,e){const r=this._db.get(e=i.id+e);if(void 0!==r)return this._db.delete(e),r.lives=r.lifetime,this._db.set(e,r),++this._hit,r.entry;++this._miss}peek(i,e){const r=this._db.get(i.id+e);return r?++this._hit:++this._miss,r?.entry}get performanceInfo(){const i={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},e={},r=new Array;this._db.forEach((h,v)=>{const x=h.lifetime;r[x]=(r[x]||0)+h.size,this._users.forAll(P=>{const{id:R,name:l}=P;v.startsWith(R)&&(e[l]=(e[l]||0)+h.size)})});const _={};this._users.forAll(h=>{const v=h.name;"hitRate"in h&&"number"==typeof h.hitRate&&!isNaN(h.hitRate)&&h.hitRate>0?(e[v]=e[v]||0,_[v]=Math.round(100*h.hitRate)+"%"):_[v]="0%"});const g=Object.keys(e);g.sort((h,v)=>e[v]-e[h]),g.forEach(h=>i[h]=Math.round(e[h]/2**20)+"MB / "+_[h]);for(let h=r.length-1;h>=0;--h){const v=r[h];v&&(i["Priority "+(h+-3-1)]=Math.round(v/this._size*100)+"%")}return i}resetStats(){this._hit=this._miss=0,this._users.forAll(i=>i.resetHitRate())}clear(i){const e=i.id;this._db.forEach((r,_)=>{_.startsWith(e)&&(this._size-=r.size,this._db.delete(_),this._notifyRemove(_,r.entry,r.size,O.ALL))}),i.size=0}clearAll(){this._db.forEach((i,e)=>this._notifyRemove(e,i.entry,i.size,O.ALL)),this._users.forAll(i=>i.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(i,e,r,_){let g;return this._removeFuncs.some(h=>{if(i.startsWith(h[0])){const v=h[1](e,_,r);return"number"==typeof v&&(g=v),!0}return!1}),g}_checkSize(){this._users.forAll(i=>this._checkSizeLimits(i)),this._checkSizeLimits()}_checkSizeLimits(i){const e=i??this;if(e.maxSize<0||e.size<=e.maxSize)return;const r=i?.id;let _=!0;for(;_;){_=!1;for(const[g,h]of this._db)if(0===h.lifetime&&(!r||g.startsWith(r))){if(this._purgeItem(g,h,i),e.size<=.9*e.maxSize)return;_||=this._db.has(g)}}for(const[g,h]of this._db)if((!r||g.startsWith(r))&&(this._purgeItem(g,h,i),e.size<=.9*e.maxSize))return}_purgeItem(i,e,r=this._users.find(_=>i.startsWith(_.id))){if(this._db.delete(i),e.lives<=1){this._size-=e.size,r&&(r.size-=e.size);const _=this._notifyRemove(i,e.entry,e.size,O.SOME);null!=_&&_>0&&(this._size+=_,r&&(r.size+=_),e.lives=e.lifetime,e.size=_,this._db.set(i,e))}else--e.lives,this._db.set(i,e)}}let A=0;class b{constructor(i,e,r){this.entry=i,this.size=e,this.lifetime=r,this.lives=r}}},82001:(W,j,c)=>{c.d(j,{CS:()=>h,Cw:()=>g,Yu:()=>l,j5:()=>v,lm:()=>f});var S=c(15861),T=c(11931),U=c(26152),O=c(62691),L=c(66476),C=c(34222),A=c(6785),b=c(43814),D=c(27048),i=c(43585),e=c(91963),r=c(93792);const _={esriGeometryPoint:"points",esriGeometryPolyline:"polylines",esriGeometryPolygon:"polygons"};function g(t){const a=t.folders||[],s=a.slice(),o=new Map,p=new Map,M=new Map,n=new Map,E=new Map,u={esriGeometryPoint:p,esriGeometryPolyline:M,esriGeometryPolygon:n};(t.featureCollection?.layers||[]).forEach(m=>{const z=(0,C.d9)(m);z.featureSet.features=[];const I=m.featureSet.geometryType;o.set(I,z);const B=m.layerDefinition.objectIdField;"esriGeometryPoint"===I?x(p,B,m.featureSet.features):"esriGeometryPolyline"===I?x(M,B,m.featureSet.features):"esriGeometryPolygon"===I&&x(n,B,m.featureSet.features)}),t.groundOverlays&&t.groundOverlays.forEach(m=>{E.set(m.id,m)}),a.forEach(m=>{m.networkLinkIds.forEach(z=>{const I=function R(t,a,s){const o=function P(t,a){let s;return a.some(o=>o.id===t&&(s=o,!0)),s}(t,s);return o&&(o.parentFolderId=a,o.networkLink=o),o}(z,m.id,t.networkLinks);I&&s.push(I)})}),s.forEach(m=>{if(m.featureInfos){m.points=(0,C.d9)(o.get("esriGeometryPoint")),m.polylines=(0,C.d9)(o.get("esriGeometryPolyline")),m.polygons=(0,C.d9)(o.get("esriGeometryPolygon")),m.mapImages=[];for(const z of m.featureInfos)switch(z.type){case"esriGeometryPoint":case"esriGeometryPolyline":case"esriGeometryPolygon":{const I=u[z.type].get(z.id);I&&m[_[z.type]]?.featureSet.features.push(I);break}case"GroundOverlay":{const I=E.get(z.id);I&&m.mapImages.push(I);break}}m.fullExtent=f([m])}});const y=f(s);return{folders:a,sublayers:s,extent:y}}function h(t,a,s,o){const p=U.id?.findCredential(t);return t=(0,A.fl)(t,{token:p?.token}),(0,L.Z)(T.default.kmlServiceUrl,{query:{url:t,model:"simple",folders:"",refresh:0!==s||void 0,outSR:JSON.stringify(a)},responseType:"json",signal:o})}function v(t,a,s=null,o=[]){const p=[],M={},n=a.sublayers,E=new Set(a.folders.map(u=>u.id));return n.forEach(u=>{const y=new t;if(s?y.read(u,s):y.read(u),o.length&&E.has(y.id)&&(y.visible=o.includes(y.id)),M[u.id]=y,null!=u.parentFolderId&&-1!==u.parentFolderId){const m=M[u.parentFolderId];m.sublayers||(m.sublayers=[]),m.sublayers?.unshift(y)}else p.unshift(y)}),p}function x(t,a,s){s.forEach(o=>{t.set(o.attributes[a],o)})}function l(t){return d.apply(this,arguments)}function d(){return(d=(0,S.Z)(function*(t){const a=r.Z.fromJSON(t.featureSet).features,o=(0,e.i)(t.layerDefinition.drawingInfo.renderer),p=O.Z.fromJSON(t.popupInfo),M=[];for(const n of a){const E=yield o.getSymbolAsync(n);n.symbol=E,n.popupTemplate=p,n.visible=!0,M.push(n)}return M})).apply(this,arguments)}function f(t){const a=(0,D.Ue)(D.G_),s=(0,D.Ue)(D.G_);for(const o of t){if(o.polygons?.featureSet?.features)for(const p of o.polygons.featureSet.features)(0,i.Yg)(a,p.geometry),(0,D.TC)(s,a);if(o.polylines?.featureSet?.features)for(const p of o.polylines.featureSet.features)(0,i.Yg)(a,p.geometry),(0,D.TC)(s,a);if(o.points?.featureSet?.features)for(const p of o.points.featureSet.features)(0,i.Yg)(a,p.geometry),(0,D.TC)(s,a);if(o.mapImages)for(const p of o.mapImages)(0,i.Yg)(a,p.extent),(0,D.TC)(s,a)}return(0,D.fS)(s,D.G_)?void 0:{xmin:s[0],ymin:s[1],zmin:s[2],xmax:s[3],ymax:s[4],zmax:s[5],spatialReference:b.Z.WGS84}}},96043:(W,j,c)=>{c.d(j,{AJ:()=>A,If:()=>i,k0:()=>C,uI:()=>D,ul:()=>L,wx:()=>e});var S=c(55117),T=c(55768),U=c(5710),O=c(23515);const L=2.4;function C(r){return(0,T.Wz)(r*L)}function A(r){return(0,T.F2)(r)/L}function b(r,_,g,h){let{color:v,ratio:x}=_,{color:P,ratio:R}=g;R===x&&(1===R?x-=1e-6:R+=1e-6);const l=(0,S.uZ)((h-x)/(R-x),0,1);(0,U.l)(r,v.toArray(),P.toArray(),l)}function D(r){const g=new Uint8ClampedArray(2048);if((r=r.filter(({ratio:R})=>R>=0&&R<=1).sort((R,l)=>R.ratio-l.ratio).map(({color:R,ratio:l})=>({color:R,ratio:Math.max(l,.001)}))).length<1)return g;let h=r[0],v=r[0],x=1;const P=(0,O.Ue)();for(let R=0;R<512;R++){const l=(R+.5)/512;for(;l>v.ratio&&x<r.length;)h=v,v=r[x++];b(P,h,v,l),g.set(P,4*R)}return g}function i(r,_,g){const h=Math.sqrt(r**2+_**2)/g;return h>1?0:3/(Math.PI*g**2)*(1-h**2)**2}function e(r){return"function"==typeof r?r:r?_=>+_[r]:()=>1}},93792:(W,j,c)=>{c.d(j,{Z:()=>R});var v,S=c(50484),T=c(2189),U=c(35458),O=c(84303),L=c(89317),C=c(34222),A=c(80543),i=(c(14007),c(4703),c(62185)),e=c(10141),r=c(7547),_=c(43814),g=c(40637),h=c(81247);const x=new O.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let P=v=class extends L.wq{constructor(l){super(l),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(l,d){const f=_.Z.fromJSON(d.spatialReference),t=[];for(let a=0;a<l.length;a++){const s=l[a],o=U.Z.fromJSON(s),p=s.geometry?.spatialReference;null==o.geometry||p||(o.geometry.spatialReference=f);const M=s.aggregateGeometries,n=o.aggregateGeometries;if(M&&null!=n)for(const E in n){const u=n[E],y=M[E],m=y?.spatialReference;null==u||m||(u.spatialReference=f)}t.push(o)}return t}writeGeometryType(l,d,f,t){if(l)return void x.write(l,d,f,t);const{features:a}=this;if(a)for(const s of a)if(null!=s?.geometry)return void x.write(s.geometry.type,d,f,t)}readQueryGeometry(l,d){if(!l)return null;const f=!!l.spatialReference,t=(0,g.im)(l);return t&&!f&&d.spatialReference&&(t.spatialReference=_.Z.fromJSON(d.spatialReference)),t}writeSpatialReference(l,d){if(l)return void(d.spatialReference=l.toJSON());const{features:f}=this;if(f)for(const t of f)if(t&&null!=t.geometry&&t.geometry.spatialReference)return void(d.spatialReference=t.geometry.spatialReference.toJSON())}clone(){return new v(this.cloneProperties())}cloneProperties(){return(0,C.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(l){const d=this.write();if(d.features&&Array.isArray(l)&&l.length>0)for(let f=0;f<d.features.length;f++){const t=d.features[f];if(t.geometry){const a=l?.[f];t.geometry=a?.toJSON()||t.geometry}}return d}quantize(l){const{scale:[d,f],translate:[t,a]}=l,p=this.features,M=this._getQuantizationFunction(this.geometryType,n=>Math.round((n-t)/d),n=>Math.round((a-n)/f));for(let n=0,E=p.length;n<E;n++)M?.(p[n].geometry)||(p.splice(n,1),n--,E--);return this.transform=l,this}unquantize(){const{geometryType:l,features:d,transform:f}=this;if(!f)return this;const{translate:[t,a],scale:[s,o]}=f;let n=null,E=null;if(this.hasZ&&null!=f?.scale?.[2]){const{translate:[,,y],scale:[,,m]}=f;n=z=>z*m+y}if(this.hasM&&null!=f?.scale?.[3]){const{translate:[,,,y],scale:[,,,m]}=f;E=z=>null==z?z:z*m+y}const u=this._getHydrationFunction(l,y=>y*s+t,y=>a-y*o,n,E);for(const{geometry:y}of d)null!=y&&u&&u(y);return this.transform=null,this}_quantizePoints(l,d,f){let t,a;const s=[];for(let o=0,p=l.length;o<p;o++){const M=l[o];if(o>0){const n=d(M[0]),E=f(M[1]);n===t&&E===a||(s.push([n-t,E-a]),t=n,a=E)}else t=d(M[0]),a=f(M[1]),s.push([t,a])}return s.length>0?s:null}_getQuantizationFunction(l,d,f){return"point"===l?t=>(t.x=d(t.x),t.y=f(t.y),t):"polyline"===l||"polygon"===l?t=>{const a=(0,g.oU)(t)?t.rings:t.paths,s=[];for(let o=0,p=a.length;o<p;o++){const n=this._quantizePoints(a[o],d,f);n&&s.push(n)}return s.length>0?((0,g.oU)(t)?t.rings=s:t.paths=s,t):null}:"multipoint"===l?t=>{const a=this._quantizePoints(t.points,d,f);return a&&a.length>0?(t.points=a,t):null}:"extent"===l?t=>t:null}_getHydrationFunction(l,d,f,t,a){return"point"===l?s=>{s.x=d(s.x),s.y=f(s.y),t&&(s.z=t(s.z))}:"polyline"===l||"polygon"===l?s=>{const o=(0,g.oU)(s)?s.rings:s.paths;let p,M;for(let n=0,E=o.length;n<E;n++){const u=o[n];for(let y=0,m=u.length;y<m;y++){const z=u[y];y>0?(p+=z[0],M+=z[1]):(p=z[0],M=z[1]),z[0]=d(p),z[1]=f(M)}}if(t&&a)for(let n=0,E=o.length;n<E;n++){const u=o[n];for(let y=0,m=u.length;y<m;y++){const z=u[y];z[2]=t(z[2]),z[3]=a(z[3])}}else if(t)for(let n=0,E=o.length;n<E;n++){const u=o[n];for(let y=0,m=u.length;y<m;y++){const z=u[y];z[2]=t(z[2])}}else if(a)for(let n=0,E=o.length;n<E;n++){const u=o[n];for(let y=0,m=u.length;y<m;y++){const z=u[y];z[2]=a(z[2])}}}:"extent"===l?s=>{s.xmin=d(s.xmin),s.ymin=f(s.ymin),s.xmax=d(s.xmax),s.ymax=f(s.ymax),t&&null!=s.zmax&&null!=s.zmin&&(s.zmax=t(s.zmax),s.zmin=t(s.zmin)),a&&null!=s.mmax&&null!=s.mmin&&(s.mmax=a(s.mmax),s.mmin=a(s.mmin))}:"multipoint"===l?s=>{const o=s.points;let p,M;for(let n=0,E=o.length;n<E;n++){const u=o[n];n>0?(p+=u[0],M+=u[1]):(p=u[0],M=u[1]),u[0]=d(p),u[1]=f(M)}if(t&&a)for(let n=0,E=o.length;n<E;n++){const u=o[n];u[2]=t(u[2]),u[3]=a(u[3])}else if(t)for(let n=0,E=o.length;n<E;n++){const u=o[n];u[2]=t(u[2])}else if(a)for(let n=0,E=o.length;n<E;n++){const u=o[n];u[2]=a(u[2])}}:null}};(0,S._)([(0,A.Cb)({type:String,json:{write:!0}})],P.prototype,"displayFieldName",void 0),(0,S._)([(0,A.Cb)({type:Boolean,json:{write:{overridePolicy:l=>({enabled:l})}}})],P.prototype,"exceededTransferLimit",void 0),(0,S._)([(0,A.Cb)({type:[U.Z],json:{write:!0}})],P.prototype,"features",void 0),(0,S._)([(0,i.r)("features")],P.prototype,"readFeatures",null),(0,S._)([(0,A.Cb)({type:[h.Z],json:{write:!0}})],P.prototype,"fields",void 0),(0,S._)([(0,A.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:x.read}}})],P.prototype,"geometryType",void 0),(0,S._)([(0,r.c)("geometryType")],P.prototype,"writeGeometryType",null),(0,S._)([(0,A.Cb)({type:Boolean,json:{write:{overridePolicy:l=>({enabled:l})}}})],P.prototype,"hasM",void 0),(0,S._)([(0,A.Cb)({type:Boolean,json:{write:{overridePolicy:l=>({enabled:l})}}})],P.prototype,"hasZ",void 0),(0,S._)([(0,A.Cb)({types:T.qM,json:{write:!0}})],P.prototype,"queryGeometry",void 0),(0,S._)([(0,i.r)("queryGeometry")],P.prototype,"readQueryGeometry",null),(0,S._)([(0,A.Cb)({type:_.Z,json:{write:!0}})],P.prototype,"spatialReference",void 0),(0,S._)([(0,r.c)("spatialReference")],P.prototype,"writeSpatialReference",null),(0,S._)([(0,A.Cb)({json:{write:!0}})],P.prototype,"transform",void 0),P=v=(0,S._)([(0,e.j)("esri.rest.support.FeatureSet")],P),P.prototype.toJSON.isDefaultToJSON=!0;const R=P}}]);