"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[2746,318,5398],{657:(ue,ee,a)=>{a.d(ee,{$c:()=>$,Hg:()=>se,jW:()=>te,uD:()=>X});var w=a(73514),g=a(83944),ne=a(49301);const A=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function x(u){return u instanceof w.Z}function _(u){return u instanceof g.Z?Object.keys(u.items):x(u)?(0,ne.vw)(u).keys():u?Object.keys(u):[]}function F(u,f){return u instanceof g.Z?u.items[f]:u[f]}function J(u){return u?u.declaredClass:null}function O(u,f){const c=u.diff;if(c&&"function"==typeof c)return c(u,f);const E=_(u),b=_(f);if(0===E.length&&0===b.length)return;if(!E.length||!b.length||function R(u,f){return!(!Array.isArray(u)||!Array.isArray(f))&&u.length!==f.length}(u,f))return{type:"complete",oldValue:u,newValue:f};const P=b.filter(v=>!E.includes(v)),K=E.filter(v=>!b.includes(v)),Y=E.filter(v=>b.includes(v)&&F(u,v)!==F(f,v)).concat(P,K).sort(),Q=J(u);if(Q&&A.has(Q)&&Y.length)return{type:"complete",oldValue:u,newValue:f};let W;const T=x(u)&&x(f);for(const v of Y){const h=F(u,v),y=F(f,v);let L;if((T||"function"!=typeof h&&"function"!=typeof y)&&h!==y&&(null!=h||null!=y)){if(c&&c[v]&&"function"==typeof c[v])L=c[v]?.(h,y);else if(h instanceof Date&&y instanceof Date){if(h.getTime()===y.getTime())continue;L={type:"complete",oldValue:h,newValue:y}}else L="object"==typeof h&&"object"==typeof y&&J(h)===J(y)?O(h,y):{type:"complete",oldValue:h,newValue:y};null!=L&&(null!=W?W.diff[v]=L:W={type:"partial",diff:{[v]:L}})}}return W}function te(u,f){return X(u,f)}function X(u,f){if(null==u)return!1;const c=f.split(".");let E=u;for(const b of c){if("complete"===E.type)return!0;if("partial"!==E.type)return!1;{const P=E.diff[b];if(!P)return!1;E=P}}return!0}function $(u,f){if(!u)return!1;if("partial"===u.type){const c=Object.keys(u.diff);return 1===c.length&&c[0]===f}return!1}function se(u,f){if("function"!=typeof u&&"function"!=typeof f&&(null!=u||null!=f))return null==u||null==f||"object"==typeof u&&"object"==typeof f&&J(u)!==J(f)?{type:"complete",oldValue:u,newValue:f}:O(u,f)}},15398:(ue,ee,a)=>{a.d(ee,{A4:()=>ne,L9:()=>A,yV:()=>g});var w=a(25037);class g{}function ne(_){return _ instanceof w.ld?_===g.instance:"unknown"===_?.toString().toLowerCase()}function A(_){return ne(_)?g.instance:_}g.instance=new w.vF("Etc/UTC")},66398:(ue,ee,a)=>{function g(i){return i?{originPosition:"upper-left"===i.originPosition?"upperLeft":"lower-left"===i.originPosition?"lowerLeft":i.originPosition,scale:i.tolerance?[i.tolerance,i.tolerance,1,1]:[1,1,1,1],translate:null!=i.extent?[i.extent.xmin,i.extent.ymax,i.extent.zmin??0,i.extent.mmin??0]:[0,0,0,0]}:null}function A(i){if(function ne(i){return"lowerLeft"===i.originPosition&&4===i.scale.length&&4===i.translate.length}(i))return i;const{originPosition:s,scale:l,translate:d}=i,p=l[1]??1;return{originPosition:"lowerLeft",scale:[l[0]??1,"lowerLeft"===s?p:-p,l[2]??1,l[3]??1],translate:[d[0]??0,d[1]??0,d[2]??0,d[3]??0]}}function u({scale:i,translate:s},l){return l*i[0]+s[0]}function f({scale:i,translate:s},l){return l*i[1]+s[1]}function c({scale:i,translate:s},l){return(l??0)*i[2]+s[2]}function E({scale:i,translate:s},l){return l?l*i[3]+s[3]:0}function b(i,s){return i&&s?Q:i&&!s?K:!i&&s?Y:P}a.d(ee,{G6:()=>ce,Ie:()=>ae,J9:()=>B,RF:()=>ie,U1:()=>j,vY:()=>g}),a(40637);const P=(i,s)=>{const l=new Array(s.length);if(!s.length)return l;const d=s[0];let m=u(i,d[0]),p=f(i,d[1]);l[0]=[m,p];const{scale:D,originPosition:U}=i,H=D[0],V="lowerLeft"===U?D[1]:-D[1];for(let Z=1;Z<s.length;Z++){const[G,k]=s[Z];m+=H*G,p+=V*k,l[Z]=[m,p]}return l},K=(i,s)=>{const l=new Array(s.length);if(!s.length)return l;const d=s[0];let m=u(i,d[0]),p=f(i,d[1]);l[0]=[m,p,c(i,d[2])];const{scale:D,originPosition:U}=i,H=D[0],V="lowerLeft"===U?D[1]:-D[1];for(let Z=1;Z<s.length;Z++){const[G,k,q]=s[Z];m+=H*G,p+=V*k,l[Z]=[m,p,c(i,q)]}return l},Y=(i,s)=>{const l=new Array(s.length);if(!s.length)return l;const d=s[0];let m=u(i,d[0]),p=f(i,d[1]);l[0]=[m,p,E(i,d[2])];const{scale:D,originPosition:U}=i,H=D[0],V="lowerLeft"===U?D[1]:-D[1];for(let Z=1;Z<s.length;Z++){const[G,k,q]=s[Z];m+=H*G,p+=V*k,l[Z]=[m,p,E(i,q)]}return l},Q=(i,s)=>{const l=new Array(s.length);if(!s.length)return l;const d=s[0];let m=u(i,d[0]),p=f(i,d[1]);l[0]=[m,p,c(i,d[2]),E(i,d[3])];const{scale:D,originPosition:U}=i,H=D[0],V="lowerLeft"===U?D[1]:-D[1];for(let Z=1;Z<s.length;Z++){const[G,k,q,de]=s[Z];m+=H*G,p+=V*k,l[Z]=[m,p,c(i,q),E(i,de)]}return l};function W(i,s,l){const d=new Array(l.length);for(let m=0;m<l.length;m++)d[m]=s(i,l[m]);return d}function ie(i,s,l){const d=A(i);return s.x=function x({scale:i,translate:s},l){return Math.round((l-s[0])/i[0])}(d,l.x),s.y=function _({scale:i,translate:s},l){return Math.round((l-s[1])/i[1])}(d,l.y),null!=l.z&&(s.z=function F({scale:i,translate:s},l){return Math.round(((l??0)-s[2])/i[2])}(d,l.z)),null!=l.m&&(s.m=function R({scale:i,translate:s},l){return l?Math.round((l-s[3])/i[3]):0}(d,l.m)),s}function B(i,s,l,d=l?.hasZ??!1,m=l?.hasM??!1){if(null!=l){const p=A(i);s.points=b(d,m)(p,l.points),s.hasZ=d,s.hasM=m}return s}function j(i,s,l,d=null!=l?.z,m=null!=l?.m){if(null==l)return s;const p=A(i);return s.x=u(p,l.x),s.y=f(p,l.y),d&&(s.z=c(p,l.z)),m&&(s.m=E(p,l.m)),s}function ae(i,s,l,d=l?.hasZ??!1,m=l?.hasM??!1){if(null!=l){const p=A(i);s.rings=W(p,b(d,m),l.rings),s.hasZ=d,s.hasM=m}return s}function ce(i,s,l,d=l?.hasZ??!1,m=l?.hasM??!1){if(null!=l){const p=A(i);s.paths=W(p,b(d,m),l.paths),s.hasZ=d,s.hasM=m}return s}},22858:(ue,ee,a)=>{a.r(ee),a.d(ee,{default:()=>le});var S,w=a(15861),g=a(50484),A=(a(2189),a(83944)),x=a(5603),_=a(3233),F=a(79412),R=a(77675),J=a(6785),O=a(80543),$=(a(14007),a(4703),a(65311),a(62185)),se=a(10141),M=a(7547),u=a(43814),f=a(95060),c=a(19855),E=a(80099),b=a(70509),P=a(25836),K=a(29717),Y=a(56956),Q=a(88278),W=a(89317),T=a(67016),v=a(72578),h=a(1535),y=a(82001),L=a(26894);let z=S=class extends(Q.Z.EventedMixin((0,W.eC)(T.Z))){constructor(...I){super(...I),this.description=null,this.fullExtent=null,this.id=null,this.networkLink=null,this.parent=null,this.sublayers=null,this.title=null,this.sourceJSON=null,this.layer=null,this.addHandles([(0,R.on)(()=>this.sublayers,"after-add",({item:C})=>{C.parent=this,C.layer=this.layer},R.Z_),(0,R.on)(()=>this.sublayers,"after-remove",({item:C})=>{C.layer=C.parent=null},R.Z_),(0,R.YP)(()=>this.sublayers,(C,B)=>{if(B)for(const j of B)j.layer=j.parent=null;if(C)for(const j of C)j.parent=this,j.layer=this.layer},R.Z_),(0,R.YP)(()=>this.layer,C=>{if(this.sublayers)for(const B of this.sublayers)B.layer=C},R.Z_)])}initialize(){(0,R.N1)(()=>this.networkLink).then(()=>(0,R.N1)(()=>!0===this.visible)).then(()=>this.load())}load(I){if(!this.networkLink||this.networkLink.viewFormat)return;const C=null!=I?I.signal:null,B=this._fetchService(this._get("networkLink")?.href??"",C).then(j=>{const ae=(0,y.lm)(j.sublayers);this.fullExtent=L.Z.fromJSON(ae),this.sourceJSON=j;const ce=(0,h.se)(A.Z.ofType(S),(0,y.j5)(S,j));this.sublayers?this.sublayers.addMany(ce):this.sublayers=ce,this.layer?.emit("sublayer-update"),this.layer&&this.layer.notifyChange("visibleSublayers")});return this.addResolvingPromise(B),Promise.resolve(this)}get visible(){return this._get("visible")}set visible(I){this._get("visible")!==I&&(this._set("visible",I),this.layer&&this.layer.notifyChange("visibleSublayers"))}readVisible(I,C){return!!C.visibility}_fetchService(I,C){return(0,y.CS)(I,this.layer.outSpatialReference,this.layer.refreshInterval,C).then(B=>(0,y.Cw)(B.data))}};(0,g._)([(0,O.Cb)()],z.prototype,"description",void 0),(0,g._)([(0,O.Cb)({type:L.Z})],z.prototype,"fullExtent",void 0),(0,g._)([(0,O.Cb)()],z.prototype,"id",void 0),(0,g._)([(0,O.Cb)({readOnly:!0,value:null})],z.prototype,"networkLink",void 0),(0,g._)([(0,O.Cb)({json:{write:{allowNull:!0}}})],z.prototype,"parent",void 0),(0,g._)([(0,O.Cb)({type:A.Z.ofType(z),json:{write:{allowNull:!0}}})],z.prototype,"sublayers",void 0),(0,g._)([(0,O.Cb)({value:null,json:{read:{source:"name",reader:I=>(0,v.Cb)(I)}}})],z.prototype,"title",void 0),(0,g._)([(0,O.Cb)({value:!0})],z.prototype,"visible",null),(0,g._)([(0,$.r)("visible",["visibility"])],z.prototype,"readVisible",null),(0,g._)([(0,O.Cb)()],z.prototype,"sourceJSON",void 0),(0,g._)([(0,O.Cb)()],z.prototype,"layer",void 0),z=S=(0,g._)([(0,se.j)("esri.layers.support.KMLSublayer")],z);const oe=z,ie=["kml","xml"];let N=class extends((0,c.h7)((0,P.Q)((0,K.M)((0,E.q)((0,b.I)((0,_.R)(f.Z))))))){constructor(...I){super(...I),this._visibleFolders=[],this.allSublayers=new x.Z({getCollections:()=>[this.sublayers],getChildrenFunction:C=>C.sublayers}),this.outSpatialReference=u.Z.WGS84,this.path=null,this.legendEnabled=!1,this.operationalLayerType="KML",this.sublayers=null,this.type="kml",this.url=null}initialize(){this.addHandles([(0,R.YP)(()=>this.sublayers,(I,C)=>{C&&C.forEach(B=>{B.parent=null,B.layer=null}),I&&I.forEach(B=>{B.parent=this,B.layer=this})},R.Z_),this.on("sublayer-update",()=>this.notifyChange("fullExtent"))])}normalizeCtorArgs(I,C){return"string"==typeof I?{url:I,...C}:I}readSublayersFromItemOrWebMap(I,C){this._visibleFolders=C.visibleFolders}readSublayers(I,C,B){return(0,y.j5)(oe,C,B,this._visibleFolders)}writeSublayers(I,C){const B=[],j=I.toArray();for(;j.length;){const ae=j[0];ae.networkLink||(ae.visible&&B.push(ae.id),ae.sublayers&&j.push(...ae.sublayers.toArray())),j.shift()}C.visibleFolders=B}get title(){const I=this._get("title");return I&&"defaults"!==this.originOf("title")?I:this.url?(0,J.vt)(this.url,ie)||"KML":I}set title(I){this._set("title",I)}get visibleSublayers(){const I=this.sublayers,C=[],B=j=>{j.visible&&(C.push(j),j.sublayers&&j.sublayers.forEach(B))};return I&&I.forEach(B),C}get fullExtent(){return this._recomputeFullExtent()}load(I){const C=null!=I?I.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["KML"],supportsData:!1},I).catch(F.r9).then(()=>this._fetchService(C))),Promise.resolve(this)}destroy(){super.destroy(),this.allSublayers.destroy()}_fetchService(I){var C=this;return(0,w.Z)(function*(){const B=yield Promise.resolve().then(()=>C.resourceInfo?{ssl:!1,data:C.resourceInfo}:(0,y.CS)(C.url??"",C.outSpatialReference,C.refreshInterval,I)),j=(0,y.Cw)(B.data);j&&C.read(j,{origin:"service"})})()}_recomputeFullExtent(){let I=null;null!=this.extent&&(I=this.extent.clone());const C=B=>{if(B.sublayers)for(const j of B.sublayers.items)C(j),j.visible&&j.fullExtent&&(null!=I?I.union(j.fullExtent):I=j.fullExtent.clone())};return C(this),I}};(0,g._)([(0,O.Cb)({readOnly:!0})],N.prototype,"allSublayers",void 0),(0,g._)([(0,O.Cb)({type:u.Z})],N.prototype,"outSpatialReference",void 0),(0,g._)([(0,O.Cb)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],N.prototype,"path",void 0),(0,g._)([(0,O.Cb)({readOnly:!0,json:{read:!1,write:!1}})],N.prototype,"legendEnabled",void 0),(0,g._)([(0,O.Cb)({type:["show","hide","hide-children"]})],N.prototype,"listMode",void 0),(0,g._)([(0,O.Cb)({type:["KML"]})],N.prototype,"operationalLayerType",void 0),(0,g._)([(0,O.Cb)({})],N.prototype,"resourceInfo",void 0),(0,g._)([(0,O.Cb)({type:A.Z.ofType(oe),json:{write:{ignoreOrigin:!0}}})],N.prototype,"sublayers",void 0),(0,g._)([(0,$.r)(["web-map","portal-item"],"sublayers",["visibleFolders"])],N.prototype,"readSublayersFromItemOrWebMap",null),(0,g._)([(0,$.r)("service","sublayers",["sublayers"])],N.prototype,"readSublayers",null),(0,g._)([(0,M.c)("sublayers")],N.prototype,"writeSublayers",null),(0,g._)([(0,O.Cb)({readOnly:!0,json:{read:!1}})],N.prototype,"type",void 0),(0,g._)([(0,O.Cb)({json:{origins:{"web-map":{read:{source:"title"}}},write:{ignoreOrigin:!0}}})],N.prototype,"title",null),(0,g._)([(0,O.Cb)(Y.HQ)],N.prototype,"url",void 0),(0,g._)([(0,O.Cb)({readOnly:!0})],N.prototype,"visibleSublayers",null),(0,g._)([(0,O.Cb)({type:L.Z})],N.prototype,"extent",void 0),(0,g._)([(0,O.Cb)()],N.prototype,"fullExtent",null),N=(0,g._)([(0,se.j)("esri.layers.KMLLayer")],N);const le=N},70509:(ue,ee,a)=>{a.d(ee,{I:()=>K});var w=a(15861),g=a(50484),ne=a(11931),A=a(26152),x=a(66476),_=a(37636),F=a(57964),R=a(4703),J=a(51172),O=a(79412),te=a(6785),X=a(80543),se=(a(14007),a(65311),a(62185)),M=a(10141),u=a(7547),f=a(85971),c=a(61018),E=a(27835),b=a(57437),P=a(50318);const K=Q=>{let W=class extends Q{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,J.SC)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(T){T!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",T))}readPortalItem(T,v,h){if(v.itemId)return new E.default({id:v.itemId,portal:h?.portal})}writePortalItem(T,v){T?.id&&(v.itemId=T.id)}loadFromPortal(T,v){var h=this;return(0,w.Z)(function*(){if(h.portalItem?.id)try{const{load:y}=yield Promise.all([a.e(2772),a.e(8592),a.e(6964)]).then(a.bind(a,36964));return(0,O.k_)(v),yield y({instance:h,supportedTypes:T.supportedTypes,validateItem:T.validateItem,supportsData:T.supportsData,layerModuleTypeMap:T.layerModuleTypeMap},v)}catch(y){throw(0,O.D_)(y)||R.Z.getLogger(h).warn(`Failed to load layer (${h.title}, ${h.id}) portal item (${h.portalItem.id})\n  ${y}`),y}})()}finishLoadEditablePortalLayer(T){var v=this;return(0,w.Z)(function*(){v._set("userHasEditingPrivileges",yield v._fetchUserHasEditingPrivileges(T).catch(h=>((0,O.r9)(h),!0)))})()}setUserPrivileges(T,v){var h=this;return(0,w.Z)(function*(){if(!ne.default.userPrivilegesApplied)return h.finishLoadEditablePortalLayer(v);if(h.url)try{const{features:{edit:y,fullEdit:L},content:{updateItem:S}}=yield h._fetchUserPrivileges(T,v);h._set("userHasEditingPrivileges",y),h._set("userHasFullEditingPrivileges",L),h._set("userHasUpdateItemPrivileges",S)}catch(y){(0,O.r9)(y)}})()}_fetchUserPrivileges(T,v){var h=this;return(0,w.Z)(function*(){let y=h.portalItem;if(!T||!y||!y.loaded||y.sourceUrl)return h._fetchFallbackUserPrivileges(v);const L=T===y.id;if(L&&y.portal.user)return(0,P.Ss)(y);let S,z;if(L)S=y.portal.url;else try{S=yield(0,f.oP)(h.url,v)}catch(le){(0,O.r9)(le)}if(!S||!(0,te.Zo)(S,y.portal.url))return h._fetchFallbackUserPrivileges(v);try{const le=null!=v?v.signal:null;z=yield A.id?.getCredential(`${S}/sharing`,{prompt:!1,signal:le})}catch(le){(0,O.r9)(le)}if(!z)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(L?yield y.reload():(y=new E.default({id:T,portal:{url:S}}),yield y.load(v)),y.portal.user)return(0,P.Ss)(y)}catch(le){(0,O.r9)(le)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_fetchFallbackUserPrivileges(T){var v=this;return(0,w.Z)(function*(){let h=!0;try{h=yield v._fetchUserHasEditingPrivileges(T)}catch(y){(0,O.r9)(y)}return{features:{edit:h,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(T){var v=this;return(0,w.Z)(function*(){const h=v.url?A.id?.findCredential(v.url):null;if(!h)return!0;const y=Y.credential===h?Y.user:yield v._fetchEditingUser(T);return Y.credential=h,Y.user=y,null==y?.privileges||y.privileges.includes("features:user:edit")})()}_fetchEditingUser(T){var v=this;return(0,w.Z)(function*(){const h=v.portalItem?.portal?.user;if(h)return h;const y=A.id?.findServerInfo(v.url??"");if(!y?.owningSystemUrl)return null;const L=`${y.owningSystemUrl}/sharing/rest`,S=c.Z.getDefault();if(S&&S.loaded&&(0,te.Fv)(S.restUrl)===(0,te.Fv)(L))return S.user;const z=`${L}/community/self`,oe=null!=T?T.signal:null,ie=yield(0,_.q6)((0,x.Z)(z,{authMode:"no-prompt",query:{f:"json"},signal:oe}));return ie.ok?b.Z.fromJSON(ie.value.data):null})()}read(T,v){v&&(v.layer=this),super.read(T,v)}write(T,v){const h=v?.portal,y=this.portalItem?.id&&(this.portalItem.portal||c.Z.getDefault());return h&&y&&!(0,te.tm)(y.restUrl,h.restUrl)?(v.messages&&v.messages.push(new F.Z("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(T,{...v,layer:this})}};return(0,g._)([(0,X.Cb)({type:E.default})],W.prototype,"portalItem",null),(0,g._)([(0,se.r)("web-document","portalItem",["itemId"])],W.prototype,"readPortalItem",null),(0,g._)([(0,u.c)("web-document","portalItem",{itemId:{type:String}})],W.prototype,"writePortalItem",null),(0,g._)([(0,X.Cb)({clonable:!1})],W.prototype,"resourceReferences",void 0),(0,g._)([(0,X.Cb)({type:Boolean,readOnly:!0})],W.prototype,"userHasEditingPrivileges",void 0),(0,g._)([(0,X.Cb)({type:Boolean,readOnly:!0})],W.prototype,"userHasFullEditingPrivileges",void 0),(0,g._)([(0,X.Cb)({type:Boolean,readOnly:!0})],W.prototype,"userHasUpdateItemPrivileges",void 0),W=(0,g._)([(0,M.j)("esri.layers.mixins.PortalLayer")],W),W},Y={credential:null,user:null}},25836:(ue,ee,a)=>{a.d(ee,{Q:()=>v});var w=a(15861),g=a(50484),A=(a(14007),a(4703)),x=a(79412),_=a(80543),F=a(73018),J=(a(65311),a(10141)),O=a(76215),te=a(83944),se=(a(37636),a(57964),a(12926),a(43571));const M=new te.Z,u=new WeakMap;function b(h,y){return Number.isFinite(h)&&Number.isFinite(y)?y<=0?h:b(y,h%y):0}let P=0,K=0;function Y(){const h=Date.now();let y=!1;for(const L of M){const S=L.deref();S?S.refreshInterval&&h-(u.get(S)??0)+5>=6e4*S.refreshInterval&&(u.set(S,h),S.refresh(h)):y=!0}if(y)for(let L=M.length-1;L>=0;L--)M.at(L).deref()||M.removeAt(L)}(0,se.EH)(()=>{const h=Date.now();let y=0;for(const L of M){const S=L.deref();S&&(y=b(Math.round(6e4*S.refreshInterval),y),S.refreshInterval?u.get(S)||u.set(S,h):u.delete(S))}if(y!==K){if(K=y,clearInterval(P),0===K)return void(P=0);P=setInterval(Y,K)}});const v=h=>{let y=class extends h{constructor(...L){super(...L),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,x.Ds)(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||function f(h){(function E(h){return null!=h&&"object"==typeof h&&"refreshInterval"in h&&"refresh"in h})(h)&&M.push(new WeakRef(h))}(this)},()=>{})}destroy(){!function c(h){const y=M.find(L=>L.deref()===h);y&&M.remove(y)}(this)}castRefreshInterval(L){return L>=.1?L:L<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(L=Date.now()){(0,x.R8)(this._debounceHasDataChanged()).then(S=>{S&&this._set("refreshTimestamp",L),this.emit("refresh",{dataChanged:S})},S=>{A.Z.getLogger(this).error(S),this.emit("refresh",{dataChanged:!1,error:S})})}hasDataChanged(){return(0,w.Z)(function*(){return!0})()}get test(){}};return(0,g._)([(0,_.Cb)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:O.C}}}}})],y.prototype,"refreshInterval",void 0),(0,g._)([(0,F.p)("refreshInterval")],y.prototype,"castRefreshInterval",null),(0,g._)([(0,_.Cb)({readOnly:!0})],y.prototype,"refreshTimestamp",void 0),(0,g._)([(0,_.Cb)({readOnly:!0})],y.prototype,"refreshParameters",null),y=(0,g._)([(0,J.j)("esri.layers.mixins.RefreshableLayer")],y),y}},40100:(ue,ee,a)=>{a.d(ee,{Z:()=>re});var w=a(57964),g=a(89317),ne=a(4703),A=a(8611),x=a(15398),_=a(85295),F=a(764),R=a(25037);const X=new Map;class re{static fromJSON(c){return new re(c.fields,c.timeZoneByFieldName)}static fromLayer(c){return new re(c.fields??[],u(c))}static fromLayerJSON(c){return new re(c.fields??[],u(c))}constructor(c=[],E){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=c||[],this._timeZoneByFieldName=E?new Map(E):null;const b=[];for(const P of this.fields){const K=P?.name,Y=se(K);if(K&&Y){const Q=$(K);this._fieldsMap.set(K,P),this._fieldsMap.set(Q,P),this._normalizedFieldsMap.set(Y,P),b.push(`${Q}:${P.type}:${this._timeZoneByFieldName?.get(K)}`),(0,_.y2)(P)?(this.dateFields.push(P),this._dateFieldsSet.add(P)):(0,_.H7)(P)&&(this._numericFieldsSet.add(P),this.numericFields.push(P)),(0,_.Dl)(P)||(0,_.Se)(P)||(P.editable=null==P.editable||!!P.editable,P.nullable=null==P.nullable||!!P.nullable)}}b.sort(),this.uid=b.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const c of this.fields)(0,_.Dl)(c)||(0,_.Se)(c)||c.nullable||void 0!==(0,_.os)(c)||this._requiredFields.push(c)}return this._requiredFields}equals(c){return this.uid===c?.uid}has(c){return null!=this.get(c)}get(c){if(!c)return;let E=this._fieldsMap.get(c);return E||(E=this._fieldsMap.get($(c))??this._normalizedFieldsMap.get(se(c)),E&&this._fieldsMap.set(c,E),E)}getTimeZone(c){const E=this.get(c&&"string"!=typeof c?c.name:c);return E?this._timeZoneByFieldName?this._timeZoneByFieldName.get(E.name):"date"===E.type||"esriFieldTypeDate"===E.type?(ne.Z.getLogger("esri.layers.support.FieldsIndex").error(new w.Z("getTimeZone:no-timezone-information",`no time zone information for field '${E.name}'`)),F.pt):M.has(E.type)?F._4:null:null}getLuxonTimeZone(c){const E=this.getTimeZone(c);return E?E===F._4?x.yV.instance:E===F.pt?R.Qf.utcInstance:(0,A.s1)(X,E,()=>R.vF.create(E)):null}isDateField(c){return this._dateFieldsSet.has(this.get(c))}isTimeOnlyField(c){return(0,_.sX)(this.get(c))}isNumericField(c){return this._numericFieldsSet.has(this.get(c))}normalizeFieldName(c){return this.get(c)?.name??void 0}toJSON(){return{fields:this.fields.map(c=>(0,g.AK)(c)?c.toJSON():c),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function $(f){return f.trim().toLowerCase()}function se(f){return(0,_.q6)(f)?.toLowerCase()??""}const M=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function u(f){const c=new Map;if(!f.fields)return c;const E=!0===f.datesInUnknownTimezone,{timeInfo:b,editFieldsInfo:P}=f,K=(b?"startField"in b?b.startField:b.startTimeField:"")??"",Y=(b?"endField"in b?b.endField:b.endTimeField:"")??"",Q=function te(f){return"dateFieldsTimeZone"in f}(f)?f.dateFieldsTimeZone??null:f.dateFieldsTimeReference?(0,F.Jv)(f.dateFieldsTimeReference):null,W=P?function J(f){return"timeZone"in f}(P)?P.timeZone??Q:P.dateFieldsTimeReference?(0,F.Jv)(P.dateFieldsTimeReference):Q??F.pt:null,T=b?function O(f){return"timeZone"in f}(b)?b.timeZone??Q:b.timeReference?(0,F.Jv)(b.timeReference):Q:null,v=new Map([[$(P?.creationDateField??""),W],[$(P?.editDateField??""),W],[$(K),T],[$(Y),T]]);for(const{name:h,type:y}of f.fields)if(M.has(y))c.set(h,F._4);else if("date"!==y&&"esriFieldTypeDate"!==y)c.set(h,null);else if(E)c.set(h,F._4);else{const L=v.get($(h??""))??Q;c.set(h,L)}return c}},50318:(ue,ee,a)=>{a.d(ee,{$o:()=>X,Fj:()=>J,IW:()=>te,Ss:()=>se,_$:()=>R,ck:()=>O,hz:()=>$,qj:()=>F});var w=a(15861),g=a(83821),ne=a(43814),A=a(48230);function _(){return(_=(0,w.Z)(function*(M){const u=M.spatialReference;if(u.isWGS84)return M.clone();if(u.isWebMercator)return(0,A.Sx)(M);const f=ne.Z.WGS84;return yield(0,g.initializeProjection)(u,f),(0,g.project)(M,f)})).apply(this,arguments)}function F(M,u){if(!R(M,u)){const f=M.typeKeywords;f?f.push(u):M.typeKeywords=[u]}}function R(M,u){return!!M.typeKeywords?.includes(u)}function J(M){return R(M,$.HOSTED_SERVICE)}function O(M,u){const f=M.typeKeywords;if(f){const c=f.indexOf(u);c>-1&&f.splice(c,1)}}function te(M,u,f){f?F(M,u):O(M,u)}function X(M){return re.apply(this,arguments)}function re(){return re=(0,w.Z)(function*(M){const u=M.clone().normalize();let f;if(u.length>1)for(const c of u)f?c.width>f.width&&(f=c):f=c;else f=u[0];return function x(M){return _.apply(this,arguments)}(f)}),re.apply(this,arguments)}const $={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function se(M){const{portal:u,isOrgItem:f,itemControl:c}=M,E=u.user?.privileges;let b=!E||E.includes("features:user:edit"),P=!!f&&!!E?.includes("features:user:fullEdit");const K="update"===c||"admin"===c;return K?P=b=!0:P&&(b=!0),{features:{edit:b,fullEdit:P},content:{updateItem:K}}}}}]);