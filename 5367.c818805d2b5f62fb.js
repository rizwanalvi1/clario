"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[5367,3686],{15367:(V,H,F)=>{F.d(H,{Z:()=>b});var d=F(15861),S=F(18722),f=F(70930),R=F(95418),j=F(58446),w=F(76961),C=F(23686);class b extends R.Z{constructor(g){super(g),this._relation="",this._relationGeom=null,this._relationString="",this.declaredClass="esri.arcade.featureset.actions.SpatialFilter",this._relationString=g.relationString,this._parent=g.parentfeatureset,this._maxProcessing=40,this._relation=g.relation,this._relationGeom=g.relationGeom}_getSet(g){var c=this;return(0,d.Z)(function*(){if(null===c._wset){yield c._ensureLoaded();const Z=yield c._parent._getFilteredSet("esriSpatialRelRelation"!==c._relation?c._relation:c._relation+":"+c._relationString,c._relationGeom,null,null,g);return c._checkCancelled(g),c._wset=new j.Z(Z._candidates.slice(0),Z._known.slice(0),Z._ordered,c._clonePageDefinition(Z.pagesDefinition)),c._wset}return c._wset})()}_isInFeatureSet(g){let c=this._parent._isInFeatureSet(g);return c===w.dj.NotInFeatureSet?c:(c=this._idstates[g],void 0===c?w.dj.Unknown:c)}_getFeature(g,c,Z){return this._parent._getFeature(g,c,Z)}_getFeatures(g,c,Z,T){return this._parent._getFeatures(g,c,Z,T)}_featureFromCache(g){return this._parent._featureFromCache(g)}executeSpatialRelationTest(g){var c=this;return(0,d.Z)(function*(){if(null===g.geometry)return!1;switch(c._relation){case"esriSpatialRelEnvelopeIntersects":return(0,C.intersects)((0,w.SV)(c._relationGeom),(0,w.SV)(g.geometry));case"esriSpatialRelIntersects":return(0,C.intersects)(c._relationGeom,g.geometry);case"esriSpatialRelContains":return(0,C.contains)(c._relationGeom,g.geometry);case"esriSpatialRelOverlaps":return(0,C.overlaps)(c._relationGeom,g.geometry);case"esriSpatialRelWithin":return(0,C.within)(c._relationGeom,g.geometry);case"esriSpatialRelTouches":return(0,C.touches)(c._relationGeom,g.geometry);case"esriSpatialRelCrosses":return(0,C.crosses)(c._relationGeom,g.geometry);case"esriSpatialRelRelation":return(0,C.relate)(c._relationGeom,g.geometry,c._relationString??"")}})()}_fetchAndRefineFeatures(g,c,Z){var T=this;return(0,d.Z)(function*(){const A=new j.Z([],g,!1,null),P=Math.min(c,g.length);yield T._parent?._getFeatures(A,-1,P,Z),T._checkCancelled(Z);const N=[];for(let e=0;e<P;e++){const t=T._parent._featureFromCache(g[e]);N.push(yield T.executeSpatialRelationTest(t))}for(let e=0;e<c;e++)T._idstates[g[e]]=!0===N[e]?w.dj.InFeatureSet:w.dj.NotInFeatureSet;return"success"})()}_getFilteredSet(g,c,Z,T,A){var P=this;return(0,d.Z)(function*(){yield P._ensureLoaded();const N=yield P._parent._getFilteredSet("esriSpatialRelRelation"!==P._relation?P._relation:P._relation+":"+P._relationString,P._relationGeom,Z,T,A);let e;return P._checkCancelled(A),e=null!==c?new j.Z(N._candidates.slice(0).concat(N._known.slice(0)),[],N._ordered,P._clonePageDefinition(N.pagesDefinition)):new j.Z(N._candidates.slice(0),N._known.slice(0),N._ordered,P._clonePageDefinition(N.pagesDefinition)),e})()}_stat(g,c,Z,T,A,P,N){var e=this;return(0,d.Z)(function*(){if(""!==Z)return{calculated:!1};const t=yield e._parent._stat(g,c,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,A,P,N);return!1===t.calculated?null===A&&""===Z&&null===T?e._manualStat(g,c,P,N):{calculated:!1}:t})()}_canDoAggregates(g,c,Z,T,A){var P=this;return(0,d.Z)(function*(){return""===Z&&null===T&&null!==P._parent&&P._parent._canDoAggregates(g,c,"esriSpatialRelRelation"!==P._relation?P._relation:P._relation+":"+P._relationString,P._relationGeom,A)})()}_getAggregatePagesDataSourceDefinition(g,c,Z,T,A,P,N){var e=this;return(0,d.Z)(function*(){if(null===e._parent)throw new f.EN(f.H9.NeverReach);return e._parent._getAggregatePagesDataSourceDefinition(g,c,"esriSpatialRelRelation"!==e._relation?e._relation:e._relation+":"+e._relationString,e._relationGeom,A,P,N)})()}static registerAction(){R.Z._featuresetFunctions.intersects=function(g){return null==g?new S.Z({parentfeatureset:this}):new b({parentfeatureset:this,relation:"esriSpatialRelIntersects",relationGeom:g})},R.Z._featuresetFunctions.envelopeIntersects=function(g){return null==g?new S.Z({parentfeatureset:this}):new b({parentfeatureset:this,relation:"esriSpatialRelEnvelopeIntersects",relationGeom:g})},R.Z._featuresetFunctions.contains=function(g){return null==g?new S.Z({parentfeatureset:this}):new b({parentfeatureset:this,relation:"esriSpatialRelContains",relationGeom:g})},R.Z._featuresetFunctions.overlaps=function(g){return null==g?new S.Z({parentfeatureset:this}):new b({parentfeatureset:this,relation:"esriSpatialRelOverlaps",relationGeom:g})},R.Z._featuresetFunctions.within=function(g){return null==g?new S.Z({parentfeatureset:this}):new b({parentfeatureset:this,relation:"esriSpatialRelWithin",relationGeom:g})},R.Z._featuresetFunctions.touches=function(g){return null==g?new S.Z({parentfeatureset:this}):new b({parentfeatureset:this,relation:"esriSpatialRelTouches",relationGeom:g})},R.Z._featuresetFunctions.crosses=function(g){return null==g?new S.Z({parentfeatureset:this}):new b({parentfeatureset:this,relation:"esriSpatialRelCrosses",relationGeom:g})},R.Z._featuresetFunctions.relate=function(g,c){return null==g?new S.Z({parentfeatureset:this}):new b({parentfeatureset:this,relation:"esriSpatialRelRelation",relationGeom:g,relationString:c})}}getFieldsIndex(){return this._parent.getFieldsIndex()}}},18722:(V,H,F)=>{F.d(H,{Z:()=>w});var d=F(15861),S=F(70930),f=F(95418),R=F(58446),j=F(76961);class w extends f.Z{constructor(b){super(b),this.declaredClass="esri.layers.featureset.sources.Empty",this._maxProcessing=1e3,this._wset=new R.Z([],[],!1,null),this._parent=b.parentfeatureset,this._databaseType=j.Bj.Standardised}_getSet(){var b=this;return(0,d.Z)(function*(){return b._wset})()}optimisePagingFeatureQueries(){}_isInFeatureSet(){return j.dj.NotInFeatureSet}_getFeature(){return(0,d.Z)(function*(){throw new S.EN(S.H9.NeverReach)})()}queryAttachments(){return(0,d.Z)(function*(){return[]})()}_getFeatures(){return(0,d.Z)(function*(){return"success"})()}_featureFromCache(){return null}_fetchAndRefineFeatures(){return(0,d.Z)(function*(){throw new S.EN(S.H9.NeverReach)})()}_getFilteredSet(){return(0,d.Z)(function*(){return new R.Z([],[],!1,null)})()}_stat(b,J,g,c,Z,T,A){return this._manualStat(b,J,T,A)}_canDoAggregates(){return(0,d.Z)(function*(){return!1})()}}},95418:(V,H,F)=>{F.d(H,{Z:()=>A});var d=F(15861),S=F(19104),f=F(70930),R=F(860);class j{constructor(e,t){this._lastId=-1,this._progress=t,this._parent=e}reset(){this._lastId=-1}nextBatchAsArcadeFeatures(e,t){var a=this;return(0,d.Z)(function*(){const n=yield a.nextBatch(e);return null===n?n:n.map(u=>R.Z.createFromGraphicLikeObject(u.geometry,u.attributes,a._parent,t))})()}nextBatch(e){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(n=>this.nextBatch(e),n=>this.nextBatch(e));const t={returnpromise:null,hasset:!1},a=[];return t.returnpromise=new Promise((n,u)=>{this._parent._getSet(this._progress).then(l=>{const I=l._known;let v=I.length-1;if("GETPAGES"===I[I.length-1]&&(v-=1),this._lastId+e>v&&I.length>0&&"GETPAGES"===I[I.length-1])this._parent._expandPagedSet(l,this._parent._maxQueryRate(),0,0,this._progress).then(G=>{t.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(e).then(n,u)},G=>{t.hasset=!0,this._parent._mainSetInUse=null,u(G)});else{if(v>=this._lastId+e||0===l._candidates.length){for(let G=0;G<e;G++){const i=G+this._lastId+1;if(i>=I.length)break;a[G]=I[i]}return this._lastId+=a.length,0===a.length&&(t.hasset=!0,this._parent._mainSetInUse=null,n([])),void this._parent._getFeatureBatch(a,this._progress).then(G=>{t.hasset=!0,this._parent._mainSetInUse=null,n(G)},G=>{t.hasset=!0,this._parent._mainSetInUse=null,u(G)})}this._parent._refineSetBlock(l,this._parent._maxProcessingRate(),this._progress).then(()=>{t.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(e).then(n,u)},G=>{t.hasset=!0,this._parent._mainSetInUse=null,u(G)})}},l=>{t.hasset=!0,this._parent._mainSetInUse=null,u(l)})}),!1===t.hasset&&(this._parent._mainSetInUse=t.returnpromise,t.hasset=!0),t.returnpromise}next(){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then(t=>this.next(),t=>this.next());const e={returnpromise:null,hasset:!1};return e.returnpromise=new Promise((t,a)=>{this._parent._getSet(this._progress).then(n=>{const u=n._known;this._lastId<u.length-1?"GETPAGES"===u[this._lastId+1]?this._parent._expandPagedSet(n,this._parent._maxQueryRate(),0,0,this._progress).then(l=>(e.hasset=!0,this._parent._mainSetInUse=null,this.next())).then(t,a):(this._lastId+=1,this._parent._getFeature(n,u[this._lastId],this._progress).then(l=>{e.hasset=!0,this._parent._mainSetInUse=null,t(l)},l=>{e.hasset=!0,this._parent._mainSetInUse=null,a(l)})):n._candidates.length>0?this._parent._refineSetBlock(n,this._parent._maxProcessingRate(),this._progress).then(()=>{e.hasset=!0,this._parent._mainSetInUse=null,this.next().then(t,a)},l=>{e.hasset=!0,this._parent._mainSetInUse=null,a(l)}):(e.hasset=!0,this._parent._mainSetInUse=null,t(null))},n=>{e.hasset=!0,this._parent._mainSetInUse=null,a(n)})}),!1===e.hasset&&(this._parent._mainSetInUse=e.returnpromise,e.hasset=!0),e.returnpromise}count(){var e=this;return(0,d.Z)(function*(){if(-1!==e._parent._totalCount)return e._parent._totalCount;const t=yield e._parent._getSet(e._progress),a=yield e._refineAllSets(t);return e._parent._totalCount=a._known.length,e._parent._totalCount})()}_refineAllSets(e){var t=this;return(0,d.Z)(function*(){if(e._known.length>0&&"GETPAGES"===e._known[e._known.length-1])return yield t._parent._expandPagedSet(e,t._parent._maxQueryRate(),0,1,t._progress),t._refineAllSets(e);if(e._candidates.length>0){if("GETPAGES"===e._known[e._candidates.length-1])return yield t._parent._expandPagedSet(e,t._parent._maxQueryRate(),0,2,t._progress),t._refineAllSets(e);const a=yield t._parent._refineSetBlock(e,t._parent._maxProcessingRate(),t._progress);return a._candidates.length>0?t._refineAllSets(a):a}return e})()}}var w=F(58446),C=F(76961),b=F(80389),J=F(79412),g=F(85904),c=F(23686),Z=F(43814),T=F(40100);class A{constructor(e){this.recentlyUsedQueries=null,this.featureSetQueryInterceptor=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=C.Bj.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass="esri.arcade.featureset.support.FeatureSet",this._featureCache=[],this.typeIdField=null,this.types=null,this.subtypeField=null,this.subtypes=null,this.fields=null,this.geometryType="",this.objectIdField="",this.globalIdField="",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,this.fsetInfo=null,e?.lrucache&&(this.recentlyUsedQueries=e.lrucache),e?.interceptor&&(this.featureSetQueryInterceptor=e.interceptor)}optimisePagingFeatureQueries(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)}_hasMemorySource(){return!0}prop(e,t){return void 0===t?this[e]:(void 0!==this[e]&&(this[e]=t),this)}end(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent}_ensureLoaded(){return this.load()}load(){return null===this._loadPromise&&(this._loadPromise=this.loadImpl()),this._loadPromise}loadImpl(){var e=this;return(0,d.Z)(function*(){return!0===e._parent?.loaded?(e._initialiseFeatureSet(),e):(yield e._parent?.load(),e._initialiseFeatureSet(),e)})()}_initialiseFeatureSet(){null!==this._parent?(this.fields=this._parent.fields.slice(0),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types,this.subtypeField=this._parent.subtypeField,this.subtypes=this._parent.subtypes):(this.fields=[],this.typeIdField="",this.subtypeField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new Z.Z({wkid:4326}),this.geometryType=C.Qk.point)}getField(e,t){let a;return(t=t||this.fields)&&(e=e.toLowerCase(),t.some(n=>(n&&n.name.toLowerCase()===e&&(a=n),!!a))),a}getFieldsIndex(){return null===this._fieldsIndex&&(this._fieldsIndex=T.Z.fromLayer({timeInfo:this.timeInfo,editFieldsInfo:this.editFieldsInfo,dateFieldsTimeZone:this.dateFieldsTimeZone,datesInUnknownTimezone:this.datesInUnknownTimezone,fields:this.fields})),this._fieldsIndex}_maxProcessingRate(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())}_maxQueryRate(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery}_checkCancelled(e){if(null!=e&&e.aborted)throw new f.EN(f.H9.Cancelled)}nativeCapabilities(){return this._parent.nativeCapabilities()}_canDoAggregates(e,t,a,n,u){var l=this;return(0,d.Z)(function*(){return null!==l._parent&&l._parent._canDoAggregates(e,t,a,n,u)})()}_getAggregatePagesDataSourceDefinition(e,t,a,n,u,l,I){var v=this;return(0,d.Z)(function*(){if(null===v._parent)throw new f.EN(f.H9.NeverReach);return v._parent._getAggregatePagesDataSourceDefinition(e,t,a,n,u,l,I)})()}_getAgregagtePhysicalPage(e,t,a){var n=this;return(0,d.Z)(function*(){if(null===n._parent)throw new f.EN(f.H9.NeverReach);return n._parent._getAgregagtePhysicalPage(e,t,a)})()}databaseType(){var e=this;return(0,d.Z)(function*(){if(e._databaseType===C.Bj.NotEvaluated){if(null!==S.Z.applicationCache){const t=S.Z.applicationCache.getDatabaseType(e._cacheableFeatureSetSourceKey());if(null!==t)return t}if(null!==e._databaseTypeProbed)return e._databaseTypeProbed;try{e._databaseTypeProbed=e._getDatabaseTypeImpl(),null!==S.Z.applicationCache&&S.Z.applicationCache.setDatabaseType(e._cacheableFeatureSetSourceKey(),e._databaseTypeProbed)}catch(t){throw null!==S.Z.applicationCache&&S.Z.applicationCache.clearDatabaseType(e._cacheableFeatureSetSourceKey()),t}return e._databaseTypeProbed}return e._databaseType})()}_getDatabaseTypeImpl(){var e=this;return(0,d.Z)(function*(){const t=[{thetype:C.Bj.SqlServer,testwhere:"(CAST( '2015-01-01' as DATETIME) = CAST( '2015-01-01' as DATETIME)) AND OBJECTID<0"},{thetype:C.Bj.Oracle,testwhere:"(TO_DATE('2003-11-18','YYYY-MM-DD') = TO_DATE('2003-11-18','YYYY-MM-DD')) AND OBJECTID<0"},{thetype:C.Bj.StandardisedNoInterval,testwhere:"(date '2015-01-01 10:10:10' = date '2015-01-01 10:10:10') AND OBJECTID<0"}];for(const a of t)if(!0===(yield e._runDatabaseProbe(a.testwhere)))return a.thetype;return C.Bj.StandardisedNoInterval})()}_cacheableFeatureSetSourceKey(){return"MUSTBESET"}_runDatabaseProbe(e){var t=this;return(0,d.Z)(function*(){if(null!==t._parent)return t._parent._runDatabaseProbe(e);throw new f.EN(f.H9.NotImplemented)})()}isTable(){return this._parent?.isTable()??!1}_featureFromCache(e){if(void 0!==this._featureCache[e])return this._featureCache[e]}_isInFeatureSet(e){return C.dj.Unknown}_getSet(e){throw new f.EN(f.H9.NotImplemented)}_getFeature(e,t,a){var n=this;return(0,d.Z)(function*(){if(n._checkCancelled(a),void 0!==n._featureFromCache(t)||(yield n._getFeatures(e,t,n._maxProcessingRate(),a),n._checkCancelled(a),void 0!==n._featureFromCache(t)))return n._featureFromCache(t);throw new f.EN(f.H9.MissingFeatures)})()}_getFeatureBatch(e,t){var a=this;return(0,d.Z)(function*(){a._checkCancelled(t);const n=new w.Z([],e,!1,null),u=[];yield a._getFeatures(n,-1,e.length,t),a._checkCancelled(t);for(const l of e)void 0!==a._featureFromCache(l)&&u.push(a._featureFromCache(l));return u})()}_getFeatures(e,t,a,n){return(0,d.Z)(function*(){return"success"})()}_getFilteredSet(e,t,a,n,u){throw new f.EN(f.H9.NotImplemented)}_refineSetBlock(e,t,a){var n=this;return(0,d.Z)(function*(){if(!0===n._checkIfNeedToExpandCandidatePage(e,n._maxQueryRate()))return yield n._expandPagedSet(e,n._maxQueryRate(),0,0,a),n._refineSetBlock(e,t,a);n._checkCancelled(a);const u=e._candidates.length;n._refineKnowns(e,t);let l=u-e._candidates.length;if(0===e._candidates.length||l>=t)return e;if(yield n._refineIfParentKnown(e,t-l,a),n._checkCancelled(a),n._refineKnowns(e,t-l),l=u-e._candidates.length,l<t&&e._candidates.length>0){const I=t-l,v=n._prepareFetchAndRefineSet(e._candidates);return yield n._fetchAndRefineFeatures(v,v.length>I?I:e._candidates.length,a),n._checkCancelled(a),n._refineKnowns(e,t-l),e}return e})()}_fetchAndRefineFeatures(e,t,a){return null}_prepareFetchAndRefineSet(e){const t=[];for(let a=0;a<e.length;a++)this._isPhysicalFeature(e[a])&&t.push(e[a]);return t}_isPhysicalFeature(e){return null===this._parent||this._parent._isPhysicalFeature(e)}_refineKnowns(e,t){let a=0,n=null;const u=[];t=this._maxQueryRate();for(let l=0;l<e._candidates.length&&"GETPAGES"!==e._candidates[l];l++){let I=!1;const v=this._candidateIdTransform(e._candidates[l]);v!==e._candidates[l]&&(I=!0);const U=this._isInFeatureSet(v);if(U===C.dj.InFeatureSet)!0===I?e._known.includes(v)||(e._known.push(v),a+=1):(e._known.push(e._candidates[l]),a+=1),null===n?n={start:l,end:l}:n.end===l-1?n.end=l:(u.push(n),n={start:l,end:l});else if(U===C.dj.NotInFeatureSet)null===n?n={start:l,end:l}:n.end===l-1?n.end=l:(u.push(n),n={start:l,end:l}),a+=1;else if(U===C.dj.Unknown&&(a+=1,!0===e._ordered))break;if(a>=t)break}null!==n&&u.push(n);for(let l=u.length-1;l>=0;l--)e._candidates.splice(u[l].start,u[l].end-u[l].start+1)}_refineIfParentKnown(e,t,a){const n=new w.Z([],[],e._ordered,null);return n._candidates=e._candidates.slice(0),this._parent._refineSetBlock(n,t,a)}_candidateIdTransform(e){return this._parent._candidateIdTransform(e)}_checkIfNeedToExpandKnownPage(e,t){if(null===e.pagesDefinition)return!1;let a=0;for(let n=e._lastFetchedIndex;n<e._known.length;n++){if("GETPAGES"===e._known[n])return!0;if(void 0===this._featureCache[e._known[n]]&&(a+=1,a>=t))break}return!1}_checkIfNeedToExpandCandidatePage(e,t){if(null===e.pagesDefinition)return!1;let a=0;for(let n=0;n<e._candidates.length;n++){if("GETPAGES"===e._candidates[n])return!0;if(a+=1,a>=t)break}return!1}_expandPagedSet(e,t,a,n,u){var l=this;return(0,d.Z)(function*(){if(null===l._parent)throw new f.EN(f.H9.NotImplemented);return l._parent._expandPagedSet(e,t,a,n,u)})()}_expandPagedSetFeatureSet(e,t,a,n,u){var l=this;return(0,d.Z)(function*(){if(e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]&&(n=1),0===n&&e._candidates.length>0&&"GETPAGES"===e._candidates[e._candidates.length-1]&&(n=2),0===n)return"finished";const I=yield l._getPage(e,n,u);return a+I<t?l._expandPagedSet(e,t,a+I,0,u):"success"})()}_getPage(e,t,a){var n=this;return(0,d.Z)(function*(){const u=1===t?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){u.length=u.length-1;let l=0;for(let v=0;v<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+v>=e.pagesDefinition.internal.set.length);v++)u[u.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+v],l++;e.pagesDefinition.resultOffset+=l;let I=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(I=!0),!1===I&&u.push("GETPAGES"),l}return yield n._getPhysicalPage(e,t,a),n._getPage(e,t,a)})()}_getPhysicalPage(e,t,a){return null}_clonePageDefinition(e){return null===this._parent?null:this._parent._clonePageDefinition(e)}_first(e){return this.iterator(e).next()}first(e){return this._first(e)}calculateStatistic(e,t,a,n){var u=this;return(0,d.Z)(function*(){yield u._ensureLoaded();let l=yield u._stat(e,t,"",null,null,a,n);return!1===l.calculated&&(l=yield u._manualStat(e,t,a,n)),l.result})()}_manualStat(e,t,a,n){var u=this;return(0,d.Z)(function*(){let l=null;switch(e.toLowerCase()){case"count":return l=yield(0,b.QX)(u,n),{calculated:!0,result:l};case"distinct":return l=yield(0,b.EB)(u,t,a,n),{calculated:!0,result:l};case"avg":case"mean":return l=yield(0,b.J6)(u,t,n),{calculated:!0,result:l};case"stdev":return l=yield(0,b.m)(u,t,n),{calculated:!0,result:l};case"variance":return l=yield(0,b.CA)(u,t,n),{calculated:!0,result:l};case"sum":return l=yield(0,b.Sm)(u,t,n),{calculated:!0,result:l};case"min":return l=yield(0,b.VV)(u,t,n),{calculated:!0,result:l};case"max":return l=yield(0,b.Fp)(u,t,n),{calculated:!0,result:l};default:return{calculated:!0,result:0}}})()}_stat(e,t,a,n,u,l,I){var v=this;return(0,d.Z)(function*(){const U=yield v._parent._stat(e,t,a,n,u,l,I);return!1===U.calculated?null===u&&""===a&&null===n?v._manualStat(e,t,l,I):{calculated:!1}:U})()}_unionAllGeomSelf(e){const t=this.iterator(this._defaultTracker(e)),a=[];return new Promise((n,u)=>{this._unionShapeInBatches(a,t,n,u)})}_unionAllGeom(e){return new Promise((t,a)=>{const n=this.iterator(this._defaultTracker(e));this._unionShapeInBatches([],n,t,a)})}_unionShapeInBatches(e,t,a,n){t.next().then(u=>{try{null!==u&&null!==u.geometry&&e.push(u.geometry),e.length>30||null===u&&e.length>1?(0,c.union)(e).then(l=>{try{null===u?a(l):this._unionShapeInBatches(e=[l],t,a,n)}catch(I){n(I)}},n):null===u?a(1===e.length?e[0]:null):this._unionShapeInBatches(e,t,a,n)}catch(l){n(l)}},n)}iterator(e){return new j(this,e)}intersection(e,t=!1){return A._featuresetFunctions.intersection.bind(this)(e,t)}difference(e,t=!1,a=!0){return A._featuresetFunctions.difference.bind(this)(e,t,a)}symmetricDifference(e,t=!1,a=!0){return A._featuresetFunctions.symmetricDifference.bind(this)(e,t,a)}morphShape(e,t,a="unknown",n=null){return A._featuresetFunctions.morphShape.bind(this)(e,t,a,n)}morphShapeAndAttributes(e,t,a="unknown"){return A._featuresetFunctions.morphShapeAndAttributes.bind(this)(e,t,a)}union(e,t=!1){return A._featuresetFunctions.union.bind(this)(e,t)}intersects(e){return A._featuresetFunctions.intersects.bind(this)(e)}envelopeIntersects(e){return A._featuresetFunctions.envelopeIntersects.bind(this)(e)}contains(e){return A._featuresetFunctions.contains.bind(this)(e)}overlaps(e){return A._featuresetFunctions.overlaps.bind(this)(e)}relate(e,t){return A._featuresetFunctions.relate.bind(this)(e,t)}within(e){return A._featuresetFunctions.within.bind(this)(e)}touches(e){return A._featuresetFunctions.touches.bind(this)(e)}top(e){return A._featuresetFunctions.top.bind(this)(e)}crosses(e){return A._featuresetFunctions.crosses.bind(this)(e)}buffer(e,t,a,n=!0){return A._featuresetFunctions.buffer.bind(this)(e,t,a,n)}filter(e,t=null){return A._featuresetFunctions.filter.bind(this)(e,t)}orderBy(e){return A._featuresetFunctions.orderBy.bind(this)(e)}dissolve(e,t){return A._featuresetFunctions.dissolve.bind(this)(e,t)}groupby(e,t){return A._featuresetFunctions.groupby.bind(this)(e,t)}reduce(e,t=null,a){return new Promise((n,u)=>{this._reduceImpl(this.iterator(this._defaultTracker(a)),e,t,0,n,u,0)})}_reduceImpl(e,t,a,n,u,l,I){try{if(++I>1e3)return void setTimeout(()=>{this._reduceImpl(e,t,a,n,u,l,I=0)});e.next().then(v=>{try{if(null===v)u(a);else{const U=t(a,v,n,this);(0,J.y8)(U)?U.then(G=>{this._reduceImpl(e,t,G,n+1,u,l,I)},l):this._reduceImpl(e,t,U,n+1,u,l,I)}}catch(U){l(U)}},l)}catch(v){l(v)}}removeField(e){return A._featuresetFunctions.removeField.bind(this)(e)}addField(e,t,a=null){return A._featuresetFunctions.addField.bind(this)(e,t,a)}sumArea(e,t=!1,a){const n=(0,C.EI)(e);return this.reduce((u,l)=>null===l.geometry?0:t?(0,c.geodesicArea)(l.geometry,n).then(I=>u+I):(0,c.planarArea)(l.geometry,n).then(I=>u+I),0,a)}sumLength(e,t=!1,a){const n=(0,C.Lz)(e);return this.reduce((u,l)=>null===l.geometry?0:t?(0,c.geodesicLength)(l.geometry,n).then(I=>u+I):(0,c.planarLength)(l.geometry,n).then(I=>u+I),0,a)}distinct(e,t=1e3,a=null,n){var u=this;return(0,d.Z)(function*(){yield u.load();const l=g.WhereClause.create(e,u.getFieldsIndex(),u.dateFieldsTimeZoneDefaultUTC);return P(l,a),u.calculateStatistic("distinct",l,t,u._defaultTracker(n))})()}min(e,t=null,a){var n=this;return(0,d.Z)(function*(){yield n.load();const u=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return P(u,t),n.calculateStatistic("min",u,-1,n._defaultTracker(a))})()}max(e,t=null,a){var n=this;return(0,d.Z)(function*(){yield n.load();const u=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return P(u,t),n.calculateStatistic("max",u,-1,n._defaultTracker(a))})()}avg(e,t=null,a){var n=this;return(0,d.Z)(function*(){yield n.load();const u=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return P(u,t),n.calculateStatistic("avg",u,-1,n._defaultTracker(a))})()}sum(e,t=null,a){var n=this;return(0,d.Z)(function*(){yield n.load();const u=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return P(u,t),n.calculateStatistic("sum",u,-1,n._defaultTracker(a))})()}stdev(e,t=null,a){var n=this;return(0,d.Z)(function*(){yield n.load();const u=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return P(u,t),n.calculateStatistic("stdev",u,-1,n._defaultTracker(a))})()}variance(e,t=null,a){var n=this;return(0,d.Z)(function*(){yield n.load();const u=g.WhereClause.create(e,n.getFieldsIndex(),n.dateFieldsTimeZoneDefaultUTC);return P(u,t),n.calculateStatistic("variance",u,-1,n._defaultTracker(a))})()}count(e){var t=this;return(0,d.Z)(function*(){return yield t.load(),t.calculateStatistic("count",g.WhereClause.create("1",t.getFieldsIndex(),t.dateFieldsTimeZoneDefaultUTC),-1,t._defaultTracker(e))})()}_defaultTracker(e){return e??{aborted:!1}}forEach(e,t){return new Promise((a,n)=>{this._forEachImpl(this.iterator(this._defaultTracker(t)),e,this,a,n,0)})}_forEachImpl(e,t,a,n,u,l){try{if(++l>1e3)return void setTimeout(()=>{this._forEachImpl(e,t,a,n,u,l=0)},0);e.next().then(I=>{try{if(null===I)n(a);else{const v=t(I);null==v?this._forEachImpl(e,t,a,n,u,l):(0,J.y8)(v)?v.then(()=>{try{this._forEachImpl(e,t,a,n,u,l)}catch(U){u(U)}},u):this._forEachImpl(e,t,a,n,u,l)}}catch(v){u(v)}},u)}catch(I){u(I)}}convertToJSON(e){const t={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}};for(let a=0;a<this.fields.length;a++)t.layerDefinition.fields.push((0,C.Sh)(this.fields[a]));return this.reduce((a,n)=>{const u={geometry:n.geometry?.toJSON(),attributes:{}};for(const l in n.attributes)u.attributes[l]=n.attributes[l];return t.featureSet.features.push(u),1},0,e).then(()=>t)}castToText(e=!1){return"object, FeatureSet"}queryAttachments(e,t,a,n,u){return this._parent.queryAttachments(e,t,a,n,u)}serviceUrl(){return this._parent.serviceUrl()}subtypeMetaData(){return this.subtypeField&&this.subtypes?{subtypeField:this.subtypeField,subtypes:this.subtypes?this.subtypes.map(e=>({name:e.name,code:e.code})):[]}:this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map(e=>({name:e.name,code:e.id})):[]}:null}relationshipMetaData(){return this._parent.relationshipMetaData()}get gdbVersion(){return this._parent?this._parent.gdbVersion:""}schema(){const e=[];for(const t of this.fields)e.push((0,C.Sh)(t));return{objectIdField:this.objectIdField,globalIdField:this.globalIdField,geometryType:void 0===C.q2[this.geometryType]?"esriGeometryNull":C.q2[this.geometryType],fields:e}}convertToText(e,t){var a=this;return(0,d.Z)(function*(){if("schema"===e)return yield a._ensureLoaded(),JSON.stringify(a.schema());if("featureset"===e){yield a._ensureLoaded();const n=[];yield a.reduce((l,I)=>{const v={geometry:I.geometry?I.geometry.toJSON():null,attributes:I.attributes};return null!==v.geometry&&v.geometry.spatialReference&&delete v.geometry.spatialReference,n.push(v),1},0,t);const u=a.schema();return u.features=n,u.spatialReference=a.spatialReference.toJSON(),JSON.stringify(u)}return a.castToText()})()}getFeatureByObjectId(e,t){return this._parent.getFeatureByObjectId(e,t)}getOwningSystemUrl(){return this._parent.getOwningSystemUrl()}getIdentityUser(){return this._parent.getIdentityUser()}getRootFeatureSet(){return null!==this._parent?this._parent.getRootFeatureSet():this}getDataSourceFeatureSet(){return null!==this._parent?this._parent.getDataSourceFeatureSet():this}castAsJson(e=null){return"keeptype"===e?.featureset?this:"none"===e?.featureset?null:{type:"FeatureSet"}}castAsJsonAsync(e=null,t=null){var a=this;return(0,d.Z)(function*(){if("keeptype"===t?.featureset)return a;if("schema"===t?.featureset)return yield a._ensureLoaded(),JSON.parse(JSON.stringify(a.schema()));if("none"===t?.featureset)return null;yield a._ensureLoaded();const n=[];yield a.reduce((l,I)=>{const v={geometry:I.geometry?!0===t?.keepGeometryType?I.geometry:I.geometry.toJSON():null,attributes:I.attributes};return null!==v.geometry&&v.geometry.spatialReference&&!0!==t?.keepGeometryType&&delete v.geometry.spatialReference,n.push(v),1},0,e);const u=a.schema();return u.features=n,u.spatialReference=!0===t?.keepGeometryType?a.spatialReference:a.spatialReference?.toJSON(),u})()}fieldTimeZone(e){return this.getFieldsIndex().getTimeZone(e)}get preferredTimeZone(){return this._parent?.preferredTimeZone??null}get dateFieldsTimeZone(){return this._parent?.dateFieldsTimeZone??null}get dateFieldsTimeZoneDefaultUTC(){if(this.datesInUnknownTimezone)return"unknown";const e=this.dateFieldsTimeZone??"UTC";return""===e?"UTC":e}get datesInUnknownTimezone(){return this._parent.datesInUnknownTimezone}get editFieldsInfo(){return this._parent?.editFieldsInfo??null}get timeInfo(){return this._parent?.timeInfo??null}set featureSetInfo(e){this.fsetInfo=e}getFeatureSetInfo(){var e=this;return(0,d.Z)(function*(){return e.fsetInfo??(yield e._parent?.getFeatureSetInfo())??null})()}}function P(N,e){if(null!==e){const t={};for(const a in e)t[a.toLowerCase()]=e[a];N.parameters=t}}A._featuresetFunctions={}},58446:(V,H,F)=>{F.d(H,{Z:()=>d});class d{constructor(f,R,j,w){this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=f,this._known=R,this._ordered=j,this.pagesDefinition=w}}},19104:(V,H,F)=>{F.d(H,{Z:()=>d});let d=(()=>{class S{constructor(){this._databaseTypeMetaData={},this._layerInfo={}}clearDatabaseType(R){void 0===this._databaseTypeMetaData[R]&&delete this._databaseTypeMetaData[R]}getDatabaseType(R){return"MUSTBESET"===R||void 0===this._databaseTypeMetaData[R]?null:this._databaseTypeMetaData[R]}setDatabaseType(R,j){this._databaseTypeMetaData[R]=j}getLayerInfo(R){return void 0===this._layerInfo[R]?null:this._layerInfo[R]}setLayerInfo(R,j){this._layerInfo[R]=j}clearLayerInfo(R){void 0!==this._layerInfo[R]&&delete this._layerInfo[R]}}return S.applicationCache=null,S})()},77023:(V,H,F)=>{F.d(H,{$e:()=>g,DT:()=>t,TE:()=>G,XF:()=>b,av:()=>A,bB:()=>J,fz:()=>Z,hq:()=>l,mA:()=>T,vR:()=>e,vn:()=>N,wF:()=>P,y5:()=>I,zR:()=>C});var d=F(93630),S=F(70930),f=F(76961),R=F(81429),j=F(85904),w=F(25037);function C(i,r){return c(i?.parseTree,r,i?.parameters)}function b(i,r,_){return c(i,r,_)}function J(i,r,_,o){return j.WhereClause.create(c(i.parseTree,f.Bj.Standardised,i.parameters,r,_),o,i.timeZone)}function g(i,r,_="AND"){return j.WhereClause.create("(("+C(i,f.Bj.Standardised)+")"+_+"("+C(r,f.Bj.Standardised)+"))",i.fieldsIndex,i.timeZone)}function c(i,r,_,o=null,y=null){let M,O,m,E;switch(i.type){case"interval":return G(c(i.value,r,_,o,y),i.qualifier,i.op);case"case-expression":{let p=" CASE ";"simple"===i.format&&(p+=c(i.operand,r,_,o,y));for(let x=0;x<i.clauses.length;x++)p+=" WHEN "+c(i.clauses[x].operand,r,_,o,y)+" THEN "+c(i.clauses[x].value,r,_,o,y);return null!==i.else&&(p+=" ELSE "+c(i.else,r,_,o,y)),p+=" END ",p}case"parameter":{const p=_[i.value.toLowerCase()];if("string"==typeof p)return"'"+_[i.value.toLowerCase()].toString().replaceAll("'","''")+"'";if((0,f.J_)(p)||(0,f.T4)(p))return N(p,r);if((0,f._U)(p))return P(p,r);if((0,f.NP)(p))return T(p,r);if((0,f.$A)(p))return A(p,r);if(Array.isArray(p)){const x=[];for(let L=0;L<p.length;L++)"string"==typeof p[L]?x.push("'"+p[L].toString().replaceAll("'","''")+"'"):(0,f.J_)(p[L])||(0,f.T4)(p[L])?x.push(N(p[L],r)):(0,f._U)(p[L])?x.push(P(p[L],r)):(0,f.NP)(p[L])?x.push(T(p[L],r)):(0,f.$A)(p[L])?x.push(A(p[L],r)):x.push(p[L].toString());return x}return p.toString()}case"expression-list":O=[];for(const p of i.value)O.push(c(p,r,_,o,y));return O;case"unary-expression":return" ( NOT "+c(i.expr,r,_,o,y)+" ) ";case"binary-expression":switch(i.operator){case"AND":return" ("+c(i.left,r,_,o,y)+" AND "+c(i.right,r,_,o,y)+") ";case"OR":return" ("+c(i.left,r,_,o,y)+" OR "+c(i.right,r,_,o,y)+") ";case"IS":if("null"!==i.right.type)throw new S.eS(S.f.UnsupportedIsRhs);return" ("+c(i.left,r,_,o,y)+" IS NULL )";case"ISNOT":if("null"!==i.right.type)throw new S.eS(S.f.UnsupportedIsRhs);return" ("+c(i.left,r,_,o,y)+" IS NOT NULL )";case"IN":return M=[],"expression-list"===i.right.type?(M=c(i.right,r,_,o,y)," ("+c(i.left,r,_,o,y)+" IN ("+M.join(",")+")) "):(E=c(i.right,r,_,o,y),Array.isArray(E)?" ("+c(i.left,r,_,o,y)+" IN ("+E.join(",")+")) ":" ("+c(i.left,r,_,o,y)+" IN ("+E+")) ");case"NOT IN":return M=[],"expression-list"===i.right.type?(M=c(i.right,r,_,o,y)," ("+c(i.left,r,_,o,y)+" NOT IN ("+M.join(",")+")) "):(E=c(i.right,r,_,o,y),Array.isArray(E)?" ("+c(i.left,r,_,o,y)+" NOT IN ("+E.join(",")+")) ":" ("+c(i.left,r,_,o,y)+" NOT IN ("+E+")) ");case"BETWEEN":return m=c(i.right,r,_,o,y)," ("+c(i.left,r,_,o,y)+" BETWEEN "+m[0]+" AND "+m[1]+" ) ";case"NOTBETWEEN":return m=c(i.right,r,_,o,y)," ("+c(i.left,r,_,o,y)+" NOT BETWEEN "+m[0]+" AND "+m[1]+" ) ";case"LIKE":return""!==i.escape?" ("+c(i.left,r,_,o,y)+" LIKE "+c(i.right,r,_,o,y)+" ESCAPE '"+i.escape+"') ":" ("+c(i.left,r,_,o,y)+" LIKE "+c(i.right,r,_,o,y)+") ";case"NOT LIKE":return""!==i.escape?" ("+c(i.left,r,_,o,y)+" NOT LIKE "+c(i.right,r,_,o,y)+" ESCAPE '"+i.escape+"') ":" ("+c(i.left,r,_,o,y)+" NOT LIKE "+c(i.right,r,_,o,y)+") ";case"<>":case"<":case">":case">=":case"<=":case"=":case"*":case"-":case"+":case"/":return" ("+c(i.left,r,_,o,y)+" "+i.operator+" "+c(i.right,r,_,o,y)+") ";case"||":return" ("+c(i.left,r,_,o,y)+" "+(r===f.Bj.SqlServer?"+":i.operator)+" "+c(i.right,r,_,o,y)+") "}throw new S.eS(S.f.UnsupportedOperator,{operator:i.operator});case"null":return"null";case"boolean":return!0===i.value?"1":"0";case"string":return"'"+i.value.toString().replaceAll("'","''")+"'";case"timestamp":return`timestamp '${i.value}'`;case"date":return`date '${i.value}'`;case"time":return`time '${i.value}'`;case"number":return i.value.toString();case"current-time":return e("date"===i.mode,r);case"column-reference":return o?o.toLowerCase()===i.column.toLowerCase()?"("+y+")":!0===i.delimited?`"${i.column.split('"').join('""')}"`:i.column:i.column;case"data-type":return i.value;case"function":{const p=c(i.args,r,_,o,y);return Z(i.name,p,r)}}throw new S.eS(S.f.UnsupportedSyntax,{node:i.type})}function Z(i,r,_){switch(i.toLowerCase().trim()){case"cos":case"sin":case"tan":case"cosh":case"tanh":case"sinh":case"acos":case"asin":case"atan":case"floor":case"log10":case"log":case"abs":if(1!==r.length)throw new S.eS(S.f.InvalidFunctionParameters,{function:i.toLowerCase().trim()});return`${i.toUpperCase().trim()}(${r[0]})`;case"ceiling":case"ceil":if(1!==r.length)throw new S.eS(S.f.InvalidFunctionParameters,{function:"ceiling"});return"CEILING("+r[0]+")";case"mod":case"power":case"nullif":if(2!==r.length)throw new S.eS(S.f.InvalidFunctionParameters,{function:i.toLowerCase().trim()});return`${i.toUpperCase().trim()}(${r[0]},${r[1]})`;case"round":if(2===r.length)return"ROUND("+r[0]+","+r[1]+")";if(1===r.length)return"ROUND("+r[0]+")";throw new S.eS(S.f.InvalidFunctionParameters,{function:"round"});case"truncate":if(r.length<1||r.length>2)throw new S.eS(S.f.InvalidFunctionParameters,{function:"truncate"});return _===f.Bj.SqlServer?"ROUND("+r[0]+(1===r.length?"0":","+r[1])+",1)":"TRUNCATE("+r[0]+(1===r.length?")":","+r[1]+")");case"char_length":case"len":if(1!==r.length)throw new S.eS(S.f.InvalidFunctionParameters,{function:"char_length"});switch(_){case f.Bj.SqlServer:return"LEN("+r[0]+")";case f.Bj.Oracle:return"LENGTH("+r[0]+")";default:return"CHAR_LENGTH("+r[0]+")"}case"coalesce":case"concat":{if(r.length<1)throw new S.eS(S.f.InvalidFunctionParameters,{function:i.toLowerCase()});let o=i.toUpperCase().trim()+"(";for(let y=0;y<r.length;y++)0!==y&&(o+=","),o+=r[y];return o+=")",o}case"lower":case"lcase":if(1!==r.length)throw new S.eS(S.f.InvalidFunctionParameters,{function:"lower"});return"LOWER("+r[0]+")";case"upper":case"ucase":if(1!==r.length)throw new S.eS(S.f.InvalidFunctionParameters,{function:"upper"});return"UPPER("+r[0]+")";case"substring":{let o="";switch(_){case f.Bj.Oracle:return o="SUBSTR("+r[0]+","+r[1],3===r.length&&(o+=","+r[2]),o+=")",o;case f.Bj.SqlServer:return o=3===r.length?"SUBSTRING("+r[0]+","+r[1]+","+r[2]+")":"SUBSTRING("+r[0]+",  "+r[1]+", LEN("+r[0]+") - "+r[1]+")",o;default:return o="SUBSTRING("+r[0]+" FROM "+r[1],3===r.length&&(o+=" FOR "+r[2]),o+=")",o}}case"extract":return"EXTRACT("+r[0].replaceAll("'","")+" FROM "+r[1]+")";case"cast":{let o="";switch(_){case f.Bj.Oracle:switch(r[1].type){case"date":o="DATE";break;case"float":o="DOUBLE";break;case"integer":o="INTEGER";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="TIMESTAMP";break;case"varchar":o="VARCHAR("+r[1].size.toString()+")"}return`CAST(${r[0]} AS ${o})`;case f.Bj.Postgres:switch(r[1].type){case"date":o="DATE";break;case"float":o="DOUBLE PRECISION";break;case"integer":o="INT";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="TIMESTAMP";break;case"varchar":o="VARCHAR("+r[1].size.toString()+")"}return`CAST(${r[0]} AS ${o})`;case f.Bj.SqlServer:switch(r[1].type){case"date":o="DATE";break;case"float":o="FLOAT";break;case"integer":o="INT";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="DATETIME";break;case"varchar":o="VARCHAR("+r[1].size.toString()+")"}return`CAST(${r[0]} AS ${o})`;default:switch(r[1].type){case"date":o="DATE";break;case"float":o="FLOAT";break;case"integer":o="INTEGER";break;case"real":o="REAL";break;case"smallint":o="SMALLINT";break;case"timestamp":o="TIMESTAMP";break;case"varchar":o="VARCHAR("+r[1].size.toString()+")"}return`CAST(${r[0]} AS ${o})`}}}throw new S.eS(S.f.InvalidFunctionParameters,{function:i})}function T(i,r){const _=i.toDateTime(),o=0===_.hour&&0===_.minute&&0===_.second&&0===_.millisecond;switch(r){case f.Bj.FILEGDB:case f.Bj.Standardised:case f.Bj.StandardisedNoInterval:return o?`date '${_.toFormat("yyyy-LL-dd")}'`:`timestamp '${_.toFormat("yyyy-LL-dd HH:mm:ss")}'`;case f.Bj.Oracle:return o?`TO_DATE('${_.toFormat("yyyy-LL-dd")}','YYYY-MM-DD')`:`TO_DATE('${_.toFormat("yyyy-LL-dd HH:mm:ss")}','YYYY-MM-DD HH24:MI:SS')`;case f.Bj.SqlServer:return`'${_.toFormat(o?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;case f.Bj.PGDB:return`#${_.toFormat(o?"LL-dd-yyyy":"LL-dd-yyyy HH:mm:ss")}#`;case f.Bj.Postgres:return`TIMESTAMP '${_.toFormat(o?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;default:return`timestamp '${_.toFormat("yyyy-LL-dd HH:mm:ss")}'`}}function A(i,r){switch(r){case f.Bj.FILEGDB:case f.Bj.Standardised:case f.Bj.StandardisedNoInterval:return i.toSQLWithKeyword();case f.Bj.Oracle:return`TO_DATE('${i.toFormat("Y-MM-DD")}'`;case f.Bj.SqlServer:return`'${i.toFormat("Y-MM-DD")}'`;case f.Bj.PGDB:return`#${i.toFormat("Y-MM-DD")}#`;case f.Bj.Postgres:return`TIMESTAMP '${i.toFormat("Y-MM-DD")}'`;default:return i.toSQLWithKeyword()}}function P(i,r){switch(i instanceof R.n&&(i=i.toStorageString()),r){case f.Bj.Oracle:return`TO_DATE('${i}', 'HH24:MI:SS')`;case f.Bj.SqlServer:return`'${i}'`;default:return`time '${i}'`}}function N(i,r){return T(d.iG.dateTimeToArcadeDate((0,f.T4)(i)?i:w.ou.fromJSDate(i)),r)}function e(i,r){switch(r){case f.Bj.FILEGDB:case f.Bj.Standardised:case f.Bj.StandardisedNoInterval:case f.Bj.Oracle:return i?"CURRENT_DATE":"CURRENT_TIMESTAMP";case f.Bj.SqlServer:return i?"CAST(GETDATE() AS DATE)":"GETDATE()";default:return i?"CURRENT_DATE":"CURRENT_TIMESTAMP"}}function t(i,r,_={}){const o={},y={},M={esriFieldTypeSmallInteger:"integer",esriFieldTypeInteger:"integer",esriFieldTypeBigInteger:"integer",esriFieldTypeSingle:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeTimeOnly:"time-only",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimestampOffset:"timestamp-offset",esriFieldTypeDate:"date",esriFieldTypeOID:"integer",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"guid",oid:"integer",long:"integer","small-integer":"integer",integer:"integer","big-integer":"integer",single:"double","time-only":"time-only","date-only":"date-only","timestamp-offset":"timestemp-offset",double:"double",date:"date",guid:"guid","global-id":"guid",string:"string"};for(const O of r){const m=O.type?M[O.type]:void 0;o[O.name.toLowerCase()]=void 0===m?"":m}for(const O in _){const m=M[_[O]];y[O.toLowerCase()]=void 0===m?"":m}switch(a(o,i.parseTree,i.parameters,y)){case"double":return"double";case"integer":return"integer";case"date":return"date";case"date-only":return"date-only";case"time-only":return"time-only";case"timestamp-offset":return"timestamp-offset";case"string":return"string";case"global-id":case"guid":return"guid"}return""}function a(i,r,_,o){let y;switch(r.type){case"interval":return"integer";case"case-expression":{const M=[];if("simple"===r.format){for(let O=0;O<r.clauses.length;O++)M.push(a(i,r.clauses[O].value,_,o));null!==r.else&&M.push(a(i,r.else,_,o))}else{for(let O=0;O<r.clauses.length;O++)M.push(a(i,r.else,_,o));null!==r.else&&M.push(a(i,r.else,_,o))}return u(M)}case"parameter":{const M=o[r.value.toLowerCase()];if(void 0===M&&_){const O=_[r.value.toLowerCase()];if(null==O)return"";if("string"==typeof O||O instanceof String)return"string";if("boolean"==typeof O)return"boolean";if((0,f.J_)(O)||(0,f.NP)(O))return"date";if((0,f.$A)(O))return"date-only";if((0,f._U)(O))return"time-only";if("number"==typeof O)return O%1==0?"integer":"double"}return void 0===M?"":M}case"expression-list":{const M=[];for(const O of r.value)M.push(a(i,O,_,o));return M}case"unary-expression":return"boolean";case"binary-expression":switch(r.operator){case"AND":case"OR":case"IN":case"NOT IN":case"BETWEEN":case"NOTBETWEEN":case"LIKE":case"NOT LIKE":case"<>":case"<":case">":case">=":case"<=":case"=":return"boolean";case"IS":case"ISNOT":if("null"!==r.right.type)throw new S.eS(S.f.UnsupportedIsRhs);return"boolean";case"*":case"-":case"+":case"/":return u([a(i,r.left,_,o),a(i,r.right,_,o)]);case"||":return"string";default:throw new S.eS(S.f.UnsupportedOperator,{operator:r.operator})}case"null":return"";case"boolean":return"boolean";case"string":return"string";case"number":return null===r.value?"":r.value%1==0?"integer":"double";case"date":return"date";case"timestamp":return r.withtimezone?"timestamp-offset":"date";case"time":return"time-only";case"current-time":return"date";case"column-reference":{const M=i[r.column.toLowerCase()];return void 0===M?"":M}case"function":switch(r.name.toLowerCase()){case"cast":switch(r.args?.value[1]?.value.type??""){case"integer":case"smallint":return"integer";case"real":case"float":return"double";case"date":case"timestamp":return!0===r.args?.value[1]?.value?.withtimezone?"timestamp-offset":"date";case"time":return"time-only";case"varchar":return"string";default:return""}case"position":case"extract":case"char_length":case"mod":return"integer";case"round":if(y=a(i,r.args,_,o),Array.isArray(y)){if(y.length<=0)return"double";y=y[0]}return y;case"sign":return"integer";case"ceiling":case"floor":case"abs":return y=a(i,r.args,_,o),Array.isArray(y)&&(y=u(y)),"integer"===y||"double"===y?y:"double";case"area":case"length":case"log":case"log10":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"cosh":case"sinh":case"tanh":case"power":return"double";case"substring":case"trim":case"concat":case"lower":case"upper":return"string";case"truncate":return"double";case"nullif":case"coalesce":return y=a(i,r.args,_,o),Array.isArray(y)?y.length>0?y[0]:"":y}return""}throw new S.eS(S.f.UnsupportedSyntax,{node:r.type})}const n={boolean:1,string:2,integer:3,double:4,date:5};function u(i){if(i){let r="";for(const _ of i)""!==_&&(r=""===r||n[r]<n[_]?_:r);return r}return""}function l(i,r){return v(i.parseTree,r)}function I(i){return"column-reference"===i?.parseTree.type}function v(i,r){if(null==i)return!1;switch(i.type){case"when-clause":return v(i.operand,r)||v(i.value,r);case"case-expression":for(const _ of i.clauses)if(v(_,r))return!0;return!("simple"!==i.format||!v(i.operand,r))||!(null===i.else||!v(i.else,r));case"parameter":case"null":case"boolean":case"date":case"timestamp":case"time":case"string":case"number":return!1;case"expression-list":for(const _ of i.value)if(v(_,r))return!0;return!1;case"unary-expression":return v(i.expr,r);case"binary-expression":return v(i.left,r)||v(i.right,r);case"column-reference":return r.toLowerCase()===i.column.toLowerCase();case"function":return v(i.args,r)}return!1}function U(i){let r="";return r+=i.period.toUpperCase(),r}function G(i,r,_){let o="";return o="interval-period"===r.type?U(r):U(r.start)+" TO "+U(r.end),"INTERVAL "+_+" "+i+" "+o}},80389:(V,H,F)=>{F.d(H,{CA:()=>l,EB:()=>M,Fp:()=>t,J6:()=>n,QX:()=>r,Sm:()=>G,VV:()=>N,g3:()=>A,m:()=>v,tj:()=>P});var d=F(15861),S=F(70930),f=F(76961),R=F(77023),j=F(88781),w=F(80458),C=F(81429);function J(m){let E=0;for(let p=0;p<m.length;p++)E+=m[p];return E/m.length}function g(m){const E=J(m);let p=0;for(let x=0;x<m.length;x++)p+=(E-m[x])**2;return p/m.length}function c(m){const E=J(m);let p=0;for(let x=0;x<m.length;x++)p+=(E-m[x])**2;return p/(m.length-1)}function Z(m){let E=0;for(let p=0;p<m.length;p++)E+=m[p];return E}function A(m){switch(m.toLowerCase()){case"distinct":return"distinct";case"avg":case"mean":return"avg";case"min":return"min";case"sum":return"sum";case"max":return"max";case"stdev":case"stddev":return"stddev";case"var":case"variance":return"var";case"count":return"count"}return""}function P(m,E,p=1e3){switch(m.toLowerCase()){case"distinct":return function T(m,E){const p=[],x={},L=[];for(let k=0;k<m.length;k++){if(null!=m[k]){const K=m[k];if((0,f.hj)(K)||(0,f.HD)(K))void 0===x[K]&&(p.push(K),x[K]=1);else{let Y=!1;for(let W=0;W<L.length;W++)!0===(0,f.tt)(L[W],K)&&(Y=!0);!1===Y&&(L.push(K),p.push(K))}}if(p.length>=E&&-1!==E)return p}return p}(E,p);case"avg":case"mean":return J(E);case"min":return Math.min.apply(Math,E);case"sum":return Z(E);case"max":return Math.max.apply(Math,E);case"stdev":case"stddev":return Math.sqrt(g(E));case"var":case"variance":return g(E);case"count":return E.length}return 0}function N(m,E,p){return e.apply(this,arguments)}function e(){return(e=(0,d.Z)(function*(m,E,p){const x=yield o(m,E,p,!0);return 0===x.length?null:Math.min.apply(Math,x)})).apply(this,arguments)}function t(m,E,p){return a.apply(this,arguments)}function a(){return(a=(0,d.Z)(function*(m,E,p){const x=yield o(m,E,p,!0);return 0===x.length?null:Math.max.apply(Math,x)})).apply(this,arguments)}function n(m,E,p){return u.apply(this,arguments)}function u(){return(u=(0,d.Z)(function*(m,E,p){let x="";E&&!(0,R.y5)(E)&&(x=(0,R.DT)(E,m.fields));const L=yield o(m,E,p,!0);if(0===L.length)return null;const k=J(L);return null===k?k:"integer"===x?function b(m){return m=+m,isFinite(m)?m-m%1||(m<0?-0:0===m?m:0):m}(k):k})).apply(this,arguments)}function l(m,E,p){return I.apply(this,arguments)}function I(){return(I=(0,d.Z)(function*(m,E,p){const x=yield o(m,E,p,!0);return 0===x.length?null:c(x)})).apply(this,arguments)}function v(m,E,p){return U.apply(this,arguments)}function U(){return(U=(0,d.Z)(function*(m,E,p){const x=yield o(m,E,p,!0);return 0===x.length?null:Math.sqrt(c(x))})).apply(this,arguments)}function G(m,E,p){return i.apply(this,arguments)}function i(){return(i=(0,d.Z)(function*(m,E,p){const x=yield o(m,E,p,!0);return 0===x.length?null:Z(x)})).apply(this,arguments)}function r(m,E){return _.apply(this,arguments)}function _(){return(_=(0,d.Z)(function*(m,E){return m.iterator(E).count()})).apply(this,arguments)}function o(m,E,p){return y.apply(this,arguments)}function y(){return(y=(0,d.Z)(function*(m,E,p,x=!1){const L=m.iterator(p),k=[],K={ticker:0};let Y=yield L.next();for(;null!==Y;){if(K.ticker++,p.aborted)throw new S.EN(S.H9.Cancelled);K.ticker%100==0&&(K.ticker=0,yield new Promise($=>{setTimeout($,0)}));const W=E?.calculateValue(Y);null===W?!1===x&&(k[k.length]=W):k[k.length]=W instanceof j.u||W instanceof C.n?W.toNumber():W instanceof w.H?W.toMilliseconds():W,Y=yield L.next()}return k})).apply(this,arguments)}function M(m,E){return O.apply(this,arguments)}function O(){return(O=(0,d.Z)(function*(m,E,p=1e3,x=null){const L=m.iterator(x),k=[],K={},Y={ticker:0};let W=yield L.next();for(;null!==W;){if(Y.ticker++,x?.aborted)throw new S.EN(S.H9.Cancelled);Y.ticker%100==0&&(Y.ticker=0,yield new Promise(ee=>{setTimeout(ee,0)}));const $=E?.calculateValue(W);let z=$;if($ instanceof j.u?z="!!DATEONLY!!-"+$.toString():$ instanceof w.H?z="!!TSOFFSETONLY!!-"+$.toString():$ instanceof C.n?z="!!TIMEONLY!!-"+$.toString():$ instanceof Date&&(z="!!DATE!!-"+$.toString()),null!=$&&void 0===K[z]&&(k.push($),K[z]=1),k.length>=p&&-1!==p)return k;W=yield L.next()}return k})).apply(this,arguments)}},23686:(V,H,F)=>{F.r(H),F.d(H,{buffer:()=>me,changeDefaultSpatialReferenceTolerance:()=>Oe,clearDefaultSpatialReferenceTolerance:()=>Ze,clip:()=>t,contains:()=>l,convexHull:()=>E,crosses:()=>I,cut:()=>n,densify:()=>we,difference:()=>x,disjoint:()=>_,distance:()=>v,equals:()=>U,extendedSpatialReferenceInfo:()=>e,flipHorizontal:()=>ve,flipVertical:()=>Fe,generalize:()=>De,geodesicArea:()=>Pe,geodesicBuffer:()=>ye,geodesicDensify:()=>Ae,geodesicLength:()=>Re,intersect:()=>Y,intersectLinesToPoints:()=>Ce,intersects:()=>G,isSimple:()=>M,nearestCoordinate:()=>Se,nearestVertex:()=>Te,nearestVertices:()=>Ie,offset:()=>ee,overlaps:()=>o,planarArea:()=>xe,planarLength:()=>be,relate:()=>y,rotate:()=>Ee,simplify:()=>O,symmetricDifference:()=>k,touches:()=>i,union:()=>$,within:()=>r});var d=F(15861),f=(F(2189),F(36885)),R=F(44107),j=F(40637);function w(s){return Array.isArray(s)?s[0]?.spatialReference:s?.spatialReference}function C(s){return s&&(Array.isArray(s)?s.map(C):s.toJSON?s.toJSON():s)}function b(s){return Array.isArray(s)?s.map(h=>(0,j.im)(h)):(0,j.im)(s)}let g;function c(){return Z.apply(this,arguments)}function Z(){return(Z=(0,d.Z)(function*(){return g||(g=(0,f.bA)("geometryEngineWorker",{strategy:"distributed"})),g})).apply(this,arguments)}function T(s,h){return A.apply(this,arguments)}function A(){return(A=(0,d.Z)(function*(s,h){return(yield c()).invoke("executeGEOperation",{operation:s,parameters:C(h)})})).apply(this,arguments)}function P(s,h){return N.apply(this,arguments)}function N(){return(N=(0,d.Z)(function*(s,h){const D=yield c();return Promise.all(D.broadcast("executeGEOperation",{operation:s,parameters:C(h)}))})).apply(this,arguments)}function e(s){return T("extendedSpatialReferenceInfo",[s])}function t(s,h){return a.apply(this,arguments)}function a(){return(a=(0,d.Z)(function*(s,h){return b(yield T("clip",[w(s),s,h]))})).apply(this,arguments)}function n(s,h){return u.apply(this,arguments)}function u(){return(u=(0,d.Z)(function*(s,h){return b(yield T("cut",[w(s),s,h]))})).apply(this,arguments)}function l(s,h){return T("contains",[w(s),s,h])}function I(s,h){return T("crosses",[w(s),s,h])}function v(s,h,D){return T("distance",[w(s),s,h,D])}function U(s,h){return T("equals",[w(s),s,h])}function G(s,h){return T("intersects",[w(s),s,h])}function i(s,h){return T("touches",[w(s),s,h])}function r(s,h){return T("within",[w(s),s,h])}function _(s,h){return T("disjoint",[w(s),s,h])}function o(s,h){return T("overlaps",[w(s),s,h])}function y(s,h,D){return T("relate",[w(s),s,h,D])}function M(s){return T("isSimple",[w(s),s])}function O(s){return m.apply(this,arguments)}function m(){return(m=(0,d.Z)(function*(s){return b(yield T("simplify",[w(s),s]))})).apply(this,arguments)}function E(s){return p.apply(this,arguments)}function p(){return(p=(0,d.Z)(function*(s,h=!1){return b(yield T("convexHull",[w(s),s,h]))})).apply(this,arguments)}function x(s,h){return L.apply(this,arguments)}function L(){return(L=(0,d.Z)(function*(s,h){return b(yield T("difference",[w(s),s,h]))})).apply(this,arguments)}function k(s,h){return K.apply(this,arguments)}function K(){return(K=(0,d.Z)(function*(s,h){return b(yield T("symmetricDifference",[w(s),s,h]))})).apply(this,arguments)}function Y(s,h){return W.apply(this,arguments)}function W(){return(W=(0,d.Z)(function*(s,h){return b(yield T("intersect",[w(s),s,h]))})).apply(this,arguments)}function $(s){return z.apply(this,arguments)}function z(){return(z=(0,d.Z)(function*(s,h=null){const D=function J(s,h){let D;return Array.isArray(s)?D=s:(D=[],D.push(s),null!=h&&D.push(h)),D}(s,h);return b(yield T("union",[w(D),D]))})).apply(this,arguments)}function ee(s,h,D,B,Q,q){return te.apply(this,arguments)}function te(){return(te=(0,d.Z)(function*(s,h,D,B,Q,q){return b(yield T("offset",[w(s),s,h,D,B,Q,q]))})).apply(this,arguments)}function me(s,h,D){return ne.apply(this,arguments)}function ne(){return(ne=(0,d.Z)(function*(s,h,D,B=!1){const Q=[w(s),s,h,D,B];return b(yield T("buffer",Q))})).apply(this,arguments)}function ye(s,h,D,B,Q,q){return re.apply(this,arguments)}function re(){return(re=(0,d.Z)(function*(s,h,D,B,Q,q){const Le=[w(s),s,h,D,B,Q,q];return b(yield T("geodesicBuffer",Le))})).apply(this,arguments)}function Se(s,h){return ae.apply(this,arguments)}function ae(){return(ae=(0,d.Z)(function*(s,h,D=!0){const B=yield T("nearestCoordinate",[w(s),s,h,D]);return{...B,coordinate:R.Z.fromJSON(B.coordinate)}})).apply(this,arguments)}function Te(s,h){return se.apply(this,arguments)}function se(){return(se=(0,d.Z)(function*(s,h){const D=yield T("nearestVertex",[w(s),s,h]);return{...D,coordinate:R.Z.fromJSON(D.coordinate)}})).apply(this,arguments)}function Ie(s,h,D,B){return ie.apply(this,arguments)}function ie(){return(ie=(0,d.Z)(function*(s,h,D,B){return(yield T("nearestVertices",[w(s),s,h,D,B])).map(Q=>({...Q,coordinate:R.Z.fromJSON(Q.coordinate)}))})).apply(this,arguments)}function ue(s){return"xmin"in s?s.center:"x"in s?s:s.extent?.center}function Ee(s,h,D){return le.apply(this,arguments)}function le(){return(le=(0,d.Z)(function*(s,h,D){if(null==s)throw new X;const B=s.spatialReference;if(null==(D=D??ue(s)))throw new X;const Q=s.constructor.fromJSON(yield T("rotate",[B,s,h,D]));return Q.spatialReference=B,Q})).apply(this,arguments)}function ve(s,h){return oe.apply(this,arguments)}function oe(){return(oe=(0,d.Z)(function*(s,h){if(null==s)throw new X;const D=s.spatialReference;if(null==(h=h??ue(s)))throw new X;const B=s.constructor.fromJSON(yield T("flipHorizontal",[D,s,h]));return B.spatialReference=D,B})).apply(this,arguments)}function Fe(s,h){return ce.apply(this,arguments)}function ce(){return(ce=(0,d.Z)(function*(s,h){if(null==s)throw new X;const D=s.spatialReference;if(null==(h=h??ue(s)))throw new X;const B=s.constructor.fromJSON(yield T("flipVertical",[D,s,h]));return B.spatialReference=D,B})).apply(this,arguments)}function De(s,h,D,B){return he.apply(this,arguments)}function he(){return(he=(0,d.Z)(function*(s,h,D,B){return b(yield T("generalize",[w(s),s,h,D,B]))})).apply(this,arguments)}function we(s,h,D){return _e.apply(this,arguments)}function _e(){return(_e=(0,d.Z)(function*(s,h,D){return b(yield T("densify",[w(s),s,h,D]))})).apply(this,arguments)}function Ae(s,h,D){return de.apply(this,arguments)}function de(){return(de=(0,d.Z)(function*(s,h,D,B=0){return b(yield T("geodesicDensify",[w(s),s,h,D,B]))})).apply(this,arguments)}function xe(s,h){return T("planarArea",[w(s),s,h])}function be(s,h){return T("planarLength",[w(s),s,h])}function Pe(s,h,D){return T("geodesicArea",[w(s),s,h,D])}function Re(s,h,D){return T("geodesicLength",[w(s),s,h,D])}function Ce(s,h){return fe.apply(this,arguments)}function fe(){return(fe=(0,d.Z)(function*(s,h){return b(yield T("intersectLinesToPoints",[w(s),s,h]))})).apply(this,arguments)}function Oe(s,h){return pe.apply(this,arguments)}function pe(){return(pe=(0,d.Z)(function*(s,h){yield P("changeDefaultSpatialReferenceTolerance",[s,h])})).apply(this,arguments)}function Ze(s){return ge.apply(this,arguments)}function ge(){return(ge=(0,d.Z)(function*(s){yield P("clearDefaultSpatialReferenceTolerance",[s])})).apply(this,arguments)}class X extends Error{constructor(){super("Illegal Argument Exception")}}}}]);