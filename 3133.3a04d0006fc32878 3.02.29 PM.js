"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[3133],{70794:(Y,G,s)=>{s.d(G,{EX:()=>q,Y3:()=>V,_Y:()=>E,jQ:()=>I,sJ:()=>A,xr:()=>O});var u=s(66599);function I(e){return"r"in e&&"g"in e&&"b"in e}function R(e){return"h"in e&&"s"in e&&"v"in e}function m(e){return"l"in e&&"a"in e&&"b"in e}function _(e){return"l"in e&&"c"in e&&"h"in e}s(5710),s(23515);const v=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],T=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function j(e,d){const l=[];let o,h;if(e[0].length!==d.length)throw new Error("dimensions do not match");const C=e.length,g=e[0].length;let x=0;for(o=0;o<C;o++){for(x=0,h=0;h<g;h++)x+=e[o][h]*d[h];l.push(x)}return l}function B(e){const d=[e.r/255,e.g/255,e.b/255].map(o=>o<=.04045?o/12.92:((o+.055)/1.055)**2.4),l=j(v,d);return{x:100*l[0],y:100*l[1],z:100*l[2]}}function w(e){const d=j(T,[e.x/100,e.y/100,e.z/100]).map(l=>Math.min(1,Math.max(l<=.0031308?12.92*l:1.055*l**.4166666666666667-.055,0)));return{r:Math.round(255*d[0]),g:Math.round(255*d[1]),b:Math.round(255*d[2])}}function S(e){const d=[e.x/95.047,e.y/100,e.z/108.883].map(l=>l>.008856451679035631?l**.3333333333333333:7.787037037037035*l+.13793103448275862);return{l:116*d[1]-16,a:500*(d[0]-d[1]),b:200*(d[1]-d[2])}}function f(e){const d=e.l,l=[(d+16)/116+e.a/500,(d+16)/116,(d+16)/116-e.b/200].map(o=>o>6/29?o**3:3*(6/29)**2*(o-4/29));return{x:95.047*l[0],y:100*l[1],z:108.883*l[2]}}function O(e){return I(e)?e:_(e)?function p(e){return w(f(function i(e){const l=e.c,o=e.h;return{l:e.l,a:l*Math.cos(o),b:l*Math.sin(o)}}(e)))}(e):m(e)?function c(e){return w(f(e))}(e):function D(e){return"x"in e&&"y"in e&&"z"in e}(e)?w(e):R(e)?function P(e){const d=(e.h+360)%360/60,o=e.v/100*255,h=o*(e.s/100),C=h*(1-Math.abs(d%2-1));let g;switch(Math.floor(d)){case 0:g={r:h,g:C,b:0};break;case 1:g={r:C,g:h,b:0};break;case 2:g={r:0,g:h,b:C};break;case 3:g={r:0,g:C,b:h};break;case 4:g={r:C,g:0,b:h};break;case 5:case 6:g={r:h,g:0,b:C};break;default:g={r:0,g:0,b:0}}return g.r=Math.round(g.r+o-h),g.g=Math.round(g.g+o-h),g.b=Math.round(g.b+o-h),g}(e):e}function E(e){return R(e)?e:function b(e){const d=e.r,l=e.g,o=e.b,h=Math.max(d,l,o),C=h-Math.min(d,l,o);let g=h,x=0===C?0:h===d?(l-o)/C%6:h===l?(o-d)/C+2:(d-l)/C+4,L=0===C?0:C/g;return x<0&&(x+=6),x*=60,L*=100,g*=100/255,{h:x,s:L,v:g}}(O(e))}function V(e){return m(e)?e:function a(e){return S(B(e))}(O(e))}function A(e){return _(e)?e:function y(e){return function M(e){const d=e.l,l=e.a,o=e.b,h=Math.sqrt(l*l+o*o);let C=Math.atan2(o,l);return C=C>0?C:C+2*Math.PI,{l:d,c:h,h:C}}(S(B(e)))}(O(e))}function q(e,d){const{r:l,g:o,b:h}=d?.ignoreAlpha?e:function J(e){let{r:d,g:l,b:o,a:h}=e;return h<1&&(d=Math.round(h*d+255*(1-h)),l=Math.round(h*l+255*(1-h)),o=Math.round(h*o+255*(1-h))),new u.Z({r:d,g:l,b:o})}(e);return.2126*l+.7152*o+.0722*h}var F,e;(e=F||(F={}))[e.Low=160]="Low",e[e.High=225]="High"},69411:(Y,G,s)=>{s.d(G,{E:()=>f});var u=s(15861),U=s(66599),W=s(70794),I=s(34222),R=s(4978),m=s(25896),_=s(57964),D=s(4703),v=s(66398);function T(M,i,a,c,y){if(null==M)return null;const p=M.referencesGeometry()&&y?function B(M,i,a){const{transform:c,hasZ:y,hasM:p}=a;j.has(i)||j.set(i,function w(M){const i={};switch(M){case"esriGeometryPoint":return(a,c,y,p)=>(0,v.U1)(c,i,a,y,p);case"esriGeometryPolygon":return(a,c,y,p)=>(0,v.Ie)(c,i,a,y,p);case"esriGeometryPolyline":return(a,c,y,p)=>(0,v.G6)(c,i,a,y,p);case"esriGeometryMultipoint":return(a,c,y,p)=>(0,v.J9)(c,i,a,y,p);default:return D.Z.getLogger("esri.views.2d.support.arcadeOnDemand").error(new _.Z("mapview-arcade",`Unable to handle geometryType: ${M}`)),a=>a}}(i));const b=j.get(i)(M.geometry,c,y,p);return{...M,geometry:b}}(i,c,y):i,b=M.repurposeFeature(p);try{return M.evaluate({...a,$feature:b},M.services)}catch(P){return D.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",P),null}}const j=new Map,S=M=>{if(!M)return[0,0,0,0];const{r:i,g:a,b:c,a:y}=M;return[i,a,c,255*y]};class f{static findApplicableOverrides(i,a,c){if(i&&a){if(i.primitiveName){let y=!1;for(const p of c)if(p.primitiveName===i.primitiveName){y=!0;break}if(!y)for(const p of a)p.primitiveName===i.primitiveName&&c.push(p)}switch(i.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(i.effects)for(const y of i.effects)f.findApplicableOverrides(y,a,c);if(i.symbolLayers)for(const y of i.symbolLayers)f.findApplicableOverrides(y,a,c);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(i.effects)for(const y of i.effects)f.findApplicableOverrides(y,a,c);if(i.markerPlacement&&f.findApplicableOverrides(i.markerPlacement,a,c),"CIMVectorMarker"===i.type){if(i.markerGraphics)for(const y of i.markerGraphics)f.findApplicableOverrides(y,a,c),f.findApplicableOverrides(y.symbol,a,c)}else"CIMCharacterMarker"===i.type?f.findApplicableOverrides(i.symbol,a,c):"CIMHatchFill"===i.type?f.findApplicableOverrides(i.lineSymbol,a,c):"CIMPictureMarker"===i.type&&f.findApplicableOverrides(i.animatedSymbolProperties,a,c)}}}static findEffectOverrides(i,a){if(!i)return null;if("CIMGeometricEffectDashes"===i.type&&(0,m.T2)(i),!a||!i.primitiveName)return{type:"cim-effect-param",effect:i,overrides:[]};const c=(0,m.Ml)(i),y=i.primitiveName,p=[];for(const b of a)b.primitiveName===y&&p.push((0,m.Ml)(b));return{type:"cim-effect-param",effect:c,overrides:(0,m.Ul)(p)}}static resolveSymbolOverrides(i,a,c,y,p,b,P){return(0,u.Z)(function*(){if(!i?.symbol)return null;let{symbol:O,primitiveOverrides:E}=i;const V=!!E;if(!V&&!y)return O;O=(0,I.d9)(O),E=(0,I.d9)(E);let A=!0;if(a||(a={attributes:{}},A=!1),V){if(A||(E=E.filter(z=>!z.valueExpressionInfo?.expression.includes("$feature"))),P||(E=E.filter(z=>!z.valueExpressionInfo?.expression.includes("$view"))),E.length>0){const z={spatialReference:c,fields:(0,m.Qf)(a.attributes),geometryType:p};yield f.createRenderExpressions(E,z),f.evaluateOverrides(E,a,p??"esriGeometryPoint",b,P)}f.applyOverrides(O,E)}return y&&f.applyDictionaryTextOverrides(O,a,y,null),O})()}static createRenderExpressions(i,a){return(0,u.Z)(function*(){const c=[];for(const y of i){const p=y.valueExpressionInfo;if(!p||f._expressionToRenderExpression.has(p.expression))continue;const b=(0,R.Yi)(p.expression,a.spatialReference,a.fields);c.push(b),b.then(P=>f._expressionToRenderExpression.set(p.expression,P))}c.length>0&&(yield Promise.all(c))})()}static evaluateOverrides(i,a,c,y,p){const b={$view:{scale:p?.scale}};for(const P of i){P.value&&"object"==typeof P.value&&(0,W.jQ)(P.value)&&("Color"===P.propertyName||"StrokeColor"===P.propertyName)&&(P.value=S(P.value));const O=P.valueExpressionInfo;if(!O)continue;const E=f._expressionToRenderExpression.get(O.expression);E&&(P.value=T(E,a,b,c,y))}}static applyDictionaryTextOverrides(i,a,c,y,p="Normal"){if(i?.type)switch(i.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const b=i.symbolLayers;if(!b)return;for(const P of b)P&&"CIMVectorMarker"===P.type&&f.applyDictionaryTextOverrides(P,a,c,y,"CIMTextSymbol"===i.type?i.textCase:p)}break;case"CIMVectorMarker":{const b=i.markerGraphics;if(!b)return;for(const P of b)P&&f.applyDictionaryTextOverrides(P,a,c,y)}break;case"CIMMarkerGraphic":{const b=i.textString;if(b&&b.includes("[")){const P=(0,m.H1)(b,c);i.textString=(0,m.E_)(a,P,y,p)}}}}static applyOverrides(i,a,c,y){if(i.primitiveName)for(const p of a)if(p.primitiveName===i.primitiveName){const b=(0,m.Le)(p.propertyName);if(y&&y.push({cim:i,nocapPropertyName:b,value:i[b]}),c){let P=!1;for(const O of c)O.primitiveName===i.primitiveName&&(P=!0);P||c.push(p)}null!=p.value&&(i[b]=p.value)}switch(i.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(i.effects)for(const p of i.effects)f.applyOverrides(p,a,c,y);if(i.symbolLayers)for(const p of i.symbolLayers)f.applyOverrides(p,a,c,y);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(i.effects)for(const p of i.effects)f.applyOverrides(p,a,c,y);if("CIMVectorMarker"===i.type&&i.markerGraphics)for(const p of i.markerGraphics)f.applyOverrides(p,a,c,y),f.applyOverrides(p.symbol,a,c,y)}}static restoreOverrides(i){for(const a of i)a.cim[a.nocapPropertyName]=a.value}static buildOverrideKey(i){let a="";for(const c of i)void 0!==c.value&&(a+=`${c.primitiveName}${c.propertyName}${JSON.stringify(c.value)}`);return a}static toValue(i,a){if("DashTemplate"===i)return a.split(" ").map(c=>Number(c));if("Color"===i){const c=new U.Z(a).toRgba();return c[3]*=255,c}return a}}f._expressionToRenderExpression=new Map},83124:(Y,G,s)=>{s.d(G,{y:()=>b});var S,u=s(50484),U=s(83944),W=s(18626),I=s(57964),R=s(77675),m=s(80543),T=(s(14007),s(4703),s(65311),s(10141)),j=s(85338),B=s(30640),w=s(38954);let f=S=class extends w.Z{constructor(P){super(P),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new S({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};(0,u._)([(0,m.Cb)({type:[Number,String],json:{write:!0}})],f.prototype,"left",void 0),(0,u._)([(0,m.Cb)({type:[Number,String],json:{write:!0}})],f.prototype,"right",void 0),(0,u._)([(0,m.Cb)({type:[Number,String],json:{write:!0}})],f.prototype,"top",void 0),(0,u._)([(0,m.Cb)({type:[Number,String],json:{write:!0}})],f.prototype,"bottom",void 0),f=S=(0,u._)([(0,T.j)("esri.views.layers.support.ClipRect")],f);const M=f;var i=s(87265);let a=class extends w.Z{constructor(P){super(P),this.type="path",this.path=[]}commitVersionProperties(){this.commitProperty("path")}};(0,u._)([(0,m.Cb)({type:[[[Number]]],json:{write:!0}})],a.prototype,"path",void 0),a=(0,u._)([(0,T.j)("esri.views.layers.support.Path")],a);const c=a;var y=s(64579);const p=U.Z.ofType({key:"type",base:null,typeMap:{rect:M,path:c,geometry:i.Z}}),b=P=>{let O=class extends P{constructor(){super(...arguments),this.attached=!1,this.clips=new p,this.highlightOptions=null,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1,this._visibleAtCurrentScale=!0}initialize(){const E=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&E&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new I.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new j.W),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([(0,R.YP)(()=>this.suspended,A=>{this.container&&(this.container.visible=!A)},R.tX),(0,R.YP)(()=>this.updateSuspended,A=>{this.view&&!A&&this.updateRequested&&this.view.requestUpdate()},R.tX),(0,R.YP)(()=>this.layer?.opacity??1,A=>{this.container&&(this.container.opacity=A)},R.tX),(0,R.YP)(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",A=>{this.container&&(this.container.blendMode=A)},R.tX),(0,R.YP)(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,A=>{this.container&&(this.container.effect=A)},R.tX),(0,R.YP)(()=>this.highlightOptions,A=>this.container.highlightOptions=A,R.tX),(0,R.on)(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)},R.tX),(0,R.YP)(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:A,scaleRange:z})=>{const J=(0,y.GB)(z,A);J!==this._visibleAtCurrentScale&&(this._visibleAtCurrentScale=J)},R.tX)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(A=>{A===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){const E=this.view?.spatialReference;return null==E||this.supportsSpatialReference(E)}get updating(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this._updatingHandles?.updating)}get visibleAtCurrentScale(){return this._visibleAtCurrentScale}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.updateSuspended||this.view.requestUpdate())}processUpdate(E){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",E),this.updateRequested&&!this.updateSuspended&&(this.updateRequested=!1,this.update(E))):this.updateRequested=!1}hitTest(E,V){return Promise.resolve(null)}supportsSpatialReference(E){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const E=super.getSuspendInfo(),V=!this.spatialReferenceSupported;return V&&(E.spatialReferenceNotSupported=V),E}addAttachHandles(E){this.addHandles(E,"attach")}};return(0,u._)([(0,m.Cb)()],O.prototype,"attached",void 0),(0,u._)([(0,m.Cb)({type:p,set(E){const V=(0,W.Z)(E,this._get("clips"),p);this._set("clips",V)}})],O.prototype,"clips",void 0),(0,u._)([(0,m.Cb)()],O.prototype,"container",void 0),(0,u._)([(0,m.Cb)({type:B.Z})],O.prototype,"highlightOptions",void 0),(0,u._)([(0,m.Cb)()],O.prototype,"moving",void 0),(0,u._)([(0,m.Cb)({readOnly:!0})],O.prototype,"spatialReferenceSupported",null),(0,u._)([(0,m.Cb)({readOnly:!0})],O.prototype,"updateParameters",void 0),(0,u._)([(0,m.Cb)()],O.prototype,"updateRequested",void 0),(0,u._)([(0,m.Cb)()],O.prototype,"updating",null),(0,u._)([(0,m.Cb)()],O.prototype,"view",void 0),(0,u._)([(0,m.Cb)()],O.prototype,"_visibleAtCurrentScale",void 0),(0,u._)([(0,m.Cb)({readOnly:!0})],O.prototype,"visibleAtCurrentScale",null),O=(0,u._)([(0,T.j)("esri.views.2d.layers.LayerView2D")],O),O}},18761:(Y,G,s)=>{s.r(G),s.d(G,{default:()=>d});var u=s(15861),U=s(50484),W=s(66599),I=s(35458),m=(s(71950),s(51172)),_=s(77675),D=s(80543),B=(s(14007),s(4703),s(65311),s(10141)),w=s(45049),S=s(24124),f=s(85460),i=(s(2189),s(90984)),a=s(50433),c=s(55768),y=s(89014),p=s(83821),b=s(64456),P=s(87265),O=s(39853),E=s(39237),V=s(17091),A=s(22784),z=s(46682),J=s(5391),q=s(44107);class ye extends b.s{constructor(o){super(),this.element=o,this._handles=new a.Z,this.isWrapAround=!1,this.perspectiveTransform=(0,y.Ue)(),this.wrapAroundShift=0,this.clipGeometry=null,this._handles.add((0,_.gx)(()=>this.element,()=>{const h=this.element;this.ready(),h&&this._handles.add((0,i.on)(h,"play",()=>this.requestRender()))},_.nn))}getMesh(o){throw new Error("Method not implemented.")}destroy(){this._handles.destroy(),this.texture=(0,m.M2)(this.texture),this._vao&&(this._vao.dispose(),this._vao=null),this._vbo&&(this._vbo.dispose(),this._vbo=null),this.texture&&(this.texture.dispose(),this.texture=null)}get textureSize(){if(!this.texture)return[1,1];const o=this.texture.descriptor;return[o.width,o.height]}get dvsMat3(){return this.parent.dvsMat3}beforeRender(o){const h=this.element;if(null==h)return;const{context:C}=o,{videoWidth:g,videoHeight:x}=h;if(0!==g&&0!==x){if(this.texture)h.paused||this.texture.setData(h);else{const L=new A.X;L.wrapMode=E.e8.CLAMP_TO_EDGE,L.preMultiplyAlpha=!0,L.width=g,L.height=x,this.texture=new V.x(C,L,h)}h.paused||(this.texture.generateMipmap(),this.requestRender()),super.beforeRender(o)}}_createTransforms(){return null}updateDrawCoords(o,h,C,g){const x=this.element,L=this._getFrameInfo();if(!x||!L)return;this._initializeData(o,L,C);const{controlPoints:K,horizon:N}=L,H=Math.sqrt(K.length),k=H,{x:Z,y:X}=o,ee=this._vertices,ie=K[H-1],Ee=K[(k-1)*H],Pe=K[(k-1)*H+H-1],ne=(0,p.project)(N?N[0].mapPoint:K[0].mapPoint,C),oe=(0,p.project)(N?N[1].mapPoint:ie.mapPoint,C),te=(0,p.project)(Ee.mapPoint,C),ae=(0,p.project)(Pe.mapPoint,C);this.clipGeometry=N?new P.Z({geometry:J.Z.fromJSON({rings:[[[te.x,te.y],[ae.x,ae.y],[oe.x,oe.y],[ne.x,ne.y],[te.x,te.y]]],spatialReference:C})}):null;for(let $=0;$<K.length;$++){const he=K[$],{sourcePoint:ce,mapPoint:pe}=he;if(null==ce||null==pe)continue;const se=(0,p.project)(pe,C);ee[2*$+0]=se.x-Z,ee[2*$+1]=se.y-X}let le=h;if(g){const $=Math.min(ne.x,oe.x,te.x,ae.x),he=Math.max(ne.x,oe.x,te.x,ae.x),{worldWidth:ce,xBounds:pe}=g,[se,Me]=pe;$<se&&he>se?le=ce:he>Me&&$<Me&&(le=-ce)}this.wrapAroundShift=le,this.isWrapAround=0!==le}getVAO(o,h,C){if(null==this._vertices)return null;const g=this._vertices;if(this._vao)this._vbo.setData(g);else{this._vbo=O.f.createVertex(o,E.l1.DYNAMIC_DRAW,g);const x=O.f.createVertex(o,E.l1.STATIC_DRAW,this._texCoords);this._ibo=O.f.createIndex(o,E.l1.DYNAMIC_DRAW,this._indices),this._vao=new z.U(o,C,h,{geometry:this._vbo,tex:x},this._ibo)}return this._vao}draw(o){o.drawElements(E.MX.TRIANGLE_STRIP,this._indices.length,o.gl.UNSIGNED_SHORT,0)}_initializeData(o,h,C){if(null!=this._vertices&&null!=this._indices)return;const{controlPoints:g}=h,x=Math.sqrt(g.length),L=x,K=new Float32Array(2*g.length),N=new Uint16Array(2*g.length);for(let Z=0;Z<g.length;Z++){const X=g[Z],{sourcePoint:ee,mapPoint:re}=X;if(null==ee||null==re)continue;const ie=(0,p.project)(re,C);K[2*Z+0]=ie.x-o.x,K[2*Z+1]=ie.y-o.y,N[2*Z+0]=ee.x,N[2*Z+1]=ee.y}const H=new Uint16Array(L*x+(L-2)*(x+2));let k=0;for(let Z=0;Z<L;Z++){for(let X=0;X<x;X++)H[k++]=Z*x+X,H[k++]=(Z+1)*x+X;Z<L-2&&(H[k++]=(Z+1)*x+(x-1),H[k++]=(Z+1)*x)}this._vertices=K,this._texCoords=N,this._indices=H}_getFrameInfo(){if(!this.groundControlPoints)return null;const o=this._getFrameControlPoints(),h=this.frameHorizonPoints;let C=null;if(h){const L=h.endX,K=h.endY;C=[{sourcePoint:(0,c.vW)(h.startX,h.startY),mapPoint:new q.Z(h.startLongitude,h.startLatitude)},{sourcePoint:(0,c.vW)(L,K),mapPoint:new q.Z(h.endLongitude,h.endLatitude)}]}return{controlPoints:o,horizon:C}}_getFrameControlPoints(){const o=this.groundControlPoints,h=o?.length;if(!h)return[];const C=new Array(h);for(let g=0;g<h;g++){const{x,y:L,lat:K,lon:N}=o[g];C[g]={sourcePoint:(0,c.vW)(x,-L),mapPoint:new q.Z(N,K)}}return C}}var me=s(83124),fe=s(50800),ve=s(37348),ge=s(50145),Ce=s(89481),de=s(66637),ue=s(35451);const Q=new W.Z([255,127,0]);let e=class extends((0,me.y)(ge.Z)){constructor(){super(...arguments),this._graphicsLayer=new w.Z,this._frameOutlineGraphic=new I.Z({symbol:new Ce.Z({outline:{type:"simple-line",color:Q}})}),this._sensorTrailGraphic=new I.Z({symbol:new de.Z({color:Q})}),this._lineOfSightGraphic=new I.Z({symbol:new de.Z({color:Q})}),this._sensorLocationGraphic=new I.Z({symbol:new ue.Z({color:Q})}),this._frameCenterGraphic=new I.Z({symbol:new ue.Z({color:Q})}),this._overlayContainer=null,this.layer=null,this.symbolColor=Q,this.visibleTelemetryElements=null}destroy(){this._graphicsLayer=(0,m.SC)(this._graphicsLayer)}initialize(){this.addHandles((0,_.YP)(()=>this.symbolColor,()=>{this._frameOutlineGraphic.symbol.outline.color=this.symbolColor,this._sensorTrailGraphic.symbol.color=this.symbolColor,this._lineOfSightGraphic.symbol.color=this.symbolColor,this._sensorLocationGraphic.symbol.color=this.symbolColor,this._frameCenterGraphic.symbol.color=this.symbolColor},_.nn)),this._graphicsLayer.graphics.addMany([this._frameOutlineGraphic,this._sensorTrailGraphic,this._lineOfSightGraphic,this._sensorLocationGraphic,this._frameCenterGraphic]),this.visibleTelemetryElements=new S.Z({frameCenter:this.layer.telemetryDisplay?.frameCenter??!0,frameOutline:this.layer.telemetryDisplay?.frameOutline??!0,lineOfSight:this.layer.telemetryDisplay?.lineOfSight??!0,sensorLocation:this.layer.telemetryDisplay?.sensorLocation??!0,sensorTrail:this.layer.telemetryDisplay?.sensorTrail??!0})}attach(){this._overlayContainer=new f.Z,this.container.addChild(this._overlayContainer),this._addOverlayMultipoint(),this.graphicsView=new ve.Z({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:this._graphicsLayer.graphics,container:new fe.Z(this.view.featuresTilingScheme)}),this.container.addChild(this.graphicsView.container),this.addAttachHandles(this._graphicsLayer.on("graphic-update",this.graphicsView.graphicUpdateHandler)),this.addAttachHandles([(0,_.YP)(()=>[this.layer.telemetryDisplay?.frameCenter,this.layer.telemetryDisplay?.frameOutline,this.layer.telemetryDisplay?.sensorLocation,this.layer.telemetryDisplay?.sensorTrail,this.layer.telemetryDisplay?.lineOfSight],()=>this._updateVisibleTelemetryElements(),_.nn),(0,_.YP)(()=>[this.layer.telemetry,this.visibleTelemetryElements?.frameCenter,this.visibleTelemetryElements?.frameOutline,this.visibleTelemetryElements?.sensorLocation,this.visibleTelemetryElements?.sensorTrail,this.visibleTelemetryElements?.lineOfSight],()=>this._updateGraphicGeometries(),_.nn)])}detach(){this._overlayContainer.removeAllChildren(),this.container.removeAllChildren(),this.graphicsView=(0,m.SC)(this.graphicsView)}supportsSpatialReference(l){return!0}moveEnd(){}viewChange(){this.graphicsView.viewChange()}update(l){this.graphicsView.processUpdate(l)}isUpdating(){return!this.graphicsView||this.graphicsView.updating}_updateVisibleTelemetryElements(){this.visibleTelemetryElements&&this.layer.telemetryDisplay&&(this.visibleTelemetryElements.frameCenter=this.layer.telemetryDisplay.frameCenter,this.visibleTelemetryElements.frameOutline=this.layer.telemetryDisplay.frameOutline,this.visibleTelemetryElements.lineOfSight=this.layer.telemetryDisplay.lineOfSight,this.visibleTelemetryElements.sensorLocation=this.layer.telemetryDisplay.sensorLocation,this.visibleTelemetryElements.sensorTrail=this.layer.telemetryDisplay.sensorTrail)}_updateGraphicGeometries(){const{telemetry:l}=this.layer,{visibleTelemetryElements:o}=this;l&&o&&(this._frameOutlineGraphic.geometry=o.frameOutline&&l.frameOutline?this.layer.telemetry.frameOutline:null,this._sensorTrailGraphic.geometry=o.sensorTrail&&l.sensorTrail?this.layer.telemetry.sensorTrail:null,this._lineOfSightGraphic.geometry=o.lineOfSight&&l.lineOfSight?this.layer.telemetry.lineOfSight:null,this._sensorLocationGraphic.geometry=o.sensorLocation&&l.sensorLocation?this.layer.telemetry.sensorLocation:null,this._frameCenterGraphic.geometry=o.frameCenter&&l.frameCenter?this.layer.telemetry.frameCenter:null)}_addOverlayMultipoint(){var l=this;return(0,u.Z)(function*(){if(!l.layer.videoElement)return;const o=new ye(l.layer.videoElement);l.addAttachHandles([(0,_.YP)(()=>[l.layer.frameHorizonPoints,l.layer.groundControlPoints],()=>{o.frameHorizonPoints=l.layer.frameHorizonPoints,o.groundControlPoints=l.layer.groundControlPoints},_.nn)]),l._overlayContainer.addChild(o),l.view.stage.requestRender()})()}};(0,U._)([(0,D.Cb)()],e.prototype,"graphicsView",void 0),(0,U._)([(0,D.Cb)()],e.prototype,"layer",void 0),(0,U._)([(0,D.Cb)()],e.prototype,"symbolColor",void 0),(0,U._)([(0,D.Cb)({type:S.Z})],e.prototype,"visibleTelemetryElements",void 0),e=(0,U._)([(0,B.j)("esri.views.2d.layers.VideoLayerView2D")],e);const d=e},50800:(Y,G,s)=>{s.d(G,{Z:()=>I});var u=s(43101),U=s(89791),W=s(31043);class I extends U.K{renderChildren(m){for(const _ of this.children)_.setTransform(m.state);if(super.renderChildren(m),this.attributeView.update(),this.children.some(_=>_.hasData)){switch(m.drawPhase){case u.jx.MAP:this._renderChildren(m,u.Xq.All);break;case u.jx.HIGHLIGHT:this.hasHighlight&&this._renderHighlight(m)}this._boundsRenderer&&this._boundsRenderer.doRender(m)}}_renderHighlight(m){(0,W.P9)(m,!1,_=>{this._renderChildren(_,u.Xq.Highlight)})}}},50145:(Y,G,s)=>{s.d(G,{Z:()=>f});var u=s(50484),U=s(73514),W=s(88278),I=s(84373),R=s(4703),m=s(51172),_=s(47868),D=s(80543),j=(s(14007),s(65311),s(10141)),B=s(90110),w=s(64579);let S=class extends((0,I.IG)((0,_.v)(W.Z.EventedMixin(U.Z)))){constructor(M){super(M),this._updatingHandles=new B.R,this.layer=null,this.parent=null}initialize(){this.when().catch(M=>{if("layerview:create-error"!==M.name){const i=this.layer&&this.layer.id||"no id",a=this.layer?.title||"no title";R.Z.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${a}', id: '${i}')`,M)}})}destroy(){this._updatingHandles=(0,m.SC)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(M){this._overrideIfSome("visible",M)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){const M=this.view.timeExtent,i=this.layer?.visibilityTimeExtent;return!M||!i||!M.intersection(i).isEmpty}canResume(){const M=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready&&(0,w.Cy)(M)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){const M=this.parent?.suspended?this.parent.suspendInfo:{};return this.view?.ready||(M.viewNotReady=!0),this.layer&&this.layer.loaded||(M.layerNotLoaded=!0),(0,w.Cy)(this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null)&&this.visibleAtCurrentScale||(M.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(M.outsideVisibilityTimeExtent=!0),this.visible||(M.layerInvisible=!0),M}isUpdating(){return!1}};(0,u._)([(0,D.Cb)()],S.prototype,"view",void 0),(0,u._)([(0,D.Cb)()],S.prototype,"fullOpacity",null),(0,u._)([(0,D.Cb)()],S.prototype,"layer",void 0),(0,u._)([(0,D.Cb)()],S.prototype,"parent",void 0),(0,u._)([(0,D.Cb)({readOnly:!0})],S.prototype,"suspended",null),(0,u._)([(0,D.Cb)({readOnly:!0})],S.prototype,"suspendInfo",null),(0,u._)([(0,D.Cb)({readOnly:!0})],S.prototype,"legendEnabled",null),(0,u._)([(0,D.Cb)({type:Boolean,readOnly:!0})],S.prototype,"updating",null),(0,u._)([(0,D.Cb)({readOnly:!0})],S.prototype,"updatingProgress",null),(0,u._)([(0,D.Cb)()],S.prototype,"updateSuspended",null),(0,u._)([(0,D.Cb)()],S.prototype,"visible",null),(0,u._)([(0,D.Cb)({readOnly:!0})],S.prototype,"visibleAtCurrentScale",null),(0,u._)([(0,D.Cb)({readOnly:!0})],S.prototype,"visibleAtCurrentTimeExtent",null),S=(0,u._)([(0,j.j)("esri.views.layers.LayerView")],S);const f=S},38954:(Y,G,s)=>{s.d(G,{Z:()=>v});var u=s(50484),U=s(89317),W=s(80543),_=(s(14007),s(4703),s(65311),s(10141));let D=class extends U.wq{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};(0,u._)([(0,W.Cb)({readOnly:!0})],D.prototype,"version",null),D=(0,u._)([(0,_.j)("esri.views.layers.support.ClipArea")],D);const v=D},87265:(Y,G,s)=>{s.d(G,{Z:()=>M});var w,u=s(50484),W=(s(2189),s(80543)),_=(s(14007),s(4703),s(65311),s(10141)),D=s(32184),v=s(40637),T=s(38954),j=s(26894),B=s(5391);const S={base:D.Z,key:"type",typeMap:{extent:j.Z,polygon:B.Z}};let f=w=class extends T.Z{constructor(i){super(i),this.type="geometry",this.geometry=null}clone(){return new w({geometry:this.geometry?.clone()??null})}commitVersionProperties(){this.commitProperty("geometry")}};(0,u._)([(0,W.Cb)({types:S,json:{read:v.im,write:!0}})],f.prototype,"geometry",void 0),f=w=(0,u._)([(0,_.j)("esri.views.layers.support.Geometry")],f);const M=f},64579:(Y,G,s)=>{function u(v){return v&&"function"==typeof v.highlight}function I(v,T){if(T&&v){const{minScale:j,maxScale:B}=v;if(function R(v,T){return null!=v&&v>0||null!=T&&T>0}(j,B))return function W(v,T,j){return null==v||v>=j&&(0===T||v<=T)}(T,j,B)}return!0}function m(v){return!v?.minScale||!v.maxScale||v.minScale>=v.maxScale}s.d(G,{Cy:()=>m,GB:()=>I,tl:()=>u})}}]);