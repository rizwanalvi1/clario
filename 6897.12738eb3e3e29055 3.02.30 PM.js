"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[6897],{5710:(ce,k,h)=>{h.d(k,{a:()=>d,b:()=>u,c:()=>ee,e:()=>n,f:()=>R,g:()=>W,i:()=>H,j:()=>L,l:()=>ue,n:()=>J,s:()=>X,t:()=>he});var F=h(89612);function ee(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function X(e,t,r,I,b){return e[0]=t,e[1]=r,e[2]=I,e[3]=b,e}function R(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function U(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function K(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function V(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function u(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function T(e,t){const r=t[0]-e[0],I=t[1]-e[1],b=t[2]-e[2],D=t[3]-e[3];return Math.sqrt(r*r+I*I+b*b+D*D)}function Z(e,t){const r=t[0]-e[0],I=t[1]-e[1],b=t[2]-e[2],D=t[3]-e[3];return r*r+I*I+b*b+D*D}function H(e){const t=e[0],r=e[1],I=e[2],b=e[3];return Math.sqrt(t*t+r*r+I*I+b*b)}function L(e){const t=e[0],r=e[1],I=e[2],b=e[3];return t*t+r*r+I*I+b*b}function J(e,t){const r=t[0],I=t[1],b=t[2],D=t[3];let N=r*r+I*I+b*b+D*D;return N>0&&(N=1/Math.sqrt(N),e[0]=r*N,e[1]=I*N,e[2]=b*N,e[3]=D*N),e}function W(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function ue(e,t,r,I){const b=t[0],D=t[1],N=t[2],q=t[3];return e[0]=b+I*(r[0]-b),e[1]=D+I*(r[1]-D),e[2]=N+I*(r[2]-N),e[3]=q+I*(r[3]-q),e}function he(e,t,r){const I=t[0],b=t[1],D=t[2],N=t[3];return e[0]=r[0]*I+r[4]*b+r[8]*D+r[12]*N,e[1]=r[1]*I+r[5]*b+r[9]*D+r[13]*N,e[2]=r[2]*I+r[6]*b+r[10]*D+r[14]*N,e[3]=r[3]*I+r[7]*b+r[11]*D+r[15]*N,e}function d(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function n(e,t){const r=e[0],I=e[1],b=e[2],D=e[3],N=t[0],q=t[1],te=t[2],ne=t[3],p=(0,F.bn)();return Math.abs(r-N)<=p*Math.max(1,Math.abs(r),Math.abs(N))&&Math.abs(I-q)<=p*Math.max(1,Math.abs(I),Math.abs(q))&&Math.abs(b-te)<=p*Math.max(1,Math.abs(b),Math.abs(te))&&Math.abs(D-ne)<=p*Math.max(1,Math.abs(D),Math.abs(ne))}Object.freeze(Object.defineProperty({__proto__:null,add:R,ceil:function C(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},copy:ee,copyVec3:function j(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},dist:T,distance:T,div:V,divide:V,dot:W,equals:n,exactEquals:d,floor:function c(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},inverse:function G(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},len:H,length:H,lerp:ue,max:function g(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},min:function M(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},mul:K,multiply:K,negate:function Q(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},normalize:J,random:function me(e,t){const r=F.FD;let I,b,D,N,q,te;t=t||1;do{I=2*r()-1,b=2*r()-1,q=I*I+b*b}while(q>=1);do{D=2*r()-1,N=2*r()-1,te=D*D+N*N}while(te>=1);const ne=Math.sqrt((1-q)/te);return e[0]=t*I,e[1]=t*b,e[2]=t*D*ne,e[3]=t*N*ne,e},round:function w(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},scale:u,scaleAndAdd:function f(e,t,r,I){return e[0]=t[0]+r[0]*I,e[1]=t[1]+r[1]*I,e[2]=t[2]+r[2]*I,e[3]=t[3]+r[3]*I,e},set:X,sqrDist:Z,sqrLen:L,squaredDistance:Z,squaredLength:L,str:function fe(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},sub:U,subtract:U,transformMat4:he,transformQuat:function de(e,t,r){const I=t[0],b=t[1],D=t[2],N=r[0],q=r[1],te=r[2],ne=r[3],p=ne*I+q*D-te*b,l=ne*b+te*I-N*D,s=ne*D+N*b-q*I,i=-N*I-q*b-te*D;return e[0]=p*ne+i*-N+l*-te-s*-q,e[1]=l*ne+i*-q+s*-N-p*-te,e[2]=s*ne+i*-te+p*-q-l*-N,e[3]=t[3],e}},Symbol.toStringTag,{value:"Module"}))},51310:(ce,k,h)=>{function F(c){return null!=R(c)||null!=X(c)}function ee(c){return U.test(c)}function j(c){return R(c)??X(c)}function X(c){const M=new Date(c);return function K(c,M){if(Number.isNaN(c.getTime()))return!1;let g=!0;if(C&&/\d+\W*$/.test(M)){const w=M.match(/[a-zA-Z]{2,}/);if(w){let u=!1,f=0;for(;!u&&f<=w.length;)u=!V.test(w[f]),f++;g=!u}}return g}(M,c)?Number.isNaN(M.getTime())?null:M.getTime()-6e4*M.getTimezoneOffset():null}function R(c){const M=U.exec(c);if(!M?.groups)return null;const g=M.groups,w=+g.year,u=+g.month-1,f=+g.day,T=+(g.hours??"0"),Z=+(g.minutes??"0"),H=+(g.seconds??"0");if(T>23||Z>59||H>59)return null;const L=g.ms??"0",Q=L?+L.padEnd(3,"0").substring(0,3):0;let G;return G=g.isUTC||!g.offsetSign?Date.UTC(w,u,f,T,Z,H,Q):6e4*("+"===g.offsetSign?-1:1)*(60*+g.offsetHours+ +g.offsetMinutes)+Date.UTC(w,u,f,T,Z,H,Q),Number.isNaN(G)?null:G}h.d(k,{mu:()=>ee,of:()=>F,sG:()=>j});const U=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,V=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,C=!Number.isNaN(new Date("technology 10").getTime())},23515:(ce,k,h)=>{function F(){return[0,0,0,0]}function j(L,Q,G,J){return[L,Q,G,J]}function K(){return j(1,1,1,1)}function V(){return j(1,0,0,0)}function C(){return j(0,1,0,0)}function c(){return j(0,0,1,0)}function M(){return j(0,0,0,1)}h.d(k,{Ue:()=>F,al:()=>j});const w=K(),u=V(),f=C(),T=c(),Z=M();Object.freeze(Object.defineProperty({__proto__:null,ONES:w,UNIT_W:Z,UNIT_X:u,UNIT_Y:f,UNIT_Z:T,ZEROS:[0,0,0,0],clone:function ee(L){return[L[0],L[1],L[2],L[3]]},create:F,createView:function R(L,Q){return new Float64Array(L,Q,4)},fromArray:function X(L,Q=[0,0,0,0]){const G=Math.min(4,L.length);for(let J=0;J<G;++J)Q[J]=L[J];return Q},fromValues:j,ones:K,unitW:M,unitX:V,unitY:C,unitZ:c,zeros:function U(){return[0,0,0,0]}},Symbol.toStringTag,{value:"Module"}))},26540:(ce,k,h)=>{h.d(k,{Q:()=>R});var F=h(57678),j=(h(14007),h(43029)),X=h(4758);class R{constructor(n=9,o){this._compareMinX=g,this._compareMinY=w,this._toBBox=a=>a,this._maxEntries=Math.max(4,n||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),o&&("function"==typeof o?this._toBBox=o:this._initFormat(o)),this.clear()}destroy(){this.clear(),G.prune(),J.prune(),W.prune(),ue.prune()}all(n){K(this._data,n)}search(n,o){let a=this._data;const _=this._toBBox;if(L(n,a))for(G.clear();a;){for(let m=0,E=a.children.length;m<E;m++){const S=a.children[m],A=a.leaf?_(S):S;L(n,A)&&(a.leaf?o(S):H(n,A)?K(S,o):G.push(S))}a=G.pop()}}collides(n){let o=this._data;const a=this._toBBox;if(!L(n,o))return!1;for(G.clear();o;){for(let _=0,m=o.children.length;_<m;_++){const E=o.children[_],S=o.leaf?a(E):E;if(L(n,S)){if(o.leaf||H(n,S))return!0;G.push(E)}}o=G.pop()}return!1}load(n){if(!n.length)return this;if(n.length<this._minEntries){for(let a=0,_=n.length;a<_;a++)this.insert(n[a]);return this}let o=this._build(n.slice(0,n.length),0,n.length-1,0);if(this._data.children.length)if(this._data.height===o.height)this._splitRoot(this._data,o);else{if(this._data.height<o.height){const a=this._data;this._data=o,o=a}this._insert(o,this._data.height-o.height-1,!0)}else this._data=o;return this}insert(n){return n&&this._insert(n,this._data.height-1),this}clear(){return this._data=new de([]),this}remove(n){if(!n)return this;let o,a=this._data,_=null,m=0,E=!1;const S=this._toBBox(n);for(W.clear(),ue.clear();a||W.length>0;){if(a||(a=W.pop(),_=W.data[W.length-1],m=ue.pop()??0,E=!0),a.leaf&&(o=(0,F.cq)(a.children,n,a.children.length,a.indexHint),-1!==o))return a.children.splice(o,1),W.push(a),this._condense(W),this;E||a.leaf||!H(a,S)?_?(m++,a=_.children[m],E=!1):a=null:(W.push(a),ue.push(m),m=0,_=a,a=a.children[0])}return this}toJSON(){return this._data}fromJSON(n){return this._data=n,this}_build(n,o,a,_){const m=a-o+1;let E=this._maxEntries;if(m<=E){const e=new de(n.slice(o,a+1));return C(e,this._toBBox),e}_||(_=Math.ceil(Math.log(m)/Math.log(E)),E=Math.ceil(m/E**(_-1)));const S=new fe([]);S.height=_;const A=Math.ceil(m/E),z=A*Math.ceil(Math.sqrt(E));Q(n,o,a,z,this._compareMinX);for(let e=o;e<=a;e+=z){const t=Math.min(e+z-1,a);Q(n,e,t,A,this._compareMinY);for(let r=e;r<=t;r+=A){const I=Math.min(r+A-1,t);S.children.push(this._build(n,r,I,_-1))}}return C(S,this._toBBox),S}_insert(n,o,a){const m=a?n:(0,this._toBBox)(n);W.clear();const E=function U(d,n,o,a){for(;a.push(n),!0!==n.leaf&&a.length-1!==o;){let _,m=1/0,E=1/0;for(let S=0,A=n.children.length;S<A;S++){const z=n.children[S],e=u(z),t=T(d,z)-e;t<E?(E=t,m=e<m?e:m,_=z):t===E&&e<m&&(m=e,_=z)}n=_||n.children[0]}return n}(m,this._data,o,W);for(E.children.push(n),M(E,m);o>=0&&W.data[o].children.length>this._maxEntries;)this._split(W,o),o--;!function V(d,n,o){for(let a=o;a>=0;a--)M(n.data[a],d)}(m,W,o)}_split(n,o){const a=n.data[o],_=a.children.length,m=this._minEntries;this._chooseSplitAxis(a,m,_);const E=this._chooseSplitIndex(a,m,_);if(!E)return;const S=a.children.splice(E,a.children.length-E),A=a.leaf?new de(S):new fe(S);A.height=a.height,C(a,this._toBBox),C(A,this._toBBox),o?n.data[o-1].children.push(A):this._splitRoot(a,A)}_splitRoot(n,o){this._data=new fe([n,o]),this._data.height=n.height+1,C(this._data,this._toBBox)}_chooseSplitIndex(n,o,a){let _,m,E;_=m=1/0;for(let S=o;S<=a-o;S++){const A=c(n,0,S,this._toBBox),z=c(n,S,a,this._toBBox),e=Z(A,z),t=u(A)+u(z);e<_?(_=e,E=S,m=t<m?t:m):e===_&&t<m&&(m=t,E=S)}return E}_chooseSplitAxis(n,o,a){const _=n.leaf?this._compareMinX:g,m=n.leaf?this._compareMinY:w;this._allDistMargin(n,o,a,_)<this._allDistMargin(n,o,a,m)&&n.children.sort(_)}_allDistMargin(n,o,a,_){n.children.sort(_);const m=this._toBBox,E=c(n,0,o,m),S=c(n,a-o,a,m);let A=f(E)+f(S);for(let z=o;z<a-o;z++){const e=n.children[z];M(E,n.leaf?m(e):e),A+=f(E)}for(let z=a-o-1;z>=o;z--){const e=n.children[z];M(S,n.leaf?m(e):e),A+=f(S)}return A}_condense(n){for(let o=n.length-1;o>=0;o--){const a=n.data[o];if(0===a.children.length)if(o>0){const _=n.data[o-1],m=_.children;m.splice((0,F.cq)(m,a,m.length,_.indexHint),1)}else this.clear();else C(a,this._toBBox)}}_initFormat(n){const o=["return a"," - b",";"];this._compareMinX=new Function("a","b",o.join(n[0])),this._compareMinY=new Function("a","b",o.join(n[1])),this._toBBox=new Function("a","return {minX: a"+n[0]+", minY: a"+n[1]+", maxX: a"+n[2]+", maxY: a"+n[3]+"};")}}function K(d,n){let o=d;for(J.clear();o;){if(!0===o.leaf)for(const a of o.children)n(a);else J.pushArray(o.children);o=J.pop()??null}}function C(d,n){c(d,0,d.children.length,n,d)}function c(d,n,o,a,_){_||(_=new de([])),_.minX=1/0,_.minY=1/0,_.maxX=-1/0,_.maxY=-1/0;for(let m,E=n;E<o;E++)m=d.children[E],M(_,d.leaf?a(m):m);return _}function M(d,n){d.minX=Math.min(d.minX,n.minX),d.minY=Math.min(d.minY,n.minY),d.maxX=Math.max(d.maxX,n.maxX),d.maxY=Math.max(d.maxY,n.maxY)}function g(d,n){return d.minX-n.minX}function w(d,n){return d.minY-n.minY}function u(d){return(d.maxX-d.minX)*(d.maxY-d.minY)}function f(d){return d.maxX-d.minX+(d.maxY-d.minY)}function T(d,n){return(Math.max(n.maxX,d.maxX)-Math.min(n.minX,d.minX))*(Math.max(n.maxY,d.maxY)-Math.min(n.minY,d.minY))}function Z(d,n){const o=Math.max(d.minX,n.minX),a=Math.max(d.minY,n.minY),_=Math.min(d.maxX,n.maxX),m=Math.min(d.maxY,n.maxY);return Math.max(0,_-o)*Math.max(0,m-a)}function H(d,n){return d.minX<=n.minX&&d.minY<=n.minY&&n.maxX<=d.maxX&&n.maxY<=d.maxY}function L(d,n){return n.minX<=d.maxX&&n.minY<=d.maxY&&n.maxX>=d.minX&&n.maxY>=d.minY}function Q(d,n,o,a,_){const m=[n,o];for(;m.length;){const E=m.pop(),S=m.pop();if(E-S<=a)continue;const A=S+Math.ceil((E-S)/a/2)*a;(0,X.q)(d,A,S,E,_),m.push(S,A,A,E)}}const G=new j.Z,J=new j.Z,W=new j.Z,ue=new j.Z({deallocator:void 0});class me{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class he extends me{constructor(){super(...arguments),this.height=1,this.indexHint=new F.SO}}class de extends he{constructor(n){super(),this.children=n,this.leaf=!0}}class fe extends he{constructor(n){super(),this.children=n,this.leaf=!1}}},46872:(ce,k,h)=>{h.d(k,{H:()=>V});var F=h(14007),ee=h(26540),j=h(45425);const R={minX:0,minY:0,maxX:0,maxY:0};class V{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new ee.Q(9,(0,F.Z)("esri-csp-restrictions")?c=>({minX:c[0],minY:c[1],maxX:c[2],maxY:c[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const c=new Array(this._idByBounds.size);let M=0;this._idByBounds.forEach((g,w)=>{c[M++]=w}),this._indexInvalid=!1,this._index.clear(),this._index.load(c)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(c=>this._idByBounds.has(c))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const c=(0,j.cS)();for(const M of this._boundsById.values())M&&(c[0]=Math.min(M[0],c[0]),c[1]=Math.min(M[1],c[1]),c[2]=Math.max(M[2],c[2]),c[3]=Math.max(M[3],c[3]));return c}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(c){const M=this._boundsById.get(c);this._boundsById.delete(c),M&&(this._idByBounds.delete(M),this._indexInvalid||this._index.remove(M))}forEachInBounds(c,M){this._loadIndex(),function K(C,c,M){(function U(C){R.minX=C[0],R.minY=C[1],R.maxX=C[2],R.maxY=C[3]})(c),C.search(R,M)}(this._index,c,g=>M(this._idByBounds.get(g)))}get(c){return this._boundsById.get(c)}has(c){return this._boundsById.has(c)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(c,M){if(!this._indexInvalid){const g=this._boundsById.get(c);g&&(this._index.remove(g),this._idByBounds.delete(g))}this._boundsById.set(c,M),M&&(this._idByBounds.set(M,c),this._indexInvalid||(this._boundsToLoad.push(M),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},84726:(ce,k,h)=>{h.d(k,{Z:()=>g});var F=h(57678),ee=h(57964),j=h(88278),X=h(4703),R=h(27048),U=h(45425),K=h(10842),V=h(46872),C=h(29085),c=h(14309);const M=(0,R.Ue)();class g{constructor(u){this.geometryInfo=u,this._boundsStore=new V.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new j.Z,this.featureAdapter=c.n}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let u=0;return this._featuresById.forEach(f=>{null!=f.geometry&&f.geometry.coords&&(u+=f.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:u/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(u){if(null==this.fullBounds)return null;const[f,T,Z,H]=this.fullBounds;return{xmin:f,ymin:T,xmax:Z,ymax:H,spatialReference:(0,C.S2)(u)}}add(u){this._add(u),this._emitChanged()}addMany(u){for(const f of u)this._add(f);this._emitChanged()}upsertMany(u){const f=u.map(T=>this._upsert(T));return this._emitChanged(),f.filter(F.pC)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(u){const f=this._featuresById.get(u);return f?(this._remove(f),this._emitChanged(),f):null}removeManyById(u){this._boundsStore.invalidateIndex();for(const f of u){const T=this._featuresById.get(f);T&&this._remove(T)}this._emitChanged()}forEachBounds(u,f){for(const T of u){const Z=this._boundsStore.get(T.objectId);Z&&f((0,R.JR)(M,Z))}}getFeature(u){return this._featuresById.get(u)}has(u){return this._featuresById.has(u)}forEach(u){this._featuresById.forEach(f=>u(f))}forEachInBounds(u,f){this._boundsStore.forEachInBounds(u,T=>{f(this._featuresById.get(T))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let u=!1;this._featuresById.forEach((f,T)=>{this._markedIds.has(T)||(u=!0,this._remove(f))}),this._markedIds.clear(),u&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(u){if(!u)return;const f=u.objectId;if(null==f)return void X.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new ee.Z("featurestore:invalid-feature","feature id is missing",{feature:u}));const T=this._featuresById.get(f);let Z;if(this._markedIds.add(f),T?(u.displayId=T.displayId,Z=this._boundsStore.get(f),this._boundsStore.delete(f)):null!=this.onFeatureAdd&&this.onFeatureAdd(u),!u.geometry?.coords?.length)return this._boundsStore.set(f,null),void this._featuresById.set(f,u);Z=(0,K.$)(Z??(0,U.Ue)(),u.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=Z&&this._boundsStore.set(f,Z),this._featuresById.set(f,u)}_upsert(u){const f=u?.objectId;if(null==f)return X.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new ee.Z("featurestore:invalid-feature","feature id is missing",{feature:u})),null;const T=this._featuresById.get(f);if(!T)return this._add(u),u;this._markedIds.add(f);const{geometry:Z,attributes:H}=u;for(const L in H)T.attributes[L]=H[L];return Z&&(T.geometry=Z,this._boundsStore.set(f,(0,K.$)((0,U.Ue)(),Z,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),T}_remove(u){null!=this.onFeatureRemove&&this.onFeatureRemove(u);const f=u.objectId;return this._markedIds.delete(f),this._boundsStore.delete(f),this._featuresById.delete(f),u}}},97454:(ce,k,h)=>{h.r(k),h.d(k,{default:()=>te});var F=h(15861),j=(h(2189),h(66476)),X=h(37636),R=h(51310),U=h(57964),K=h(4703),V=h(79412),C=h(6785),c=h(83821),M=h(27545),g=h(33721),w=h(48230),u=h(83502),f=h(62209),T=h(84726),Z=h(58829),H=h(48238),L=h(51937),Q=h(85295);const G=/^\s*"([\S\s]*)"\s*$/,J=/""/g,W="\n",ue=[","," ",";","|","\t"];function*me(p,l,s){let i=0;for(;i<=p.length;){const x=p.indexOf(l,i),y=p.substring(i,x>-1?x:void 0);i+=y.length+l.length,s&&!y.trim()||(yield y)}}function he(p){const l=p.includes("\r\n")?"\r\n":W;return me(p,l,!0)}function de(p,l){return me(p,l,!1)}function*d(p,l,s,i=(()=>Object.create(null))){const x=he(p);x.next();let y="",v="",O=0,P=i(),$=0;e:for(const ae of x){const se=de(ae,s);for(const re of se)if(y+=v+re,v="",O+=a(re),O%2==0){if(O>0){const le=G.exec(y);if(!le){P=i(),$=0,y="",O=0;continue e}P[l[$]]=le[1].replaceAll(J,'"'),$++}else P[l[$]]=y,$++;y="",O=0}else v=s;0===O?(yield P,P=i(),$=0):v=W}}function n(p,l){const s=o(p,l).filter(x=>null!=x),i=s.map(x=>(0,Q.q6)(x));for(let x=i.length-1;x>=0;x--)i[x]||(i.splice(x,1),s.splice(x,1));return{names:i,aliases:s}}function o(p,l){if(!p?.length)return[];const s=[];let i="",x="",y=0;const v=de(p,l);for(const O of v)if(i+=x+O,x="",y+=a(O),y%2==0){if(y>0){const P=G.exec(i);P&&s.push(P[1].replaceAll(J,'"'))}else s.push(i);i="",y=0}else x=l;return s}function a(p){let l=0,s=0;for(s=p.indexOf('"',s);s>=0;)l++,s=p.indexOf('"',s+1);return l}function _(p,l,s){l=(0,Q.q6)(l)?.toLowerCase(),s=(0,Q.q6)(s)?.toLowerCase();const i=p.map(v=>v.toLowerCase()),x=l?p[i.indexOf(l)]:null,y=s?p[i.indexOf(s)]:null;return{longitudeFieldName:x||p[i.indexOf(z.find(v=>i.includes(v)))],latitudeFieldName:y||p[i.indexOf(A.find(v=>i.includes(v)))]}}function E(p){if(!p.length)return"string";const l=/[^+\-.,0-9]/;return p.map(s=>{if(""!==s){if(!l.test(s)){let i=S(s);if(!isNaN(i))return/[.,]/.test(s)||!Number.isInteger(i)||i>214783647||i<-214783648?"double":"integer";if(s.includes("E")&&(i=Number(s),!Number.isNaN(i)||s.includes(",")&&(s=s.replace(",","."),i=Number(s),!Number.isNaN(i))))return"double"}return(0,R.of)(s)?"date":"string"}}).reduce((s,i)=>void 0===s?i:void 0===i?s:s===i?i:"string"===s||"string"===i?"string":"double"===s||"double"===i?"double":void 0)}const S=function(){const p=(0,L.lt)(),l=new RegExp("^"+p.regexp+"$"),s=new RegExp("["+p.group+"\\s\\xa0]","g"),i=p.factor;return x=>{const y=l.exec(x);if(p.factor=i,!y)return NaN;let v=y[1];if(!y[1]){if(!y[2])return NaN;v=y[2],p.factor*=-1}return v=v.replace(s,"").replace(p.decimal,"."),+v*p.factor}}(),A=["lat","latitude","latitude83","latdecdeg","lat_dd","y","ycenter","point_y"],z=["lon","lng","long","longitude","longitude83","longdecdeg","long_dd","x","xcenter","point_x"];var e=h(60324),t=h(40100),r=h(764),I=h(43814);const b=(0,e.bU)("esriGeometryPoint"),D=["csv"],N=[0,0];class q{constructor(l,s){this.x=l,this.y=s}}class te{constructor(){var l=this;this._queryEngine=null,this._snapshotFeatures=function(){var s=(0,F.Z)(function*(i){const x=yield l._fetch(i);return l._createFeatures(x)});return function(i){return s.apply(this,arguments)}}()}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}load(l,s={}){var i=this;return(0,F.Z)(function*(){i._loadOptions=l;const[x]=yield Promise.all([i._fetch(s.signal),i._checkProjection(l?.parsingOptions?.spatialReference)]),y=function ne(p,l){const s=l.parsingOptions||{},i={delimiter:s.delimiter,layerDefinition:null,locationInfo:{latitudeFieldName:s.latitudeField,longitudeFieldName:s.longitudeField}},x=i.layerDefinition={name:(0,C.vt)(l.url,D)||"csv",dateFieldsTimeReference:{timeZoneIANA:r.pt},drawingInfo:b,geometryType:"esriGeometryPoint",objectIdField:null,fields:[],timeInfo:s.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:s.spatialReference||{wkid:4326}}},y=he(p),v=y.next().value?.trim(),O=y.next().value?.trim();if(!v)throw new U.Z("csv-layer:empty-csv","CSV is empty",{csv:p});const{delimiter:P,locationInfo:$}=function fe(p,l,s){p=p.trim(),l=l?.trim();const i=[],x=Array.from(new Set([s?.delimiter,...ue])).filter(v=>null!=v);for(const v of x){const O=o(p,v).length,P=o(l,v).length??O;O>1&&i.push({weight:Math.min(O,P),delimiter:v})}const y=i.sort(({weight:v},{weight:O})=>O-v).map(({delimiter:v})=>v);for(const v of y){const O=_(n(p,v).names,s?.longitudeField,s?.latitudeField);if(O.longitudeFieldName&&O.latitudeFieldName)return{delimiter:v,locationInfo:O}}return{delimiter:y[0],locationInfo:null}}(v,O,s);if(!P)throw new U.Z("csv-layer:invalid-delimiter","Unable to detect the delimiter from CSV",{firstLine:v,secondLine:O,parsingOptions:s});if(!$)throw new U.Z("csv-layer:location-fields-not-found","Unable to identify latitude and longitude fields from the CSV file",{firstLine:v,secondLine:O,parsingOptions:s});i.locationInfo=$,i.delimiter=P;const{names:ae,aliases:se}=n(v,P),re=function m(p,l,s,i,x){const y=[],v=d(p,s,l),O=[];for(const P of v){if(10===O.length)break;O.push(P)}for(let P=0;P<s.length;P++){const $=s[P],ae=i[P];if($===x.longitudeFieldName||$===x.latitudeFieldName)y.push({name:$,type:"esriFieldTypeDouble",alias:ae});else{let se;switch(E(O.map(re=>re[$]))){case"integer":se="esriFieldTypeInteger";break;case"double":se="esriFieldTypeDouble";break;case"date":se="esriFieldTypeDate";break;default:se="esriFieldTypeString"}y.push({name:$,type:se,alias:ae,length:(0,Q.ZR)(se)})}}return y}(p,i.delimiter,ae,se,i.locationInfo);if(s.fields?.length){const Y=new t.Z(s.fields);for(const B of re){const oe=Y.get(B.name);oe&&Object.assign(B,oe)}}if(!re.some(Y=>"esriFieldTypeOID"===Y.type&&(x.objectIdField=Y.name,!0))){const Y={name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1};x.objectIdField=Y.name,re.unshift(Y)}x.fields=re;const le=new t.Z(x.fields);if(i.locationInfo&&(i.locationInfo.latitudeFieldName=le.get(i.locationInfo.latitudeFieldName).name,i.locationInfo.longitudeFieldName=le.get(i.locationInfo.longitudeFieldName).name),x.timeInfo){const Y=x.timeInfo;if(Y.startTimeField){const B=le.get(Y.startTimeField);B?(Y.startTimeField=B.name,B.type="esriFieldTypeDate"):Y.startTimeField=null}if(Y.endTimeField){const B=le.get(Y.endTimeField);B?(Y.endTimeField=B.name,B.type="esriFieldTypeDate"):Y.endTimeField=null}if(Y.trackIdField){const B=le.get(Y.trackIdField);Y.trackIdField=B?B.name:null}Y.startTimeField||Y.endTimeField||(x.timeInfo=null)}return i}(x,l);i._locationInfo=y.locationInfo,i._delimiter=y.delimiter,i._queryEngine=i._createQueryEngine(y);const v=yield i._createFeatures(x);i._queryEngine.featureStore.addMany(v);const{fullExtent:O,timeExtent:P}=yield i._queryEngine.fetchRecomputedExtents();if(y.layerDefinition.extent=O,P){const{start:$,end:ae}=P;y.layerDefinition.timeInfo.timeExtent=[$,ae]}return y})()}applyEdits(){return(0,F.Z)(function*(){throw new U.Z("csv-layer:editing-not-supported","applyEdits() is not supported on CSVLayer")})()}queryFeatures(l={},s={}){var i=this;return(0,F.Z)(function*(){return yield i._waitSnapshotComplete(),i._queryEngine.executeQuery(l,s.signal)})()}queryFeatureCount(l={},s={}){var i=this;return(0,F.Z)(function*(){return yield i._waitSnapshotComplete(),i._queryEngine.executeQueryForCount(l,s.signal)})()}queryObjectIds(l={},s={}){var i=this;return(0,F.Z)(function*(){return yield i._waitSnapshotComplete(),i._queryEngine.executeQueryForIds(l,s.signal)})()}queryExtent(l={},s={}){var i=this;return(0,F.Z)(function*(){return yield i._waitSnapshotComplete(),i._queryEngine.executeQueryForExtent(l,s.signal)})()}querySnapping(l,s={}){var i=this;return(0,F.Z)(function*(){return yield i._waitSnapshotComplete(),i._queryEngine.executeQueryForSnapping(l,s.signal)})()}refresh(l){var s=this;return(0,F.Z)(function*(){s._loadOptions.customParameters=l,s._snapshotTask?.abort(),s._snapshotTask=(0,X.vr)(s._snapshotFeatures),s._snapshotTask.promise.then(y=>{s._queryEngine.featureStore.clear(),y&&s._queryEngine.featureStore.addMany(y)},y=>{s._queryEngine.featureStore.clear(),(0,V.D_)(y)||K.Z.getLogger("esri.layers.CSVLayer").error(new U.Z("csv-layer:refresh","An error occurred during refresh",{error:y}))}),yield s._waitSnapshotComplete();const{fullExtent:i,timeExtent:x}=yield s._queryEngine.fetchRecomputedExtents();return{extent:i,timeExtent:x}})()}_waitSnapshotComplete(){var l=this;return(0,F.Z)(function*(){if(l._snapshotTask&&!l._snapshotTask.finished){try{yield l._snapshotTask.promise}catch{}return l._waitSnapshotComplete()}})()}_fetch(l){var s=this;return(0,F.Z)(function*(){const{url:i,customParameters:x}=s._loadOptions;if(!i)throw new U.Z("csv-layer:invalid-source","url not defined");const y=(0,C.mN)(i);return(yield(0,j.Z)(y.path,{query:{...y.query,...x},responseType:"text",signal:l})).data})()}_createQueryEngine(l){const{objectIdField:s,fields:i,extent:x,timeInfo:y}=l.layerDefinition,v=new T.Z({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1});return new H.q({fieldsIndex:t.Z.fromLayerJSON({fields:i,dateFieldsTimeReference:{timeZoneIANA:r.pt}}),geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,timeInfo:y,objectIdField:s,spatialReference:x.spatialReference||{wkid:4326},cacheSpatialQueries:!0,featureStore:v})}_createFeatures(l){var s=this;return(0,F.Z)(function*(){const{latitudeFieldName:i,longitudeFieldName:x}=s._locationInfo,{objectIdField:y,fieldsIndex:v,spatialReference:O}=s._queryEngine;let P=[];const $=[],ae=v.fields.filter(B=>B.name!==y).map(B=>B.name);let se=0;const re={};for(const B of v.fields)if("esriFieldTypeOID"!==B.type&&"esriFieldTypeGlobalID"!==B.type){const oe=(0,Q.os)(B);void 0!==oe&&(re[B.name]=oe)}const le=d(l,ae,s._delimiter,(0,e.Dm)(re,y));for(const B of le){const oe=s._parseCoordinateValue(B[i]),_e=s._parseCoordinateValue(B[x]);if(null!=_e&&null!=oe&&!isNaN(oe)&&!isNaN(_e)){B[i]=oe,B[x]=_e;for(const ie in B)if(ie!==i&&ie!==x)if(v.isDateField(ie))B[ie]=(0,R.sG)(B[ie]);else if(v.isNumericField(ie)){const pe=S(B[ie]);B[ie]=isNaN(pe)?null:pe}B[y]=se,se++,P.push(new q(_e,oe)),$.push(B)}}if(!(0,g.fS)({wkid:4326},O))if((0,g.sS)(O))for(const B of P)[B.x,B.y]=(0,w.hG)(B.x,B.y,N);else P=(0,c.projectMany)(M.N,P,I.Z.WGS84,O,null,null);const Y=[];for(let B=0;B<P.length;B++){const{x:oe,y:_e}=P[B],ie=$[B];ie[y]=B+1,Y.push(new u.u_(new f.Z([],[oe,_e]),ie,null,ie[y]))}return Y})()}_parseCoordinateValue(l){if(null==l||""===l)return null;let s=S(l);return(isNaN(s)||Math.abs(s)>181)&&(s=parseFloat(l)),s}_checkProjection(l){return(0,F.Z)(function*(){try{yield(0,Z._W)(g.YU,l)}catch{throw new U.Z("csv-layer:projection-not-supported","Projection not supported")}})()}}},60324:(ce,k,h)=>{h.d(k,{Dm:()=>V,Hq:()=>c,MS:()=>M,bU:()=>R});var F=h(14007),ee=h(34222),j=h(85559),X=h(19579);function R(g){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===g||"esriGeometryMultipoint"===g?X.I4:"esriGeometryPolyline"===g?X.ET:X.lF}}}const U=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let K=1;function V(g,w){if((0,F.Z)("esri-csp-restrictions"))return()=>({[w]:null,...g});try{let u=`this${C(w)} = null;`;for(const T in g)u+=`this${C(T)} = ${JSON.stringify(g[T])};`;const f=new Function(`\n      return class AttributesClass$${K++} {\n        constructor() {\n          ${u};\n        }\n      }\n    `)();return()=>new f}catch{return()=>({[w]:null,...g})}}function C(g){return U.test(g)?`.${g}`:`["${g}"]`}function c(g={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,ee.d9)(g)}}]}function M(g,w){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:g},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:w,supportsDelete:w,supportsEditing:w,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:w,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:j.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:w,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},19579:(ce,k,h)=>{h.d(k,{ET:()=>X,I4:()=>j,SQ:()=>F,X1:()=>ee,eG:()=>K,lF:()=>R,lj:()=>C,qP:()=>U,wW:()=>V});const F=[252,146,31,255],ee=[153,153,153,255],j={type:"esriSMS",style:"esriSMSCircle",size:6,color:F,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},X={type:"esriSLS",style:"esriSLSSolid",width:.75,color:F},R={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},U={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},K={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},V={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},C={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}}}]);