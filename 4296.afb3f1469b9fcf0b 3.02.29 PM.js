"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[4296],{6118:(A,y,t)=>{t.d(y,{JZ:()=>p,RL:()=>m,eY:()=>_});var s=t(15861),c=t(79412),n=t(92899),E=t(44406),o=t(93266),d=t(64456),C=t(98634),l=t(39237),r=t(17091),u=t(22784);function p(h){return h&&"render"in h}function m(h){const e=document.createElement("canvas");return e.width=h.width,e.height=h.height,h.render(e.getContext("2d")),e}class _ extends d.s{constructor(e=null,a=!1){super(),this.blendFunction="standard",this._sourceWidth=0,this._sourceHeight=0,this._textureInvalidated=!1,this._texture=null,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.immutable=a,this.source=e,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null),null!=this._uploadStatus&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)}get isSourceScaled(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}get height(){return void 0!==this._height?this._height:this._sourceHeight}set height(e){this._height=e}get source(){return this._source}set source(e){null==e&&null==this._source||(this._source=e,this.invalidateTexture(),this.requestRender())}get width(){return void 0!==this._width?this._width:this._sourceWidth}set width(e){this._width=e}beforeRender(e){super.beforeRender(e),this.updateTexture(e)}setSourceAsync(e,a){var i=this;return(0,s.Z)(function*(){null!=i._uploadStatus&&i._uploadStatus.controller.abort();const R=new AbortController,D=(0,c.hh)();return(0,c.$F)(a,()=>R.abort()),(0,c.$F)(R,M=>D.reject(M)),i._uploadStatus={controller:R,resolver:D},i.source=e,D.promise})()}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width))}updateTransitionProperties(e,a){e>=64&&(this.fadeTransitionEnabled=!1,this.inFadeTransition=!1),super.updateTransitionProperties(e,a)}setTransform(e){const a=(0,n.yR)(this.transforms.displayViewScreenMat3),[i,R]=e.toScreenNoRotation([0,0],[this.x,this.y]),D=this.resolution/this.pixelRatio/e.resolution,M=D*this.width,x=D*this.height,f=Math.PI*this.rotation/180;(0,n.Iu)(a,a,(0,o.al)(i,R)),(0,n.Iu)(a,a,(0,o.al)(M/2,x/2)),(0,n.U1)(a,a,-f),(0,n.Iu)(a,a,(0,o.al)(-M/2,-x/2)),(0,n.ex)(a,a,(0,o.al)(M,x)),(0,n.Jp)(this.transforms.displayViewScreenMat3,e.displayViewMat3,a)}setSamplingProfile(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))}bind(e,a){this._texture&&e.bindTexture(this._texture,a)}updateTexture({context:e,painter:a}){var i=this;return(0,s.Z)(function*(){if(!i._textureInvalidated)return;if(i._textureInvalidated=!1,i._texture||(i._texture=i._createTexture(e)),!i.source)return void i._texture.setData(null);i._texture.resize(i._sourceWidth,i._sourceHeight);const R=function P(h){return p(h)?h instanceof C.Z?h.getRenderedRasterPixels()?.renderedRasterPixels:m(h):h}(i.source);try{if(null!=i._uploadStatus){const{controller:D,resolver:M}=i._uploadStatus,x={signal:D.signal},{width:f,height:g}=i,v=i._texture;yield a.textureUploadManager.enqueueTextureUpdate({data:R,texture:v,width:f,height:g},x),M.resolve(),i._uploadStatus=null}else i._texture.setData(R);i.ready()}catch(D){(0,c.H9)(D)}})()}onDetach(){this.destroy()}_createTransforms(){return{displayViewScreenMat3:(0,E.Ue)()}}_createTexture(e){const a=this.immutable,i=new u.X;return i.internalFormat=a?l.lP.RGBA8:l.VI.RGBA,i.wrapMode=l.e8.CLAMP_TO_EDGE,i.isImmutable=a,i.width=this._sourceWidth,i.height=this._sourceHeight,new r.x(e,i)}}},98634:(A,y,t)=>{t.d(y,{Z:()=>s});class s{constructor(n,E,o){this.pixelBlock=n,this.extent=E,this.originalPixelBlock=o}get width(){return null!=this.pixelBlock?this.pixelBlock.width:0}get height(){return null!=this.pixelBlock?this.pixelBlock.height:0}render(n){const E=this.pixelBlock;if(null==E)return;const o=this.filter({extent:this.extent,pixelBlock:this.originalPixelBlock??E});if(null==o.pixelBlock)return;o.pixelBlock.maskIsAlpha&&(o.pixelBlock.premultiplyAlpha=!0);const d=o.pixelBlock.getAsRGBA(),C=n.createImageData(o.pixelBlock.width,o.pixelBlock.height);C.data.set(d),n.putImageData(C,0,0)}getRenderedRasterPixels(){const n=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});return null==n.pixelBlock?null:(n.pixelBlock.maskIsAlpha&&(n.pixelBlock.premultiplyAlpha=!0),{width:n.pixelBlock.width,height:n.pixelBlock.height,renderedRasterPixels:new Uint8Array(n.pixelBlock.getAsRGBA().buffer)})}}},16773:(A,y,t)=>{t.r(y),t.d(y,{default:()=>h});var s=t(15861),c=t(50484),n=t(4703),E=t(79412),o=t(80543),l=(t(14007),t(65311),t(10141)),r=t(81065),u=t(83124),p=t(87653),m=t(50145),P=t(32126);let _=class extends((0,P.Z)((0,u.y)(m.Z))){update(e){this._strategy.update(e).catch(a=>{(0,E.D_)(a)||n.Z.getLogger(this).error(a)}),this.notifyChange("updating")}attach(){this._bitmapContainer=new r.c,this.container.addChild(this._bitmapContainer),this._strategy=new p.Z({container:this._bitmapContainer,fetchSource:this.fetchBitmapData.bind(this),requestUpdate:this.requestUpdate.bind(this)})}detach(){this._strategy.destroy(),this._strategy=null,this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}viewChange(){}moveEnd(){this.requestUpdate()}fetchBitmapData(e,a,i){return this.layer.fetchImageBitmap(e,a,i)}doRefresh(){var e=this;return(0,s.Z)(function*(){e.requestUpdate()})()}isUpdating(){return this._strategy.updating||this.updateRequested}};(0,c._)([(0,o.Cb)()],_.prototype,"_strategy",void 0),(0,c._)([(0,o.Cb)()],_.prototype,"updating",void 0),_=(0,c._)([(0,l.j)("esri.views.2d.layers.BaseDynamicLayerView2D")],_);const h=_},83124:(A,y,t)=>{t.d(y,{y:()=>x});var _,s=t(50484),c=t(83944),n=t(18626),E=t(57964),o=t(77675),d=t(80543),u=(t(14007),t(4703),t(65311),t(10141)),p=t(85338),m=t(30640),P=t(38954);let h=_=class extends P.Z{constructor(f){super(f),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new _({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};(0,s._)([(0,d.Cb)({type:[Number,String],json:{write:!0}})],h.prototype,"left",void 0),(0,s._)([(0,d.Cb)({type:[Number,String],json:{write:!0}})],h.prototype,"right",void 0),(0,s._)([(0,d.Cb)({type:[Number,String],json:{write:!0}})],h.prototype,"top",void 0),(0,s._)([(0,d.Cb)({type:[Number,String],json:{write:!0}})],h.prototype,"bottom",void 0),h=_=(0,s._)([(0,u.j)("esri.views.layers.support.ClipRect")],h);const e=h;var a=t(87265);let i=class extends P.Z{constructor(f){super(f),this.type="path",this.path=[]}commitVersionProperties(){this.commitProperty("path")}};(0,s._)([(0,d.Cb)({type:[[[Number]]],json:{write:!0}})],i.prototype,"path",void 0),i=(0,s._)([(0,u.j)("esri.views.layers.support.Path")],i);const R=i;var D=t(64579);const M=c.Z.ofType({key:"type",base:null,typeMap:{rect:e,path:R,geometry:a.Z}}),x=f=>{let g=class extends f{constructor(){super(...arguments),this.attached=!1,this.clips=new M,this.highlightOptions=null,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1,this._visibleAtCurrentScale=!0}initialize(){const v=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&v&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new E.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new p.W),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([(0,o.YP)(()=>this.suspended,O=>{this.container&&(this.container.visible=!O)},o.tX),(0,o.YP)(()=>this.updateSuspended,O=>{this.view&&!O&&this.updateRequested&&this.view.requestUpdate()},o.tX),(0,o.YP)(()=>this.layer?.opacity??1,O=>{this.container&&(this.container.opacity=O)},o.tX),(0,o.YP)(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",O=>{this.container&&(this.container.blendMode=O)},o.tX),(0,o.YP)(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,O=>{this.container&&(this.container.effect=O)},o.tX),(0,o.YP)(()=>this.highlightOptions,O=>this.container.highlightOptions=O,o.tX),(0,o.on)(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)},o.tX),(0,o.YP)(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:O,scaleRange:U})=>{const T=(0,D.GB)(U,O);T!==this._visibleAtCurrentScale&&(this._visibleAtCurrentScale=T)},o.tX)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(O=>{O===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){const v=this.view?.spatialReference;return null==v||this.supportsSpatialReference(v)}get updating(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this._updatingHandles?.updating)}get visibleAtCurrentScale(){return this._visibleAtCurrentScale}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.updateSuspended||this.view.requestUpdate())}processUpdate(v){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",v),this.updateRequested&&!this.updateSuspended&&(this.updateRequested=!1,this.update(v))):this.updateRequested=!1}hitTest(v,B){return Promise.resolve(null)}supportsSpatialReference(v){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const v=super.getSuspendInfo(),B=!this.spatialReferenceSupported;return B&&(v.spatialReferenceNotSupported=B),v}addAttachHandles(v){this.addHandles(v,"attach")}};return(0,s._)([(0,d.Cb)()],g.prototype,"attached",void 0),(0,s._)([(0,d.Cb)({type:M,set(v){const B=(0,n.Z)(v,this._get("clips"),M);this._set("clips",B)}})],g.prototype,"clips",void 0),(0,s._)([(0,d.Cb)()],g.prototype,"container",void 0),(0,s._)([(0,d.Cb)({type:m.Z})],g.prototype,"highlightOptions",void 0),(0,s._)([(0,d.Cb)()],g.prototype,"moving",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],g.prototype,"spatialReferenceSupported",null),(0,s._)([(0,d.Cb)({readOnly:!0})],g.prototype,"updateParameters",void 0),(0,s._)([(0,d.Cb)()],g.prototype,"updateRequested",void 0),(0,s._)([(0,d.Cb)()],g.prototype,"updating",null),(0,s._)([(0,d.Cb)()],g.prototype,"view",void 0),(0,s._)([(0,d.Cb)()],g.prototype,"_visibleAtCurrentScale",void 0),(0,s._)([(0,d.Cb)({readOnly:!0})],g.prototype,"visibleAtCurrentScale",null),g=(0,s._)([(0,u.j)("esri.views.2d.layers.LayerView2D")],g),g}},50145:(A,y,t)=>{t.d(y,{Z:()=>h});var s=t(50484),c=t(73514),n=t(88278),E=t(84373),o=t(4703),d=t(51172),C=t(47868),l=t(80543),p=(t(14007),t(65311),t(10141)),m=t(90110),P=t(64579);let _=class extends((0,E.IG)((0,C.v)(n.Z.EventedMixin(c.Z)))){constructor(e){super(e),this._updatingHandles=new m.R,this.layer=null,this.parent=null}initialize(){this.when().catch(e=>{if("layerview:create-error"!==e.name){const a=this.layer&&this.layer.id||"no id",i=this.layer?.title||"no title";o.Z.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${i}', id: '${a}')`,e)}})}destroy(){this._updatingHandles=(0,d.SC)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome("visible",e)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){const e=this.view.timeExtent,a=this.layer?.visibilityTimeExtent;return!e||!a||!e.intersection(a).isEmpty}canResume(){const e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready&&(0,P.Cy)(e)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){const e=this.parent?.suspended?this.parent.suspendInfo:{};return this.view?.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),(0,P.Cy)(this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null)&&this.visibleAtCurrentScale||(e.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(e.outsideVisibilityTimeExtent=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};(0,s._)([(0,l.Cb)()],_.prototype,"view",void 0),(0,s._)([(0,l.Cb)()],_.prototype,"fullOpacity",null),(0,s._)([(0,l.Cb)()],_.prototype,"layer",void 0),(0,s._)([(0,l.Cb)()],_.prototype,"parent",void 0),(0,s._)([(0,l.Cb)({readOnly:!0})],_.prototype,"suspended",null),(0,s._)([(0,l.Cb)({readOnly:!0})],_.prototype,"suspendInfo",null),(0,s._)([(0,l.Cb)({readOnly:!0})],_.prototype,"legendEnabled",null),(0,s._)([(0,l.Cb)({type:Boolean,readOnly:!0})],_.prototype,"updating",null),(0,s._)([(0,l.Cb)({readOnly:!0})],_.prototype,"updatingProgress",null),(0,s._)([(0,l.Cb)()],_.prototype,"updateSuspended",null),(0,s._)([(0,l.Cb)()],_.prototype,"visible",null),(0,s._)([(0,l.Cb)({readOnly:!0})],_.prototype,"visibleAtCurrentScale",null),(0,s._)([(0,l.Cb)({readOnly:!0})],_.prototype,"visibleAtCurrentTimeExtent",null),_=(0,s._)([(0,p.j)("esri.views.layers.LayerView")],_);const h=_},32126:(A,y,t)=>{t.d(y,{Z:()=>r});var s=t(50484),c=t(4703),n=t(79412),E=t(77675),l=(t(14007),t(65311),t(57964),t(10141));const r=u=>{let p=class extends u{initialize(){this.addHandles((0,E.on)(()=>this.layer,"refresh",m=>{this.doRefresh(m.dataChanged).catch(P=>{(0,n.D_)(P)||c.Z.getLogger(this).error(P)})}),"RefreshableLayerView")}};return p=(0,s._)([(0,l.j)("esri.views.layers.RefreshableLayerView")],p),p}},38954:(A,y,t)=>{t.d(y,{Z:()=>r});var s=t(50484),c=t(89317),n=t(80543),C=(t(14007),t(4703),t(65311),t(10141));let l=class extends c.wq{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};(0,s._)([(0,n.Cb)({readOnly:!0})],l.prototype,"version",null),l=(0,s._)([(0,C.j)("esri.views.layers.support.ClipArea")],l);const r=l},87265:(A,y,t)=>{t.d(y,{Z:()=>e});var P,s=t(50484),n=(t(2189),t(80543)),C=(t(14007),t(4703),t(65311),t(10141)),l=t(32184),r=t(40637),u=t(38954),p=t(26894),m=t(5391);const _={base:l.Z,key:"type",typeMap:{extent:p.Z,polygon:m.Z}};let h=P=class extends u.Z{constructor(a){super(a),this.type="geometry",this.geometry=null}clone(){return new P({geometry:this.geometry?.clone()??null})}commitVersionProperties(){this.commitProperty("geometry")}};(0,s._)([(0,n.Cb)({types:_,json:{read:r.im,write:!0}})],h.prototype,"geometry",void 0),h=P=(0,s._)([(0,C.j)("esri.views.layers.support.Geometry")],h);const e=h},64579:(A,y,t)=>{function s(r){return r&&"function"==typeof r.highlight}function E(r,u){if(u&&r){const{minScale:p,maxScale:m}=r;if(function o(r,u){return null!=r&&r>0||null!=u&&u>0}(p,m))return function n(r,u,p){return null==r||r>=p&&(0===u||r<=u)}(u,p,m)}return!0}function d(r){return!r?.minScale||!r.maxScale||r.minScale>=r.maxScale}t.d(y,{Cy:()=>d,GB:()=>E,tl:()=>s})}}]);