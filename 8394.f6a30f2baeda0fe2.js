"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[8394],{11462:(j,D,e)=>{e.d(D,{I:()=>g,v:()=>h});var n=e(55117);function g(m,u,i=0){const I=(0,n.uZ)(m,0,s);for(let P=0;P<4;P++)u[i+P]=Math.floor(256*d(I*p[P]))}function h(m,u=0){let i=0;for(let I=0;I<4;I++)i+=m[u+I]*l[I];return i}const p=[1,256,65536,16777216],l=[1/256,1/65536,1/16777216,1/4294967296],s=h(new Uint8ClampedArray([255,255,255,255]));function d(m){return m-Math.floor(m)}},6118:(j,D,e)=>{e.d(D,{JZ:()=>I,RL:()=>P,eY:()=>E});var n=e(15861),g=e(79412),h=e(92899),p=e(44406),l=e(93266),s=e(64456),d=e(98634),m=e(39237),u=e(17091),i=e(22784);function I(x){return x&&"render"in x}function P(x){const a=document.createElement("canvas");return a.width=x.width,a.height=x.height,x.render(a.getContext("2d")),a}class E extends s.s{constructor(a=null,y=!1){super(),this.blendFunction="standard",this._sourceWidth=0,this._sourceHeight=0,this._textureInvalidated=!1,this._texture=null,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.immutable=y,this.source=a,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null),null!=this._uploadStatus&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)}get isSourceScaled(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}get height(){return void 0!==this._height?this._height:this._sourceHeight}set height(a){this._height=a}get source(){return this._source}set source(a){null==a&&null==this._source||(this._source=a,this.invalidateTexture(),this.requestRender())}get width(){return void 0!==this._width?this._width:this._sourceWidth}set width(a){this._width=a}beforeRender(a){super.beforeRender(a),this.updateTexture(a)}setSourceAsync(a,y){var c=this;return(0,n.Z)(function*(){null!=c._uploadStatus&&c._uploadStatus.controller.abort();const w=new AbortController,b=(0,g.hh)();return(0,g.$F)(y,()=>w.abort()),(0,g.$F)(w,O=>b.reject(O)),c._uploadStatus={controller:w,resolver:b},c.source=a,b.promise})()}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width))}updateTransitionProperties(a,y){a>=64&&(this.fadeTransitionEnabled=!1,this.inFadeTransition=!1),super.updateTransitionProperties(a,y)}setTransform(a){const y=(0,h.yR)(this.transforms.displayViewScreenMat3),[c,w]=a.toScreenNoRotation([0,0],[this.x,this.y]),b=this.resolution/this.pixelRatio/a.resolution,O=b*this.width,V=b*this.height,A=Math.PI*this.rotation/180;(0,h.Iu)(y,y,(0,l.al)(c,w)),(0,h.Iu)(y,y,(0,l.al)(O/2,V/2)),(0,h.U1)(y,y,-A),(0,h.Iu)(y,y,(0,l.al)(-O/2,-V/2)),(0,h.ex)(y,y,(0,l.al)(O,V)),(0,h.Jp)(this.transforms.displayViewScreenMat3,a.displayViewMat3,y)}setSamplingProfile(a){this._texture&&(a.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(a.samplingMode))}bind(a,y){this._texture&&a.bindTexture(this._texture,y)}updateTexture({context:a,painter:y}){var c=this;return(0,n.Z)(function*(){if(!c._textureInvalidated)return;if(c._textureInvalidated=!1,c._texture||(c._texture=c._createTexture(a)),!c.source)return void c._texture.setData(null);c._texture.resize(c._sourceWidth,c._sourceHeight);const w=function f(x){return I(x)?x instanceof d.Z?x.getRenderedRasterPixels()?.renderedRasterPixels:P(x):x}(c.source);try{if(null!=c._uploadStatus){const{controller:b,resolver:O}=c._uploadStatus,V={signal:b.signal},{width:A,height:M}=c,S=c._texture;yield y.textureUploadManager.enqueueTextureUpdate({data:w,texture:S,width:A,height:M},V),O.resolve(),c._uploadStatus=null}else c._texture.setData(w);c.ready()}catch(b){(0,g.H9)(b)}})()}onDetach(){this.destroy()}_createTransforms(){return{displayViewScreenMat3:(0,p.Ue)()}}_createTexture(a){const y=this.immutable,c=new i.X;return c.internalFormat=y?m.lP.RGBA8:m.VI.RGBA,c.wrapMode=m.e8.CLAMP_TO_EDGE,c.isImmutable=y,c.width=this._sourceWidth,c.height=this._sourceHeight,new u.x(a,c)}}},98634:(j,D,e)=>{e.d(D,{Z:()=>n});class n{constructor(h,p,l){this.pixelBlock=h,this.extent=p,this.originalPixelBlock=l}get width(){return null!=this.pixelBlock?this.pixelBlock.width:0}get height(){return null!=this.pixelBlock?this.pixelBlock.height:0}render(h){const p=this.pixelBlock;if(null==p)return;const l=this.filter({extent:this.extent,pixelBlock:this.originalPixelBlock??p});if(null==l.pixelBlock)return;l.pixelBlock.maskIsAlpha&&(l.pixelBlock.premultiplyAlpha=!0);const s=l.pixelBlock.getAsRGBA(),d=h.createImageData(l.pixelBlock.width,l.pixelBlock.height);d.data.set(s),h.putImageData(d,0,0)}getRenderedRasterPixels(){const h=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});return null==h.pixelBlock?null:(h.pixelBlock.maskIsAlpha&&(h.pixelBlock.premultiplyAlpha=!0),{width:h.pixelBlock.width,height:h.pixelBlock.height,renderedRasterPixels:new Uint8Array(h.pixelBlock.getAsRGBA().buffer)})}}},21357:(j,D,e)=>{e.r(D),e.d(D,{default:()=>ht});var n=e(15861),g=e(50484),h=e(26152),p=e(83944),l=e(51172),s=e(77675),d=e(6785),m=e(80543),P=(e(14007),e(4703),e(65311),e(10141)),f=e(26894),E=e(83821),x=e(43814),a=e(82001),y=e(15462),c=e(72262),w=e(6118),b=e(81065),O=e(83124),V=e(50800),A=e(37348),M=e(50145),S=e(66476),K=e(44107),R=e(89350),z=e(43106),H=e(61326),at=e(99273),X=e(39237),ot=e(83018),et=e(53387),lt=e(40631),it=e(17091),st=e(22784);let nt=(()=>{class o{constructor(t){if(this._ownsRctx=!1,t)this._ownsRctx=!1,this._rctx=t;else{if(o._instance)return o._instanceRefCount++,o._instance;o._instanceRefCount=1,o._instance=this,this._ownsRctx=!0;const _=document.createElement("canvas"),C=(0,at.k)(_);C.getExtension("OES_texture_float"),this._rctx=new lt.x(C,{})}const T=(0,H.s)("raster/reproject","raster/reproject",new Map([["a_position",0]]),{applyProjection:!0,bilinear:!1,bicubic:!1});this._program=this._rctx.programCache.acquire(T.shaders.vertexShader,T.shaders.fragmentShader,T.attributes),this._rctx.useProgram(this._program),this._program.setUniform1f("u_opacity",1),this._program.setUniform1i("u_image",0),this._program.setUniform1i("u_flipY",0),this._program.setUniform1i("u_transformGrid",1),this._quad=new z.Z(this._rctx,[0,0,1,0,0,1,1,1])}reprojectTexture(t,r,T=!1){const _=(0,E.project)(t.extent,r),C=new K.Z({x:(t.extent.xmax-t.extent.xmin)/t.texture.descriptor.width,y:(t.extent.ymax-t.extent.ymin)/t.texture.descriptor.height,spatialReference:t.extent.spatialReference}),{x:U,y:B}=(0,R.VO)(C,r,t.extent);let L=(U+B)/2;const N=Math.round((_.xmax-_.xmin)/L),W=Math.round((_.ymax-_.ymin)/L);L=(_.width/N+_.height/W)/2;const dt=new K.Z({x:L,y:L,spatialReference:_.spatialReference}),Q=(0,R.Qp)({projectedExtent:_,srcBufferExtent:t.extent,pixelSize:dt,hasWrapAround:!0,spacing:[16,16]}),J=(0,et.Br)(this._rctx,Q),k=new st.X(N,W);k.wrapMode=X.e8.CLAMP_TO_EDGE;const G=new ot.X(this._rctx,k);this._rctx.bindFramebuffer(G),this._rctx.setViewport(0,0,N,W),this._rctx.useProgram(this._program),this._rctx.bindTexture(t.texture,0),this._rctx.bindTexture(J,1),this._quad.bind();const{width:$=0,height:q=0}=t.texture.descriptor;if(this._program.setUniform2f("u_srcImageSize",$,q),this._program.setUniform2fv("u_transformSpacing",Q.spacing),this._program.setUniform2fv("u_transformGridSize",Q.size),this._program.setUniform2f("u_targetImageSize",N,W),this._quad.draw(),this._quad.unbind(),this._rctx.useProgram(null),this._rctx.bindFramebuffer(null),J.dispose(),T){const{width:tt,height:Y}=G,ut=new ImageData(tt??0,Y??0);G.readPixels(0,0,tt??0,Y??0,X.VI.RGBA,X.Br.UNSIGNED_BYTE,ut.data);const ct=G.detachColorTexture(X.VY.COLOR_ATTACHMENT0);return G.dispose(),{texture:ct,extent:_,imageData:ut}}const F=G.detachColorTexture(X.VY.COLOR_ATTACHMENT0);return G.dispose(),{texture:F,extent:_}}reprojectBitmapData(t,r){const T=(0,w.JZ)(t.bitmapData)?(0,w.RL)(t.bitmapData):t.bitmapData,_=new st.X;_.wrapMode=X.e8.CLAMP_TO_EDGE,_.width=t.bitmapData.width,_.height=t.bitmapData.height;const C=new it.x(this._rctx,_,T),U=this.reprojectTexture({texture:C,extent:t.extent},r,!0);U.texture.dispose();const B=document.createElement("canvas"),L=U.imageData;return B.width=L.width,B.height=L.height,B.getContext("2d").putImageData(L,0,0),{bitmapData:B,extent:U.extent}}loadAndReprojectBitmapData(t,r,T){var _=this;return(0,n.Z)(function*(){const C=(yield(0,S.Z)(t,{responseType:"image"})).data,U=document.createElement("canvas");U.width=C.width,U.height=C.height;const B=U.getContext("2d");B.drawImage(C,0,0);const L=B.getImageData(0,0,U.width,U.height);if(r.spatialReference.equals(T))return{bitmapData:L,extent:r};const N=_.reprojectBitmapData({bitmapData:L,extent:r},T);return{bitmapData:N.bitmapData,extent:N.extent}})()}destroy(){this._ownsRctx?(o._instanceRefCount--,0===o._instanceRefCount&&(this._quad.dispose(),this._program.dispose(),this._rctx.dispose(),o._instance=null)):(this._quad.dispose(),this._program.dispose())}}return o._instanceRefCount=0,o})();class rt{constructor(){this.allSublayers=new Map,this.allPoints=[],this.allPolylines=[],this.allPolygons=[],this.allMapImages=[]}}let Z=class extends((0,O.y)(M.Z)){constructor(){super(...arguments),this._bitmapIndex=new Map,this._mapImageContainer=new b.c,this._kmlVisualData=new rt,this._fetchController=null,this.allVisiblePoints=new c.J,this.allVisiblePolylines=new c.J,this.allVisiblePolygons=new c.J,this.allVisibleMapImages=new p.Z}hitTest(o,v){var t=this;return(0,n.Z)(function*(){const r=t.layer;return[t._pointsView?.hitTest(o),t._polylinesView?.hitTest(o),t._polygonsView?.hitTest(o)].flat().filter(Boolean).map(T=>(T.layer=r,T.sourceLayer=r,{type:"graphic",graphic:T,layer:r,mapPoint:o}))})()}update(o){this._polygonsView&&this._polygonsView.processUpdate(o),this._polylinesView&&this._polylinesView.processUpdate(o),this._pointsView&&this._pointsView.processUpdate(o)}attach(){this._fetchController=new AbortController,this.container.addChild(this._mapImageContainer),this._polygonsView=new A.Z({view:this.view,graphics:this.allVisiblePolygons,requestUpdateCallback:()=>this.requestUpdate(),container:new V.Z(this.view.featuresTilingScheme)}),this.container.addChild(this._polygonsView.container),this._polylinesView=new A.Z({view:this.view,graphics:this.allVisiblePolylines,requestUpdateCallback:()=>this.requestUpdate(),container:new V.Z(this.view.featuresTilingScheme)}),this.container.addChild(this._polylinesView.container),this._pointsView=new A.Z({view:this.view,graphics:this.allVisiblePoints,requestUpdateCallback:()=>this.requestUpdate(),container:new V.Z(this.view.featuresTilingScheme)}),this.container.addChild(this._pointsView.container),this.addAttachHandles([this.allVisibleMapImages.on("change",o=>{o.added.forEach(v=>this._addMapImage(v)),o.removed.forEach(v=>this._removeMapImage(v))}),(0,s.YP)(()=>this.layer.visibleSublayers,o=>{for(const[v,t]of this._kmlVisualData.allSublayers)t.visibility=0;for(const v of o){const t=this._kmlVisualData.allSublayers.get(v.id);t&&(t.visibility=1)}this._refreshCollections()})]),this._updatingHandles.addPromise(this._fetchService(this._fetchController.signal)),this._imageReprojector=new nt}detach(){this._fetchController=(0,l.IM)(this._fetchController),this._mapImageContainer.removeAllChildren(),this.container.removeAllChildren(),this._bitmapIndex.clear(),this._polygonsView=(0,l.SC)(this._polygonsView),this._polylinesView=(0,l.SC)(this._polylinesView),this._pointsView=(0,l.SC)(this._pointsView),this._imageReprojector=(0,l.SC)(this._imageReprojector)}viewChange(){this._polygonsView.viewChange(),this._polylinesView.viewChange(),this._pointsView.viewChange()}moveEnd(){}isUpdating(){return this._pointsView.updating||this._polygonsView.updating||this._polylinesView.updating}_addMapImage(o){(this.view.spatialReference?.isWGS84||this.view.spatialReference?.isWebMercator)&&this._imageReprojector.loadAndReprojectBitmapData(o.href,f.Z.fromJSON(o.extent),this.view.spatialReference).then(v=>{const t=new w.eY(v.bitmapData);t.x=v.extent.xmin,t.y=v.extent.ymax,t.resolution=v.extent.width/v.bitmapData.width,t.rotation=o.rotation,this._mapImageContainer.addChild(t),this._bitmapIndex.set(o,t)})}_getViewDependentUrl(o,v){return(0,n.Z)(function*(){const{viewFormat:t,viewBoundScale:r,httpQuery:T}=o;if(null!=t){if(null==v)throw new Error("Loading this network link requires a view state.");let _;if(yield(0,E.load)(),null!=r&&1!==r){const F=new f.Z(v.extent);F.expand(r),_=F}else _=v.extent;_=(0,E.project)(_,x.Z.WGS84);const C=(0,E.project)(_,x.Z.WebMercator),U=_.xmin,B=_.xmax,L=_.ymin,N=_.ymax,W=v.size[0]*v.pixelRatio,dt=v.size[1]*v.pixelRatio,Q=Math.max(C.width,C.height),J={"[bboxWest]":U.toString(),"[bboxEast]":B.toString(),"[bboxSouth]":L.toString(),"[bboxNorth]":N.toString(),"[lookatLon]":_.center.x.toString(),"[lookatLat]":_.center.y.toString(),"[lookatRange]":Q.toString(),"[lookatTilt]":"0","[lookatHeading]":v.rotation.toString(),"[lookatTerrainLon]":_.center.x.toString(),"[lookatTerrainLat]":_.center.y.toString(),"[lookatTerrainAlt]":"0","[cameraLon]":_.center.x.toString(),"[cameraLat]":_.center.y.toString(),"[cameraAlt]":Q.toString(),"[horizFov]":"60","[vertFov]":"60","[horizPixels]":W.toString(),"[vertPixels]":dt.toString(),"[terrainEnabled]":"0","[clientVersion]":h.i8,"[kmlVersion]":"2.2","[clientName]":"ArcGIS API for JavaScript","[language]":"en-US"},k=F=>{for(const tt in F){let Y;for(Y in J)F[tt]=F[tt].replace(Y,J[Y])}},G=(0,d.u0)(t);k(G);let $={};null!=T&&($=(0,d.u0)(T),k($));const q=(0,y.en)(o.href);return q.query={...q.query,...G,...$},`${q.path}?${(0,d.B7)(G)}`}return o.href})()}_fetchService(o){var v=this;return(0,n.Z)(function*(){const t=new rt;yield v._loadVisualData(v.layer.url,t,o),v._kmlVisualData=t,v._refreshCollections()})()}_refreshCollections(){this.allVisiblePoints.removeAll(),this.allVisiblePolylines.removeAll(),this.allVisiblePolygons.removeAll(),this.allVisibleMapImages.removeAll(),this.allVisiblePoints.addMany(this._kmlVisualData.allPoints.filter(o=>this._isSublayerVisible(o.sublayerId)).map(({item:o})=>o)),this.allVisiblePolylines.addMany(this._kmlVisualData.allPolylines.filter(o=>this._isSublayerVisible(o.sublayerId)).map(({item:o})=>o)),this.allVisiblePolygons.addMany(this._kmlVisualData.allPolygons.filter(o=>this._isSublayerVisible(o.sublayerId)).map(({item:o})=>o)),this.allVisibleMapImages.addMany(this._kmlVisualData.allMapImages.filter(o=>this._isSublayerVisible(o.sublayerId)).map(({item:o})=>o))}_isSublayerVisible(o){const v=this._kmlVisualData.allSublayers.get(o);return!!v?.visibility&&(-1===v.parentFolderId||this._isSublayerVisible(v.parentFolderId))}_loadVisualData(o,v,t){var r=this;return this._fetchParsedKML(o,t).then(function(){var T=(0,n.Z)(function*(_){for(const C of _.sublayers){v.allSublayers.set(C.id,C);const U=C.points?yield(0,a.Yu)(C.points):[],B=C.polylines?yield(0,a.Yu)(C.polylines):[],L=C.polygons?yield(0,a.Yu)(C.polygons):[],N=C.mapImages||[];if(v.allPoints.push(...U.map(W=>({item:W,sublayerId:C.id}))),v.allPolylines.push(...B.map(W=>({item:W,sublayerId:C.id}))),v.allPolygons.push(...L.map(W=>({item:W,sublayerId:C.id}))),v.allMapImages.push(...N.map(W=>({item:W,sublayerId:C.id}))),C.networkLink){const W=yield r._getViewDependentUrl(C.networkLink,r.view.state);yield r._loadVisualData(W,v,t)}}});return function(_){return T.apply(this,arguments)}}())}_fetchParsedKML(o,v){return(0,a.CS)(o,this.layer.spatialReference,this.layer.refreshInterval,v).then(t=>(0,a.Cw)(t.data))}_removeMapImage(o){const v=this._bitmapIndex.get(o);v&&(this._mapImageContainer.removeChild(v),this._bitmapIndex.delete(o))}};(0,g._)([(0,m.Cb)()],Z.prototype,"_pointsView",void 0),(0,g._)([(0,m.Cb)()],Z.prototype,"_polylinesView",void 0),(0,g._)([(0,m.Cb)()],Z.prototype,"_polygonsView",void 0),(0,g._)([(0,m.Cb)()],Z.prototype,"updating",void 0),Z=(0,g._)([(0,P.j)("esri.views.2d.layers.KMLLayerView2D")],Z);const ht=Z},83124:(j,D,e)=>{e.d(D,{y:()=>V});var E,n=e(50484),g=e(83944),h=e(18626),p=e(57964),l=e(77675),s=e(80543),i=(e(14007),e(4703),e(65311),e(10141)),I=e(85338),P=e(30640),f=e(38954);let x=E=class extends f.Z{constructor(A){super(A),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new E({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};(0,n._)([(0,s.Cb)({type:[Number,String],json:{write:!0}})],x.prototype,"left",void 0),(0,n._)([(0,s.Cb)({type:[Number,String],json:{write:!0}})],x.prototype,"right",void 0),(0,n._)([(0,s.Cb)({type:[Number,String],json:{write:!0}})],x.prototype,"top",void 0),(0,n._)([(0,s.Cb)({type:[Number,String],json:{write:!0}})],x.prototype,"bottom",void 0),x=E=(0,n._)([(0,i.j)("esri.views.layers.support.ClipRect")],x);const a=x;var y=e(87265);let c=class extends f.Z{constructor(A){super(A),this.type="path",this.path=[]}commitVersionProperties(){this.commitProperty("path")}};(0,n._)([(0,s.Cb)({type:[[[Number]]],json:{write:!0}})],c.prototype,"path",void 0),c=(0,n._)([(0,i.j)("esri.views.layers.support.Path")],c);const w=c;var b=e(64579);const O=g.Z.ofType({key:"type",base:null,typeMap:{rect:a,path:w,geometry:y.Z}}),V=A=>{let M=class extends A{constructor(){super(...arguments),this.attached=!1,this.clips=new O,this.highlightOptions=null,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1,this._visibleAtCurrentScale=!0}initialize(){const S=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&S&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new p.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new I.W),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([(0,l.YP)(()=>this.suspended,R=>{this.container&&(this.container.visible=!R)},l.tX),(0,l.YP)(()=>this.updateSuspended,R=>{this.view&&!R&&this.updateRequested&&this.view.requestUpdate()},l.tX),(0,l.YP)(()=>this.layer?.opacity??1,R=>{this.container&&(this.container.opacity=R)},l.tX),(0,l.YP)(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",R=>{this.container&&(this.container.blendMode=R)},l.tX),(0,l.YP)(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,R=>{this.container&&(this.container.effect=R)},l.tX),(0,l.YP)(()=>this.highlightOptions,R=>this.container.highlightOptions=R,l.tX),(0,l.on)(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)},l.tX),(0,l.YP)(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:R,scaleRange:z})=>{const H=(0,b.GB)(z,R);H!==this._visibleAtCurrentScale&&(this._visibleAtCurrentScale=H)},l.tX)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(R=>{R===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){const S=this.view?.spatialReference;return null==S||this.supportsSpatialReference(S)}get updating(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this._updatingHandles?.updating)}get visibleAtCurrentScale(){return this._visibleAtCurrentScale}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.updateSuspended||this.view.requestUpdate())}processUpdate(S){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",S),this.updateRequested&&!this.updateSuspended&&(this.updateRequested=!1,this.update(S))):this.updateRequested=!1}hitTest(S,K){return Promise.resolve(null)}supportsSpatialReference(S){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const S=super.getSuspendInfo(),K=!this.spatialReferenceSupported;return K&&(S.spatialReferenceNotSupported=K),S}addAttachHandles(S){this.addHandles(S,"attach")}};return(0,n._)([(0,s.Cb)()],M.prototype,"attached",void 0),(0,n._)([(0,s.Cb)({type:O,set(S){const K=(0,h.Z)(S,this._get("clips"),O);this._set("clips",K)}})],M.prototype,"clips",void 0),(0,n._)([(0,s.Cb)()],M.prototype,"container",void 0),(0,n._)([(0,s.Cb)({type:P.Z})],M.prototype,"highlightOptions",void 0),(0,n._)([(0,s.Cb)()],M.prototype,"moving",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],M.prototype,"spatialReferenceSupported",null),(0,n._)([(0,s.Cb)({readOnly:!0})],M.prototype,"updateParameters",void 0),(0,n._)([(0,s.Cb)()],M.prototype,"updateRequested",void 0),(0,n._)([(0,s.Cb)()],M.prototype,"updating",null),(0,n._)([(0,s.Cb)()],M.prototype,"view",void 0),(0,n._)([(0,s.Cb)()],M.prototype,"_visibleAtCurrentScale",void 0),(0,n._)([(0,s.Cb)({readOnly:!0})],M.prototype,"visibleAtCurrentScale",null),M=(0,n._)([(0,i.j)("esri.views.2d.layers.LayerView2D")],M),M}},53299:(j,D,e)=>{e.d(D,{H:()=>h,K:()=>g});const g=class n{};function h(p,...l){let s="";for(let d=0;d<l.length;d++)s+=p[d]+l[d];return s+=p[p.length-1],s}var p;(p=h||(h={})).int=function l(d){return Math.round(d).toString()},p.float=function s(d){return d.toPrecision(8)}},15182:(j,D,e)=>{var n,g,h,p,l,s,d,m,u,i;e.d(D,{Gv:()=>g,Iq:()=>m,JJ:()=>d,Rw:()=>p,Ti:()=>u,V_:()=>s,Vr:()=>n,Xx:()=>h,hU:()=>l}),(i=n||(n={}))[i.None=0]="None",i[i.Front=1]="Front",i[i.Back=2]="Back",i[i.COUNT=3]="COUNT",function(i){i[i.Less=0]="Less",i[i.Lequal=1]="Lequal",i[i.COUNT=2]="COUNT"}(g||(g={})),function(i){i[i.BACKGROUND=0]="BACKGROUND",i[i.UPDATE=1]="UPDATE"}(h||(h={})),function(i){i[i.NOT_LOADED=0]="NOT_LOADED",i[i.LOADING=1]="LOADING",i[i.LOADED=2]="LOADED"}(p||(p={})),function(i){i[i.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",i[i.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(l||(l={})),function(i){i[i.Highlight=0]="Highlight",i[i.MaskOccludee=1]="MaskOccludee",i[i.COUNT=2]="COUNT"}(s||(s={})),function(i){i[i.Blend=0]="Blend",i[i.Opaque=1]="Opaque",i[i.Mask=2]="Mask",i[i.MaskBlend=3]="MaskBlend",i[i.COUNT=4]="COUNT"}(d||(d={})),function(i){i[i.OFF=0]="OFF",i[i.ON=1]="ON"}(m||(m={})),function(i){i.DDS_ENCODING="image/vnd-ms.dds",i.KTX2_ENCODING="image/ktx2",i.BASIS_ENCODING="image/x.basis"}(u||(u={}))},50145:(j,D,e)=>{e.d(D,{Z:()=>x});var n=e(50484),g=e(73514),h=e(88278),p=e(84373),l=e(4703),s=e(51172),d=e(47868),m=e(80543),I=(e(14007),e(65311),e(10141)),P=e(90110),f=e(64579);let E=class extends((0,p.IG)((0,d.v)(h.Z.EventedMixin(g.Z)))){constructor(a){super(a),this._updatingHandles=new P.R,this.layer=null,this.parent=null}initialize(){this.when().catch(a=>{if("layerview:create-error"!==a.name){const y=this.layer&&this.layer.id||"no id",c=this.layer?.title||"no title";l.Z.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${c}', id: '${y}')`,a)}})}destroy(){this._updatingHandles=(0,s.SC)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(a){this._overrideIfSome("visible",a)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){const a=this.view.timeExtent,y=this.layer?.visibilityTimeExtent;return!a||!y||!a.intersection(y).isEmpty}canResume(){const a=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready&&(0,f.Cy)(a)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){const a=this.parent?.suspended?this.parent.suspendInfo:{};return this.view?.ready||(a.viewNotReady=!0),this.layer&&this.layer.loaded||(a.layerNotLoaded=!0),(0,f.Cy)(this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null)&&this.visibleAtCurrentScale||(a.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(a.outsideVisibilityTimeExtent=!0),this.visible||(a.layerInvisible=!0),a}isUpdating(){return!1}};(0,n._)([(0,m.Cb)()],E.prototype,"view",void 0),(0,n._)([(0,m.Cb)()],E.prototype,"fullOpacity",null),(0,n._)([(0,m.Cb)()],E.prototype,"layer",void 0),(0,n._)([(0,m.Cb)()],E.prototype,"parent",void 0),(0,n._)([(0,m.Cb)({readOnly:!0})],E.prototype,"suspended",null),(0,n._)([(0,m.Cb)({readOnly:!0})],E.prototype,"suspendInfo",null),(0,n._)([(0,m.Cb)({readOnly:!0})],E.prototype,"legendEnabled",null),(0,n._)([(0,m.Cb)({type:Boolean,readOnly:!0})],E.prototype,"updating",null),(0,n._)([(0,m.Cb)({readOnly:!0})],E.prototype,"updatingProgress",null),(0,n._)([(0,m.Cb)()],E.prototype,"updateSuspended",null),(0,n._)([(0,m.Cb)()],E.prototype,"visible",null),(0,n._)([(0,m.Cb)({readOnly:!0})],E.prototype,"visibleAtCurrentScale",null),(0,n._)([(0,m.Cb)({readOnly:!0})],E.prototype,"visibleAtCurrentTimeExtent",null),E=(0,n._)([(0,I.j)("esri.views.layers.LayerView")],E);const x=E},38954:(j,D,e)=>{e.d(D,{Z:()=>u});var n=e(50484),g=e(89317),h=e(80543),d=(e(14007),e(4703),e(65311),e(10141));let m=class extends g.wq{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};(0,n._)([(0,h.Cb)({readOnly:!0})],m.prototype,"version",null),m=(0,n._)([(0,d.j)("esri.views.layers.support.ClipArea")],m);const u=m},87265:(j,D,e)=>{e.d(D,{Z:()=>a});var f,n=e(50484),h=(e(2189),e(80543)),d=(e(14007),e(4703),e(65311),e(10141)),m=e(32184),u=e(40637),i=e(38954),I=e(26894),P=e(5391);const E={base:m.Z,key:"type",typeMap:{extent:I.Z,polygon:P.Z}};let x=f=class extends i.Z{constructor(y){super(y),this.type="geometry",this.geometry=null}clone(){return new f({geometry:this.geometry?.clone()??null})}commitVersionProperties(){this.commitProperty("geometry")}};(0,n._)([(0,h.Cb)({types:E,json:{read:u.im,write:!0}})],x.prototype,"geometry",void 0),x=f=(0,n._)([(0,d.j)("esri.views.layers.support.Geometry")],x);const a=x},64579:(j,D,e)=>{function n(u){return u&&"function"==typeof u.highlight}function p(u,i){if(i&&u){const{minScale:I,maxScale:P}=u;if(function l(u,i){return null!=u&&u>0||null!=i&&i>0}(I,P))return function h(u,i,I){return null==u||u>=I&&(0===i||u<=i)}(i,I,P)}return!0}function s(u){return!u?.minScale||!u.maxScale||u.minScale>=u.maxScale}e.d(D,{Cy:()=>s,GB:()=>p,tl:()=>n})},89437:(j,D,e)=>{e.d(D,{G:()=>g});var n=e(51172);class g{constructor(){this._result=!1}dispose(){this._program=(0,n.M2)(this._program)}get result(){return null!=this._program&&(this._result=this._test(this._program),this.dispose()),this._result}}},13646:(j,D,e)=>{e.d(D,{mO:()=>h});class n{constructor(l,s,d,m,u,i,I,P,f){this.createQuery=l,this.deleteQuery=s,this.resultAvailable=d,this.getResult=m,this.disjoint=u,this.beginTimeElapsed=i,this.endTimeElapsed=I,this.createTimestamp=P,this.timestampBits=f}}let g=!1;function h(p,l){if(l.disjointTimerQuery)return null;let s=p.getExtension("EXT_disjoint_timer_query_webgl2");return s?new n(()=>p.createQuery(),d=>{p.deleteQuery(d),g=!1},d=>p.getQueryParameter(d,p.QUERY_RESULT_AVAILABLE),d=>p.getQueryParameter(d,p.QUERY_RESULT),()=>p.getParameter(s.GPU_DISJOINT_EXT),d=>{g||(g=!0,p.beginQuery(s.TIME_ELAPSED_EXT,d))},()=>{p.endQuery(s.TIME_ELAPSED_EXT),g=!1},d=>s.queryCounterEXT(d,s.TIMESTAMP_EXT),()=>p.getQuery(s.TIMESTAMP_EXT,s.QUERY_COUNTER_BITS_EXT)):(s=p.getExtension("EXT_disjoint_timer_query"),s?new n(()=>s.createQueryEXT(),d=>{s.deleteQueryEXT(d),g=!1},d=>s.getQueryObjectEXT(d,s.QUERY_RESULT_AVAILABLE_EXT),d=>s.getQueryObjectEXT(d,s.QUERY_RESULT_EXT),()=>p.getParameter(s.GPU_DISJOINT_EXT),d=>{g||(g=!0,s.beginQueryEXT(s.TIME_ELAPSED_EXT,d))},()=>{s.endQueryEXT(s.TIME_ELAPSED_EXT),g=!1},d=>s.queryCounterEXT(d,s.TIMESTAMP_EXT),()=>s.getQueryEXT(s.TIMESTAMP_EXT,s.QUERY_COUNTER_BITS_EXT)):null)}},89877:(j,D,e)=>{e.d(D,{BK:()=>u,LZ:()=>m,if:()=>h,jp:()=>v,sm:()=>w,wK:()=>p,zp:()=>d});var n=e(15182),g=e(39237);function h(t,r,T=g.db.ADD,_=[0,0,0,0]){return{srcRgb:t,srcAlpha:t,dstRgb:r,dstAlpha:r,opRgb:T,opAlpha:T,color:{r:_[0],g:_[1],b:_[2],a:_[3]}}}function p(t,r,T,_,C=g.db.ADD,U=g.db.ADD,B=[0,0,0,0]){return{srcRgb:t,srcAlpha:r,dstRgb:T,dstAlpha:_,opRgb:C,opAlpha:U,color:{r:B[0],g:B[1],b:B[2],a:B[3]}}}const l={face:g.LR.BACK,mode:g.Wf.CCW},s={face:g.LR.FRONT,mode:g.Wf.CCW},d=t=>t===n.Vr.Back?l:t===n.Vr.Front?s:null,m={zNear:0,zFar:1},u={r:!0,g:!0,b:!0,a:!0};function i(t){return V.intern(t)}function I(t){return M.intern(t)}function P(t){return K.intern(t)}function f(t){return z.intern(t)}function E(t){return at.intern(t)}function x(t){return ot.intern(t)}function a(t){return lt.intern(t)}function y(t){return st.intern(t)}function c(t){return rt.intern(t)}function w(t){return ht.intern(t)}class b{constructor(r,T){this._makeKey=r,this._makeRef=T,this._interns=new Map}intern(r){if(!r)return null;const T=this._makeKey(r),_=this._interns;return _.has(T)||_.set(T,this._makeRef(r)),_.get(T)??null}}function O(t){return"["+t.join(",")+"]"}const V=new b(A,t=>({__tag:"Blending",...t}));function A(t){return t?O([t.srcRgb,t.srcAlpha,t.dstRgb,t.dstAlpha,t.opRgb,t.opAlpha,t.color.r,t.color.g,t.color.b,t.color.a]):null}const M=new b(S,t=>({__tag:"Culling",...t}));function S(t){return t?O([t.face,t.mode]):null}const K=new b(R,t=>({__tag:"PolygonOffset",...t}));function R(t){return t?O([t.factor,t.units]):null}const z=new b(H,t=>({__tag:"DepthTest",...t}));function H(t){return t?O([t.func]):null}const at=new b(X,t=>({__tag:"StencilTest",...t}));function X(t){return t?O([t.function.func,t.function.ref,t.function.mask,t.operation.fail,t.operation.zFail,t.operation.zPass]):null}const ot=new b(et,t=>({__tag:"DepthWrite",...t}));function et(t){return t?O([t.zNear,t.zFar]):null}const lt=new b(it,t=>({__tag:"ColorWrite",...t}));function it(t){return t?O([t.r,t.g,t.b,t.a]):null}const st=new b(nt,t=>({__tag:"StencilWrite",...t}));function nt(t){return t?O([t.mask]):null}const rt=new b(Z,t=>({__tag:"DrawBuffers",...t}));function Z(t){return t?O(t.buffers):null}const ht=new b(function o(t){return t?O([A(t.blending),S(t.culling),R(t.polygonOffset),H(t.depthTest),X(t.stencilTest),et(t.depthWrite),it(t.colorWrite),nt(t.stencilWrite),Z(t.drawBuffers)]):null},t=>({blending:i(t.blending),culling:I(t.culling),polygonOffset:P(t.polygonOffset),depthTest:f(t.depthTest),stencilTest:E(t.stencilTest),depthWrite:x(t.depthWrite),colorWrite:a(t.colorWrite),stencilWrite:y(t.stencilWrite),drawBuffers:c(t.drawBuffers)}));class v{constructor(r){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._drawBuffersInvalid=!0,this._stateSetters=r}setPipeline(r){(this._pipelineInvalid||r!==this._pipeline)&&(this._setBlending(r.blending),this._setCulling(r.culling),this._setPolygonOffset(r.polygonOffset),this._setDepthTest(r.depthTest),this._setStencilTest(r.stencilTest),this._setDepthWrite(r.depthWrite),this._setColorWrite(r.colorWrite),this._setStencilWrite(r.stencilWrite),this._setDrawBuffers(r.drawBuffers),this._pipeline=r),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDrawBuffers(){this._drawBuffersInvalid=!0,this._pipelineInvalid=!0}_setBlending(r){this._blending=this._setSubState(r,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}_setCulling(r){this._culling=this._setSubState(r,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}_setPolygonOffset(r){this._polygonOffset=this._setSubState(r,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}_setDepthTest(r){this._depthTest=this._setSubState(r,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}_setStencilTest(r){this._stencilTest=this._setSubState(r,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}_setDepthWrite(r){this._depthWrite=this._setSubState(r,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}_setColorWrite(r){this._colorWrite=this._setSubState(r,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}_setStencilWrite(r){this._stencilWrite=this._setSubState(r,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}_setDrawBuffers(r){this._drawBuffers=this._setSubState(r,this._drawBuffers,this._drawBuffersInvalid,this._stateSetters.setDrawBuffers),this._drawBuffersInvalid=!1}_setSubState(r,T,_,C){return(_||r!==T)&&(C(r),this._pipelineInvalid=!0),r}}},90771:(j,D,e)=>{e.d(D,{d:()=>u});var n=e(40176),g=e(39853),h=e(39237),p=e(83018),l=e(17091),s=e(22784),d=e(46682),m=e(89437);class u extends m.G{constructor(P){super(),this._rctx=P,this._program=P.programCache.acquire("\n    precision highp float;\n\n    attribute vec2 a_pos;\n    varying vec2 v_uv;\n\n    void main() {\n      v_uv = a_pos;\n      gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ","\n    precision highp float;\n\n    varying vec2 v_uv;\n\n    uniform sampler2D u_texture;\n\n    void main() {\n      gl_FragColor = texture2D(u_texture, v_uv);\n    }\n    ",new Map([["a_pos",0]]))}dispose(){super.dispose()}_test(P){const f=this._rctx;if(!f.gl)return P.dispose(),!0;const E=new s.X(1);E.wrapMode=h.e8.CLAMP_TO_EDGE,E.samplingMode=h.cw.NEAREST;const x=new p.X(f,E),a=g.f.createVertex(f,h.l1.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),y=new d.U(f,new Map([["a_pos",0]]),n.cD,{geometry:a}),c=new s.X;c.samplingMode=h.cw.LINEAR,c.wrapMode=h.e8.CLAMP_TO_EDGE;const w=new l.x(f,c,i);f.useProgram(P),f.bindTexture(w,0),P.setUniform1i("u_texture",0);const b=f.getBoundFramebufferObject(),{x:O,y:V,width:A,height:M}=f.getViewport();f.bindFramebuffer(x),f.setViewport(0,0,1,1),f.setClearColor(0,0,0,0),f.setBlendingEnabled(!1),f.clear(h.lk.COLOR_BUFFER_BIT),f.bindVAO(y),f.drawArrays(h.MX.TRIANGLE_STRIP,0,4);const S=new Uint8Array(4);return x.readPixels(0,0,1,1,h.VI.RGBA,h.Br.UNSIGNED_BYTE,S),y.dispose(),x.dispose(),w.dispose(),f.setViewport(O,V,A,M),f.bindFramebuffer(b),255!==S[0]}}const i=new Image;i.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",i.width=5,i.height=5,i.decode()}}]);