"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[4176],{19939:(dt,it,E)=>{E.d(it,{E:()=>W});const H=new(E(56715).Z);function W(A){if(null==A)return["",!1];if(!H.hasBidiChar(A))return[A,!1];let U;return U="rtl"===H.checkContextual(A)?"IDNNN":"ICNNN",[H.bidiTransform(A,U,"VLYSN"),!0]}},56123:(dt,it,E)=>{E.d(it,{BN:()=>n,Yc:()=>r,em:()=>W,mx:()=>u});var q=E(15861),H=E(11931);const W="arial-unicode-ms",A="woff2",U=new Map,S=new Set;class y{constructor(M,I){this.fontFace=M,this.promise=I}}function u(p){return m.apply(this,arguments)}function m(){return(m=(0,q.Z)(function*(p){const M=function o(p){const M=e(p)+h(p);return(p.family||W)+(M.length>0?M:"-regular")}(p),I=r(p),T=U.get(M);if(T)return T.promise;const B=new FontFace(p.family,`url('${H.default.fontsUrl}/woff2/${I}.${A}') format('${A}')`,{style:p.style,weight:p.weight}),F=document.fonts;if(F.has(B)&&"loading"===B.status)return B.loaded;const X=B.load().then(()=>(F.add(B),B));return U.set(M,new y(B,X)),S.add(B),X})).apply(this,arguments)}function n(p){if(!p)return W;const M=p.toLowerCase().split(" ").join("-");switch(M){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return M}}function r(p){const M=e(p)+h(p);return n(p.family)+(M.length>0?M:"-regular")}function e(p){if(!p.weight)return"";switch(p.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}function h(p){if(!p.style)return"";switch(p.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}},7587:(dt,it,E)=>{E.d(it,{z:()=>U});var q=E(34222),H=E(93297),W=E(40637),A=E(62209);class U{static fromOptimized(e,h,p=!1,M=!1,I=1){return(new S).initialize(e,h,p,M,I)}static fromJSON(e,h=!1,p=!1){const[M,I]=u(e);return(new m).initialize(M,I,h,p,1)}static fromOptimizedCIM(e,h,p=!1,M=!1,I=1){return(new n).initialize(e,h,p,M,I)}static fromJSONCIM(e,h=!1,p=!1,M=1){const[I,T]=u(e);return(new r).initialize(I,T,h,p,M)}static fromFeatureSetReader(e){const h=e.readGeometryForDisplay(),p=e.geometryType;return h&&p?this.fromOptimized(h,p):null}static fromFeatureSetReaderCIM(e){const h=e.readGeometryForDisplay(),p=e.geometryType;return h&&p?this.fromOptimizedCIM(h,p):null}static createEmptyOptimized(e,h=!1,p=!1,M=1){return(new S).initialize(new A.Z,e,h,p,M)}static createEmptyJSON(e,h=!1,p=!1){return(new m).initialize([],e,h,p,1)}static createEmptyOptimizedCIM(e,h=!1,p=!1,M=1){return(new n).initialize(new A.Z,e,h,p,M)}static createEmptyJSONCIM(e,h=!1,p=!1,M=1){return(new r).initialize([],e,h,p,M)}asJSON(){const e=(0,H.M)(this);return"esriGeometryEnvelope"===this.geometryType?{xmin:e[0][0][0],ymin:e[0][0][1],xmax:e[0][2][0],ymax:e[0][2][1]}:"esriGeometryMultipoint"===this.geometryType?{points:e.flat()}:"esriGeometryPoint"===this.geometryType?{x:e[0][0][0],y:e[0][0][1]}:"esriGeometryPolygon"===this.geometryType?{rings:e}:{paths:e}}getCurrentRingArea(){if(this.pathSize<3)return 0;let e,h,p=0;if(this.seekPathStart(),!this.nextPoint())return 0;e=this.x,h=this.y;const M=e,I=h;for(;this.nextPoint();)p+=(e-this.x)*(h+this.y),e=this.x,h=this.y;return p+=(e-M)*(h+I),-.5*p}invertY(){this.yFactor*=-1}}class S extends U{constructor(){super(...arguments),this._end=-1}initialize(e,h,p,M,I){return this.hasZ=p,this.hasM=M,this.geometryType=h,this._stride=2+Number(p)+Number(M),this._geometry=e,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=I,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}seekPath(e){if(e>=0&&e<this.totalSize){if(this._pathIndex<e)for(;this._pathIndex<e&&this.nextPath(););else if(this._pathIndex>e)for(;this._pathIndex>e&&this.prevPath(););return!0}return!1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride}seekPathEnd(){this._pointOffset=this._end}seekInPath(e){const h=this._pathOffset+e*this._stride;return h>=0&&h<this._end&&(this._pointOffset=h,!0)}nextPoint(){return(this._pointOffset+=this._stride)<this._end}prevPoint(){return(this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){return!(this.pathIndex>=this.totalSize-1||(this._pathIndex>=0&&(this._pathOffset+=this._stride*this.pathSize),this._pathIndex++,this._pointOffset=this._pathOffset-this._stride,this._end=this._pointOffset+this._stride+this._stride*this.pathSize,0))}prevPath(){return!(this.pathIndex<=0||(this._pathIndex--,this._end=this._pathOffset,this._pathOffset-=this._stride*this.pathSize,this._pointOffset=this._pathOffset-this._stride,0))}pathLength(){const e=this._end,h=this._stride,p=this._geometry.coords;let M=0;for(let I=this._pathOffset+h;I<e;I+=h){const F=p[I]-p[I-h],X=p[I+1]-p[I-h+1];M+=Math.sqrt(F*F+X*X)}return M}startPath(){this._geometry.lengths.push(0)}pushPath(e){this.startPath(),this.pushPoints(e)}pushPoint(e){for(let h=0;h<this._stride;++h)this._geometry.coords.push(e[h]);this._geometry.lengths[this.totalSize-1]++}pushXY(e,h){this._geometry.coords.push(e,h),this._geometry.lengths[this.totalSize-1]++}pushPoints(e){for(const h of e)for(let p=0;p<this._stride;++p)this._geometry.coords.push(h[p]);this._geometry.lengths[this.totalSize-1]+=e.length}pushCursor(e){const h=e.asOptimized();this._geometry.coords.push(...h.coords),this._geometry.lengths.push(...h.lengths)}asOptimized(){const e=this._geometry.clone();if(1!==this.yFactor)for(let h=1;h<e.coords.length;h+=this._stride)e.coords[h]*=this.yFactor;return"esriGeometryPoint"===this.geometryType&&(e.lengths.length=0),e}isClosed(){const e=this._geometry.coords,h=this._pathOffset,p=this._end-this._stride;for(let M=0;M<this._stride;M++)if(e[h+M]!==e[p+M])return!1;return!0}clone(){return(new S).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.isPoint?1:this._geometry.lengths.reduce((e,h)=>e+h)}get pathSize(){const{lengths:e}=this._geometry;return this._geometry.isPoint?1:this._pathIndex<0||this._pathIndex>e.length-1?0:e[this._pathIndex]}get totalSize(){return this._geometry.isPoint?1:this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(e){this._geometry.coords[this._pointOffset]=e}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(e){this._geometry.coords[this._pointOffset+1]=this.yFactor*e}get z(){return this._geometry.coords[this._pointOffset+2]}set z(e){this._geometry.coords[this._pointOffset+2]=e}get m(){return this._geometry.coords[this._pointOffset+(this.hasZ?3:2)]}set m(e){this._geometry.coords[this._pointOffset+3]=e}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}}function y(o){const e=[o.x,o.y];return o.z&&e.push(o.z),o.m&&e.push(o.m),e}function u(o){return(0,W.oU)(o)?[o.rings,"esriGeometryPolygon"]:(0,W.l9)(o)?[o.paths,"esriGeometryPolyline"]:(0,W.aW)(o)?[[o.points],"esriGeometryMultipoint"]:(0,W.YX)(o)?[[[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]]],"esriGeometryEnvelope"]:(0,W.wp)(o)?[[[y(o)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}class m extends U{initialize(e,h,p,M,I){return this._paths=e,this.geometryType=h,this.hasZ=p,this.hasM=M,this._pathIndex=this._pointIndex=-1,this.yFactor=I,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1}seekPath(e){return this._pathIndex=e,this._pointIndex=-1,e>=0&&e<this.totalSize&&(this._currentPath=this._paths[e],!0)}seekPathStart(){this._pointIndex=-1}seekPathEnd(){this._pointIndex=this._currentPath.length}seekInPath(e){return e>=0&&e<this._currentPath.length&&(this._pointIndex=e,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this.pathIndex>0&&(this._pointIndex=-1,this._pathIndex--,this._currentPath=this._paths[this._pathIndex],!0)}pathLength(){const e=this._currentPath.length,h=this._currentPath;let p=0;for(let M=1;M<e;M++){const I=h[M-1],T=h[M],X=T[0]-I[0],V=T[1]-I[1];p+=Math.sqrt(X*X+V*V)}return p}startPath(){this._paths.push([])}pushPath(e){this._paths.push(e)}pushPoint(e){this._paths[this.totalSize-1].push(e)}pushXY(e,h){this._paths[this.totalSize-1].push([e,h])}pushPoints(e){this._paths[this.totalSize-1].push(...e)}pushCursor(e){const h=(0,H.M)(e);for(const p of h)this.pushPath(p)}asOptimized(){const e=new A.Z;if("esriGeometryPoint"===this.geometryType)e.coords.push(...this._paths[0][0]),e.lengths.length=0;else for(const h of this._paths){for(const p of h)e.coords.push(p[0]),e.coords.push(p[1]*this.yFactor),this.hasZ&&e.coords.push(p[2]),this.hasM&&e.coords.push(p[this._mIndex]);e.lengths.push(h.length)}return e}isClosed(){const e=this._currentPath[0],h=this._currentPath[this._currentPath.length-1];for(let p=0;p<e.length;p++)if(e[p]!==h[p])return!1;return!0}clone(){return(new m).initialize((0,q.d9)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map(e=>e.length).reduce((e,h)=>e+h)}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(e){this._currentPoint[0]=e}get y(){return this.yFactor*this._currentPoint[1]}set y(e){this._currentPoint[1]=this.yFactor*e}get z(){return this._currentPoint[2]}set z(e){this._currentPoint[2]=e}get m(){return this._currentPoint[this._mIndex]}set m(e){this._currentPoint[this._mIndex]=e}get pathIndex(){return this._pathIndex}}class n extends S{initialize(e,h,p,M,I){return super.initialize(e,h,p,M,I),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map(T=>new Set)),this}startPath(){super.startPath(),this._controlPoints.push(new Set)}clone(){const e=(new n).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return e._controlPoints=this._controlPoints,e}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex)}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(e){this._controlPoints[this.pathIndex].add(e)}getControlPointAt(e){return this._controlPoints[this.pathIndex].has(e)}}class r extends m{initialize(e,h,p,M,I){return super.initialize(e,h,p,M,I)}clone(){return(new r).initialize((0,q.d9)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][4]=1}getControlPoint(){return 1===this._paths[this.pathIndex][this._pointIndex][4]}setControlPointAt(e){this._paths[this.pathIndex][e][4]=1}getControlPointAt(e){return 1===this._paths[this.pathIndex][e][4]}}},81321:(dt,it,E)=>{E.d(it,{r:()=>y});var q=E(45425),H=E(43585),W=E(56880),A=E(54746),U=E(26230);const S=222045e-19;function y(D){if(0===D.totalSize)return null;const b=(0,H.Cs)(D);if(!b)return null;const v=4*(Math.abs(b[0])+Math.abs(b[2])+Math.abs(b[1])+Math.abs(b[3])+1)*S;let O=0,L=0;D.reset();for(let l=0;D.nextPath();l++){const c=D.getCurrentRingArea();c>L&&(L=c,O=l)}if(D.seekPath(O),0===D.pathSize)return null;D.seekPathStart();const R=(0,H.qu)(D);if(Math.abs(L)<=2*v*v)return[(R[0]+R[2])/2,(R[1]+R[3])/2];D.seekPathStart();const j=(0,W.Zc)(D,(0,q.Ue)());if(null===j)return null;if(D.totalPoints<4)return j;const G=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],K=[NaN,NaN,NaN,NaN],tt=[NaN,NaN,NaN,NaN];let ot=!1,$=m(j,D,!0);0===$.distance&&(ot=!0,G[0][0]=j[0],G[0][1]=j[1],$=m(j,D,!1)),K[0]=$.distance,tt[0]=0;const ut=[NaN,NaN];let ct=!1,ht=.25,_t=-1,at=NaN;do{if(at=NaN,G[1]=_(D,M(R[0],R[2],ht),0,b),isNaN(G[1][0])||isNaN(G[1][1])||($=m(G[1],D,!1),at=$.distance),!isNaN(at)&&at>v&&u(G[1],D))ct=!0,K[1]=at,tt[1]=I(G[1],j);else if(!isNaN(at)&&at>_t&&(_t=at,ut[0]=G[1][0],ut[1]=G[1][1]),ht-=.01,ht<.1){if(!(_t>=0))break;ct=!0,K[1]=_t,G[1][0]=ut[0],G[1][1]=ut[1],tt[1]=I(G[1],j)}}while(!ct);ct=!1,ht=.5,_t=-1;let mt=.01,Pt=1;do{if(at=NaN,G[2]=_(D,M(R[0],R[2],ht),0,b),isNaN(G[2][0])||isNaN(G[2][1])||($=m(G[2],D,!1),at=$.distance),!isNaN(at)&&at>v&&u(G[2],D))ct=!0,K[2]=at,tt[2]=I(G[2],j);else if(!isNaN(at)&&at>_t)_t=at,ut[0]=G[2][0],ut[1]=G[2][1];else if(at>_t&&(_t=at,ut[0]=G[2][0],ut[1]=G[2][1]),ht=.5+mt*Pt,mt+=.01,Pt*=-1,ht<.3||ht>.7){if(!(_t>=0))break;ct=!0,K[2]=_t,G[2][0]=ut[0],G[2][1]=ut[1],tt[2]=I(G[2],j)}}while(!ct);ct=!1,ht=.75,_t=-1;do{if(at=NaN,G[3]=_(D,M(R[0],R[2],ht),0,b),isNaN(G[3][0])||isNaN(G[3][1])||($=m(G[3],D,!1),at=$.distance),!isNaN(at)&&at>v&&u(G[3],D))ct=!0,K[3]=at,tt[3]=I(G[3],j);else if(at>_t&&(_t=at,ut[0]=G[3][0],ut[1]=G[3][1]),ht+=.01,ht>.9){if(!(_t>=0))break;ct=!0,K[3]=_t,G[3][0]=ut[0],G[3][1]=ut[1],tt[3]=I(G[3],j)}}while(!ct);const gt=[0,1,2,3],pt=ot?0:1;let yt;for(let l=pt;l<4;l++)for(let c=pt;c<3;c++){const P=tt[c],C=tt[c+1];T(P,C)>0&&(yt=gt[c],gt[c]=gt[c+1],gt[c+1]=yt,tt[c]=C,tt[c+1]=P)}let Q=pt,f=0,d=0;for(let l=pt;l<4;l++){switch(l){case 0:d=2*K[gt[l]];break;case 1:d=1.66666666*K[gt[l]];break;case 2:d=1.33333333*K[gt[l]];break;case 3:d=K[gt[l]]}d>f&&(f=d,Q=gt[l])}return G[Q]}function u(D,b){let v,O,L,R,j=0;for(b.reset();b.nextPath()&&b.nextPoint();)for(v=b.x,O=b.y;b.nextPoint();v=L,O=R)L=b.x,R=b.y,O>D[1]!=R>D[1]&&((L-v)*(D[1]-O)-(R-O)*(D[0]-v)>0?j++:j--);return 0!==j}function m(D,b,v){if(v&&u(D,b))return{coord:D,distance:0};let O=1/0,L=0,R=0,j=[0,0],G=[0,0];const K=[0,0];for(b.reset();b.nextPath()&&b.nextPoint();)if(!(b.pathSize<2))for(j[0]=b.x,j[1]=b.y;b.nextPoint();j=G){G=[b.x,b.y],(0,A.r8)(K,D,j,G);const tt=I(D,K);tt<O&&(O=tt,L=K[0],R=K[1])}return{coord:[L,R],distance:Math.sqrt(O)}}function _(D,b,v,O){const L=[b,0];let R=1/0,j=1/0,G=!1,K=!1;const tt=[[b,O[1]-1],[b,O[3]+1]],ot=[0,0],$=[0,0],ut=[0,0],ct=[[0,0],[0,0]],ht=(0,q.Ue)();for(D.reset();D.nextPath()&&D.nextPoint();)if(!(D.pathSize<2))for(ct[0][0]=D.x,ct[0][1]=D.y;D.nextPoint();ct[0][0]=ct[1][0],ct[0][1]=ct[1][1]){if(ct[1][0]=D.x,ct[1][1]=D.y,null===g(ht,ct)||($[0]=tt[0][0],$[1]=tt[0][1],ut[0]=tt[1][0],ut[1]=tt[1][1],0===h(ht,$,ut))||!(0,U.UT)(tt[0],tt[1],ct[0],ct[1],ot))continue;const _t=ot[1];R>j?_t<R&&(R=_t,G=!0):_t<j&&(j=_t,K=!0)}return G&&K?L[1]=(R+j)/2:L[0]=L[1]=NaN,L}function g(D,b){if(b.length<2)return null;D||(D=(0,q.Ue)());const[v,O]=b[0],[L,R]=b[1];return D[0]=Math.min(v,L),D[1]=Math.min(O,R),D[2]=Math.max(v,L),D[3]=Math.max(O,R),D}const n=1,r=4,o=3,e=12;function h(D,b,v){let O=p(b,D),L=p(v,D);const R=D[0],j=D[1],G=D[2],K=D[3];if(O&L)return 0;if(!(O|L))return 4;const tt=(O?1:0)|(L?2:0);do{const ot=v[0]-b[0],$=v[1]-b[1];if(ot>$)O&o?(O&n?(b[1]+=$*(R-b[0])/ot,b[0]=R):(b[1]+=$*(G-b[0])/ot,b[0]=G),O=p(b,D)):L&o?(L&n?(v[1]+=$*(R-v[0])/ot,v[0]=R):(v[1]+=$*(G-v[0])/ot,v[0]=G),L=p(v,D)):O?(O&r?(b[0]+=ot*(j-b[1])/$,b[1]=j):(b[0]+=ot*(K-b[1])/$,b[1]=K),O=p(b,D)):(L&r?(v[0]+=ot*(j-v[1])/$,v[1]=j):(v[0]+=ot*(K-v[1])/$,v[1]=K),L=p(v,D));else if(O&e?(O&r?(b[0]+=ot*(j-b[1])/$,b[1]=j):(b[0]+=ot*(K-b[1])/$,b[1]=K),O=p(b,D)):L&e?(L&r?(v[0]+=ot*(j-v[1])/$,v[1]=j):(v[0]+=ot*(K-v[1])/$,v[1]=K),L=p(v,D)):O?(O&n?(b[1]+=$*(R-b[0])/ot,b[0]=R):(b[1]+=$*(G-b[0])/ot,b[0]=G),O=p(b,D)):(L&n?(v[1]+=$*(R-v[0])/ot,v[0]=R):(v[1]+=$*(G-v[0])/ot,v[0]=G),L=p(v,D)),O&L)return 0}while(O|L);return tt}function p(D,b){return(D[0]<b[0]?1:0)|(D[0]>b[2]?1:0)<<1|(D[1]<b[1]?1:0)<<2|(D[1]>b[3]?1:0)<<3}function M(D,b,v){return D+(b-D)*v}function I(D,b){return(D[0]-b[0])*(D[0]-b[0])+(D[1]-b[1])*(D[1]-b[1])}function T(D,b){if(D<b)return-1;if(D>b)return 1;if(D===b)return 0;const v=isNaN(D),O=isNaN(b);return v<O?-1:v>O?1:0}},70207:(dt,it,E)=>{E.d(it,{qh:()=>A,v1:()=>U,vT:()=>S});var q=E(40460),H=E(75038);function A(y,u){y[4]=u}class U{constructor(u,m=!0,_=!0,g=0){this.isClosed=!1,this.geometryCursor=null,this.geometryCursor=!m&&"esriGeometryPolygon"===u.geometryType||!_&&"esriGeometryPolyline"===u.geometryType?null:u,this.geomUnitsPerPoint=g,this.iterateMultiPath=!1,this.iteratePath=!1,this.internalPlacement=new H.u}next(){if(!this.geometryCursor)return null;const u=this.processMultiPath(this.geometryCursor);return this.iterateMultiPath&&u||(this.geometryCursor=null),u}processMultiPath(u){for(;this.iteratePath||u.pathIndex<u.totalSize-1;){this.iteratePath||u.nextPath(),this.iterateMultiPath=!0;const m=this.processPath(u);if(m)return m}return this.iterateMultiPath=!1,null}}class S{constructor(u,m,_,g=0){this.isClosed=!1,this._tileKey=null,this.inputGeometries=u,this.acceptPolygon=m,this.acceptPolyline=_,this.geomUnitsPerPoint=g,this.iteratePath=!1,this.multiPathCursor=null}next(){for(;;){if(!this.multiPathCursor){let u=this.inputGeometries.next();for(;u&&(this.isClosed=this.acceptPolygon&&"esriGeometryPolygon"===u.geometryType||"esriGeometryEnvelope"===u.geometryType,this.multiPathCursor=u,!this.multiPathCursor);)u=this.inputGeometries.next();if(!this.multiPathCursor)return null;this._tileKey&&this.isClippingRequired(this.multiPathCursor)&&(this.multiPathCursor.reset(),this.multiPathCursor=(0,q.L)(this.multiPathCursor,256))}for(;this.iteratePath||this.multiPathCursor.nextPath();){this.multiPathCursor.seekPathStart();const u=this.processPath(this.multiPathCursor);if(u)return u}this.multiPathCursor=null}}isClippingRequired(u){return!1}}},40460:(dt,it,E)=>{E.d(it,{L:()=>S,z:()=>U});var q=E(7587),H=E(80247);const W=512;let A;class U{constructor(u){this._geometry=u}next(){const u=this._geometry;return this._geometry=null,u}}function S(y,u){A||(A=new H.bN(0,0,0,1));const m="esriGeometryPolygon"===y.geometryType,g=m?3:2;let n,r;for(A.reset(m?H.Vl.Polygon:H.Vl.LineString),A.setPixelMargin(u+1),A.setExtent(W);y.nextPath();)if(!(y.pathSize<g)){for(y.nextPoint(),n=y.x,r=-y.y,A.moveTo(n,r);y.nextPoint();)n=y.x,r=-y.y,A.lineTo(n,r);m&&A.close()}const o=A.result(!1);if(o){const e=q.z.createEmptyOptimizedCIM(y.geometryType);for(const h of o){e.startPath();for(const p of h)e.pushXY(p.x,-p.y)}return e.reset(),e}return null}},7070:(dt,it,E)=>{E.d(it,{h:()=>b,W:()=>v});let q=(()=>{class O{static local(){return null===O.instance&&(O.instance=new O),O.instance}execute(R,j,G,K,tt){return new H(R,j,G)}}return O.instance=null,O})();class H{constructor(L,R,j){this._inputGeometries=L,this._angleTolerance=void 0!==R.angleTolerance?R.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let L=this._inputGeometries.next();for(;L;){if("esriGeometryPolygon"===L.geometryType)this._isClosed=!0;else if("esriGeometryPolyline"===L.geometryType)this._isClosed=!1;else{if("esriGeometryEnvelope"!==L.geometryType){L=this._inputGeometries.next();continue}if(this._maxCosAngle)return L;this._isClosed=!0}for(;L.nextPath();)this._processPath(L);return L.reset(),L}return null}_processPath(L){if(L.nextPoint()){const R=L.x,j=L.y;let G=R,K=j,tt=L.pathSize,ot=0,$=0,ut=0,ct=0,ht=0,_t=0;this._isClosed&&++tt;for(let at=1;L.nextPoint()||at<tt;++at){let mt,Pt;this._isClosed&&at===tt-1?(mt=R,Pt=j):(mt=L.x,Pt=L.y);const gt=mt-G,pt=Pt-K,yt=Math.sqrt(gt*gt+pt*pt);at>1&&yt>0&&ut>0&&(ot*gt+$*pt)/yt/ut<=this._maxCosAngle&&L.setControlPointAt(at-1),1===at&&(ct=gt,ht=pt,_t=yt),yt>0&&(G=mt,K=Pt,ot=gt,$=pt,ut=yt)}this._isClosed&&ut>0&&_t>0&&(ot*ct+$*ht)/_t/ut<=this._maxCosAngle&&L.setControlPointAt(0)}}}var W=E(77442),A=E(99586),U=E(71691),S=E(92328),y=E(57876),u=E(16584),m=E(4322);let _=(()=>{class O{static local(){return null===O.instance&&(O.instance=new O),O.instance}execute(R,j,G,K,tt){return new g(R,j,G)}}return O.instance=null,O})();class g{constructor(L,R,j){this._inputGeometries=L,this._offsetX=void 0!==R.offsetX?R.offsetX*j:0,this._offsetY=void 0!==R.offsetY?R.offsetY*j:0}next(){let L=this._inputGeometries.next();for(;L;){if(L.totalSize>0)return this._move(L.clone(),this._offsetX,this._offsetY);L=this._inputGeometries.next()}return null}_move(L,R,j){for(;L.nextPath();)for(;L.nextPoint();)L.x=L.x+R,L.y=L.y+j;return L.reset(),L}}var n=E(50765);let r=(()=>{class O{static local(){return null===O.instance&&(O.instance=new O),O.instance}execute(R,j,G,K,tt){return new o(R,j,G)}}return O.instance=null,O})();class o{constructor(L,R,j){this._inputGeometries=L,this._reverse=void 0===R.reverse||R.reverse}next(){let L=this._inputGeometries.next();for(;L;){if(!this._reverse)return L;if("esriGeometryPolyline"===L.geometryType)return e(L.clone());L=this._inputGeometries.next()}return null}}function e(O){for(;O.nextPath();)for(let L=0;L<O.pathSize/2;L++){O.seekInPath(L);const R=O.x,j=O.y;O.seekInPath(O.pathSize-L-1);const G=O.x,K=O.y;O.x=R,O.y=j,O.seekInPath(L),O.x=G,O.y=K}return O.reset(),O}var h=E(91522),p=E(76929),M=E(86740),I=E(78586),T=E(52153),B=E(25065),F=E(81961),X=E(18436),V=E(34949),D=E(40321);function b(O){if(!O)return null;switch(O.type){case"CIMGeometricEffectAddControlPoints":return q.local();case"CIMGeometricEffectArrow":return W.P.local();case"CIMGeometricEffectBuffer":return A.I.local();case"CIMGeometricEffectControlMeasureLine":return U.Y.local();case"CIMGeometricEffectCut":return S.d.local();case"CIMGeometricEffectDashes":return y.x.local();case"CIMGeometricEffectDonut":return u.h.local();case"CIMGeometricEffectJog":return m.F.local();case"CIMGeometricEffectMove":return _.local();case"CIMGeometricEffectOffset":return n.F.local();case"CIMGeometricEffectReverse":return r.local();case"CIMGeometricEffectRotate":return h.O.local();case"CIMGeometricEffectScale":return p.I.local();case"CIMGeometricEffectWave":return M.w.local()}return null}function v(O){if(!O)return null;switch(O.type){case"CIMMarkerPlacementAlongLineSameSize":return I.W.local();case"CIMMarkerPlacementAtExtremities":return T.j.local();case"CIMMarkerPlacementAtRatioPositions":return B.x.local();case"CIMMarkerPlacementInsidePolygon":return F.O.local();case"CIMMarkerPlacementOnLine":return X.D.local();case"CIMMarkerPlacementOnVertices":return V.o.local();case"CIMMarkerPlacementPolygonCenter":return D.y.local()}return null}},75038:(dt,it,E)=>{E.d(it,{u:()=>q});class q{constructor(){this.setIdentity()}getAngle(){return(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0}setTranslate(A,U){this.tx=A,this.ty=U}setTranslateZ(A){this.tz=A}setRotateCS(A,U){this.rz=void 0,this.rzCos=A,this.rzSin=U}setRotate(A){this.rz=A,this.rzCos=void 0,this.rzSin=void 0}setRotateY(A){this.ry=A}setScale(A){this.s=A}setMeasure(A){this.m=A}}},36198:(dt,it,E)=>{E.d(it,{cD:()=>ut,uQ:()=>ot,Tu:()=>$,zA:()=>K,et:()=>Pt});var q=E(56123),H=E(14007),W=E(34222),A=E(4703),U=E(51479),S=E(55768),y=E(7587),u=E(45425),m=E(43585),_=E(56880),g=E(40637),n=E(40460);class r{applyColorSubstituition(f,d){if(!d)return f;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:l,height:c}=f,P=this._rasterizationCanvas,C=P.getContext("2d",{willReadFrequently:!0});f!==P&&(P.width=l,P.height=c,C.drawImage(f,0,0,l,c));const x=C.getImageData(0,0,l,c).data;if(d)for(const z of d)if(z&&z.oldColor&&4===z.oldColor.length&&z.newColor&&4===z.newColor.length){const[w,N,Y,J]=z.oldColor,[nt,Z,et,st]=z.newColor;if(w===nt&&N===Z&&Y===et&&J===st)continue;for(let rt=0;rt<x.length;rt+=4)w===x[rt]&&N===x[rt+1]&&Y===x[rt+2]&&J===x[rt+3]&&(x[rt]=nt,x[rt+1]=Z,x[rt+2]=et,x[rt+3]=st)}const k=new ImageData(x,l,c);return C.putImageData(k,0,0),P}tintImageData(f,d){if(!d||d.length<4)return f;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:l,height:c}=f,P=this._rasterizationCanvas,C=P.getContext("2d",{willReadFrequently:!0});f!==P&&(P.width=l,P.height=c,C.drawImage(f,0,0,l,c));const x=C.getImageData(0,0,l,c),k=new Uint8Array(x.data),z=[d[0]/255,d[1]/255,d[2]/255,d[3]/255];for(let N=0;N<k.length;N+=4)k[N]*=z[0],k[N+1]*=z[1],k[N+2]*=z[2],k[N+3]*=z[3];const w=new ImageData(new Uint8ClampedArray(k.buffer),l,c);return C.putImageData(w,0,0),P}}var o=E(7070),e=E(75038),h=E(73896),p=E(11196);function M(Q){const f=Q.getFrame(0);if(f instanceof HTMLImageElement||f instanceof HTMLCanvasElement)return f;const d=document.createElement("canvas");d.width=Q.width,d.height=Q.height;const l=d.getContext("2d");return f instanceof ImageData?l.putImageData(f,0,0):l.drawImage(f,0,0),d}var I=E(43818),T=E(52759);function F(Q){return`rgba(${Q.slice(0,3).toString()},${Q[3]})`}class X{constructor(f){f&&(this._textRasterizationCanvas=f)}rasterizeText(f,d){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const l=this._textRasterizationCanvas,c=l.getContext("2d",{willReadFrequently:!0});V(c,d),this._parameters=d,this._textLines=f.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const{decoration:P,weight:C}=d.font;this._lineThroughWidthOffset=P&&"line-through"===P?.1*this._lineHeight:0;const x=null!=d.backgroundColor||null!=d.borderLine,k=x?T.c9:0,z=this._computeTextWidth(c,d)+2*k,w=this._lineHeight*this._textLines.length+2*k;if(l.width=z+2*this._lineThroughWidthOffset,l.height=w,0===l.width||0===l.height)return l.width=l.height=1,{size:[0,0],image:new Uint32Array(0),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0,canvas:l};this._renderedLineHeight=Math.round(this._lineHeight*d.pixelRatio),this._renderedHaloSize=(0,S.F2)(d.halo.size)*d.pixelRatio,this._renderedWidth=z*d.pixelRatio,this._renderedHeight=w*d.pixelRatio,this._lineThroughWidthOffset*=d.pixelRatio;const Y=d.halo&&d.halo.color?d.halo.color:[0,0,0,0];this._fillStyle=F(d.color??[0,0,0,0]),this._haloStyle=function B(Q){return`rgb(${Q.slice(0,3).toString()})`}(Y);const J=this._renderedLineHeight,nt=this._renderedHaloSize;c.save(),c.clearRect(0,0,l.width,l.height),V(c,d);const Z=k*d.pixelRatio,et=function D(Q,f){return"center"===Q?.5*f:"right"===Q?f:0}(c.textAlign,this._renderedWidth-2*Z)+nt+Z,st=nt+Z,rt=nt>0;let lt=this._lineThroughWidthOffset,ft=0;if(x){c.save();const Et=d.backgroundColor??[0,0,0,0],bt=d.borderLine?.color??[0,0,0,0],wt=2*(0,S.F2)(d.borderLine?.size??0);c.fillStyle=F(Et),c.strokeStyle=F(bt),c.lineWidth=wt,c.fillRect(0,0,l.width,l.height),c.strokeRect(0,0,l.width,l.height),c.restore()}rt&&this._renderHalo(c,et,st,lt,ft,d),ft+=st,lt+=et;for(const Et of this._textLines)rt?(c.globalCompositeOperation="destination-out",c.fillStyle="rgb(0, 0, 0)",c.fillText(Et,lt,ft),c.globalCompositeOperation="source-over",c.fillStyle=this._fillStyle,c.fillText(Et,lt,ft)):(c.fillStyle=this._fillStyle,c.fillText(Et,lt,ft)),P&&"none"!==P&&this._renderDecoration(c,lt,ft,P,C),ft+=J;c.restore();const Mt=this._renderedWidth+2*this._lineThroughWidthOffset,Ct=this._renderedHeight,St=c.getImageData(0,0,Mt,Ct),xt=new Uint8Array(St.data);if(d.premultiplyColors){let Et;for(let bt=0;bt<xt.length;bt+=4)Et=xt[bt+3]/255,xt[bt]=xt[bt]*Et,xt[bt+1]=xt[bt+1]*Et,xt[bt+2]=xt[bt+2]*Et}let It,vt;switch(d.horizontalAlignment){case"left":It=-.5;break;case"right":It=.5;break;default:It=0}switch(d.verticalAlignment){case"bottom":vt=-.5;break;case"top":vt=.5;break;case"baseline":vt=-1/6;break;default:vt=0}return{size:[Mt,Ct],image:new Uint32Array(xt.buffer),sdf:!1,simplePattern:!1,anchorX:It,anchorY:vt,canvas:l}}_renderHalo(f,d,l,c,P,C){const x=this._renderedWidth,k=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=x,this._haloRasterizationCanvas.height=k;const z=this._haloRasterizationCanvas,w=z.getContext("2d");w.clearRect(0,0,x,k),V(w,C);const{decoration:N,weight:Y}=C.font;w.fillStyle=this._haloStyle,w.strokeStyle=this._haloStyle,w.lineJoin="round",this._renderHaloNative(w,d,l,N,Y),f.globalAlpha=this._parameters.halo.color[3],f.drawImage(z,0,0,x,k,c,P,x,k),f.globalAlpha=1}_renderHaloNative(f,d,l,c,P){const C=this._renderedLineHeight,x=this._renderedHaloSize;for(const k of this._textLines){const z=2*x,w=5,N=.1;for(let Y=0;Y<w;Y++){const J=(1-(w-1)*N+Y*N)*z;f.lineWidth=J,f.strokeText(k,d,l),c&&"none"!==c&&this._renderDecoration(f,d,l,c,P,J)}l+=C}}computeTextSize(f,d){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const l=this._textRasterizationCanvas,c=l.getContext("2d");V(c,d),this._parameters=d,this._textLines=f.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const P=this._computeTextWidth(c,d),C=this._lineHeight*this._textLines.length;return l.width=P,l.height=C,[P*d.pixelRatio,C*d.pixelRatio]}_computeTextWidth(f,d){let l=0;for(const P of this._textLines)l=Math.max(l,f.measureText(P).width);const c=d.font;return("italic"===c.style||"oblique"===c.style||"string"==typeof c.weight&&("bold"===c.weight||"bolder"===c.weight)||"number"==typeof c.weight&&c.weight>600)&&(l+=.3*f.measureText("w").width),l+=2*(0,S.F2)(this._parameters.halo.size),Math.round(l)}_computeLineHeight(){let f=1.275*this._parameters.size;const d=this._parameters.font.decoration;return d&&"underline"===d&&(f*=1.3),Math.round(f+2*(0,S.F2)(this._parameters.halo.size))}_renderDecoration(f,d,l,c,P,C){const x=.9*this._lineHeight,k="bold"===P?.06:"bolder"===P?.09:.04;switch(f.textAlign){case"center":d-=this._renderedWidth/2;break;case"right":d-=this._renderedWidth}const z=f.textBaseline;if("underline"===c)switch(z){case"top":l+=x;break;case"middle":l+=x/2}else if("line-through"===c)switch(z){case"top":l+=x/1.5;break;case"middle":l+=x/3}const w=C?1.5*C:Math.ceil(x*k);f.save(),f.beginPath(),f.strokeStyle=f.fillStyle,f.lineWidth=w,f.moveTo(d-this._lineThroughWidthOffset,l),f.lineTo(d+this._renderedWidth+2*this._lineThroughWidthOffset,l),f.stroke(),f.restore()}}function V(Q,f){const d=Math.max(f.size,.5),l=f.font,c=`${l.style} ${l.weight} ${(0,S.F2)(d*f.pixelRatio).toFixed(1)}px ${l.family}, sans-serif`;let P;switch(Q.font=c,Q.textBaseline="top",f.horizontalAlignment){case"left":default:P="left";break;case"right":P="right";break;case"center":P="center"}Q.textAlign=P}var b=E(25896),v=E(99657),O=E(60559),L=E(43501);const R=Math.PI/180;class K{constructor(f){this._t=f}static createIdentity(){return new K([1,0,0,0,1,0])}clone(){return new K(this._t.slice())}transform(f){const d=this._t;return[d[0]*f[0]+d[1]*f[1]+d[2],d[3]*f[0]+d[4]*f[1]+d[5]]}static createScale(f,d){return new K([f,0,0,0,d,0])}scale(f,d){const l=this._t;return l[0]*=f,l[1]*=f,l[2]*=f,l[3]*=d,l[4]*=d,l[5]*=d,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(f,d){return new K([0,0,f,0,0,d])}translate(f,d){const l=this._t;return l[2]+=f,l[5]+=d,this}static createRotate(f){const d=Math.cos(f),l=Math.sin(f);return new K([d,-l,0,l,d,0])}rotate(f){return K.multiply(this,K.createRotate(f),this)}angle(){const f=this._t[0],d=this._t[3],l=Math.sqrt(f*f+d*d);return[f/l,d/l]}static multiply(f,d,l){const c=f._t,P=d._t,x=c[1]*P[0]+c[4]*P[1],k=c[2]*P[0]+c[5]*P[1]+P[2],z=c[0]*P[3]+c[3]*P[4],w=c[1]*P[3]+c[4]*P[4],N=c[2]*P[3]+c[5]*P[4]+P[5],Y=l._t;return Y[0]=c[0]*P[0]+c[3]*P[1],Y[1]=x,Y[2]=k,Y[3]=z,Y[4]=w,Y[5]=N,l}invert(){const f=this._t;let d=f[0]*f[4]-f[1]*f[3];return 0===d?new K([0,0,0,0,0,0]):(d=1/d,new K([f[4]*d,-f[1]*d,(f[1]*f[5]-f[2]*f[4])*d,-f[3]*d,f[0]*d,(f[2]*f[3]-f[0]*f[5])*d]))}}class tt{constructor(f,d){this._resourceManager=f,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new U.Z(e.u,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(d||K.createIdentity()),this._sizeTransfos.push(d?d.scaleRatio():1)}setTransform(f,d){this._transfos=[f||K.createIdentity()],this._sizeTransfos=[d||(f?f.scaleRatio():1)]}setGeomUnitsPerPoint(f){this._geomUnitsPerPoint=f}transformPt(f){return this._transfos[this._transfos.length-1].transform(f)}transformSize(f){return f*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(f){return this._transfos[this._transfos.length-1].invert().transform(f)}reverseTransformSize(f){return f/this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformScalar(f){return f/this._transfos[this._transfos.length-1].scaleRatio()}getTransformAngle(){return this._transfos[this._transfos.length-1].angle()}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}prevGeomUnitsPerPoint(){return this._transfos.length>2?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(f,d){const l=d?f.scaleRatio():1;K.multiply(f,this.back(),f),this._transfos.push(f),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*l)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(f,d,l){if(f)switch(f.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(f,d);break;case"CIMTextSymbol":this.drawTextSymbol(f,d,l)}}drawMultiLayerSymbol(f,d){if(!f||!d)return;const l=f.symbolLayers;if(!l)return;const c=f.effects;if(c&&c.length>0){const P=this.executeEffects(c,d);if(P){let C=P.next();for(;C;)this.drawSymbolLayers(l,C.asJSON()),C=P.next()}}else this.drawSymbolLayers(l,d)}executeEffects(f,d){const l=this._resourceManager.geometryEngine;let c=new n.z(y.z.fromJSONCIM(d));for(const P of f){const C=(0,o.h)(P);C&&(c=C.execute(c,P,this.geomUnitsPerPoint(),null,l))}return c}drawSymbolLayers(f,d){let l=f.length;for(;l--;){const c=f[l];if(!c||!1===c.enable)continue;const P=c.effects;if(P&&P.length>0){const C=this.executeEffects(P,d);if(C){let x=null;for(;(x=C.next())&&(this.drawSymbolLayer(c,x.asJSON()),!this._earlyReturn););}}else this.drawSymbolLayer(c,d);if(this._earlyReturn)return}}drawSymbolLayer(f,d){switch(f.type){case"CIMSolidFill":this.drawSolidFill(d,f.color);break;case"CIMHatchFill":this.drawHatchFill(d,f);break;case"CIMPictureFill":this.drawPictureFill(d,f);break;case"CIMGradientFill":this.drawGradientFill(d,f);break;case"CIMSolidStroke":this.drawSolidStroke(d,f.color,f.width,f.capStyle,f.joinStyle,f.miterLimit);break;case"CIMPictureStroke":this.drawPictureStroke(d,f);break;case"CIMGradientStroke":this.drawGradientStroke(d,f);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(f,d)}}drawHatchFill(f,d){const l=function ct(Q,f,d){let l=(0,b.J0)(Q.separation,h.E.CIMHatchFill.separation)*d,c=(0,b.J0)(Q.rotation);if(0===l)return null;l<0&&(l=-l);let P=0;const C=.5*l;for(;P>C;)P-=l;for(;P<-C;)P+=l;const x=(0,u.Ue)();(0,m.$P)(x,f),x[0]-=C,x[1]-=C,x[2]+=C,x[3]+=C;const k=[[x[0],x[1]],[x[0],x[3]],[x[2],x[3]],[x[2],x[1]]];for(;c>180;)c-=180;for(;c<0;)c+=180;const z=Math.cos(c*R),w=Math.sin(c*R),N=-l*w,Y=l*z;let J,nt,Z,et;P=(0,b.J0)(Q.offsetX)*d*w-(0,b.J0)(Q.offsetY)*d*z,J=Z=Number.MAX_VALUE,nt=et=-Number.MAX_VALUE;for(const St of k){const xt=St[0],It=St[1],vt=z*xt+w*It,Et=-w*xt+z*It;J=Math.min(J,vt),Z=Math.min(Z,Et),nt=Math.max(nt,vt),et=Math.max(et,Et)}Z=Math.floor(Z/l)*l;let st=z*J-w*Z-N*P/l,rt=w*J+z*Z-Y*P/l,lt=z*nt-w*Z-N*P/l,ft=w*nt+z*Z-Y*P/l;const Mt=1+Math.round((et-Z)/l),Ct=[];for(let St=0;St<Mt;St++)st+=N,rt+=Y,lt+=N,ft+=Y,Ct.push([[st,rt],[lt,ft]]);return{paths:Ct}}(d,f,this.geomUnitsPerPoint());l&&(this.pushClipPath(f),this.drawMultiLayerSymbol(d.lineSymbol,l),this.popClipPath())}drawPictureFill(f,d){}drawGradientFill(f,d){}drawPictureStroke(f,d){}drawGradientStroke(f,d){}drawMarkerLayer(f,d){const l=f.markerPlacement;if(l){const c=(0,o.W)(l);if(c){const P="CIMMarkerPlacementInsidePolygon"===l.type||"CIMMarkerPlacementPolygonCenter"===l.type&&l.clipAtBoundary;P&&this.pushClipPath(d);const C=c.execute(y.z.fromJSONCIM(d),l,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine);if(C){let x=null;for(;(x=C.next())&&(this.drawMarker(f,x),!this._earlyReturn););}P&&this.popClipPath()}}else{const c=this._placementPool.acquire();if((0,g.wp)(d))c.tx=d.x,c.ty=d.y,this.drawMarker(f,c);else if((0,g.oU)(d)){const P=(0,_.tO)(d);P&&([c.tx,c.ty]=P,this.drawMarker(f,c))}else for(const P of d.points)if(c.tx=P[0],c.ty=P[1],this.drawMarker(f,c),this._earlyReturn)break;this._placementPool.release(c)}}drawMarker(f,d){switch(f.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(f,d);break;case"CIMVectorMarker":this.drawVectorMarker(f,d)}}drawPictureMarker(f,d){if(!f)return;const l=this._resourceManager.getResource(f.url),c=(0,b.J0)(f.size,h.E.CIMPictureMarker.size);if(null==l||c<=0)return;const P=l.width,C=l.height;if(!P||!C)return;const x=P/C,k=(0,b.J0)(f.scaleX,1),z=K.createIdentity(),w=f.anchorPoint;if(w){let et=w.x,st=w.y;"Absolute"!==f.anchorPointUnits&&(et*=c*x*k,st*=c),z.translate(-et,-st)}let N=(0,b.J0)(f.rotation);f.rotateClockwise&&(N=-N),this._mapRotation&&(N+=this._mapRotation),N&&z.rotate(N*R);let Y=(0,b.J0)(f.offsetX),J=(0,b.J0)(f.offsetY);if(Y||J){if(this._mapRotation){const et=R*this._mapRotation,st=Math.cos(et),rt=Math.sin(et),lt=Y*rt+J*st;Y=Y*st-J*rt,J=lt}z.translate(Y,J)}const nt=this.geomUnitsPerPoint();1!==nt&&z.scale(nt,nt);const Z=d.getAngle();Z&&z.rotate(Z),z.translate(d.tx,d.ty),this.push(z,!1),this.drawImage(f,c),this.pop()}drawVectorMarker(f,d){if(!f)return;const l=f.markerGraphics;if(!l)return;const c=(0,b.J0)(f.size,h.E.CIMVectorMarker.size),P=f.frame,C=P?P.ymax-P.ymin:0,x=c&&C?c/C:1,k=K.createIdentity();P&&k.translate(.5*-(P.xmax+P.xmin),.5*-(P.ymax+P.ymin));const z=f.anchorPoint;if(z){let Z=z.x,et=z.y;"Absolute"!==f.anchorPointUnits?P&&(Z*=P.xmax-P.xmin,et*=P.ymax-P.ymin):(Z/=x,et/=x),k.translate(-Z,-et)}1!==x&&k.scale(x,x);let w=(0,b.J0)(f.rotation);f.rotateClockwise&&(w=-w),this._mapRotation&&(w+=this._mapRotation),w&&k.rotate(w*R);let N=(0,b.J0)(f.offsetX),Y=(0,b.J0)(f.offsetY);if(N||Y){if(this._mapRotation){const Z=R*this._mapRotation,et=Math.cos(Z),st=Math.sin(Z),rt=N*st+Y*et;N=N*et-Y*st,Y=rt}k.translate(N,Y)}const J=this.geomUnitsPerPoint();1!==J&&k.scale(J,J);const nt=d.getAngle();nt&&k.rotate(nt),k.translate(d.tx,d.ty),this.push(k,f.scaleSymbolsProportionally);for(const Z of l){Z?.symbol&&Z.geometry||A.Z.getLogger("esri.symbols.cim.CIMSymbolDrawHelper").error("Invalid marker graphic",Z);let et=Z.textString;if("number"==typeof et&&(et=et.toString()),this.drawSymbol(Z.symbol,Z.geometry,et),this._earlyReturn)break}this.pop()}drawTextSymbol(f,d,l){if(!f||!(0,g.wp)(d)||(0,b.J0)(f.height,h.E.CIMTextSymbol.height)<=0)return;const c=K.createIdentity();let P=(0,b.J0)(f.angle);P=-P,P&&c.rotate(P*R);const C=(0,b.J0)(f.offsetX),x=(0,b.J0)(f.offsetY);(C||x)&&c.translate(C,x);const k=this.geomUnitsPerPoint();1!==k&&c.scale(k,k),c.translate(d.x,d.y),this.push(c,!1),this.drawText(f,l),this.pop()}}class ot extends tt{constructor(f,d){super(f,d),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new I.Z(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return(0,u.al)(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(f){if(f&&!(this._clipCount>0))if((0,g.oU)(f))this._processPath(f.rings,0);else if((0,g.l9)(f))this._processPath(f.paths,0);else if((0,g.YX)(f)){const d=mt(f);d&&this._processPath(d.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}drawSolidStroke(f,d,l){if(!f||this._clipCount>0||null==l||l<=0)return;const c=Math.max(.5*this.transformSize((0,b.J0)(l,h.E.CIMSolidStroke.width)),.25);if((0,g.oU)(f))this._processPath(f.rings,c);else if((0,g.l9)(f))this._processPath(f.paths,c);else if((0,g.YX)(f)){const P=mt(f);P&&this._processPath(P.rings,c)}else console.error("drawSolidStroke unexpected geometry type!")}drawMarkerLayer(f,d){(0,g.oU)(d)&&f.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===f.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===f.markerPlacement.type&&f.markerPlacement.clipAtBoundary)?this._processPath(d.rings,0):super.drawMarkerLayer(f,d)}drawHatchFill(f,d){this.drawSolidFill(f)}drawPictureFill(f,d){this.drawSolidFill(f)}drawGradientFill(f,d){this.drawSolidFill(f)}drawPictureStroke(f,d){this.drawSolidStroke(f,null,d.width)}drawGradientStroke(f,d){this.drawSolidStroke(f,null,d.width)}pushClipPath(f){this.drawSolidFill(f),this._clipCount++}popClipPath(){this._clipCount--}drawImage(f,d){const{url:l}=f,c=(0,b.J0)(f.scaleX,1);let P=c*d,C=d;const x=this._resourceManager.getResource(l);if(null!=x){const k=x.height/x.width;P=c*(d?k>1?d:d/k:x.width),C=d?k>1?d*k:d:x.height}this._merge(this.transformPt([-P/2,-C/2]),0),this._merge(this.transformPt([-P/2,C/2]),0),this._merge(this.transformPt([P/2,-C/2]),0),this._merge(this.transformPt([P/2,C/2]),0)}drawText(f,d){if(!d||0===d.length)return;this._textRasterizer||(this._textRasterizer=new X);const l=gt(f);let[c,P]=this._textRasterizer.computeTextSize(d,l);c=(0,S.Wz)(c),P=(0,S.Wz)(P);let C=0;switch(f.horizontalAlignment){case"Left":C=c/2;break;case"Right":C=-c/2}let x=0;switch(f.verticalAlignment){case"Bottom":x=P/2;break;case"Top":x=-P/2;break;case"Baseline":x=P/6}this._merge(this.transformPt([-c/2+C,-P/2+x]),0),this._merge(this.transformPt([-c/2+C,P/2+x]),0),this._merge(this.transformPt([c/2+C,-P/2+x]),0),this._merge(this.transformPt([c/2+C,P/2+x]),0)}_processPath(f,d){if(f)for(const l of f){const c=l?l.length:0;if(c>1){this._merge(this.transformPt(l[0]),d);for(let P=1;P<c;P++)this._merge(this.transformPt(l[P]),d)}}}_merge(f,d){f[0]-d<this._xmin&&(this._xmin=f[0]-d),f[0]+d>this._xmax&&(this._xmax=f[0]+d),f[1]-d<this._ymin&&(this._ymin=f[1]-d),f[1]+d>this._ymax&&(this._ymax=f[1]+d)}}class $ extends tt{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0,this._textInfo=null}hitTest(f,d,l,c,P,C){const x=C*(0,S.F2)(1);if(this.setTransform(),this.setGeomUnitsPerPoint(x),this._searchPoint=[(f[0]+f[2])/2,(f[1]+f[3])/2],this._searchDistPoint=(f[2]-f[0])/2/x,this._textInfo=c,this._mapRotation=d&&("CIMPointSymbol"===d.type&&"Map"!==d.angleAlignment||"CIMTextSymbol"===d.type)?P:0,!(0,H.Z)("esri-mobile")){const z=(0,S.Wz)(v.pd*window.devicePixelRatio),w=(0,S.Wz)(v.fG);("CIMLineSymbol"!==d?.type&&"CIMPolygonSymbol"!==d?.type||!d.symbolLayers?.some(b.k5))&&"CIMMeshSymbol"!==d?.type&&((0,b.ap)(d)??0)<w&&(this._searchDistPoint=z)}return this._earlyReturn=!1,this.drawSymbol(d,l),this._earlyReturn}drawSolidFill(f,d){this._hitTestFill(f)}drawHatchFill(f,d){this._hitTestFill(f)}drawPictureFill(f,d){this._hitTestFill(f)}drawGradientFill(f,d){this._hitTestFill(f)}drawSolidStroke(f,d,l,c,P,C){this._hitTestStroke(f,l)}drawPictureStroke(f,d){this._hitTestStroke(f,d.width)}drawGradientStroke(f,d){this._hitTestStroke(f,d.width)}drawMarkerLayer(f,d){f.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===f.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===f.markerPlacement.type&&f.markerPlacement.clipAtBoundary)?this._hitTestFill(d):super.drawMarkerLayer(f,d)}pushClipPath(f){}popClipPath(){}drawImage(f,d){const{url:l}=f,c=(0,b.J0)(f.scaleX,1),P=this._resourceManager.getResource(l);if(null==P||0===P.height||0===d)return;const C=d*this.geomUnitsPerPoint(),x=C*c*(P.width/P.height),k=this.reverseTransformPt(this._searchPoint),z=this._searchDistPoint;Math.abs(k[0])<x/2+z&&Math.abs(k[1])<C/2+z&&(this._earlyReturn=!0)}drawText(f,d){const l=this._textInfo;if(!l)return;const c=l.get(f);if(!c||!c.glyphMosaicItems.glyphs.length)return;const P=(0,L.vn)((0,b.J0)(f.height,h.E.CIMTextSymbol.height)),{lineGapType:C,lineGap:x}=f,k=C?Pt(C,(0,b.J0)(x),P):0,z="CIMBackgroundCallout"===f.callout?.type,w=(0,O.Nr)(c.glyphMosaicItems,{scale:P/v.iD,angle:0,xOffset:0,yOffset:0,horizontalAlignment:f.horizontalAlignment,verticalAlignment:f.verticalAlignment,maxLineWidth:(0,L.g1)(f.lineWidth),lineHeight:v.uk*Math.max(.25,Math.min(k||1,4)),decoration:f.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:z}),N=this.reverseTransformPt(this._searchPoint),Y=N[0],J=N[1];for(const nt of w.glyphs)if(Y>nt.xTopLeft&&Y<nt.xBottomRight&&J>-nt.yBottomRight&&J<-nt.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(f){let d=null;if((0,g.YX)(f))d=[[[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,f.ymin]]];else if((0,g.oU)(f))d=f.rings;else{if(!(0,g.l9)(f))return;d=f.paths}const l=this.reverseTransformPt(this._searchPoint);(function ht(Q,f){let d=0;for(const l of f){const c=l.length;for(let P=1;P<c;P++){const C=l[P-1],x=l[P];C[1]>Q[1]!=x[1]>Q[1]&&((x[0]-C[0])*(Q[1]-C[1])-(x[1]-C[1])*(Q[0]-C[0])>0?d++:d--)}}return 0!==d})(l,d)&&(this._earlyReturn=!0),!this._earlyReturn&&_t(l,d,this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}_hitTestStroke(f,d){let l=null;if((0,g.YX)(f))l=[[[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,f.ymin]]];else if((0,g.oU)(f))l=f.rings;else{if(!(0,g.l9)(f))return;l=f.paths}_t(this.reverseTransformPt(this._searchPoint),l,(0,b.J0)(d,h.E.CIMSolidStroke.width)*this.geomUnitsPerPoint()/2+this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}}class ut extends tt{constructor(f,d,l,c){super(d,l),this._applyAdditionalRenderProps=c,this._colorSubstitutionHelper=new r,this._ctx=f}drawSolidFill(f,d){if(!f)return;if((0,g.oU)(f))this._buildPath(f.rings,!0);else if((0,g.l9)(f))this._buildPath(f.paths,!0);else if((0,g.YX)(f))this._buildPath(mt(f).rings,!0);else{if(!(0,g.aW)(f))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}const l=this._ctx;l.fillStyle="string"==typeof d?d:"rgba("+Math.round(d[0])+","+Math.round(d[1])+","+Math.round(d[2])+","+(d[3]??255)/255+")",l.fill("evenodd")}drawSolidStroke(f,d,l,c,P,C){if(!f||!d||0===l)return;if((0,g.oU)(f))this._buildPath(f.rings,!0);else if((0,g.l9)(f))this._buildPath(f.paths,!1);else{if(!(0,g.YX)(f))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(mt(f).rings,!0)}const x=this._ctx;x.strokeStyle="string"==typeof d?d:"rgba("+Math.round(d[0])+","+Math.round(d[1])+","+Math.round(d[2])+","+(d[3]??255)/255+")",x.lineWidth=Math.max(this.transformSize(l),.5),this._setCapStyle(c),this._setJoinStyle(P),x.miterLimit=C,x.stroke()}pushClipPath(f){if(this._ctx.save(),(0,g.oU)(f))this._buildPath(f.rings,!0);else if((0,g.l9)(f))this._buildPath(f.paths,!0);else{if(!(0,g.YX)(f))return;this._buildPath(mt(f).rings,!0)}this._ctx.clip("evenodd")}popClipPath(){this._ctx.restore()}drawImage(f,d){const{colorSubstitutions:l,url:c,tintColor:P}=f,C=(0,b.J0)(f.scaleX,1),x=this._resourceManager.getResource(c);if(null==x)return;let k=d*(x.width/x.height),z=d;d||(k=x.width,z=x.height);const w=(0,b.TB)(c)||"src"in x&&(0,b.TB)(x.src);let N="getFrame"in x?M(x):x;l&&(N=this._colorSubstitutionHelper.applyColorSubstituition(N,l)),this._applyAdditionalRenderProps&&!w&&P&&(N=this._colorSubstitutionHelper.tintImageData(N,P));const Y=this.transformPt([0,0]),[J,nt]=this.getTransformAngle(),Z=this.transformSize(1),et=this._ctx;et.save(),et.setTransform({m11:C*Z*J,m12:C*Z*nt,m21:-Z*nt,m22:Z*J,m41:Y[0],m42:Y[1]}),et.drawImage(N,-k/2,-z/2,k,z),et.restore()}drawText(f,d){if(!d||0===d.length)return;this._textRasterizer||(this._textRasterizer=new X);const l=gt(f);l.size*=this.transformSize((0,S.Wz)(1));const c=this._textRasterizer.rasterizeText(d,l);if(!c)return;const{size:P,anchorX:C,anchorY:x,canvas:k}=c,z=P[0]*(C+.5),w=P[1]*(x-.5),N=this._ctx,Y=this.transformPt([0,0]),[J,nt]=this.getTransformAngle();N.save(),N.setTransform({m11:1*J,m12:1*nt,m21:-1*nt,m22:1*J,m41:Y[0]-1*z,m42:Y[1]+1*w}),N.drawImage(k,0,0),N.restore()}drawPictureFill(f,d){if(!f)return;let{colorSubstitutions:l,height:c,offsetX:P,offsetY:C,rotation:x,scaleX:k,tintColor:z,url:w}=d;const N=this._resourceManager.getResource(w);if(null==N)return;if((0,g.oU)(f))this._buildPath(f.rings,!0);else if((0,g.l9)(f))this._buildPath(f.paths,!0);else if((0,g.YX)(f))this._buildPath(mt(f).rings,!0);else{if(!(0,g.aW)(f))return;console.log("CanvasDrawHelper.drawPictureFill - No implementation!")}const Y=this._ctx,J=(0,b.TB)(w)||"src"in N&&(0,b.TB)(N.src);let nt,Z="getFrame"in N?M(N):N;if(l&&(Z=this._colorSubstitutionHelper.applyColorSubstituition(Z,l)),this._applyAdditionalRenderProps){J||z&&(Z=this._colorSubstitutionHelper.tintImageData(Z,z)),nt=Y.createPattern(Z,"repeat");const et=this.transformSize(1);x||(x=0),P?P*=et:P=0,C?C*=et:C=0,c&&(c*=et);const st=c?c/N.height:1,rt=k&&c?k*c/N.width:1;if(0!==x||1!==st||1!==rt||0!==P||0!==C){const lt=new DOMMatrix;lt.rotateSelf(0,0,-x).translateSelf(P,C).scaleSelf(rt,st,1),nt.setTransform(lt)}}else nt=Y.createPattern(Z,"repeat");Y.save(),Y.fillStyle=nt,Y.fill("evenodd"),Y.restore()}drawPictureStroke(f,d){if(!f)return;let{colorSubstitutions:l,capStyle:c,joinStyle:P,miterLimit:C,tintColor:x,url:k,width:z}=d;const w=this._resourceManager.getResource(k);if(null==w)return;let N;if((0,g.oU)(f))N=f.rings;else if((0,g.l9)(f))N=f.paths;else{if(!(0,g.YX)(f))return(0,g.aW)(f)?void console.log("CanvasDrawHelper.drawPictureStroke - No implementation!"):void 0;N=mt(f).rings}z||(z=w.width);const Y=(0,b.TB)(k)||"src"in w&&(0,b.TB)(w.src);let J="getFrame"in w?M(w):w;l&&(J=this._colorSubstitutionHelper.applyColorSubstituition(J,l)),this._applyAdditionalRenderProps&&(Y||x&&(J=this._colorSubstitutionHelper.tintImageData(J,x)));const nt=Math.max(this.transformSize((0,S.F2)(z)),.5),Z=nt/J.width,et=this._ctx,st=et.createPattern(J,"repeat-y");let rt,lt;et.save(),this._setCapStyle(c),this._setJoinStyle(P),void 0!==C&&(et.miterLimit=C),et.lineWidth=nt;for(let ft of N)if(ft=(0,W.d9)(ft),yt(ft),ft&&!(ft.length<=1)){rt=this.transformPt(ft[0]);for(let Mt=1;Mt<ft.length;Mt++){lt=this.transformPt(ft[Mt]);const Ct=at(rt,lt),St=new DOMMatrix;St.translateSelf(0,rt[1]-nt/2).scaleSelf(Z,Z,1).rotateSelf(0,0,90-Ct),st.setTransform(St),et.strokeStyle=st,et.beginPath(),et.moveTo(rt[0],rt[1]),et.lineTo(lt[0],lt[1]),et.stroke(),rt=lt}}et.restore()}_buildPath(f,d){const l=this._ctx;if(l.beginPath(),f)for(const c of f){const P=c?c.length:0;if(P>1){let C=this.transformPt(c[0]);l.moveTo(C[0],C[1]);for(let x=1;x<P;x++)C=this.transformPt(c[x]),l.lineTo(C[0],C[1]);d&&l.closePath()}}}_setCapStyle(f){switch(f){case p.kP.Butt:this._ctx.lineCap="butt";break;case p.kP.Round:this._ctx.lineCap="round";break;case p.kP.Square:this._ctx.lineCap="square"}}_setJoinStyle(f){switch(f){case p.r4.Bevel:this._ctx.lineJoin="bevel";break;case p.r4.Round:this._ctx.lineJoin="round";break;case p.r4.Miter:this._ctx.lineJoin="miter"}}}function _t(Q,f,d){for(const l of f){const c=l.length;for(let P=1;P<c;P++){const C=l[P-1],x=l[P];let k=(x[0]-C[0])*(x[0]-C[0])+(x[1]-C[1])*(x[1]-C[1]);if(0!==k&&(k=Math.sqrt(k),Math.abs(((x[0]-C[0])*(Q[1]-C[1])-(x[1]-C[1])*(Q[0]-C[0]))/k)<d)){const w=((x[0]-C[0])*(Q[0]-C[0])+(x[1]-C[1])*(Q[1]-C[1]))/k;if(w>-d&&w<k+d)return!0}}}return!1}function at(Q,f){return 180/Math.PI*Math.atan2(f[1]-Q[1],f[0]-Q[0])}const mt=Q=>Q?{spatialReference:Q.spatialReference,rings:[[[Q.xmin,Q.ymin],[Q.xmin,Q.ymax],[Q.xmax,Q.ymax],[Q.xmax,Q.ymin],[Q.xmin,Q.ymin]]]}:null,Pt=(Q,f,d)=>{switch(Q){case"ExtraLeading":return 1+f/d;case"Multiple":return f;case"Exact":return f/d}};function gt(Q,f=1){const d=(0,b.BX)(Q),l=(0,b.wi)(Q.fontStyleName),c=Q.fontFamilyName??q.em,{weight:P,style:C}=l,x=f*(Q.height||5),k=(0,b.X_)(Q.horizontalAlignment),z=(0,b.FG)(Q.verticalAlignment),w=(0,b.W7)(Q),N=(0,b.W7)(Q.haloSymbol),Y=null!=N?f*(Q.haloSize??0):0,J="CIMBackgroundCallout"===Q.callout?.type?Q.callout.backgroundSymbol:null,nt=(0,b.W7)(J),Z=(0,b.F)(J),et=(0,b.$Z)(J);return{color:w,size:x,horizontalAlignment:k,verticalAlignment:z,font:{family:c,style:(0,b.pJ)(C),weight:(0,b.On)(P),decoration:d},halo:{size:Y||0,color:N,style:C},backgroundColor:nt,borderLine:null!=Z&&null!=et?{size:Z,color:et}:null,pixelRatio:1,premultiplyColors:!0}}const pt=1e-4;function yt(Q){let f,d,l,c,P,C=Q[0],x=1;for(;x<Q.length;)f=Q[x][0]-C[0],d=Q[x][1]-C[1],c=0!==f?d/f:Math.PI/2,void 0!==l&&c-l<=pt?(Q.splice(x-1,1),C=P):(P=C,C=Q[x],x++),l=c}},84176:(dt,it,E)=>{E.d(it,{B$:()=>K,Tg:()=>j,U1:()=>Pt,bP:()=>G,qp:()=>ot,rW:()=>v});var q=E(19939),H=E(14007),W=E(34222),A=E(4703),U=E(65311),S=E(55768),y=E(45425),u=E(43585),m=E(14890),_=E(75038),g=E(36198),n=E(73896),r=E(11196),o=E(25896),e=E(26981),h=E(26128),p=E(99657),M=E(60559),I=E(43501);const T=Math.PI,B=T/2,F=Math.PI/180,X=96/72,b=()=>A.Z.getLogger("esri.symbols.cim.CIMSymbolHelper");function v(d){let l;switch(d.type){case"cim":return d.data;case"web-style":return d;case"simple-marker":{const c=K.fromSimpleMarker(d);if(!c)throw new Error("InternalError: Cannot convert symbol to CIM");l=c;break}case"picture-marker":l=K.fromPictureMarker(d);break;case"simple-line":l=K.fromSimpleLineSymbol(d);break;case"simple-fill":l=K.fromSimpleFillSymbol(d);break;case"picture-fill":l=K.fromPictureFillSymbol(d);break;case"text":l=K.fromTextSymbol(d)}return{type:"CIMSymbolReference",symbol:l}}function O(d,l,c){switch(l.type){case"CIMSymbolReference":return O(d,l.symbol,c);case"CIMPointSymbol":null==c&&(c={x:0,y:0}),d.drawSymbol(l,c);break;case"CIMLineSymbol":null==c&&(c={paths:[[[0,0],[10,0]]]}),d.drawSymbol(l,c);break;case"CIMPolygonSymbol":null==c&&(c={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),d.drawSymbol(l,c);break;case"CIMTextSymbol":d.drawSymbol(l,{x:0,y:0});break;case"CIMVectorMarker":{const P=new _.u;d.drawMarker(l,P);break}}return d.envelope()}function L(d){if(!d)return 0;switch(d.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(d.offset);default:return 0}}function R(d){if(!d)return 0;switch(d.type){case"CIMGeometricEffectArrow":return Math.abs(.5*d.width);case"CIMGeometricEffectBuffer":return Math.abs(d.size);case"CIMGeometricEffectControlMeasureLine":return 500;case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(d.length);case"CIMGeometricEffectJog":return Math.abs(.5*d.length);case"CIMGeometricEffectMove":return Math.max(Math.abs((0,o.J0)(d.offsetX)),Math.abs((0,o.J0)(d.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(d.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(d.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(d.fromWidth),Math.abs(d.toWidth));case"CIMGeometricEffectWave":return Math.abs(d.amplitude);case"CIMGeometricEffectDonut":return Math.abs(d.width)}}function j(d){if(!d)return 0;let l=0;for(const c of d)l+=R(c);return l}class G{static getSymbolInflateSize(l,c,P,C,x){return l||(l=[0,0,0,0]),c?this._getInflateSize(l,c,P,C,x):l}static safeSize(l){const c=Math.max(Math.abs(l[0]),Math.abs(l[2])),P=Math.max(Math.abs(l[1]),Math.abs(l[3]));return Math.sqrt(c*c+P*P)}static _vectorMarkerBounds(l,c,P,C){let x=!0;const k=(0,y.Ue)();if(c?.markerGraphics)for(const z of c.markerGraphics){const w=[0,0,0,0];z.geometry&&((0,u.$P)(k,z.geometry),w[0]=0,w[1]=0,w[2]=0,w[3]=0,this.getSymbolInflateSize(w,z.symbol,P,0,C),k[0]+=w[0],k[1]+=w[1],k[2]+=w[2],k[3]+=w[3],x?(l[0]=k[0],l[1]=k[1],l[2]=k[2],l[3]=k[3],x=!1):(l[0]=Math.min(l[0],k[0]),l[1]=Math.min(l[1],k[1]),l[2]=Math.max(l[2],k[2]),l[3]=Math.max(l[3],k[3])))}return l}static _getInflateSize(l,c,P,C,x){if(function gt(d){return void 0!==d.symbolLayers}(c)){const k=this._getLayersInflateSize(l,c.symbolLayers,P,C,x),z=j(c.effects);return z>0&&(k[0]-=z,k[1]-=z,k[2]+=z,k[3]+=z),k}return this._getTextInflatedSize(l,c,x)}static _getLayersInflateSize(l,c,P,C,x){let k=!0;if(!c)return l;for(const z of c){if(!z)continue;let w=[0,0,0,0];switch(z.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{let J=z.width;null!=J&&(J/=z.capStyle===r.kP.Square||z.joinStyle===r.r4.Miter?1.4142135623730951:2,w[0]=-J,w[1]=-J,w[2]=J,w[3]=J);break}case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":{const Y=z;if("CIMVectorMarker"===z.type){const st=z;if(w=this._vectorMarkerBounds(w,st,P,x),st.frame){const rt=(st.frame.xmin+st.frame.xmax)/2,lt=(st.frame.ymin+st.frame.ymax)/2;if(w[0]-=rt,w[1]-=lt,w[2]-=rt,w[3]-=lt,null!=st.size){const ft=st.size/(st.frame.ymax-st.frame.ymin);w[0]*=ft,w[1]*=ft,w[2]*=ft,w[3]*=ft}}}else if("CIMPictureMarker"===z.type){const st=z,rt=P.getResource(st.url);let lt=1;if(null!=rt&&rt.height&&(lt=rt.width/rt.height),null!=Y.size){const ft=Y.size/2,Mt=Y.size*lt*st.scaleX/2;w=[-Mt,-ft,Mt,ft]}}else if(null!=Y.size){const st=Y.size/2;w=[-st,-st,st,st]}if(Y.anchorPoint){let st,rt;"Absolute"===Y.anchorPointUnits?(st=Y.anchorPoint.x,rt=Y.anchorPoint.y):(st=Y.anchorPoint.x*(w[2]-w[0]),rt=Y.anchorPoint.y*(w[3]-w[1]));const lt=1.25*Math.sqrt(st*st+rt*rt);w[0]-=lt,w[1]-=lt,w[2]+=lt,w[3]+=lt}let J=(0,o.J0)(Y.rotation);if(Y.rotateClockwise&&(J=-J),C&&(J-=C),J){const st=F*J,rt=Math.cos(st),lt=Math.sin(st),ft=(0,y.Ue)([h.FM,h.FM,-h.FM,-h.FM]);(0,y.Ho)(ft,[w[0]*rt-w[1]*lt,w[0]*lt+w[1]*rt]),(0,y.Ho)(ft,[w[0]*rt-w[3]*lt,w[0]*lt+w[3]*rt]),(0,y.Ho)(ft,[w[2]*rt-w[1]*lt,w[2]*lt+w[1]*rt]),(0,y.Ho)(ft,[w[2]*rt-w[3]*lt,w[2]*lt+w[3]*rt]),w=ft}let nt=(0,o.J0)(Y.offsetX),Z=(0,o.J0)(Y.offsetY);if(C){const st=F*C,rt=Math.cos(st),lt=Math.sin(st),ft=nt*lt+Z*rt;nt=nt*rt-Z*lt,Z=ft}w[0]+=nt,w[1]+=Z,w[2]+=nt,w[3]+=Z;const et=L(Y.markerPlacement);et>0&&(w[0]-=et,w[1]-=et,w[2]+=et,w[3]+=et);break}}const N=j(z.effects);N>0&&(w[0]-=N,w[1]-=N,w[2]+=N,w[3]+=N),k?(l[0]=w[0],l[1]=w[1],l[2]=w[2],l[3]=w[3],k=!1):(l[0]=Math.min(l[0],w[0]),l[1]=Math.min(l[1],w[1]),l[2]=Math.max(l[2],w[2]),l[3]=Math.max(l[3],w[3]))}return l}static _getTextInflatedSize(l,c,P){const C=(0,I.vn)(c.height??n.E.CIMTextSymbol.height);if(l[0]=-C/2,l[1]=-C/2,l[2]=C/2,l[3]=C/2,!P)return l;const x=P.get(c);if(!x||!x.glyphMosaicItems.glyphs.length)return l;const{lineGapType:k,lineGap:z}=c,w=k?(0,g.et)(k,z??0,C):0,N="CIMBackgroundCallout"===c.callout?.type,Y=(0,M.Nr)(x.glyphMosaicItems,{scale:C/p.iD,angle:(0,o.J0)(c.angle),xOffset:(0,o.J0)(c.offsetX),yOffset:(0,o.J0)(c.offsetY),horizontalAlignment:c.horizontalAlignment,verticalAlignment:c.verticalAlignment,maxLineWidth:(0,I.g1)(c.lineWidth),lineHeight:p.uk*Math.max(.25,Math.min(w||1,4)),decoration:c.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:N}).boundsT,J=Math.sqrt(Y.width*Y.width+Y.height*Y.height);return l[0]-=Y.x+J,l[1]-=Y.y-J,l[2]+=Y.x+J,l[3]+=-Y.y+J,l}}class K{static getEnvelope(l,c,P){if(!l)return null;const C=new g.uQ(P);if(Array.isArray(l)){let x;for(const k of l)x?x.union(O(C,k,c)):x=O(C,k,c);return x}return O(C,l,c)}static getTextureAnchor(l,c){const P=this.getEnvelope(l,null,c);if(!P)return[0,0,0];const z=P.height*X+2;return[-(P.x+.5*P.width)*X/(P.width*X+2),-(P.y+.5*P.height)*X/z,z]}static rasterize(l,c,P,C,x=!0){const k=P||this.getEnvelope(c,null,C);if(!k)return[null,0,0,0,0];const z=(k.x+.5*k.width)*X,w=(k.y+.5*k.height)*X;l.width=k.width*X,l.height=k.height*X,P||(l.width+=2,l.height+=2);const N=l.getContext("2d",{willReadFrequently:!0}),Y=g.zA.createScale(X,-X);Y.translate(.5*l.width-z,.5*l.height+w);const J=new g.cD(N,C,Y);switch(c.type){case"CIMPointSymbol":J.drawSymbol(c,{type:"point",x:0,y:0});break;case"CIMVectorMarker":{const et=new _.u;J.drawMarker(c,et);break}}const nt=N.getImageData(0,0,l.width,l.height),Z=new Uint8Array(nt.data);if(x){let et;for(let st=0;st<Z.length;st+=4)et=Z[st+3]/255,Z[st]=Z[st]*et,Z[st+1]=Z[st+1]*et,Z[st+2]=Z[st+2]*et}return[Z,l.width,l.height,-z/l.width,-w/l.height]}static fromTextSymbol(l){const{text:c}=l;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:K.createCIMTextSymbolfromTextSymbol(l),textString:c}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}static fromPictureFillSymbol(l){const{height:c,outline:P,width:C,xoffset:x,xscale:k,yoffset:z,yscale:w}=l,N=[],Y={type:"CIMPolygonSymbol",symbolLayers:N};if(P){const st=f(P);st&&N.push(st)}let J=l.url;"esriPFS"===l.type&&l.imageData&&(J=l.imageData);const nt="angle"in l?l.angle??0:0;return N.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:r.Qb.Picture,tintColor:null,url:J,height:(c??0)*(w||1),width:(C??0)*(k||1),offsetX:(0,o.J0)(x),offsetY:(0,o.J0)(z),rotation:(0,o.J0)(-nt),colorSubstitutions:null}),Y}static fromSimpleFillSymbol(l){const{color:c,style:P,outline:C}=l,x=[],k={type:"CIMPolygonSymbol",symbolLayers:x};if(C){const z=f(C);z&&x.push(z)}if(P&&"solid"!==P&&"none"!==P&&"esriSFSSolid"!==P&&"esriSFSNull"!==P){const z={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:ht(c),capStyle:r.kP.Butt,joinStyle:r.r4.Miter,width:.75}]};let w=0;const N=(0,S.Wz)(yt(P)?8:10);switch(P){case"vertical":case"esriSFSVertical":w=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":w=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":w=45;break;case"cross":case"esriSFSCross":w=0}x.push({type:"CIMHatchFill",lineSymbol:z,offsetX:0,offsetY:0,rotation:w,separation:N}),"cross"===P||"esriSFSCross"===P?x.push({type:"CIMHatchFill",lineSymbol:(0,W.d9)(z),offsetX:0,offsetY:0,rotation:90,separation:N}):"diagonal-cross"!==P&&"esriSFSDiagonalCross"!==P||x.push({type:"CIMHatchFill",lineSymbol:(0,W.d9)(z),offsetX:0,offsetY:0,rotation:45,separation:N})}else!P||"solid"!==P&&"esriSFSSolid"!==P||x.push({type:"CIMSolidFill",enable:!0,color:ht(c)});return k}static fromSimpleLineSymbol(l){const{cap:c,color:P,join:C,marker:x,miterLimit:k,style:z,width:w}=l;let N=null;"solid"!==z&&"none"!==z&&"esriSLSSolid"!==z&&"esriSLSNull"!==z&&(N=[{type:"CIMGeometricEffectDashes",dashTemplate:Pt(z,c),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const Y=[];if(x){let J;switch(x.placement){case"begin-end":J=r.Tx.Both;break;case"begin":J=r.Tx.JustBegin;break;case"end":J=r.Tx.JustEnd;break;default:J=r.Tx.None}const nt=K.fromSimpleMarker(x,w,P).symbolLayers[0];nt.markerPlacement={type:"CIMMarkerPlacementAtExtremities",placePerPart:!1,angleToLine:!0,offset:0,extremityPlacement:J,offsetAlongLine:0},Y.push(nt)}return Y.push({type:"CIMSolidStroke",color:"none"!==z&&"esriSLSNull"!==z?ht(P):[0,0,0,0],capStyle:ot(c),joinStyle:$(C),miterLimit:k,width:w,effects:N}),{type:"CIMLineSymbol",symbolLayers:Y}}static fromPictureMarker(l){const{angle:c,height:P,width:C,xoffset:x,yoffset:k}=l;let z=l.url;return"esriPMS"===l.type&&l.imageData&&(z=l.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:r.Qb.Picture,tintColor:null,url:z,size:P,width:C,offsetX:(0,o.J0)(x),offsetY:(0,o.J0)(k),rotation:(0,o.J0)(-c)}]}}static createCIMTextSymbolfromTextSymbol(l){const{angle:c,color:P,font:C,haloColor:x,haloSize:k,horizontalAlignment:z,kerning:w,lineWidth:N,text:Y,verticalAlignment:J,xoffset:nt,yoffset:Z,backgroundColor:et,borderLineColor:st,borderLineSize:rt}=l;let lt,ft,Mt,Ct,St,xt;C&&(lt=C.family,ft=C.style,Mt=C.weight,Ct=C.size,St=C.decoration);let It=!1;return Y&&(It=(0,q.E)(Y)[1]),(et||rt)&&(xt={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:ht(et)},{type:"CIMSolidStroke",color:ht(st),width:rt}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null}),{type:"CIMTextSymbol",angle:c,blockProgression:r.zV.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:r.eZ.Normal,fontEncoding:r.DD.Unicode,fontFamilyName:lt||"Arial",fontStyleName:_t(ft,Mt),fontType:r.Ky.Unspecified,haloSize:k,height:Ct,hinting:r.Dd.Default,horizontalAlignment:ut(z??"center"),kerning:w,letterWidth:100,ligatures:!0,lineGapType:"Multiple",lineWidth:N,offsetX:(0,o.J0)(nt),offsetY:(0,o.J0)(Z),strikethrough:"line-through"===St,underline:"underline"===St,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:ht(P)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:ht(x)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:It?r.UX.RTL:r.UX.LTR,verticalAlignment:ct(J??"baseline"),verticalGlyphOrientation:r.RS.Right,wordSpacing:100,billboardMode3D:r.UR.FaceNearPlane,callout:xt}}static createPictureMarkerRasterizationParam(l){const{angle:c,height:P,width:C,xoffset:x,yoffset:k}=l,z=l.url??l.source?.url??l.source?.imageData;return z?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:r.Qb.Picture,tintColor:null,url:z,size:P,width:C,offsetX:(0,o.J0)(x),offsetY:(0,o.J0)(k),rotation:(0,o.J0)(-c)}}:null}static createPictureFillRasterizationParam(l){const{width:c,height:P,xoffset:C,yoffset:x,url:k}=l;return k?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureFill",scaleX:1,textureFilter:r.Qb.Picture,tintColor:null,url:k,width:c,height:P,offsetX:(0,o.J0)(C),offsetY:(0,o.J0)(x),rotation:0}}:null}static fromSimpleMarker(l,c,P){const{style:C}=l,x=l.color??P;if("path"===C||"esriSMSPath"===C){const J=[];if("outline"in l&&l.outline){const et=l.outline;J.push({type:"CIMSolidStroke",enable:!0,width:et.width,color:ht(et.color),path:l.path})}J.push({type:"CIMSolidFill",enable:!0,color:ht(x),path:l.path});const[nt,Z]=pt("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:-(0,o.J0)(l.angle),size:(0,o.J0)(l.size||6),offsetX:(0,o.J0)(l.xoffset),offsetY:(0,o.J0)(l.yoffset),scaleSymbolsProportionally:!1,frame:nt,markerGraphics:[{type:"CIMMarkerGraphic",geometry:Z,symbol:{type:"CIMPolygonSymbol",symbolLayers:J}}]}]}}const k=[];let z,w,N=l.size;if("outline"in l&&l.outline&&"none"!==l.outline.style&&"esriSLSNull"!==l.outline.style){const J=l.outline,nt="solid"!==J.style&&"esriSLSSolid"!==J.style;[z,w]=nt?pt(C,l.size):pt(C);const Z=J.width??e.CJ.width;if(nt){const rt=Z/l.size,lt=(z.xmax-z.xmin)*rt/2,ft=(z.ymax-z.ymin)*rt/2;z.xmin-=lt,z.xmax+=lt,z.ymin-=ft,z.ymax+=ft,N&&(N+=Z)}const et="cross"!==l.style&&"x"!==l.style||"dot"===l?.outline.style||"short-dot"===l?.outline.style?r.sj.HalfGap:r.sj.FullPattern,st=nt?[{type:"CIMGeometricEffectAddControlPoints"},{type:"CIMGeometricEffectDashes",dashTemplate:Pt(J.style,null).map(rt=>J.width&&J.width>0?rt*J.width:rt),lineDashEnding:et,controlPointEnding:r.sj.FullPattern}]:void 0;k.push({type:"CIMSolidStroke",capStyle:nt?r.kP.Round:r.kP.Butt,enable:!0,width:Z,color:ht(J.color),effects:st})}else!c||"line-marker"!==l.type||"cross"!==l.style&&"x"!==l.style?[z,w]=pt(C):([z,w]=pt(C),k.push({type:"CIMSolidStroke",enable:!0,width:c,color:ht(x)}));k.push({type:"CIMSolidFill",enable:!0,color:ht(x)});const Y={type:"CIMPolygonSymbol",symbolLayers:k};return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,o.J0)(-l.angle),size:(0,o.J0)(N||6*c),offsetX:(0,o.J0)(l.xoffset),offsetY:(0,o.J0)(l.yoffset),scaleSymbolsProportionally:!1,frame:z,markerGraphics:[{type:"CIMMarkerGraphic",geometry:w,symbol:Y}]}]}}static fromCIMHatchFill(l,c){const P=c*(l.separation??n.E.CIMHatchFill.separation),C=P/2,x=(0,W.d9)(l.lineSymbol);x.symbolLayers?.forEach(w=>{switch(w.type){case"CIMSolidStroke":null!=w.width&&(w.width*=c),w.effects?.forEach(N=>{if("CIMGeometricEffectDashes"===N.type){const Y=N.dashTemplate;N.dashTemplate=Y?.map(J=>J*c)}});break;case"CIMVectorMarker":{null!=w.size&&(w.size*=c);const N=w.markerPlacement;null!=N&&"placementTemplate"in N&&(N.placementTemplate=N.placementTemplate.map(Y=>Y*c));break}}});let k=this._getLineSymbolPeriod(x)||4;for(;k<4;)k*=2;const z=k/2;return{type:"CIMVectorMarker",frame:{xmin:-z,xmax:z,ymin:-C,ymax:C},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-z,0],[z,0]]]},symbol:x}],size:P}}static fetchResources(l,c,P,C=null){return l&&c&&tt(l,x=>{(function Q(d,l,c){if(d.effects&&null==l.geometryEngine){if(l.geometryEnginePromise)return void c.push(l.geometryEnginePromise);(0,o.Cc)(d.effects)&&(l.geometryEnginePromise=(0,o.RI)(),c.push(l.geometryEnginePromise),l.geometryEnginePromise.then(P=>l.geometryEngine=P))}})(x,c,P),"url"in x&&x.url&&P.push(c.fetchResource(x.url,{signal:C}))}),P}static fetchFonts(l,c,P){if(l&&c)if("symbolLayers"in l&&l.symbolLayers){for(const C of l.symbolLayers)if("CIMVectorMarker"===C.type&&C.markerGraphics)for(const x of C.markerGraphics)x?.symbol&&K.fetchFonts(x.symbol,c,P)}else if("CIMTextSymbol"===l.type){const{fontFamilyName:C,fontStyleName:x}=l;if(!C||"calcitewebcoreicons"===C.toLowerCase())return;const{style:k,weight:z}=(0,o.wi)(x),w=(0,o.BX)(l),N=new m.Z({family:C,style:k,weight:z,decoration:w});P.push(c.loadFont(N).catch(()=>{b().error(`Unsupported font ${C} in CIM symbol`)}))}}static _getLineSymbolPeriod(l){if(l){const c=this._getEffectsRepeat(l.effects);if(c)return c;if(l.symbolLayers)for(const P of l.symbolLayers)if(P){const C=this._getEffectsRepeat(P.effects);if(C)return C;switch(P.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const x=this._getPlacementRepeat(P.markerPlacement);if(x)return x}}}}return 0}static _getEffectsRepeat(l){if(l)for(const c of l)if(c)switch(c.type){case"CIMGeometricEffectDashes":{const P=c.dashTemplate;if(P&&P.length){let C=0;for(const x of P)C+=x;return 1&P.length&&(C*=2),C}break}case"CIMGeometricEffectWave":return c.period;default:b().error(`unsupported geometric effect type ${c.type}`)}return 0}static _getPlacementRepeat(l){if(l)switch(l.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const c=l.placementTemplate;if(c&&c.length){let P=0;for(const C of c)P+=+C;return 1&c.length&&(P*=2),P}break}}return 0}static fromCIMInsidePolygon(l){const c=l.markerPlacement,P={...l};P.markerPlacement=null,P.anchorPoint=null;const C=Math.abs(c.stepX),x=Math.abs(c.stepY),k=(c.randomness??100)/100;let z,w,N,Y;if("Random"===c.gridType){const J=(0,S.Wz)(p.KA),nt=Math.max(Math.floor(J/C),1),Z=Math.max(Math.floor(J/x),1);z=nt*C/2,w=Z*x/2,N=2*w;const et=new U.Z(c.seed),st=k*C/1.5,rt=k*x/1.5;Y=[];for(let lt=0;lt<nt;lt++)for(let ft=0;ft<Z;ft++){const Mt=lt*C-z+st*(.5-et.getFloat()),Ct=ft*x-w+rt*(.5-et.getFloat());Y.push({x:Mt,y:Ct}),0===lt&&Y.push({x:Mt+2*z,y:Ct}),0===ft&&Y.push({x:Mt,y:Ct+2*w})}}else!0===c.shiftOddRows?(z=C/2,w=x,N=2*x,Y=[{x:-z,y:0},{x:z,y:0},{x:0,y:w},{x:0,y:-w}]):(z=C/2,w=x/2,N=x,Y=[{x:-C,y:0},{x:0,y:-x},{x:-C,y:-x},{x:0,y:0},{x:C,y:0},{x:0,y:x},{x:C,y:x},{x:-C,y:x},{x:C,y:-x}]);return{type:"CIMVectorMarker",frame:{xmin:-z,xmax:z,ymin:-w,ymax:w},markerGraphics:Y.map(J=>({type:"CIMMarkerGraphic",geometry:J,symbol:{type:"CIMPointSymbol",symbolLayers:[P]}})),size:N}}}function tt(d,l){if(d)switch(d.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const c=d.symbolLayers;if(!c)return;for(const P of c)if(l(P),"CIMVectorMarker"===P.type){const C=P.markerGraphics;if(!C)continue;for(const x of C)if(x){const k=x.symbol;k&&tt(k,l)}}break}}}const ot=d=>{if(!d)return r.kP.Butt;switch(d){case"butt":return r.kP.Butt;case"square":return r.kP.Square;case"round":return r.kP.Round}},$=d=>{if(!d)return r.r4.Miter;switch(d){case"miter":return r.r4.Miter;case"round":return r.r4.Round;case"bevel":return r.r4.Bevel}},ut=d=>{if(null==d)return"Center";switch(d){case"left":return"Left";case"right":return"Right";case"center":return"Center"}},ct=d=>{if(null==d)return"Center";switch(d){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},ht=d=>{if(!d)return[0,0,0,0];const{r:l,g:c,b:P,a:C}=d;return[l,c,P,255*C]},_t=(d,l)=>{const c=at(l),P=mt(d);return c&&P?`${c}-${P}`:`${c}${P}`},at=d=>{if(!d)return"";switch(d.toLowerCase()){case"bold":case"bolder":return"bold"}return""},mt=d=>{if(!d)return"";switch(d.toLowerCase()){case"italic":case"oblique":return"italic"}return""},Pt=(d,l)=>{const c=(0,H.Z)("safari")?.001:0,P="butt"===l;switch(d){case"dash":case"esriSLSDash":return P?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return P?[4,3,1,3]:[3,4,c,4];case"dot":case"esriSLSDot":return P?[1,3]:[c,4];case"long-dash":case"esriSLSLongDash":return P?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return P?[8,3,1,3]:[7,4,c,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return P?[8,3,1,3,1,3]:[7,4,c,4,c,4];case"short-dash":case"esriSLSShortDash":return P?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return P?[4,1,1,1]:[3,2,c,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return P?[4,1,1,1,1,1]:[3,2,c,2,c,2];case"short-dot":case"esriSLSShortDot":return P?[1,1]:[c,2];case"solid":case"esriSLSSolid":case"none":return b().error("Unexpected: style does not require rasterization"),[0,0];default:return b().error(`Tried to rasterize SLS, but found an unexpected style: ${d}!`),[0,0]}},pt=(d,l=100)=>{const c=l/2;let P,C;const x=d;if("circle"===x||"esriSMSCircle"===x){let z=Math.acos(1-.25/c),w=Math.ceil(T/z/4);0===w&&(w=1),z=B/w,w*=4;const N=[];N.push([c,0]);for(let Y=1;Y<w;Y++)N.push([c*Math.cos(Y*z),-c*Math.sin(Y*z)]);N.push([c,0]),P={rings:[N]},C={xmin:-c,ymin:-c,xmax:c,ymax:c}}else if("cross"===x||"esriSMSCross"===x)P={paths:[[[0,c],[0,-c]],[[c,0],[-c,0]]]},C={xmin:-c,ymin:-c,xmax:c,ymax:c};else if("diamond"===x||"esriSMSDiamond"===x)P={rings:[[[-c,0],[0,c],[c,0],[0,-c],[-c,0]]]},C={xmin:-c,ymin:-c,xmax:c,ymax:c};else if("square"===x||"esriSMSSquare"===x)P={rings:[[[-c,-c],[-c,c],[c,c],[c,-c],[-c,-c]]]},C={xmin:-c,ymin:-c,xmax:c,ymax:c};else if("x"===x||"esriSMSX"===x)P={paths:[[[c,c],[-c,-c]],[[c,-c],[-c,c]]]},C={xmin:-c,ymin:-c,xmax:c,ymax:c};else if("triangle"===x||"esriSMSTriangle"===x){const k=.5773502691896257*l,z=-k,w=2/3*l,N=w-l;P={rings:[[[z,N],[0,w],[k,N],[z,N]]]},C={xmin:z,ymin:N,xmax:k,ymax:w}}else"arrow"===x&&(P={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},C={xmin:-c,ymin:-c,xmax:c,ymax:c});return[C,P]},yt=d=>"vertical"===d||"horizontal"===d||"cross"===d||"esriSFSCross"===d||"esriSFSVertical"===d||"esriSFSHorizontal"===d;function f(d){if(!d)return null;let l=null;const{cap:c,color:P,join:C,miterLimit:x,style:k,width:z}=d;return"solid"!==k&&"none"!==k&&"esriSLSSolid"!==k&&"esriSLSNull"!==k&&(l=[{type:"CIMGeometricEffectDashes",dashTemplate:Pt(k,c),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),{type:"CIMSolidStroke",color:"esriSLSNull"!==k&&"none"!==k?ht(P):[0,0,0,0],capStyle:ot(c),joinStyle:$(C),miterLimit:x,width:z,effects:l}}},24862:(dt,it,E)=>{E.d(it,{D:()=>W,N:()=>A});var q=E(7587),H=E(11196);const W=.03;class A{constructor(S=0,y=!1){}isEmpty(S){if(!S.nextPoint())return!0;let y,u,m,_;for(y=S.x,u=S.y;S.nextPoint();y=u,u=_)if(m=S.x,_=S.y,m!==y||_!==u)return S.seekPathStart(),!1;return S.seekPathStart(),!0}normalize(S){const y=Math.sqrt(S[0]*S[0]+S[1]*S[1]);0!==y&&(S[0]/=y,S[1]/=y)}getLength(S,y,u,m){const _=u-S,g=m-y;return Math.sqrt(_*_+g*g)}getSegLength(S){const[[y,u],[m,_]]=S;return this.getLength(y,u,m,_)}getCoord2D(S,y,u,m,_){return[S+(u-S)*_,y+(m-y)*_]}getSegCoord2D(S,y){const[[u,m],[_,g]]=S;return this.getCoord2D(u,m,_,g,y)}getAngle(S,y,u,m,_){return Math.atan2(m-y,u-S)}getAngleCS(S,y,u,m,_){const g=u-S,n=m-y,r=Math.sqrt(g*g+n*n);return r>0?[g/r,n/r]:[1,0]}getSegAngleCS(S,y){const[[u,m],[_,g]]=S;return this.getAngleCS(u,m,_,g,y)}cut(S,y,u,m,_,g){return[_<=0?[S,y]:this.getCoord2D(S,y,u,m,_),g>=1?[u,m]:this.getCoord2D(S,y,u,m,g)]}getSubCurve(S,y,u){const m=q.z.createEmptyOptimizedCIM("esriGeometryPolyline");return this.appendSubCurve(m,S,y,u)?m:null}appendSubCurve(S,y,u,m){S.startPath(),y.seekPathStart();let _=0,g=!0;if(!y.nextPoint())return!1;let n=y.x,r=y.y;for(;y.nextPoint();){const o=this.getLength(n,r,y.x,y.y);if(0!==o){if(g){if(_+o>u){let h=1,p=!1;_+o>=m&&(h=(m-_)/o,p=!0);const M=this.cut(n,r,y.x,y.y,(u-_)/o,h);if(M&&S.pushPoints(M),p)break;g=!1}}else{if(_+o>m){const e=this.cut(n,r,y.x,y.y,0,(m-_)/o);e&&S.pushPoint(e[1]);break}S.pushXY(y.x,y.y)}_+=o,n=y.x,r=y.y}else n=y.x,r=y.y}return!0}getCIMPointAlong(S,y){if(!S.nextPoint())return null;let u,m,_,g,n=0;for(u=S.x,m=S.y;S.nextPoint();u=_,m=g){_=S.x,g=S.y;const r=this.getLength(u,m,_,g);if(0!==r){if(n+r>y)return this.getCoord2D(u,m,_,g,(y-n)/r);n+=r}}return null}offset(S,y,u,m,_){if(!S||S.length<2)return null;let g=0,n=S[g++],r=g;for(;g<S.length;){const p=S[g];p[0]===n[0]&&p[1]===n[1]||(g!==r&&(S[r]=S[g]),n=S[r++]),g++}const o=S[0][0]===S[r-1][0]&&S[0][1]===S[r-1][1];if(o&&--r,r<(o?3:2))return null;const e=[];n=o?S[r-1]:null;let h=S[0];for(let p=0;p<r;p++){const M=p===r-1?o?S[0]:null:S[p+1];if(n)if(M){const I=[M[0]-h[0],M[1]-h[1]];this.normalize(I);const T=[h[0]-n[0],h[1]-n[1]];this.normalize(T);const B=T[0]*I[1]-T[1]*I[0],F=T[0]*I[0]+T[1]*I[1];if(0===B&&1===F){h=M;continue}if(B>=0==y<=0){if(F<1){const X=[I[0]-T[0],I[1]-T[1]];this.normalize(X);const V=Math.sqrt((1+F)/2);if(V>1/m){const D=-Math.abs(y)/V;e.push([h[0]-X[0]*D,h[1]-X[1]*D])}}}else switch(u){case H.id.Mitered:{const X=Math.sqrt((1+F)/2);if(X>0&&1/X<m){const V=[I[0]-T[0],I[1]-T[1]];this.normalize(V);const D=Math.abs(y)/X;e.push([h[0]-V[0]*D,h[1]-V[1]*D]);break}}case H.id.Bevelled:e.push([h[0]+T[1]*y,h[1]-T[0]*y]),e.push([h[0]+I[1]*y,h[1]-I[0]*y]);break;case H.id.Rounded:if(F<1){e.push([h[0]+T[1]*y,h[1]-T[0]*y]);const X=Math.floor(2.5*(1-F));if(X>0){const V=1/X;let D=V;for(let b=1;b<X;b++,D+=V){const v=[T[1]*(1-D)+I[1]*D,-T[0]*(1-D)-I[0]*D];this.normalize(v),e.push([h[0]+v[0]*y,h[1]+v[1]*y])}}e.push([h[0]+I[1]*y,h[1]-I[0]*y])}break;default:if(B<0)e.push([h[0]+(T[1]+T[0])*y,h[1]+(T[1]-T[0])*y]),e.push([h[0]+(I[1]-I[0])*y,h[1]-(I[0]+I[1])*y]);else{const X=Math.sqrt((1+Math.abs(F))/2),V=[I[0]-T[0],I[1]-T[1]];this.normalize(V);const D=y/X;e.push([h[0]-V[0]*D,h[1]-V[1]*D])}}}else{const I=[h[0]-n[0],h[1]-n[1]];this.normalize(I),e.push([h[0]+I[1]*y,h[1]-I[0]*y])}else{const I=[M[0]-h[0],M[1]-h[1]];this.normalize(I),e.push([h[0]+I[1]*y,h[1]-I[0]*y])}n=h,h=M}return e.length<(o?3:2)?null:(o&&e.push([e[0][0],e[0][1]]),e)}}},84086:(dt,it,E)=>{E.d(it,{Ll:()=>u,Yw:()=>U,h9:()=>A,u:()=>S});var S,m,q=E(7587),H=E(24862);class A{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return 0===this._values.length}size(){return this._values.length}init(_,g,n=!0){if(this._setEmpty(),!_||0===_.length)return!1;for(let r=0;r<_.length;r++){let o=Math.abs(_[r]);n&&o<1e-7&&(o=1e-7),this._values.push(o),this._length+=o}return g&&1&_.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(_){const g=this._values?this._values.length:0;for(let n=0;n<g;++n)this._values[n]*=_;this._length*=_,this.extPtGap*=_,this.ctrlPtGap*=_}addValue(_){this._length+=_,this._values.push(_)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}class U{constructor(){this.pt=null,this.ca=0,this.sa=0}}(m=S||(S={}))[m.FAIL=0]="FAIL",m[m.END=1]="END",m[m.CONTINUE=2]="CONTINUE";class y{constructor(){this.reset()}reset(){this.segment=null,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return null!==this.segment}copyTo(_){_.segment=this.segment,_.segmentLength=this.segmentLength,_.abscissa=this.abscissa,_.isPathEnd=this.isPathEnd,_.isPartEnd=this.isPartEnd}}class u extends H.N{constructor(_=0,g=!1){super(_,g),this._tolerance=H.D,this._currentPosition=new y}updateTolerance(_){this._tolerance=H.D*_}init(_,g,n=!0){return n?(this._patternLength=g.length(),this._partExtPtGap=g.extPtGap,this._partCtrlPtGap=g.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._pathCursor=_,this._seg=-1,this._setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(_,g=S.FAIL){const n=new y;return!!this._nextPosition(_,n,null,g)&&(n.copyTo(this._currentPosition),!0)}curPointAndAngle(_){_.pt=this._getPoint(this._currentPosition);const[g,n]=this._getAngleCS(this._currentPosition);_.ca=g,_.sa=n}nextPointAndAngle(_,g,n=S.FAIL){const r=new y;if(!this._nextPosition(_,r,null,n))return!1;r.copyTo(this._currentPosition),g.pt=this._getPoint(r);const[o,e]=this._getAngleCS(r);return g.ca=o,g.sa=e,!0}nextCurve(_){if(0===_)return null;const g=q.z.createEmptyOptimizedCIM("esriGeometryPolyline");g.startPath(),g.nextPath();const n=new y;return this._nextPosition(_,n,g,S.END)?(n.copyTo(this._currentPosition),g):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){return this._currentPosition.segment[1]}getPt(_){return this._pathCursor.seekInPath(_),[this._pathCursor.x,this._pathCursor.y]}getSeg(_){return[this.getPt(_),this.getPt(_+1)]}_nextPosition(_,g,n,r){if(this._currentPosition.isPathEnd)return!1;let o=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(o/=this._currentPosition.segmentLength),this._currentPosition.copyTo(g);g.abscissa+_*this._partLengthRatio>g.segmentLength+this._tolerance;){if(n){if(0===n.pathSize)if(0===o){const h=g.segment[0];n.pushXY(h[0],h[1])}else n.pushPoint(this.getSegCoord2D(g.segment,o));const e=g.segment[1];n.pushXY(e[0],e[1])}if(o=0,_-=(g.segmentLength-g.abscissa)/this._partLengthRatio,this._partSegCount)g.segment=this._nextSegment(),g.segmentLength=this.getSegLength(g.segment),g.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart())return r!==S.FAIL&&(g.segmentLength=this.getSegLength(g.segment),g.isPartEnd=!0,r===S.END?(g.abscissa=g.segmentLength,g.isPathEnd=!0):g.abscissa=g.segmentLength+_,!0);this._currentPosition.copyTo(g)}}if(g.abscissa+=_*this._partLengthRatio,n){0===n.pathSize&&n.pushPoint(0===o?g.segment[0]:this.getSegCoord2D(g.segment,o));const e=g.abscissa/g.segmentLength;n.pushPoint(1===e?g.segment[1]:this.getSegCoord2D(g.segment,e))}return this._partSegCount||Math.abs(g.abscissa-g.segmentLength)<this._tolerance&&(g.isPathEnd=this._partIsLast,g.isPartEnd=!0),!0}_getPoint(_){return this.getSegCoord2D(this._currentPosition.segment,_.segmentLength<=0?0:_.abscissa/_.segmentLength)}_getAngleCS(_){return this.getSegAngleCS(this._currentPosition.segment,_.segmentLength<=0?0:_.abscissa/_.segmentLength)}_setPosAtNextPart(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.getSegLength(this._nextSegment()),this._partSegCount++,this._pathCursor.getControlPointAt(this._getEndPointIndex())){this._partIsLast=!this._hasNextSegment();break}let _=this._partSegCount;for(;_;)this._previousSegment(),--_;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.getSegLength(this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const g=this._getStartPointIndex();this._ctrlPtBegin=this._pathCursor.getControlPointAt(g);let n=g+this._partSegCount+1;if(n>=this._pathCursor.pathSize&&(n=0),this._ctrlPtEnd=this._pathCursor.getControlPointAt(n),this._patternLength>0){const r=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,o=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let e=Math.round((this._partLength-(r+o))/this._patternLength);e<=0&&(e=r+o>0?0:1),this._partLengthRatio=this._partLength/(r+o+e*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}_hasNextSegment(){return this._seg<this._pathCursor.pathSize-2}_previousSegment(){return this.getSeg(--this._seg)}_nextSegment(){return this.getSeg(++this._seg)}_getStartPointIndex(){return this._seg}_getEndPointIndex(){return this._seg+1}}},43818:(dt,it,E)=>{E.d(it,{Z:()=>q});class q{constructor(W=0,A=0,U=0,S=0){this.x=W,this.y=A,this.width=U,this.height=S}static fromExtent(W){return new q(W.xmin,-W.ymax,W.xmax-W.xmin,W.ymax-W.ymin)}get isEmpty(){return this.width<=0||this.height<=0}union(W){this.x=Math.min(this.x,W.x),this.y=Math.min(this.y,W.y),this.width=Math.max(this.width,W.width),this.height=Math.max(this.height,W.height)}}},77442:(dt,it,E)=>{E.d(it,{P:()=>m});var q=E(7587),H=E(93297),W=E(70207),A=E(24862),U=E(11196);const S=1.7320508075688772,u=U.TF.OpenEnded;let m=(()=>{class g{static local(){return null===g.instance&&(g.instance=new g),g.instance}execute(r,o,e,h,p){return new _(r,o,e)}}return g.instance=null,g})();class _ extends W.vT{constructor(n,r,o){super(n,!1,!0),this._curveHelper=new A.N,this._width=(void 0!==r.width?r.width:5)*o,this._arrowType=void 0!==r.geometricEffectArrowType?r.geometricEffectArrowType:void 0!==r.arrowType?r.arrowType:u,this._offsetFlattenError=A.D*o}processPath(n){const r=q.z.createEmptyOptimizedCIM(n.geometryType);switch(this._arrowType){case U.TF.OpenEnded:default:this._constructSimpleArrow(r,n,!0);break;case U.TF.Block:this._constructSimpleArrow(r,n,!1);break;case U.TF.Crossed:this._constructCrossedArrow(r,n)}return r}_constructSimpleArrow(n,r,o){const e=r.pathLength();let h=this._width;e<2*h&&(h=e/2);const p=this._curveHelper.getSubCurve(r,0,e-h);if(!p||!p.nextPath())return;p.seekPathStart();const M=h/2;if(this._curveHelper.isEmpty(p))return;const I=(0,H.l)(p),T=this._constructOffset(I,-M);if(!T)return;const B=this._constructOffset(I,M);if(!B)return;const F=this._constructArrowBasePoint(T,-M/2);if(!F)return;const X=this._constructArrowBasePoint(B,M/2);if(!X)return;r.seekInPath(r.pathSize-1);const V=[r.x,r.y];n.pushPath(B),n.nextPath(),n.nextPoint(),n.setControlPoint(),n.pushPoint(X),n.nextPoint(),n.setControlPoint(),n.pushPoint(V),n.nextPoint(),n.setControlPoint(),n.pushPoint(F),n.nextPoint(),n.setControlPoint(),n.pushPoints(T.reverse()),n.setControlPoint(),o||(n.setControlPointAt(0),n.setControlPointAt(n.pathSize-1),n.pushPoint(B[0])),n.reset()}_constructCrossedArrow(n,r){const o=r.pathLength();let e=this._width;o<e*(1+S+1)&&(e=o/(1+S+1)),r.seekPathStart();const h=this._curveHelper.getSubCurve(r,0,o-e*(1+S));if(!h)return;h.nextPath();const p=e/2;if(this._curveHelper.isEmpty(h))return;const M=(0,H.l)(h),I=this._constructOffset(M,p);if(!I)return;const T=this._constructOffset(M,-p);if(!T)return;const B=this._curveHelper.getSubCurve(r,0,o-e);if(!B||(B.nextPath(),this._curveHelper.isEmpty(B)))return;const F=(0,H.l)(B),X=this._constructOffset(F,p);if(!X)return;const V=this._constructOffset(F,-p);if(!V)return;const D=X[X.length-1],b=this._constructArrowBasePoint(X,p/2);if(!b)return;const v=V[V.length-1],O=this._constructArrowBasePoint(V,-p/2);if(!O)return;r.seekInPath(r.pathSize-1);const L=[r.x,r.y];n.pushPath(I),n.nextPath(),n.nextPoint(),n.setControlPoint(),n.pushPoint(v),n.nextPoint(),n.setControlPoint(),n.pushPoint(O),n.nextPoint(),n.setControlPoint(),n.pushPoint(L),n.nextPoint(),n.setControlPoint(),n.pushPoint(b),n.nextPoint(),n.setControlPoint(),n.pushPoint(D),n.nextPoint(),n.setControlPoint(),n.pushPoints(T.reverse()),n.nextPoint(),n.setControlPoint(),n.reset()}_constructOffset(n,r){return this._curveHelper.offset(n,r,U.id.Rounded,4,this._offsetFlattenError)}_constructArrowBasePoint(n,r){if(!n||n.length<2)return null;const o=n[n.length-2],e=n[n.length-1],h=[e[0]-o[0],e[1]-o[1]];return this._curveHelper.normalize(h),[e[0]+h[1]*r,e[1]-h[0]*r]}}},99586:(dt,it,E)=>{E.d(it,{I:()=>u}),E(2189);var H=E(7587),W=E(93297),A=E(40460),U=E(24862),S=E(11196),y=E(43814);let u=(()=>{class _{static local(){return null===_.instance&&(_.instance=new _),_.instance}execute(n,r,o,e,h,p){return new m(n,r,o,e,h,p)}}return _.instance=null,_})();class m{constructor(g,n,r,o,e,h){this._inputGeometries=g,this._tileKey=o,this._geometryEngine=e,this._curveHelper=new U.N,this._size=(void 0!==n.size?n.size:1)*r,this._maxInflateSize=h*r,this._offsetFlattenError=U.D*r}next(){let g;for(;g=this._inputGeometries.next();){if(0===this._size)return g;if("esriGeometryEnvelope"===g.geometryType)if(this._size>0){const e=H.z.createEmptyOptimizedCIM(g.geometryType),h=(0,W.M)(g)[0],p=this._curveHelper.offset(h,this._size,S.id.Rounded,4,this._offsetFlattenError);if(p)return e.pushPath(p),e}else if(this._size<0){const e=g.asJSON();if(Math.min(e.xmax-e.xmin,e.ymax-e.ymin)+2*this._size>0)return H.z.fromJSONCIM({xmin:e.xmin-this._size,xmax:e.xmax+this._size,ymin:e.ymin-this._size,ymax:e.ymax+this._size})}const n=this._geometryEngine;if(null==n)return null;const r=this._tileKey?(0,A.L)(g,this._maxInflateSize):g;if(!r)continue;const o=n.buffer(y.Z.WebMercator,r.asJSON(),this._size,1);return o?H.z.fromJSONCIM(o):null}return null}}},71691:(dt,it,E)=>{E.d(it,{Y:()=>U});var q=E(7587),H=E(93297),W=E(70207),A=E(11196);let U=(()=>{class y{static local(){return null===y.instance&&(y.instance=new y),y.instance}execute(m,_,g,n,r){return new S(m,_,g)}}return y.instance=null,y})();class S{constructor(u,m,_){this._defaultPointSize=20,this._inputGeometries=u,this._geomUnitsPerPoint=_,this._rule=m.rule??A.Em.FullGeometry,this._defaultSize=this._defaultPointSize*_}next(){let u;for(;u=this._inputGeometries.next();){const m=this._processGeom((0,H.M)(u));if(m?.length)return q.z.fromJSONCIM({paths:m})}return null}_clone(u){return[u[0],u[1]]}_mid(u,m){return[(u[0]+m[0])/2,(u[1]+m[1])/2]}_mix(u,m,_,g){return[u[0]*m+_[0]*g,u[1]*m+_[1]*g]}_add(u,m){return[u[0]+m[0],u[1]+m[1]]}_add2(u,m,_){return[u[0]+m,u[1]+_]}_sub(u,m){return[u[0]-m[0],u[1]-m[1]]}_dist(u,m){return Math.sqrt((u[0]-m[0])*(u[0]-m[0])+(u[1]-m[1])*(u[1]-m[1]))}_norm(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}_normalize(u,m=1){const _=m/this._norm(u);u[0]*=_,u[1]*=_}_leftPerpendicular(u){const _=u[0];u[0]=-u[1],u[1]=_}_leftPerp(u){return[-u[1],u[0]]}_rightPerpendicular(u){const _=-u[0];u[0]=u[1],u[1]=_}_rightPerp(u){return[u[1],-u[0]]}_dotProduct(u,m){return u[0]*m[0]+u[1]*m[1]}_crossProduct(u,m){return u[0]*m[1]-u[1]*m[0]}_rotateDirect(u,m,_){const n=u[0]*_+u[1]*m;u[0]=u[0]*m-u[1]*_,u[1]=n}_makeCtrlPt(u){const m=[u[0],u[1]];return(0,W.qh)(m,1),m}_addAngledTicks(u,m,_,g){const n=this._sub(_,m);this._normalize(n);const r=this._crossProduct(n,this._sub(g,m));let o;o=r>0?this._rightPerp(n):this._leftPerp(n);const e=Math.abs(r)/2,h=[];h.push([m[0]+(o[0]-n[0])*e,m[1]+(o[1]-n[1])*e]),h.push(m),h.push(_),h.push([_[0]+(o[0]+n[0])*e,_[1]+(o[1]+n[1])*e]),u.push(h)}_addBezier2(u,m,_,g,n){if(0==n--)return void u.push(g);const r=this._mid(m,_),o=this._mid(_,g),e=this._mid(r,o);this._addBezier2(u,m,r,e,n),this._addBezier2(u,e,o,g,n)}_addBezier3(u,m,_,g,n,r){if(0==r--)return void u.push(n);const o=this._mid(m,_),e=this._mid(_,g),h=this._mid(g,n),p=this._mid(o,e),M=this._mid(e,h),I=this._mid(p,M);this._addBezier3(u,m,o,p,I,r),this._addBezier3(u,I,M,h,n,r)}_add90DegArc(u,m,_,g,n){const r=n??this._crossProduct(this._sub(_,m),this._sub(g,m))>0,o=this._mid(m,_),e=this._sub(o,m);r?this._leftPerpendicular(e):this._rightPerpendicular(e),o[0]+=e[0],o[1]+=e[1],this._addBezier3(u,m,this._mix(m,.33333,o,.66667),this._mix(_,.33333,o,.66667),_,4)}_addArrow(u,m,_){const g=m[0],n=m[1],r=m[m.length-1],o=this._sub(g,n),e=this._norm(o);this._normalize(o);const h=Math.abs(this._crossProduct(o,this._sub(r,n)));let p=this._dotProduct(o,this._sub(r,n));p<.05*e?p=.05*e:p>.95*e&&(p=.95*e);const M=.5*h,I=this._leftPerp(o),T=[n[0]+o[0]*p,n[1]+o[1]*p],B=m.length-1,F=[];F.push(_?[-I[0],-I[1]]:I);let X=[-o[0],-o[1]];for(let V=1;V<B-1;V++){const D=this._sub(m[V+1],m[V]);this._normalize(D);const b=this._dotProduct(D,X),v=this._crossProduct(D,X),O=Math.sqrt((1+b)/2),L=this._sub(D,X);this._normalize(L),L[0]/=O,L[1]/=O,F.push(v<0?[-L[0],-L[1]]:L),X=D}F.push(this._rightPerp(X));for(let V=F.length-1;V>0;V--)u.push([m[V][0]+F[V][0]*M,m[V][1]+F[V][1]*M]);u.push([T[0]+F[0][0]*M,T[1]+F[0][1]*M]),u.push([T[0]+F[0][0]*h,T[1]+F[0][1]*h]),u.push(g),u.push([T[0]-F[0][0]*h,T[1]-F[0][1]*h]),u.push([T[0]-F[0][0]*M,T[1]-F[0][1]*M]);for(let V=1;V<F.length;V++)u.push([m[V][0]-F[V][0]*M,m[V][1]-F[V][1]*M])}_cp2(u,m,_){return u.length>=2?u[1]:this._add2(u[0],m*this._defaultSize,_*this._defaultSize)}_cp3(u,m,_,g){if(u.length>=3)return u[2];const n=this._mix(u[0],1-_,m,_),r=this._sub(m,u[0]);return this._normalize(r),this._rightPerpendicular(r),[n[0]+r[0]*g*this._defaultSize,n[1]+r[1]*g*this._defaultSize]}_arrowPath(u){if(u.length>2)return u;const m=u[0],_=this._cp2(u,-4,0),g=this._sub(m,_);this._normalize(g);const n=this._rightPerp(g);return[m,_,[m[0]+(n[0]-g[0])*this._defaultSize,m[1]+(n[1]-g[1])*this._defaultSize]]}_arrowLastSeg(u){const m=u[0],_=this._cp2(u,-4,0);let g;if(u.length>=3)g=u[u.length-1];else{const n=this._sub(m,_);this._normalize(n);const r=this._rightPerp(n);g=[m[0]+(r[0]-n[0])*this._defaultSize,m[1]+(r[1]-n[1])*this._defaultSize]}return[_,g]}_processGeom(u){if(!u)return null;const m=[];for(const _ of u){if(!_||0===_.length)continue;const g=_.length;let n=_[0];switch(this._rule){case A.Em.PerpendicularFromFirstSegment:{const r=this._cp2(_,0,-1),o=this._cp3(_,r,.5,4),e=[];e.push(o),e.push(this._mid(n,r)),m.push(e);break}case A.Em.ReversedFirstSegment:{const r=this._cp2(_,0,-1);m.push([r,n]);break}case A.Em.PerpendicularToSecondSegment:{if(_.length<3)return[];const r=this._cp2(_,-4,1),o=this._cp3(_,r,.882353,-1.94),e=[];e.push(this._mid(r,o)),e.push(n),m.push(e);break}case A.Em.SecondSegmentWithTicks:{if(_.length<3)return[];const r=this._cp2(_,-4,1),o=this._cp3(_,r,.882353,-1.94),e=this._sub(o,r);let h;h=this._crossProduct(e,this._sub(n,r))>0?this._rightPerp(e):this._leftPerp(e);const p=[];p.push([r[0]+(h[0]-e[0])/3,r[1]+(h[1]-e[1])/3]),p.push(r),p.push(o),p.push([o[0]+(h[0]+e[0])/3,o[1]+(h[1]+e[1])/3]),m.push(p);break}case A.Em.DoublePerpendicular:{const r=this._cp2(_,0,-1),o=this._cp3(_,r,.5,3),e=this._mid(n,r),h=this._sub(e,o);this._normalize(h);const p=this._crossProduct(h,this._sub(n,o));this._leftPerpendicular(h);const M=[];M.push(n),M.push([o[0]+h[0]*p,o[1]+h[1]*p]),m.push(M);const I=[];I.push([o[0]-h[0]*p,o[1]-h[1]*p]),I.push(r),m.push(I);break}case A.Em.OppositeToFirstSegment:{const r=this._cp2(_,0,-1),o=this._cp3(_,r,.5,3),e=this._mid(n,r),h=this._sub(e,o);this._normalize(h);const p=this._crossProduct(h,this._sub(n,o));this._leftPerpendicular(h);const M=[];M.push([o[0]+h[0]*p,o[1]+h[1]*p]),M.push([o[0]-h[0]*p,o[1]-h[1]*p]),m.push(M);break}case A.Em.TriplePerpendicular:{const r=this._cp2(_,0,-1),o=this._cp3(_,r,.5,4),e=this._mid(n,r),h=this._sub(e,o);this._normalize(h);const p=this._crossProduct(h,this._sub(n,o));this._leftPerpendicular(h);const M=[];M.push([o[0]+h[0]*p*.8,o[1]+h[1]*p*.8]),M.push([e[0]+.8*(n[0]-e[0]),e[1]+.8*(n[1]-e[1])]),m.push(M),m.push([o,e]);const I=[];I.push([o[0]-h[0]*p*.8,o[1]-h[1]*p*.8]),I.push([e[0]+.8*(r[0]-e[0]),e[1]+.8*(r[1]-e[1])]),m.push(I);break}case A.Em.HalfCircleFirstSegment:{const r=this._cp2(_,0,-1),o=this._cp3(_,r,.5,4),e=this._mid(n,r);let h=this._sub(r,n);const p=Math.cos(Math.PI/18),M=Math.sin(Math.PI/18),I=Math.sqrt((1+p)/2),T=Math.sqrt((1-p)/2),B=[];let F;this._crossProduct(h,this._sub(o,n))>0?(B.push(n),h=this._sub(n,e),F=r):(B.push(r),h=this._sub(r,e),F=n),this._rotateDirect(h,I,T),h[0]/=I,h[1]/=I;for(let X=1;X<=18;X++)B.push(this._add(e,h)),this._rotateDirect(h,p,M);B.push(F),m.push(B);break}case A.Em.HalfCircleSecondSegment:{const r=this._cp2(_,0,-1),o=this._cp3(_,r,1,-1);let e=this._sub(n,r);this._normalize(e);const h=this._crossProduct(e,this._sub(o,r))/2;this._leftPerpendicular(e);const p=[r[0]+e[0]*h,r[1]+e[1]*h];e=this._sub(r,p);const M=Math.cos(Math.PI/18);let I=Math.sin(Math.PI/18);h>0&&(I=-I);const T=[r];for(let B=1;B<=18;B++)this._rotateDirect(e,M,I),T.push(this._add(p,e));m.push(T);break}case A.Em.HalfCircleExtended:{const r=this._cp2(_,0,-2),o=this._cp3(_,r,1,-1);let e;if(g>=4)e=_[3];else{const B=this._sub(n,r);e=this._add(o,B)}const h=this._dist(r,o)/2/.75,p=this._sub(r,n);this._normalize(p,h);const M=this._sub(o,e);this._normalize(M,h),m.push([e,o]);const T=[this._clone(o)];this._addBezier3(T,o,this._add(o,M),this._add(r,p),r,4),T.push(n),m.push(T);break}case A.Em.OpenCircle:{const r=this._cp2(_,-2,0),o=this._sub(r,n),e=Math.cos(Math.PI/18),h=-Math.sin(Math.PI/18),p=[r];for(let M=1;M<=33;M++)this._rotateDirect(o,e,h),p.push(this._add(n,o));m.push(p);break}case A.Em.CoverageEdgesWithTicks:{const r=this._cp2(_,0,-1);let o,e;if(g>=3)o=_[2];else{const I=this._sub(r,n),T=this._leftPerp(I);o=[n[0]+T[0]-.25*I[0],n[1]+T[1]-.25*I[1]]}if(g>=4)e=_[3];else{const I=this._mid(n,r),T=this._sub(n,r);this._normalize(T),this._leftPerpendicular(T);const B=this._crossProduct(T,this._sub(o,I));this._rightPerpendicular(T),e=[o[0]+T[0]*B*2,o[1]+T[1]*B*2]}const h=this._sub(r,n);let p,M;p=this._crossProduct(h,this._sub(o,n))>0?this._rightPerp(h):this._leftPerp(h),M=[],M.push(o),M.push(n),M.push([n[0]+(p[0]-h[0])/3,n[1]+(p[1]-h[1])/3]),m.push(M),p=this._crossProduct(h,this._sub(e,r))>0?this._rightPerp(h):this._leftPerp(h),M=[],M.push([r[0]+(p[0]+h[0])/3,r[1]+(p[1]+h[1])/3]),M.push(r),M.push(e),m.push(M);break}case A.Em.GapExtentWithDoubleTicks:{const r=this._cp2(_,0,2),o=this._cp3(_,r,0,1);let e;if(g>=4)e=_[3];else{const h=this._sub(r,n);e=this._add(o,h)}this._addAngledTicks(m,n,r,this._mid(o,e)),this._addAngledTicks(m,o,e,this._mid(n,r));break}case A.Em.GapExtentMidline:{const r=this._cp2(_,2,0),o=this._cp3(_,r,0,1);let e;if(g>=4)e=_[3];else{const p=this._sub(r,n);e=this._add(o,p)}const h=[];h.push(this._mid(n,o)),h.push(this._mid(r,e)),m.push(h);break}case A.Em.Chevron:{const r=this._cp2(_,-1,-1);let o;if(g>=3)o=_[2];else{const e=this._sub(r,n);this._leftPerpendicular(e),o=this._add(n,e)}m.push([r,this._makeCtrlPt(n),o]);break}case A.Em.PerpendicularWithArc:{const r=this._cp2(_,0,-2),o=this._cp3(_,r,.5,-1),e=this._sub(r,n),h=this._norm(e);e[0]/=h,e[1]/=h;const p=this._crossProduct(e,this._sub(o,n));let M=this._dotProduct(e,this._sub(o,n));M<.05*h?M=.05*h:M>.95*h&&(M=.95*h);const I=[n[0]+e[0]*M,n[1]+e[1]*M];let T=this._leftPerp(e),B=[];if(B.push([I[0]-T[0]*p,I[1]-T[1]*p]),B.push([I[0]+T[0]*p,I[1]+T[1]*p]),m.push(B),g>=4){const D=_[3];let b=this._dotProduct(e,this._sub(D,n));b<.1*h?b=.1*h:b>.9*h&&(b=.9*h);const v=[n[0]+e[0]*b,n[1]+e[1]*b],O=this._crossProduct(e,this._sub(D,n)),L=[];L.push([v[0]-T[0]*O,v[1]-T[1]*O]),L.push([v[0]+T[0]*O,v[1]+T[1]*O]),m.push(L)}const F=[r[0]+T[0]*p,r[1]+T[1]*p];T=this._sub(r,F);const X=Math.cos(Math.PI/18);let V=Math.sin(Math.PI/18);p<0&&(V=-V),B=[n,r];for(let D=1;D<=9;D++)this._rotateDirect(T,X,V),B.push(this._add(F,T));m.push(B);break}case A.Em.ClosedHalfCircle:{const r=this._cp2(_,2,0),o=this._mid(n,r),e=this._sub(r,o),h=Math.cos(Math.PI/18),p=Math.sin(Math.PI/18),M=[n,r];for(let I=1;I<=18;I++)this._rotateDirect(e,h,p),M.push(this._add(o,e));m.push(M);break}case A.Em.TripleParallelExtended:{const r=this._cp2(_,0,-2),o=this._cp3(_,r,1,-2),e=this._mid(n,r),h=this._sub(o,r);this._normalize(h);const p=Math.abs(this._crossProduct(h,this._sub(e,r)))/2,M=this._dist(r,o),I=[r,n];I.push([n[0]+h[0]*M*.5,n[1]+h[1]*M*.5]),m.push(I);const T=[];T.push([e[0]-h[0]*p,e[1]-h[1]*p]),T.push([e[0]+h[0]*M*.375,e[1]+h[1]*M*.375]),(0,W.qh)(T[T.length-1],1),T.push([e[0]+h[0]*M*.75,e[1]+h[1]*M*.75]),m.push(T),m.push([r,o]);break}case A.Em.ParallelWithTicks:{const r=this._cp2(_,3,0),o=this._cp3(_,r,.5,-1),e=this._sub(o,r);this._normalize(e);const h=this._crossProduct(e,this._sub(o,n));this._leftPerpendicular(e),this._addAngledTicks(m,n,r,o),this._addAngledTicks(m,this._mix(n,1,e,h),this._mix(r,1,e,h),this._mid(n,r));break}case A.Em.Parallel:{const r=this._cp2(_,3,0),o=this._cp3(_,r,.5,-1),e=this._sub(r,n);this._normalize(e);const h=this._leftPerp(e),p=this._crossProduct(e,this._sub(o,n));let M=[n,r];m.push(M),M=[],M.push([n[0]+h[0]*p,n[1]+h[1]*p]),M.push([r[0]+h[0]*p,r[1]+h[1]*p]),m.push(M);break}case A.Em.PerpendicularToFirstSegment:{const r=this._cp2(_,3,0),o=this._cp3(_,r,.5,-1),e=this._mid(n,r),h=this._sub(r,n);this._normalize(h);const p=this._crossProduct(h,this._sub(o,n));this._leftPerpendicular(h);const M=[];M.push([e[0]-h[0]*p*.25,e[1]-h[1]*p*.25]),M.push([e[0]+h[0]*p*1.25,e[1]+h[1]*p*1.25]),m.push(M);break}case A.Em.ParallelOffset:{const r=this._cp2(_,3,0),o=this._cp3(_,r,.5,-1),e=this._sub(r,n);this._normalize(e);const h=this._crossProduct(e,this._sub(o,n));this._leftPerpendicular(e);const p=[];p.push([n[0]-e[0]*h,n[1]-e[1]*h]),p.push([r[0]-e[0]*h,r[1]-e[1]*h]),m.push(p);const M=[];M.push([n[0]+e[0]*h,n[1]+e[1]*h]),M.push([r[0]+e[0]*h,r[1]+e[1]*h]),m.push(M);break}case A.Em.OffsetOpposite:{const r=this._cp2(_,3,0),o=this._cp3(_,r,.5,-1),e=this._sub(r,n);this._normalize(e);const h=this._crossProduct(e,this._sub(o,n));this._leftPerpendicular(e);const p=[];p.push([n[0]-e[0]*h,n[1]-e[1]*h]),p.push([r[0]-e[0]*h,r[1]-e[1]*h]),m.push(p);break}case A.Em.OffsetSame:{const r=this._cp2(_,3,0),o=this._cp3(_,r,.5,-1),e=this._sub(r,n);this._normalize(e);const h=this._crossProduct(e,this._sub(o,n));this._leftPerpendicular(e);const p=[];p.push([n[0]+e[0]*h,n[1]+e[1]*h]),p.push([r[0]+e[0]*h,r[1]+e[1]*h]),m.push(p);break}case A.Em.CircleWithArc:{let r=this._cp2(_,3,0);const o=this._cp3(_,r,.5,-1);let e,h;if(g>=4)e=_[3],h=this._crossProduct(this._sub(e,r),this._sub(o,r))>0;else{e=r,h=this._crossProduct(this._sub(e,n),this._sub(o,n))>0;const B=24*this._geomUnitsPerPoint,F=this._sub(e,n);this._normalize(F,B);const X=Math.sqrt(2)/2;this._rotateDirect(F,X,h?X:-X),r=this._add(n,F)}const p=this._sub(r,n),M=Math.cos(Math.PI/18),I=Math.sin(Math.PI/18),T=[r];for(let B=1;B<=36;B++)this._rotateDirect(p,M,I),T.push(this._add(n,p));this._add90DegArc(T,r,e,o,h),(0,W.qh)(T[T.length-8],1),m.push(T);break}case A.Em.DoubleJog:{let r,o=this._cp2(_,-3,1),e=this._cp3(_,o,-1,-.5);if(g>=4)r=_[3];else{const V=n;n=o,r=e;const D=this._dist(n,V),b=this._dist(r,V);let v=30*this._geomUnitsPerPoint;.5*D<v&&(v=.5*D),.5*b<v&&(v=.5*b),o=this._mix(n,v/D,V,(D-v)/D),e=this._mix(r,v/b,V,(b-v)/b)}const h=this._mid(n,o),p=this._mid(r,e),M=this._dist(n,o),I=this._dist(e,r);let T=Math.min(M,I)/8;T=Math.min(T,24*this._geomUnitsPerPoint);const B=Math.cos(Math.PI/4);let F=this._sub(n,o);this._normalize(F,T),this._crossProduct(F,this._sub(r,o))>0?this._rotateDirect(F,B,-B):this._rotateDirect(F,B,B);let X=[];X.push(o),X.push(this._add(h,F)),X.push(this._sub(h,F)),X.push(n),m.push(X),F=this._sub(r,e),this._normalize(F,T),this._crossProduct(F,this._sub(n,e))<0?this._rotateDirect(F,B,B):this._rotateDirect(F,B,-B),X=[],X.push(e),X.push(this._add(p,F)),X.push(this._sub(p,F)),X.push(r),m.push(X);break}case A.Em.PerpendicularOffset:{const r=this._cp2(_,-4,1),o=this._cp3(_,r,.882353,-1.94),e=this._sub(o,r);this._crossProduct(e,this._sub(n,r))>0?this._rightPerpendicular(e):this._leftPerpendicular(e);const h=[e[0]/8,e[1]/8],p=this._sub(this._mid(r,o),h);m.push([p,n]);break}case A.Em.LineExcludingLastSegment:{const r=this._arrowPath(_),o=[];let e=r.length-2;for(;e--;)o.push(r[e]);m.push(o);break}case A.Em.MultivertexArrow:{const r=this._arrowPath(_),o=[];this._addArrow(o,r,!1),m.push(o);break}case A.Em.CrossedArrow:{const r=this._arrowPath(_),o=[];this._addArrow(o,r,!0),m.push(o);break}case A.Em.ChevronArrow:{const[r,o]=this._arrowLastSeg(_),e=10*this._geomUnitsPerPoint,h=this._sub(n,r),p=this._norm(h);this._normalize(h);const M=this._crossProduct(h,this._sub(o,r));let I=this._dotProduct(h,this._sub(o,r));I<.05*p?I=.05*p:I>.95*p-e&&(I=.95*p-e);const T=[r[0]+h[0]*I,r[1]+h[1]*I],B=this._leftPerp(h),F=[];F.push([T[0]+B[0]*M+h[0]*e,T[1]+B[1]*M+h[1]*e]),F.push(n),F.push([T[0]-B[0]*M+h[0]*e,T[1]-B[1]*M+h[1]*e]),m.push(F);break}case A.Em.ChevronArrowOffset:{const[r,o]=this._arrowLastSeg(_),e=this._sub(n,r),h=this._norm(e);this._normalize(e);const p=this._crossProduct(e,this._sub(o,r));let M=this._dotProduct(e,this._sub(o,r));M<.05*h?M=.05*h:M>.95*h&&(M=.95*h);const I=[r[0]+e[0]*M,r[1]+e[1]*M];this._leftPerpendicular(e);const T=[];T.push([I[0]+e[0]*p*.5,I[1]+e[1]*p*.5]),T.push(this._mid(I,n)),T.push([I[0]-e[0]*p*.5,I[1]-e[1]*p*.5]),m.push(T);break}case A.Em.PartialFirstSegment:{const[r,o]=this._arrowLastSeg(_),e=this._sub(n,r),h=this._norm(e);this._normalize(e);let p=this._dotProduct(e,this._sub(o,r));p<.05*h?p=.05*h:p>.95*h&&(p=.95*h),m.push([r,[r[0]+e[0]*p,r[1]+e[1]*p]]);break}case A.Em.Arch:{const r=this._cp2(_,0,-1),o=this._cp3(_,r,.5,1),e=this._sub(n,r),h=this._mix(o,1,e,.55),p=this._mix(o,1,e,-.55),M=[n];this._addBezier2(M,n,h,o,4),this._addBezier2(M,o,p,r,4),m.push(M);break}case A.Em.CurvedParallelTicks:{const r=this._cp2(_,-4,1),o=this._cp3(_,r,.882353,-1.94),e=this._sub(o,r);this._crossProduct(e,this._sub(n,r))>0?this._rightPerpendicular(e):this._leftPerpendicular(e);const h=[e[0]/8,e[1]/8],p=this._sub(this._mid(r,o),h),M=this._sub(this._mix(r,.75,o,.25),h),I=this._sub(this._mix(r,.25,o,.75),h),T=[r];this._addBezier2(T,r,M,p,3),this._addBezier2(T,p,I,o,3),m.push(T);for(let B=0;B<8;B++){const F=T[2*B+1],X=[this._clone(F)];X.push(this._add(F,[e[0]/4,e[1]/4])),m.push(X)}break}case A.Em.Arc90Degrees:{const r=this._cp2(_,0,-1),o=this._cp3(_,r,.5,1),e=[r];this._add90DegArc(e,r,n,o),m.push(e);break}case A.Em.TipWithPerpendicularAndTicks:{const[r,o]=this._arrowLastSeg(_),e=10*this._geomUnitsPerPoint,h=this._sub(n,r),p=this._norm(h);this._normalize(h);let M=this._crossProduct(h,this._sub(o,r)),I=this._dotProduct(h,this._sub(o,r));I<.05*p?I=.05*p:I>.95*p-e&&(I=.95*p-e);const T=this._leftPerp(h),B=[n[0]-h[0]*e,n[1]-h[1]*e],F=.5*Math.max(p-I-e,e);M=Math.abs(M);const X=[];X.push([B[0]+T[0]*(M+F)-h[0]*F,B[1]+T[1]*(M+F)-h[1]*F]),X.push([B[0]+T[0]*M,B[1]+T[1]*M]),X.push([B[0]-T[0]*M,B[1]-T[1]*M]),X.push([B[0]-T[0]*(M+F)-h[0]*F,B[1]-T[1]*(M+F)-h[1]*F]),m.push(X),m.push([B,n]);break}default:m.push(_)}}return m}}},92328:(dt,it,E)=>{E.d(it,{d:()=>A});var q=E(7587),H=E(70207),W=E(24862);let A=(()=>{class S{static local(){return null===S.instance&&(S.instance=new S),S.instance}execute(u,m,_,g,n){return new U(u,m,_)}}return S.instance=null,S})();class U extends H.vT{constructor(y,u,m){super(y,!0,!0),this._curveHelper=new W.N,this._beginCut=(void 0!==u.beginCut?u.beginCut:1)*m,this._endCut=(void 0!==u.endCut?u.endCut:1)*m,this._middleCut=(void 0!==u.middleCut?u.middleCut:0)*m,this._invert=void 0!==u.invert&&u.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0)}processPath(y){const{_beginCut:u,_endCut:m,_middleCut:_}=this,g=y.pathLength(),n=q.z.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._invert){if(0!==u||0!==m||0!==_)if(u+m+_>=g)for(n.startPath();y.nextPoint();)n.pushXY(y.x,y.y);else this._curveHelper.appendSubCurve(n,y,0,u),this._curveHelper.appendSubCurve(n,y,.5*(g-_),.5*(g+_)),this._curveHelper.appendSubCurve(n,y,g-m,m)}else if(0===u&&0===m&&0===_)for(n.startPath();y.nextPoint();)n.pushXY(y.x,y.y);else u+m+_<g&&(0===_?this._curveHelper.appendSubCurve(n,y,u,g-m):(this._curveHelper.appendSubCurve(n,y,u,.5*(g-_)),this._curveHelper.appendSubCurve(n,y,.5*(g+_),g-m)));return 0===n.totalSize?null:n}}},57876:(dt,it,E)=>{E.d(it,{x:()=>_});var q=E(7587),H=E(93297),W=E(54746),A=E(70207),U=E(11196),S=E(84086),y=E(25896);let _=(()=>{class n{static local(){return null===n.instance&&(n.instance=new n),n.instance}execute(o,e,h,p,M){return new g(o,e,h,p)}}return n.instance=null,n})();class g extends A.vT{constructor(r,o,e,h){super(r,!0,!0),this._firstCurve=null,this._walker=new S.Ll,this._walker.updateTolerance(e),this._endings=o.lineDashEnding,this._customDashPos=-(o.offsetAlongLine??0)*e,this._offsetAtEnd=(o.customEndingOffset??0)*e,this._tileKey=h;let p=(0,y.T2)(o).dashTemplate;null==p&&(p=[]),p.length%2&&(p=[...p,...p]);let M=0;for(let I=0;I<p.length;I++){let T=Math.abs(p[I]);T<1e-7&&(T=1e-7),M+=T}this._patternLength=M,this._numOfDashesPerPattern=p.length/2,this._pattern=new S.h9,this._pattern.init(p,!0),this._pattern.scale(e)}processPath(r){if(0===this._pattern.length()){this.iteratePath=!1;const h=(0,H.l)(r);return q.z.fromJSONCIM({paths:[h]})}if(!this.iteratePath){let h=!0;switch(this._endings){case U.sj.HalfPattern:case U.sj.HalfGap:default:this._pattern.extPtGap=0;break;case U.sj.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case U.sj.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case U.sj.NoConstraint:this.isClosed||(h=!1);break;case U.sj.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}const p=r.pathLength();if(this._pattern.isEmpty()||p<.1*this._pattern.length()){const M=(0,H.l)(r);return q.z.fromJSONCIM({paths:[M]})}if(!this._walker.init(r,this._pattern,h)){const M=(0,H.l)(r);return q.z.fromJSONCIM({paths:[M]})}}let o;if(this.iteratePath)o=this._pattern.nextValue();else{let h;switch(this._endings){case U.sj.HalfPattern:default:h=.5*this._pattern.firstValue();break;case U.sj.HalfGap:h=.5*-this._pattern.lastValue();break;case U.sj.FullGap:h=-this._pattern.lastValue();break;case U.sj.FullPattern:h=0;break;case U.sj.NoConstraint:case U.sj.Custom:h=-this._customDashPos}let p=h/this._pattern.length();p-=Math.floor(p),h=p*this._pattern.length(),this._pattern.reset(),o=this._pattern.nextValue();let M=!1;for(;h>=o;)h-=o,o=this._pattern.nextValue(),M=!M;o-=h,M?(this._walker.nextPosition(o),o=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(o),o=this._pattern.nextValue(),this._walker.nextPosition(o),o=this._pattern.nextValue())}let e=this._walker.nextCurve(o);if(e)if(this._walker.isPathEnd()){if(this.iteratePath=!1,this._firstCurve){for(this._firstCurve.nextPath();this._firstCurve.nextPoint();)e.pushXY(this._firstCurve.x,this._firstCurve.y);this._firstCurve=null}}else o=this._pattern.nextValue(),!this._walker.nextPosition(o)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(e.pushCursor(this._firstCurve),this._firstCurve=null)):this.iteratePath=!0;else this.iteratePath=!1,e=this._firstCurve,this._firstCurve=null;return e?.reset(),e}isClippingRequired(r){const o=(0,H.M)(r);let e=0;for(const h of o)e+=(0,W.ok)(h);return Math.round(this._numOfDashesPerPattern*(e/this._patternLength))>1e3}}},16584:(dt,it,E)=>{E.d(it,{h:()=>S}),E(2189);var H=E(7587),W=E(40460),U=(E(11196),E(43814));let S=(()=>{class u{static local(){return null===u.instance&&(u.instance=new u),u.instance}execute(_,g,n,r,o,e){return new y(_,g,n,r,o,e)}}return u.instance=null,u})();class y{constructor(m,_,g,n,r,o){this._inputGeometries=m,this._tileKey=n,this._geometryEngine=r,this._maxInflateSize=o*g,this._width=(void 0!==_.width?_.width:2)*g,this._option=_.option}next(){let m;for(;m=this._inputGeometries.next();){if("esriGeometryEnvelope"===m.geometryType&&this._width>0){const _=m.asJSON();return Math.min(_.xmax-_.xmin,_.ymax-_.ymin)-2*this._width<0?m:H.z.fromJSONCIM({paths:[[[_.xmin+this._width,_.ymin+this._width],[_.xmax-this._width,_.ymin+this._width],[_.xmax-this._width,_.ymax-this._width],[_.xmin+this._width,_.ymax-this._width],[_.xmin+this._width,_.ymin+this._width]],[[_.xmin,_.ymin],[_.xmin,_.ymax],[_.xmax,_.ymax],[_.xmax,_.ymin],[_.xmin,_.ymin]]]})}if("esriGeometryPolygon"===m.geometryType){if(0===this._width)return m.clone();const _=this._geometryEngine;if(null==_)return null;const g=this._tileKey?(0,W.L)(m,this._maxInflateSize):m.clone();if(!g)continue;const n=_.buffer(U.Z.WebMercator,g.asJSON(),-this._width,1);if(n)for(const r of n.rings)if(r){g.startPath();for(const o of r.reverse())g.pushXY(o[0],g.yFactor*o[1])}return g}}return null}}},4322:(dt,it,E)=>{E.d(it,{F:()=>A});var q=E(7587),H=E(70207),W=E(24862);let A=(()=>{class S{static local(){return null===S.instance&&(S.instance=new S),S.instance}execute(u,m,_,g,n){return new U(u,m,_)}}return S.instance=null,S})();class U extends H.vT{constructor(y,u,m){super(y,!1,!0),this._curveHelper=new W.N,this._length=(void 0!==u.length?u.length:20)*m,this._angle=void 0!==u.angle?u.angle:225,this._position=void 0!==u.position?u.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1}processPath(y){const u=q.z.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._curveHelper.isEmpty(y))return null;y.seekInPath(0);const m=y.x,_=y.y;y.seekInPath(y.pathSize-1);const g=y.x,n=y.y;this._curveHelper.normalize([g-m,n-_]);const o=m+(g-m)*this._position/100,e=_+(n-_)*this._position/100,h=Math.cos((90-this._angle)/180*Math.PI);let p=Math.sin((90-this._angle)/180*Math.PI);return this._mirror&&(p=-p),this._mirror=!this._mirror,u.pushPath([[m,_],[o-this._length/2*h,e-this._length/2*p],[o+this._length/2*h,e+this._length/2*p],[g,n]]),u}}},50765:(dt,it,E)=>{E.d(it,{F:()=>_}),E(2189);var H=E(7587),W=E(93297),A=E(40637),U=E(40460),S=E(24862),y=E(11196),u=E(43814);let _=(()=>{class n{static local(){return null===n.instance&&(n.instance=new n),n.instance}execute(o,e,h,p,M,I){return new g(o,e,h,p,M,I)}}return n.instance=null,n})();class g{constructor(r,o,e,h,p,M){this._inputGeometries=r,this._tileKey=h,this._geometryEngine=p,this._curveHelper=new S.N,this._offset=(o.offset??1)*e,this._method=o.method,this._maxInflateSize=Math.max(Math.abs(M*e),10),this._option=o.option,this._offsetFlattenError=S.D*e}next(){let r;for(;r=this._inputGeometries.next();){if(0===this._offset)return r.clone();if("esriGeometryEnvelope"===r.geometryType){if(this._method===y.id.Rounded&&this._offset>0){const M=(0,W.l)(r),I=this._curveHelper.offset(M,-this._offset,this._method,4,this._offsetFlattenError);if(I){const T=H.z.createEmptyOptimizedCIM(r.geometryType);return T.pushPath(I),T}return null}const p=r.asJSON();if((0,A.YX)(p)&&Math.min(p.xmax-p.xmin,p.ymax-p.ymin)+2*this._offset>0)return H.z.fromJSONCIM({xmin:p.xmin-this._offset,xmax:p.xmax+this._offset,ymin:p.ymin-this._offset,ymax:p.ymax+this._offset})}const o=this._geometryEngine;if(null==o)continue;const e=this._tileKey?(0,U.L)(r,this._maxInflateSize):r.clone();if(!e)continue;const h=o.offset(u.Z.WebMercator,e.asJSON(),-this._offset,1,this._method,4,this._offsetFlattenError);return h?H.z.fromJSONCIM(h):null}return null}}},91522:(dt,it,E)=>{E.d(it,{O:()=>H});var q=E(43585);let H=(()=>{class A{static local(){return null===A.instance&&(A.instance=new A),A.instance}execute(S,y,u,m,_){return new W(S,y,u)}}return A.instance=null,A})();class W{constructor(U,S,y){this._inputGeometries=U,this._rotateAngle=void 0!==S.angle?S.angle*Math.PI/180:0}next(){let U=this._inputGeometries.next();for(;U;){if(0===this._rotateAngle||"esriGeometryPoint"===U.geometryType)return U;if(U.totalSize>0){const S=(0,q.Cs)(U),y=(S[2]+S[0])/2,u=(S[3]+S[1])/2;return U.reset(),this._rotate(U.clone(),y,u)}U=this._inputGeometries.next()}return null}_rotate(U,S,y){const u=Math.cos(this._rotateAngle),m=Math.sin(this._rotateAngle);for(;U.nextPath();)for(;U.nextPoint();){const _=U.x-S,g=U.y-y;U.x=S+_*u-g*m,U.y=y+_*m+g*u}return U.reset(),U}}},76929:(dt,it,E)=>{E.d(it,{I:()=>H});var q=E(43585);let H=(()=>{class A{static local(){return null===A.instance&&(A.instance=new A),A.instance}execute(S,y,u,m,_){return new W(S,y,u)}}return A.instance=null,A})();class W{constructor(U,S,y){this._inputGeometries=U,this._xFactor=void 0!==S.xScaleFactor?S.xScaleFactor:1.15,this._yFactor=void 0!==S.yScaleFactor?S.yScaleFactor:1.15}next(){const U=this._inputGeometries.next();if(U){if(1===this._xFactor&&1===this._yFactor||"esriGeometryPoint"===U.geometryType)return U;if(U.totalSize>0){const S=(0,q.Cs)(U),y=(S[2]+S[0])/2,u=(S[3]+S[1])/2;return U.reset(),this._scaleCursor(U.clone(),y,u)}}return null}_scaleCursor(U,S,y){for(;U.nextPath();)for(;U.nextPoint();)U.x=S+(U.x-S)*this._xFactor,U.y=y+(U.y-y)*this._yFactor;return U.reset(),U}}},86740:(dt,it,E)=>{E.d(it,{w:()=>A});var q=E(7587),H=E(11196),W=E(84086);let A=(()=>{class S{static local(){return null===S.instance&&(S.instance=new S),S.instance}execute(u,m,_,g,n){return new U(u,m,_)}}return S.instance=null,S})();class U{constructor(y,u,m){this._inputGeometries=y,this._height=(void 0!==u.amplitude?u.amplitude:2)*m,this._period=(void 0!==u.period?u.period:3)*m,this._style=u.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new W.h9,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new W.Ll,this._walker.updateTolerance(m)}next(){let y=this._inputGeometries.next();for(;y;){if(0===this._height||0===this._period)return y;const u=this._processGeom(y);if(u)return u;y=this._inputGeometries.next()}return null}_processGeom(y){const u=q.z.createEmptyOptimizedCIM(y.geometryType);for(;y.nextPath();){u.startPath();const m=y.pathLength();if(this._walker.init(y,this._pattern))switch(this._style){case H.zQ.Sinus:default:this._constructCurve(u,m,!1);break;case H.zQ.Square:this._constructSquare(u,m);break;case H.zQ.Triangle:this._constructTriangle(u,m);break;case H.zQ.Random:this._constructCurve(u,m,!0)}else for(;y.nextPoint();)u.pushXY(y.x,y.y)}return u}_constructCurve(y,u,m){let _=Math.round(u/this._period);0===_&&(_=1);const r=this._period/16,o=1/(16*_+1),e=2*Math.PI*u/(u/_),h=2*Math.PI*Math.random(),p=2*Math.PI*Math.random(),M=2*Math.PI*Math.random(),I=.75-Math.random()/2,T=.75-Math.random()/2,B=new W.Yw;this._walker.curPointAndAngle(B),y.pushPoint(B.pt);let F=0;for(;;){if(!this._walker.nextPointAndAngle(r,B)){y.pushPoint(this._walker.getPathEnd());break}{const X=F;let V;if(F+=o,m){const D=this._height/2*(1+.3*Math.sin(I*e*X+h));V=D*Math.sin(e*X+p),V+=D*Math.sin(T*e*X+M),V/=2}else V=.5*this._height*Math.sin(.5*e*X);y.pushXY(B.pt[0]-V*B.sa,B.pt[1]+V*B.ca)}}}_constructSquare(y,u){Math.round(u/this._period);let m=!0;for(;;){let _=!1;if(this._walker.curPositionIsValid()){const g=new W.Yw;this._walker.curPointAndAngle(g);const n=new W.Yw;if(this._walker.nextPointAndAngle(this._period,n)){const r=new W.Yw;this._walker.nextPointAndAngle(this._period,r)&&(m?(y.pushPoint(g.pt),m=!1):y.pushPoint(g.pt),y.pushXY(g.pt[0]-this._height/2*g.sa,g.pt[1]+this._height/2*g.ca),y.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),y.pushXY(n.pt[0]+this._height/2*n.sa,n.pt[1]-this._height/2*n.ca),y.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca),_=!0)}}if(!_){y.pushPoint(this._walker.getPathEnd());break}}}_constructTriangle(y,u){Math.round(u/this._period);let m=!0;for(;;){let _=!1;if(this._walker.curPositionIsValid()){const g=new W.Yw;this._walker.curPointAndAngle(g);const n=new W.Yw;if(this._walker.nextPointAndAngle(this._period/2,n)){const r=new W.Yw;this._walker.nextPointAndAngle(this._period,r)&&(this._walker.nextPosition(this._period/2)&&(m?(y.pushPoint(g.pt),m=!1):y.pushPoint(g.pt),y.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),y.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca)),_=!0)}}if(!_){y.pushPoint(this._walker.getPathEnd());break}}}}},78586:(dt,it,E)=>{E.d(it,{W:()=>A});var q=E(70207),H=E(11196),W=E(84086);let A=(()=>{class S{static local(){return null===S.instance&&(S.instance=new S),S.instance}execute(u,m,_,g,n){return new U(u,m,_)}}return S.instance=null,S})();class U extends q.v1{constructor(y,u,m){super(y),this._geometryWalker=new W.Ll,this._geometryWalker.updateTolerance(m),this._angleToLine=u.angleToLine??!0,this._offset=(u.offset?u.offset:0)*m,this._originalEndings=u.endings,this._offsetAtEnd=(u.customEndingOffset?u.customEndingOffset:0)*m,this._position=-(u.offsetAlongLine?u.offsetAlongLine:0)*m,this._pattern=new W.h9,this._pattern.init(u.placementTemplate,!1),this._pattern.scale(m),this._endings=this._originalEndings}processPath(y){if(this._pattern.isEmpty())return null;let u;if(this.iteratePath)u=this._pattern.nextValue();else{this._endings=this._originalEndings===H.JS.WithFullGap&&this.isClosed?H.JS.WithMarkers:this._originalEndings,this._pattern.extPtGap=0;let _,g=!0;switch(this._endings){case H.JS.NoConstraint:_=-this._position,_=this._adjustPosition(_),g=!1;break;case H.JS.WithHalfGap:default:_=-this._pattern.lastValue()/2;break;case H.JS.WithFullGap:_=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case H.JS.WithMarkers:_=0;break;case H.JS.Custom:_=-this._position,_=this._adjustPosition(_),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(y,this._pattern,g))return null;this._pattern.reset();let n=0;for(;_>n;)_-=n,n=this._pattern.nextValue();n-=_,u=n,this.iteratePath=!0}const m=new W.Yw;return this._geometryWalker.nextPointAndAngle(u,m)?this._endings===H.JS.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===H.JS.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(m.pt[0]-this._offset*m.sa,m.pt[1]+this._offset*m.ca),this._angleToLine&&this.internalPlacement.setRotateCS(m.ca,m.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(y){let u=y/this._pattern.length();return u-=Math.floor(u),u*this._pattern.length()}}},52153:(dt,it,E)=>{E.d(it,{j:()=>A});var q=E(70207),H=E(24862),W=E(11196);let A=(()=>{class S{static local(){return null===S.instance&&(S.instance=new S),S.instance}execute(u,m,_,g,n){return new U(u,m,_)}}return S.instance=null,S})();class U extends q.v1{constructor(y,u,m){super(y,!1,!0),this._curveHelper=new H.N,this._placePerPart=u.placePerPart??!1,this._angleToLine=void 0===u.angleToLine||u.angleToLine,this._offset=void 0!==u.offset?u.offset*m:0,this._type=u.extremityPlacement,this._position=void 0!==u.offsetAlongLine?u.offsetAlongLine*m:0,this._beginProcessed=!1}processMultiPath(y){return this._placePerPart?super.processMultiPath(y):this.processPath(y)}processPath(y){let u;switch(this._type){case W.Tx.Both:default:this._beginProcessed?(u=this._atExtremities(y,this._position,!1),this._beginProcessed=!1,this.iterateMultiPath=!1,this.iteratePath=!1):(u=this._atExtremities(y,this._position,!0),this._beginProcessed=!0,this.iterateMultiPath=!0,this.iteratePath=!0);break;case W.Tx.JustBegin:u=this._atExtremities(y,this._position,!0);break;case W.Tx.JustEnd:u=this._atExtremities(y,this._position,!1);case W.Tx.None:}return u}_atExtremities(y,u,m){if(this._placePerPart||y.seekPath(m?0:y.totalSize-1),m||y.seekPathEnd(),m?y.nextPoint():y.prevPoint()){let _=0,[g,n]=[0,0],[r,o]=[y.x,y.y];for(;m?y.nextPoint():y.prevPoint();){g=r,n=o,r=y.x,o=y.y;const e=this._curveHelper.getLength(g,n,r,o);if(_+e>u){const h=(u-_)/e,[p,M]=this._curveHelper.getAngleCS(g,n,r,o,h),I=this._curveHelper.getCoord2D(g,n,r,o,h);return this.internalPlacement.setTranslate(I[0]-this._offset*M,I[1]+this._offset*p),this._angleToLine&&this.internalPlacement.setRotateCS(-p,-M),this.internalPlacement}_+=e}}return null}}},25065:(dt,it,E)=>{E.d(it,{x:()=>W});var q=E(70207),H=E(84086);let W=(()=>{class U{static local(){return null===U.instance&&(U.instance=new U),U.instance}execute(y,u,m,_,g){return new A(y,u,m)}}return U.instance=null,U})();class A extends q.v1{constructor(S,y,u){super(S),this._walker=new H.Ll,this._walker.updateTolerance(u),this._angleToLine=void 0===y.angleToLine||y.angleToLine,this._offset=void 0!==y.offset?y.offset*u:0,this._beginGap=void 0!==y.beginPosition?y.beginPosition*u:0,this._endGap=void 0!==y.endPosition?y.endPosition*u:0,this._flipFirst=void 0===y.flipFirst||y.flipFirst,this._pattern=new H.h9,this._pattern.init(y.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(S){if(this._pattern.isEmpty())return null;let y;if(this.iteratePath){const n=this._pattern.nextValue()*this._subPathLen,r=this._beginGap+n;y=r-this._prevPos,this._prevPos=r}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=S.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(S,this._pattern,!1))return null;this._pattern.reset();const n=this._pattern.nextValue()*this._subPathLen,r=this._beginGap+n;y=r-this._prevPos,this._prevPos=r,this.iteratePath=!0}const u=new H.Yw;if(!this._walker.nextPointAndAngle(y,u,H.u.END))return this.iteratePath=!1,null;let _,g;return this.internalPlacement.setTranslate(u.pt[0]-this._offset*u.sa,u.pt[1]+this._offset*u.ca),this._angleToLine?(_=u.ca,g=u.sa):(_=1,g=0),this._isFirst&&this._flipFirst&&(_=-_,g=-g),this.internalPlacement.setRotateCS(_,g),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}},81961:(dt,it,E)=>{E.d(it,{O:()=>u});var q=E(65311),H=E(75038),W=E(11196);const A=512,S=24,y=1e-6;let u=(()=>{class n{static local(){return null===n.instance&&(n.instance=new n),n.instance}execute(o,e,h,p,M){return new m(o,e,h,p,M)}}return n.instance=null,n})();class m{constructor(r,o,e,h,p){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._accelerationMap=null,this._testInsidePolygon=!1,this._verticalSubdivision=!0,this._stepX=Math.abs(o.stepX??16)*e,this._stepY=Math.abs(o.stepY??16)*e,this._stepX=Math.round(128*this._stepX)/128,this._stepY=Math.round(128*this._stepY)/128,0!==this._stepX&&0!==this._stepY){if(this._gridType=o.gridType??W.bj.Fixed,this._gridType===W.bj.Random)this._randomLCG=new q.Z(1*(o.seed??13)),this._randomness=(o.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0,this._buildRandomValues();else{if(this._randomness=0,this._gridAngle=o.gridAngle??0,this._shiftOddRows=o.shiftOddRows??!1,this._offsetX=(o.offsetX??0)*e,this._offsetY=(o.offsetY??0)*e,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}if(this._graphicOriginX=0,this._graphicOriginY=0,null!=h){const[M,I,T,B]=h.split("/"),F=parseFloat(M),X=parseFloat(I),V=parseFloat(T),D=parseFloat(B);this._graphicOriginX=-(D*2**F+V)*A,this._graphicOriginY=X*A,this._testInsidePolygon=!0}this._internalPlacement=new H.u,this._calculateMinMax(r),this._geometryCursor=r}}next(){return this._geometryCursor?this._nextInside():null}_buildRandomValues(){if(!m._randValues){m._randValues=[];for(let r=0;r<S;r++)for(let o=0;o<S;o++)m._randValues.push(this._randomLCG.getFloat()),m._randValues.push(this._randomLCG.getFloat())}}_calculateMinMax(r){let o,e,h,p,M,I,T,B,F,X,V,D,b,v;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,T=B=b=V=Number.MAX_VALUE,F=X=v=D=-Number.MAX_VALUE;const O=1!==this._cosAngle;for(r.reset();r.nextPath();)for(;r.nextPoint();)I=r.x,M=r.y,o=I-this._graphicOriginX-this._offsetX,e=M-this._graphicOriginY-this._offsetY,O?(h=this._cosAngle*o-this._sinAngle*e,p=this._sinAngle*o+this._cosAngle*e):(h=o,p=e),T=Math.min(T,h),F=Math.max(F,h),B=Math.min(B,p),X=Math.max(X,p),V=Math.min(V,M),D=Math.max(D,M),b=Math.min(b,I),v=Math.max(v,I);if(V=V!==Number.MAX_VALUE?V:-A-this._stepY,D=D!==-Number.MAX_VALUE?D:this._stepY,b=b!==Number.MAX_VALUE?b:-this._stepX,v=v!==-Number.MAX_VALUE?v:A+this._stepX,this._verticalSubdivision=D-V>=v-b,this._polygonMin=this._verticalSubdivision?V:b,this._testInsidePolygon){let j=0-this._graphicOriginX-this._offsetX-this._stepX,G=A-this._graphicOriginX-this._offsetX+this._stepX,K=-A-this._graphicOriginY-this._offsetY-this._stepY,tt=0-this._graphicOriginY-this._offsetY+this._stepY;if(O){const ot=[[j,K],[j,tt],[G,K],[G,tt]];j=K=Number.MAX_VALUE,G=tt=-Number.MAX_VALUE;for(const $ of ot){const ut=this._cosAngle*$[0]-this._sinAngle*$[1],ct=this._sinAngle*$[0]+this._cosAngle*$[1];j=Math.min(j,ut),G=Math.max(G,ut),K=Math.min(K,ct),tt=Math.max(tt,ct)}}T=T!==Number.MAX_VALUE?Math.max(T,j):j,B=B!==Number.MAX_VALUE?Math.max(B,K):K,F=F!==-Number.MAX_VALUE?Math.min(F,G):G,X=X!==-Number.MAX_VALUE?Math.min(X,tt):tt}this._xMin=Math.round(T/this._stepX),this._xMax=Math.round(F/this._stepX),this._yMin=Math.round(B/this._stepY),this._yMax=Math.round(X/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1,this._buildAccelerationMap(r,b,v,V,D)}_buildAccelerationMap(r,o,e,h,p){r.reset();const M=new Map,I=this._verticalSubdivision,T=I?p-h:e-o;let B=Math.ceil(T/10);if(B<=1)return;const F=Math.floor(T/B);let X,V,D,b,v,O,L,R,j,G,K;for(B++,this._delta=F,I?(j=-A-2*this._stepY,G=2*this._stepY,K=h):(j=-2*this._stepX,G=A+2*this._stepX,K=o);r.nextPath();)if(!(r.pathSize<2)&&r.nextPoint())for(X=r.x,V=r.y;r.nextPoint();X=D,V=b){if(D=r.x,b=r.y,I){if(V===b||V<j&&b<j||V>G&&b>G)continue;v=Math.min(V,b),O=Math.max(V,b)}else{if(X===D||X<j&&D<j||X>G&&D>G)continue;v=Math.min(X,D),O=Math.max(X,D)}for(;v<O;)L=Math.floor((v-K)/F),g(L,X,V,D,b,M),v+=F;R=Math.floor((O-K)/F),R>L&&g(R,X,V,D,b,M)}this._accelerationMap=M}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let r=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(r+=.5*this._stepX);const o=this._currentY*this._stepY+this._offsetY;let e,h;if(this._currentX++,this._gridType===W.bj.Random){const p=(this._currentX%S+S)%S,M=(this._currentY%S+S)%S;e=this._graphicOriginX+r+this._stepX*this._randomness*(.5-m._randValues[M*S+p])*2/3,h=this._graphicOriginY+o+this._stepY*this._randomness*(.5-m._randValues[M*S+p+1])*2/3}else e=this._graphicOriginX+this._cosAngle*r+this._sinAngle*o,h=this._graphicOriginY-this._sinAngle*r+this._cosAngle*o;if(!this._testInsidePolygon||this._isInsidePolygon(e,h,this._geometryCursor))return this._internalPlacement.setTranslate(e,h),this._internalPlacement}}_isInsidePolygon(r,o,e){if(null==this._accelerationMap)return function _(n,r,o){let e,h,p,M,I=0;for(n+=y,r+=y,o.reset();o.nextPath();)if(o.nextPoint())for(e=o.x,h=o.y;o.nextPoint();e=p,h=M)p=o.x,M=o.y,h>r!=M>r&&((p-e)*(r-h)-(M-h)*(n-e)>0?I++:I--);return 0!==I}(r,o,e);r+=y,o+=y;const h=this._verticalSubdivision,M=Math.floor(((h?o:r)-this._polygonMin)/this._delta),I=this._accelerationMap.get(M);if(!I)return!1;let T,B,F,X=0;for(const V of I){if(T=V[0],B=V[1],h){if(T[1]>o==B[1]>o)continue;F=(B[0]-T[0])*(o-T[1])-(B[1]-T[1])*(r-T[0])}else{if(T[0]>r==B[0]>r)continue;F=(B[1]-T[1])*(r-T[0])-(B[0]-T[0])*(o-T[1])}F>0?X++:X--}return 0!==X}}function g(n,r,o,e,h,p){let M=p.get(n);M||(M=[],p.set(n,M)),M.push([[r,o],[e,h]])}},18436:(dt,it,E)=>{E.d(it,{D:()=>U});var q=E(70207),H=E(24862),W=E(11196);let U=(()=>{class y{static local(){return null===y.instance&&(y.instance=new y),y.instance}execute(m,_,g,n,r){return new S(m,_,g)}}return y.instance=null,y})();class S extends q.v1{constructor(u,m,_){super(u),this._curveHelper=new H.N,this._angleToLine=void 0===m.angleToLine||m.angleToLine,this._offset=void 0!==m.offset?m.offset*_:0,this._relativeTo=m.relativeTo,this._position=void 0!==m.startPointOffset?m.startPointOffset*_:0,this._epsilon=.001*_}processPath(u){const m=this._position;if(this._relativeTo===W.CS.SegmentMidpoint){if(this.iteratePath||(this.iteratePath=!0),u.nextPoint()){let[g,n]=[u.x,u.y],[r,o]=[0,0];for(;u.nextPoint();){r=u.x,o=u.y;const e=this._curveHelper.getLength(g,n,r,o);if(e<this._epsilon){g=r,n=o;continue}const h=.5+this._position/e,[p,M]=this._curveHelper.getAngleCS(g,n,r,o,h),I=this._curveHelper.getCoord2D(g,n,r,o,h);return this.internalPlacement.setTranslate(I[0]-this._offset*M,I[1]+this._offset*p),this._angleToLine&&this.internalPlacement.setRotateCS(p,M),this.internalPlacement}}return this.iteratePath=!1,null}return this.onLine(u,m,this._relativeTo===W.CS.LineEnd)}onLine(u,m,_){let g,n=!1;switch(this._relativeTo){case W.CS.LineMiddle:default:u.seekPathStart(),g=u.pathLength()/2+m;break;case W.CS.LineBeginning:g=m;break;case W.CS.LineEnd:g=m,n=!0}_?u.seekPathEnd():u.seekPathStart();let r=0;if(_?u.prevPoint():u.nextPoint()){let[o,e]=[u.x,u.y],[h,p]=[0,0];for(;_?u.prevPoint():u.nextPoint();){h=u.x,p=u.y;const M=this._curveHelper.getLength(o,e,h,p);if(r+M>g){const I=(g-r)/M,[T,B]=this._curveHelper.getAngleCS(o,e,h,p,I),F=this._curveHelper.getCoord2D(o,e,h,p,I),X=n?-this._offset:this._offset;return this.internalPlacement.setTranslate(F[0]-X*B,F[1]+X*T),this._angleToLine&&(n?this.internalPlacement.setRotateCS(-T,-B):this.internalPlacement.setRotateCS(T,B)),this.internalPlacement}o=h,e=p,r+=M}}return null}}},34949:(dt,it,E)=>{E.d(it,{o:()=>A});var q=E(70207),H=E(24862);let A=(()=>{class y{static local(){return null===y.instance&&(y.instance=new y),y.instance}execute(m,_,g,n,r){return new U(m,_,g)}}return y.instance=null,y})();class U extends q.v1{constructor(u,m,_){super(u),this._curveHelper=new H.N,this._angleToLine=void 0===m.angleToLine||m.angleToLine,this._offset=void 0!==m.offset?m.offset*_:0,this._endPoints=void 0===m.placeOnEndPoints||m.placeOnEndPoints,this._controlPoints=void 0===m.placeOnControlPoints||m.placeOnControlPoints,this._regularVertices=void 0===m.placeOnRegularVertices||m.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(u){if(this.iteratePath||(this._preparePath(u),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const m=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(m[2]);let _=m[0],g=m[1];if(0!==this._offset){const n=Math.cos(m[2]),r=Math.sin(m[2]);_-=this._offset*r,g+=this._offset*n}return this.internalPlacement.setTranslate(_,g),this._tagIterator++,this.internalPlacement}_preparePath(u){this._tags.length=0,this._tagIterator=0,u.seekPathStart();const m=u.isClosed();let _=0,g=!1,n=0,r=0;if(u.seekPathStart(),u.nextPoint()){let o=u.x,e=u.y,h=u.getControlPoint(),p=!0,M=u.nextPoint();for(;M;){const I=u.x,T=u.y,B=u.getControlPoint();(this._angleToLine||0!==this._offset)&&(n=this._curveHelper.getAngle(o,e,I,T,0)),p?(p=!1,m?(_=n,g=h):(this._endPoints||this._controlPoints&&h)&&this._tags.push([o,e,n])):h?this._controlPoints&&this._tags.push([o,e,S(r,n)]):this._regularVertices&&this._tags.push([o,e,S(r,n)]),(this._angleToLine||0!==this._offset)&&(r=this._curveHelper.getAngle(o,e,I,T,1)),M=u.nextPoint(),M||(m?B||g?this._controlPoints&&this._tags.push([I,T,S(r,_)]):this._regularVertices&&this._tags.push([I,T,S(r,_)]):(this._endPoints||this._controlPoints&&B)&&this._tags.push([I,T,r])),o=I,e=T,h=B}}this._tagIterator=0}}function S(y,u){const m=Math.PI;for(;Math.abs(u-y)>m+2e-15;)u-y>m?u-=2*m:u+=2*m;return(y+u)/2}},40321:(dt,it,E)=>{E.d(it,{y:()=>S});var q=E(43585),H=E(56880),W=E(81321),A=E(75038),U=E(11196);let S=(()=>{class u{static local(){return null===u.instance&&(u.instance=new u),u.instance}execute(_,g,n,r,o){return new y(_,g,n)}}return u.instance=null,u})();class y{constructor(m,_,g){this._geometryCursor=m,this._offsetX=void 0!==_.offsetX?_.offsetX*g:0,this._offsetY=void 0!==_.offsetY?_.offsetY*g:0,this._method=void 0!==_.method?_.method:U.Lh.OnPolygon,this._internalPlacement=new A.u}next(){const m=this._geometryCursor;return this._geometryCursor=null,m?this._polygonCenter(m):null}_polygonCenter(m){let _=!1;switch(this._method){case U.Lh.CenterOfMass:{const g=(0,H.NA)(m);g&&(this._internalPlacement.setTranslate(g[0]+this._offsetX,g[1]+this._offsetY),_=!0)}break;case U.Lh.BoundingBoxCenter:{const g=(0,q.Cs)(m);g&&(this._internalPlacement.setTranslate((g[2]+g[0])/2+this._offsetX,(g[3]+g[1])/2+this._offsetY),_=!0)}break;default:{const g=(0,W.r)(m);null!==g&&(this._internalPlacement.setTranslate(g[0]+this._offsetX,g[1]+this._offsetY),_=!0)}}return _?this._internalPlacement:null}}},13948:(dt,it,E)=>{E.d(it,{TR:()=>A,b7:()=>S,g:()=>u,kH:()=>U,qv:()=>y,tf:()=>m});var q=E(4703);const H=()=>q.Z.getLogger("esri.views.2d.engine.webgl.alignmentUtils");var W,A,n;function U(n){if(!n)return W.Center;switch(n){case"Left":case"left":return W.Left;case"Right":case"right":return W.Right;case"Justify":return H().warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),W.Center;case"Center":case"center":return W.Center}}function S(n){if(!n)return A.Center;switch(n){case"Top":case"top":return A.Top;case"Center":case"middle":return A.Center;case"Baseline":case"baseline":return A.Baseline;case"Bottom":case"bottom":return A.Bottom}}function y(n){switch(n){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return["right","bottom"];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return["center","bottom"];case"above-right":case"esriServerPointLabelPlacementAboveRight":return["left","bottom"];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return["right","middle"];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return["center","middle"];case"center-right":case"esriServerPointLabelPlacementCenterRight":return["left","middle"];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return["right","top"];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return["center","top"];case"below-right":case"esriServerPointLabelPlacementBelowRight":return["left","top"];default:return console.debug(`Found invalid placement type ${n}`),["center","middle"]}}function u(n){switch(n){case W.Right:case"right":return-1;case W.Center:case"center":return 0;case W.Left:case"left":return 1;default:return console.debug(`Found invalid horizontal alignment ${n}`),0}}function m(n){switch(n){case A.Top:case"top":return 1;case A.Center:case"middle":return 0;case A.Bottom:case A.Baseline:case"baseline":case"bottom":return-1;default:return console.debug(`Found invalid vertical alignment ${n}`),0}}(n=W||(W={}))[n.Left=-1]="Left",n[n.Center=0]="Center",n[n.Right=1]="Right",function(n){n[n.Top=1]="Top",n[n.Center=0]="Center",n[n.Bottom=-1]="Bottom",n[n.Baseline=2]="Baseline"}(A||(A={}))},60559:(dt,it,E)=>{E.d(it,{Nr:()=>D});var q=E(60902),H=E(78332),W=E(29726),A=E(93266),U=E(13948),S=E(46117),y=E(79865);const u=22,m=4,_=u+m,g=u-6,n=3,r=Math.PI/180;class h{constructor(v,O,L,R){this._rotationT=(0,H.Ue)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const j=L.rect,G=new Float32Array(8);v*=R,O*=R;const K=L.code?j.width*R:L.metrics.width,tt=L.code?j.height*R:L.metrics.height;this.width=K,this.height=tt,G[0]=v,G[1]=O,G[2]=v+K,G[3]=O,G[4]=v,G[5]=O+tt,G[6]=v+K,G[7]=O+tt,this._data=G,this._setTextureCoords(j),this._scale=R,this._mosaic=L,this.x=v,this.y=O,this.maxOffset=Math.max(v+K,O+tt)}get mosaic(){return this._mosaic}set angle(v){this._angle=v,(0,q.Us)(this._rotationT,-v),this._setOffsets()}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:v,width:O}=this._mosaic.metrics,L=O*this._scale,R=Math.abs(v)*this._scale,j=new Float32Array(8);j[0]=this.x,j[1]=this.y,j[2]=this.x+L,j[3]=this.y,j[4]=this.x,j[5]=this.y+R,j[6]=this.x+L,j[7]=this.y+R;const G=(0,q.Jp)((0,H.Ue)(),this._rotationT,this._transform);(0,H.Zz)(j,j,G);let K=1/0,tt=1/0,ot=0,$=0;for(let at=0;at<4;at++){const mt=j[2*at],Pt=j[2*at+1];K=Math.min(K,mt),tt=Math.min(tt,Pt),ot=Math.max(ot,mt),$=Math.max($,Pt)}const ut=ot-K,ct=$-tt;this._bounds=new y.Z(K+ut/2,tt+ct/2,ut,ct)}return this._bounds}setTransform(v){this._transform=v,this._offsets=null}_setOffsets(){this._offsets||(this._offsets={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0]});const v=(0,q.Jp)((0,H.Ue)(),this._rotationT,this._transform);this._offsets.topLeft[0]=this._data[0],this._offsets.topLeft[1]=this._data[1],this._offsets.topRight[0]=this._data[2],this._offsets.topRight[1]=this._data[3],this._offsets.bottomLeft[0]=this._data[4],this._offsets.bottomLeft[1]=this._data[5],this._offsets.bottomRight[0]=this._data[6],this._offsets.bottomRight[1]=this._data[7],(0,W.iu)(this._offsets.topLeft,this._offsets.topLeft,v),(0,W.iu)(this._offsets.topRight,this._offsets.topRight,v),(0,W.iu)(this._offsets.bottomLeft,this._offsets.bottomLeft,v),(0,W.iu)(this._offsets.bottomRight,this._offsets.bottomRight,v)}_setTextureCoords({x:v,y:O,width:L,height:R}){this._texcoords={topLeft:[v,O],topRight:[v+L,O],bottomLeft:[v,O+R],bottomRight:[v+L,O+R]}}}const p=(b,v)=>({code:0,page:0,sdf:!0,rect:new S.Z(0,0,11,8),textureBinding:v,metrics:{advance:0,height:4,width:b,left:0,top:0}});function M(b,v){return b.forEach(O=>(0,W.iu)(O,O,v)),{topLeft:b[0],topRight:b[1],bottomLeft:b[2],bottomRight:b[3]}}class I{constructor(v,O,L){this._rotation=0,this._decorate(v,O,L),this.glyphs=v,this.bounds=this._createBounds(v),this.isMultiline=O.length>1,this._hasRotation=0!==L.angle,this._transform=this._createGlyphTransform(this.bounds,L),this._borderLineSizePx=L.borderLineSizePx,(L.borderLineSizePx||L.hasBackground)&&([this.bounds,this.textBox]=this.shapeBackground(this._transform));for(const R of v)R.setTransform(this._transform)}setRotation(v){if(0===v&&0===this._rotation)return;this._rotation=v;const O=this._transform,L=(0,q.Us)((0,H.Ue)(),v);(0,q.Jp)(O,L,O);for(const R of this.glyphs)R.setTransform(this._transform)}_decorate(v,O,L){if(!L.decoration||"none"===L.decoration||!v.length)return;const R=L.scale,j="underline"===L.decoration?_:g,G=v[0].textureBinding;for(const K of O)v.push(new h(K.startX*R,K.startY*R+j*R,p((K.width+K.glyphWidthEnd)*R,G),1))}shapeBackground(v){const L=(1.5+(this._borderLineSizePx||0))/2,R=this._borderLineSizePx?L:0,{xmin:j,ymin:G,xmax:K,ymax:tt,x:ot,y:$,width:ut,height:ct}=this.bounds,ht=[j-8,G-8],_t=[K+8,G-8],at=[j-8,tt+8],mt=[K+8,tt+8],Pt=M([[ht[0]-L,ht[1]-L],[_t[0]+L,_t[1]-L],[ht[0]+R,ht[1]+R],[_t[0]-R,_t[1]+R]],v),gt=M([[at[0]+R,at[1]-R],[mt[0]-R,mt[1]-R],[at[0]-L,at[1]+L],[mt[0]+L,mt[1]+L]],v),pt=M([[ht[0]-L,ht[1]-L],[ht[0]+R,ht[1]+R],[at[0]-L,at[1]+L],[at[0]+R,at[1]-R]],v),yt=M([[_t[0]-R,_t[1]+R],[_t[0]+L,_t[1]-L],[mt[0]-R,mt[1]-R],[mt[0]+L,mt[1]+L]],v),Q={main:M([ht,_t,at,mt],v),top:Pt,bot:gt,left:pt,right:yt};return[new y.Z(ot,$,ut+2*L,ct+2*L),Q]}get boundsT(){const v=this.bounds,O=(0,W.t8)((0,A.Ue)(),v.x,v.y);if((0,W.iu)(O,O,this._transform),this._hasRotation){const L=Math.max(v.width,v.height);return new y.Z(O[0],O[1],L,L)}return new y.Z(O[0],O[1],v.width,v.height)}_createBounds(v){let O=1/0,L=1/0,R=0,j=0;for(const tt of v)O=Math.min(O,tt.xTopLeft),L=Math.min(L,tt.yTopLeft),R=Math.max(R,tt.xBottomRight),j=Math.max(j,tt.yBottomRight);const G=R-O,K=j-L;return new y.Z(O+G/2,L+K/2,G,K)}_createGlyphTransform(v,O){const L=r*O.angle,R=(0,H.Ue)(),j=(0,A.Ue)();return(0,q.Iu)(R,R,(0,W.t8)(j,O.xOffset,-O.yOffset)),O.useCIMAngleBehavior?(0,q.U1)(R,R,L):((0,q.Iu)(R,R,(0,W.t8)(j,v.x,v.y)),(0,q.U1)(R,R,L),(0,q.Iu)(R,R,(0,W.t8)(j,-v.x,-v.y))),R}}class T{constructor(v,O,L,R,j,G){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(O,L)),this.end=Math.max(0,Math.max(O,L)),this.end<v.length&&(this.glyphWidthEnd=v[this.end].metrics.width),this.width=R,this.yMin=j,this.yMax=G}}const B=b=>10===b,F=b=>32===b;function D(b,v){const O=v.scale,L=new Array,{glyphs:R,isRightToLeft:j}=b,G=function X(b,v,O){const L=new Array,j=O.maxLineWidth*(1/O.scale),G=v?b.length-1:0,K=v?-1:b.length,tt=v?-1:1;let ot=G,$=0,ut=0,ct=ot,ht=ct,_t=0,at=1/0,mt=0;for(;ot!==K;){const{code:gt,metrics:pt}=b[ot],yt=Math.abs(pt.top);B(gt)||F(gt)||(at=Math.min(at,yt),mt=Math.max(mt,yt+pt.height)),B(gt)?(ot!==G&&(L.push(new T(b,ct,ot-tt,$,at===1/0?0:at,mt)),at=1/0,mt=0),$=0,ct=ot+tt,ht=ot+tt,ut=0):F(gt)?(ht=ot+tt,ut=0,_t=pt.advance,$+=pt.advance):$>j?(ht!==ct?($-=_t,L.push(new T(b,ct,ht-2*tt,$-ut,at,mt)),at=1/0,mt=0,ct=ht,$=ut):(L.push(new T(b,ct,ot-tt,$,at,mt)),at=1/0,mt=0,ct=ot,ht=ot,$=0),$+=pt.advance,ut+=pt.advance):($+=pt.advance,ut+=pt.advance),ot+=tt}const Pt=new T(b,ct,ot-tt,$,at,mt);return Pt.start>=0&&Pt.end<b.length&&L.push(Pt),L}(R,j,v),K=G.length?function V(b,v){let O=0;for(let j=0;j<b.length;j++){const{width:G}=b[j];O=Math.max(G,O)}const R=b[0].yMin;return{x:0,y:R,height:b[b.length-1].yMax+v.lineHeight*(b.length-1)+("underline"===v.decoration?m:0)-R,width:O}}(G,v):{x:0,y:0,height:0,width:0},tt=(0,U.kH)(v.horizontalAlignment),ot=(0,U.b7)(v.verticalAlignment),$=ot===U.TR.Baseline?1:0,ct=(1-$)*-K.y+K.height/2*($?0:ot-1)+($?1:0)*-u;for(let ht=0;ht<G.length;ht++){const{start:_t,end:at,width:mt}=G[ht];let Pt=-1*(tt+1)*(mt/2)-n;const gt=ht*v.lineHeight+ct-n;G[ht].startX=Pt,G[ht].startY=gt;for(let pt=_t;pt<=at;pt++){const yt=R[pt];if(B(yt.code))continue;const Q=new h(Pt+yt.metrics.left,gt-yt.metrics.top,yt,O);Pt+=yt.metrics.advance,L.push(Q)}}return new I(L,G,v)}},43501:(dt,it,E)=>{E.d(it,{OC:()=>y,XA:()=>g,g1:()=>r,vn:()=>n});var q=E(55768),H=E(5391),U=(E(45425),E(33721),E(99657));const y=50;function g(o){if(!o)return null;const{xmin:e,ymin:h,xmax:p,ymax:M,spatialReference:I}=o;return new H.Z({rings:[[[e,h],[e,M],[p,M],[p,h],[e,h]]],spatialReference:I})}function n(o){return(0,q.Wz)(Math.round((0,q.F2)(o)))}function r(o){const e=(0,q.Wz)(U.A5),h=(0,q.Wz)(U.NT);return Math.max(e,Math.min(o||h,h))}}}]);