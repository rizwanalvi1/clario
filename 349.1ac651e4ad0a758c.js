"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[349],{5710:($,K,_)=>{_.d(K,{a:()=>r,b:()=>Y,c:()=>M,e:()=>u,f:()=>A,g:()=>B,i:()=>b,j:()=>C,l:()=>E,n:()=>U,s:()=>W,t:()=>n});var m=_(89612);function M(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function W(e,t,o,p,w){return e[0]=t,e[1]=o,e[2]=p,e[3]=w,e}function A(e,t,o){return e[0]=t[0]+o[0],e[1]=t[1]+o[1],e[2]=t[2]+o[2],e[3]=t[3]+o[3],e}function F(e,t,o){return e[0]=t[0]-o[0],e[1]=t[1]-o[1],e[2]=t[2]-o[2],e[3]=t[3]-o[3],e}function N(e,t,o){return e[0]=t[0]*o[0],e[1]=t[1]*o[1],e[2]=t[2]*o[2],e[3]=t[3]*o[3],e}function S(e,t,o){return e[0]=t[0]/o[0],e[1]=t[1]/o[1],e[2]=t[2]/o[2],e[3]=t[3]/o[3],e}function Y(e,t,o){return e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e[3]=t[3]*o,e}function a(e,t){const o=t[0]-e[0],p=t[1]-e[1],w=t[2]-e[2],D=t[3]-e[3];return Math.sqrt(o*o+p*p+w*w+D*D)}function h(e,t){const o=t[0]-e[0],p=t[1]-e[1],w=t[2]-e[2],D=t[3]-e[3];return o*o+p*p+w*w+D*D}function b(e){const t=e[0],o=e[1],p=e[2],w=e[3];return Math.sqrt(t*t+o*o+p*p+w*w)}function C(e){const t=e[0],o=e[1],p=e[2],w=e[3];return t*t+o*o+p*p+w*w}function U(e,t){const o=t[0],p=t[1],w=t[2],D=t[3];let P=o*o+p*p+w*w+D*D;return P>0&&(P=1/Math.sqrt(P),e[0]=o*P,e[1]=p*P,e[2]=w*P,e[3]=D*P),e}function B(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function E(e,t,o,p){const w=t[0],D=t[1],P=t[2],V=t[3];return e[0]=w+p*(o[0]-w),e[1]=D+p*(o[1]-D),e[2]=P+p*(o[2]-P),e[3]=V+p*(o[3]-V),e}function n(e,t,o){const p=t[0],w=t[1],D=t[2],P=t[3];return e[0]=o[0]*p+o[4]*w+o[8]*D+o[12]*P,e[1]=o[1]*p+o[5]*w+o[9]*D+o[13]*P,e[2]=o[2]*p+o[6]*w+o[10]*D+o[14]*P,e[3]=o[3]*p+o[7]*w+o[11]*D+o[15]*P,e}function r(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function u(e,t){const o=e[0],p=e[1],w=e[2],D=e[3],P=t[0],V=t[1],X=t[2],J=t[3],G=(0,m.bn)();return Math.abs(o-P)<=G*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(p-V)<=G*Math.max(1,Math.abs(p),Math.abs(V))&&Math.abs(w-X)<=G*Math.max(1,Math.abs(w),Math.abs(X))&&Math.abs(D-J)<=G*Math.max(1,Math.abs(D),Math.abs(J))}Object.freeze(Object.defineProperty({__proto__:null,add:A,ceil:function z(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},copy:M,copyVec3:function T(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},dist:a,distance:a,div:S,divide:S,dot:B,equals:u,exactEquals:r,floor:function R(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},inverse:function l(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},len:b,length:b,lerp:E,max:function k(e,t,o){return e[0]=Math.max(t[0],o[0]),e[1]=Math.max(t[1],o[1]),e[2]=Math.max(t[2],o[2]),e[3]=Math.max(t[3],o[3]),e},min:function j(e,t,o){return e[0]=Math.min(t[0],o[0]),e[1]=Math.min(t[1],o[1]),e[2]=Math.min(t[2],o[2]),e[3]=Math.min(t[3],o[3]),e},mul:N,multiply:N,negate:function L(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},normalize:U,random:function Z(e,t){const o=m.FD;let p,w,D,P,V,X;t=t||1;do{p=2*o()-1,w=2*o()-1,V=p*p+w*w}while(V>=1);do{D=2*o()-1,P=2*o()-1,X=D*D+P*P}while(X>=1);const J=Math.sqrt((1-V)/X);return e[0]=t*p,e[1]=t*w,e[2]=t*D*J,e[3]=t*P*J,e},round:function x(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},scale:Y,scaleAndAdd:function H(e,t,o,p){return e[0]=t[0]+o[0]*p,e[1]=t[1]+o[1]*p,e[2]=t[2]+o[2]*p,e[3]=t[3]+o[3]*p,e},set:W,sqrDist:h,sqrLen:C,squaredDistance:h,squaredLength:C,str:function d(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},sub:F,subtract:F,transformMat4:n,transformQuat:function i(e,t,o){const p=t[0],w=t[1],D=t[2],P=o[0],V=o[1],X=o[2],J=o[3],G=J*p+V*D-X*w,Q=J*w+X*p-P*D,q=J*D+P*w-V*p,ee=-P*p-V*w-X*D;return e[0]=G*J+ee*-P+Q*-X-q*-V,e[1]=Q*J+ee*-V+q*-P-G*-X,e[2]=q*J+ee*-X+G*-V-Q*-P,e[3]=t[3],e}},Symbol.toStringTag,{value:"Module"}))},79144:($,K,_)=>{function m(){return new Float32Array(3)}function M(a){const h=new Float32Array(3);return h[0]=a[0],h[1]=a[1],h[2]=a[2],h}function T(a,h,b){const C=new Float32Array(3);return C[0]=a,C[1]=h,C[2]=b,C}function A(){return m()}function F(){return T(1,1,1)}function N(){return T(1,0,0)}function S(){return T(0,1,0)}function z(){return T(0,0,1)}_.d(K,{Ue:()=>m,al:()=>T,d9:()=>M});const R=A(),j=F(),k=N(),x=S(),Y=z();Object.freeze(Object.defineProperty({__proto__:null,ONES:j,UNIT_X:k,UNIT_Y:x,UNIT_Z:Y,ZEROS:R,clone:M,create:m,createView:function W(a,h){return new Float32Array(a,h,3)},fromValues:T,ones:F,unitX:N,unitY:S,unitZ:z,zeros:A},Symbol.toStringTag,{value:"Module"}))},23515:($,K,_)=>{function m(){return[0,0,0,0]}function T(C,L,l,U){return[C,L,l,U]}function N(){return T(1,1,1,1)}function S(){return T(1,0,0,0)}function z(){return T(0,1,0,0)}function R(){return T(0,0,1,0)}function j(){return T(0,0,0,1)}_.d(K,{Ue:()=>m,al:()=>T});const x=N(),Y=S(),H=z(),a=R(),h=j();Object.freeze(Object.defineProperty({__proto__:null,ONES:x,UNIT_W:h,UNIT_X:Y,UNIT_Y:H,UNIT_Z:a,ZEROS:[0,0,0,0],clone:function M(C){return[C[0],C[1],C[2],C[3]]},create:m,createView:function A(C,L){return new Float64Array(C,L,4)},fromArray:function W(C,L=[0,0,0,0]){const l=Math.min(4,C.length);for(let U=0;U<l;++U)L[U]=C[U];return L},fromValues:T,ones:N,unitW:j,unitX:S,unitY:z,unitZ:R,zeros:function F(){return[0,0,0,0]}},Symbol.toStringTag,{value:"Module"}))},37764:($,K,_)=>{_.d(K,{I:()=>z});var S,m=_(50484),M=_(89317),T=_(80543),N=(_(14007),_(4703),_(65311),_(10141));let z=S=class extends M.wq{constructor(){super(...arguments),this.title=null}clone(){return new S({title:this.title})}};(0,m._)([(0,T.Cb)({type:String,json:{write:!0}})],z.prototype,"title",void 0),z=S=(0,m._)([(0,N.j)("esri.renderers.support.LegendOptions")],z)},11892:($,K,_)=>{_.d(K,{Z:()=>k});var R,m=_(50484),M=_(66599),T=_(89317),W=_(80543),A=_(1535),S=(_(65311),_(14007),_(10141)),z=_(7547);let j=R=class extends T.wq{constructor(x){super(x),this.color=null,this.label=null,this.value=null}writeValue(x,Y,H){Y[H]=x??0}clone(){return new R({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};(0,m._)([(0,W.Cb)({type:M.Z,json:{type:[A.z8],write:!0}})],j.prototype,"color",void 0),(0,m._)([(0,W.Cb)({type:String,json:{write:!0}})],j.prototype,"label",void 0),(0,m._)([(0,W.Cb)({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],j.prototype,"value",void 0),(0,m._)([(0,z.c)("value")],j.prototype,"writeValue",null),j=R=(0,m._)([(0,S.j)("esri.renderers.visualVariables.support.ColorStop")],j);const k=j},39093:($,K,_)=>{_.r(K),_.d(K,{default:()=>i});var m=_(57678),M=_(40271),T=_(36510),W=_(686),A=_(43548),F=_(79144),N=_(43814),S=_(83639),R=(_(14007),_(21705)),j=_(71212),k=_(70615),x=_(67826),Y=_(42815);function h(d,r,u){return d?.attributeInfo.useElevation?r?function b(d,r){const u=new Float64Array(r);for(let s=0;s<r;s++)u[s]=d[3*s+2];return u}(r,u):null:d?.attributeInfo.storageInfo?(0,x.qM)(d.attributeInfo.storageInfo,d.buffer,u):null}function L(d){switch(d){default:case null:case"none":return r=>r;case"low-four-bit":return r=>15&r;case"high-four-bit":return r=>(240&r)>>4;case"absolute-value":return r=>Math.abs(r);case"modulo-ten":return r=>r%10}}function l(d){let r=0;for(const u of d||[])r|=1<<u;return r}var U=_(38475);class B{transform(r){const u=this._transform(r),s=[u.points.buffer,u.rgb.buffer];null!=u.pointIdFilterMap&&s.push(u.pointIdFilterMap.buffer);for(const g of u.attributes)"buffer"in g.values&&(0,M.eP)(g.values.buffer)&&g.values.buffer!==u.rgb.buffer&&s.push(g.values.buffer);return Promise.resolve({result:u,transferList:s})}_transform(r){const u=function a(d,r){if(null==d.encoding||""===d.encoding){const u=(0,x.W7)(r,d);if(null==u.vertexAttributes.position)return;const s=(0,x.I_)(r,u.vertexAttributes.position),g=u.header.fields,I=[g.offsetX,g.offsetY,g.offsetZ],c=[g.scaleX,g.scaleY,g.scaleZ],y=s.length/3,f=new Float64Array(3*y);for(let O=0;O<y;O++)f[3*O]=s[3*O]*c[0]+I[0],f[3*O+1]=s[3*O+1]*c[1]+I[1],f[3*O+2]=s[3*O+2]*c[2]+I[2];return f}if("lepcc-xyz"===d.encoding)return(0,Y.Gi)(r).result}(r.schema,r.geometryBuffer);let s=u.length/3,g=null;const I=new Array,c=h(r.primaryAttributeData,u,s);null!=r.primaryAttributeData&&c&&I.push({attributeInfo:r.primaryAttributeData.attributeInfo,values:c});const y=h(r.modulationAttributeData,u,s);null!=r.modulationAttributeData&&y&&I.push({attributeInfo:r.modulationAttributeData.attributeInfo,values:y});let f=function H(d,r,u,s){const{rendererJSON:g,isRGBRenderer:I}=d;let c=null,y=null;if(r&&I)c=r;else if(r&&"pointCloudUniqueValueRenderer"===g?.type){y=k.Z.fromJSON(g);const f=y.colorUniqueValueInfos;c=new Uint8Array(3*s);const O=L(y.fieldTransformType);for(let v=0;v<s;v++){const e=(O?O(r[v]):r[v])+"";for(let t=0;t<f.length;t++)if(f[t].values.includes(e)){c[3*v]=f[t].color.r,c[3*v+1]=f[t].color.g,c[3*v+2]=f[t].color.b;break}}}else if(r&&"pointCloudStretchRenderer"===g?.type){y=j.Z.fromJSON(g);const f=y.stops;c=new Uint8Array(3*s);const O=L(y.fieldTransformType);for(let v=0;v<s;v++){const e=O?O(r[v]):r[v],t=f.length-1;if(e<f[0].value)c[3*v]=f[0].color.r,c[3*v+1]=f[0].color.g,c[3*v+2]=f[0].color.b;else if(e>=f[t].value)c[3*v]=f[t].color.r,c[3*v+1]=f[t].color.g,c[3*v+2]=f[t].color.b;else for(let o=1;o<f.length;o++)if(e<f[o].value){const p=(e-f[o-1].value)/(f[o].value-f[o-1].value);c[3*v]=f[o].color.r*p+f[o-1].color.r*(1-p),c[3*v+1]=f[o].color.g*p+f[o-1].color.g*(1-p),c[3*v+2]=f[o].color.b*p+f[o-1].color.b*(1-p);break}}}else if(r&&"pointCloudClassBreaksRenderer"===g?.type){y=R.Z.fromJSON(g);const f=y.colorClassBreakInfos;c=new Uint8Array(3*s);const O=L(y.fieldTransformType);for(let v=0;v<s;v++){const e=O?O(r[v]):r[v];for(let t=0;t<f.length;t++)if(e>=f[t].minValue&&e<=f[t].maxValue){c[3*v]=f[t].color.r,c[3*v+1]=f[t].color.g,c[3*v+2]=f[t].color.b;break}}}else c=new Uint8Array(3*s).fill(255);if(u&&y?.colorModulation){const f=y.colorModulation.minValue,O=y.colorModulation.maxValue,v=.3;for(let e=0;e<s;e++){const t=u[e],o=t>=O?1:t<=f?v:v+(1-v)*(t-f)/(O-f);c[3*e]=o*c[3*e],c[3*e+1]=o*c[3*e+1],c[3*e+2]=o*c[3*e+2]}}return c}(r.rendererInfo,c,y,s);if(r.filterInfo&&r.filterInfo.length>0&&null!=r.filterAttributesData){const v=r.filterAttributesData.filter(m.pC).map(e=>{const t=h(e,u,s),o={attributeInfo:e.attributeInfo,values:t};return I.push(o),o});g=new Uint32Array(s),s=function C(d,r,u,s,g){const I=d.length/3;let c=0;for(let y=0;y<I;y++){let f=!0;for(let O=0;O<s.length&&f;O++){const{filterJSON:v}=s[O],e=g[O].values[y];switch(v.type){case"pointCloudValueFilter":{const t="exclude"===v.mode;v.values.includes(e)===t&&(f=!1);break}case"pointCloudBitfieldFilter":{const t=l(v.requiredSetBits),o=l(v.requiredClearBits);((e&t)!==t||e&o)&&(f=!1);break}case"pointCloudReturnFilter":{const t=15&e,o=e>>>4&15,p=o>1,w=1===t,D=t===o;let P=!1;for(const V of v.includedReturns)if("last"===V&&D||"firstOfMany"===V&&w&&p||"lastOfMany"===V&&D&&p||"single"===V&&!p){P=!0;break}P||(f=!1);break}}}f&&(u[c]=y,d[3*c]=d[3*y],d[3*c+1]=d[3*y+1],d[3*c+2]=d[3*y+2],r[3*c]=r[3*y],r[3*c+1]=r[3*y+1],r[3*c+2]=r[3*y+2],c++)}return c}(u,f,g,r.filterInfo,v)}for(const v of r.userAttributesData){const e=h(v,u,s);I.push({attributeInfo:v.attributeInfo,values:e})}3*s<f.length&&(f=new Uint8Array(f.buffer.slice(0,3*s))),function Z(d,r,u){if(0!==u)for(let s=0;s<r;s++)d[3*s+2]+=u}(u,s,r.elevationOffset);const O=function E(d,r,u,s,g){if(!(0,S.projectBuffer)(d,s,0,d,g,0,r))throw new Error("Can't reproject");const I=(0,F.d9)(u.center),c=(0,F.Ue)(),y=(0,F.Ue)(),f=(0,F.d9)(u.halfSize);(0,T.Kx)(n,u.quaternion);const O=new Float32Array(3*r);for(let v=0;v<r;v++){let e=3*v;c[0]=d[e]-I[0],c[1]=d[e+1]-I[1],c[2]=d[e+2]-I[2],(0,A.u)(y,c,n),f[0]=Math.max(f[0],Math.abs(y[0])),f[1]=Math.max(f[1],Math.abs(y[1])),f[2]=Math.max(f[2],Math.abs(y[2])),O[e++]=c[0],O[e++]=c[1],O[e]=c[2]}return u.halfSize=f,O}(u,s,U.Oo.fromData(r.obbData),N.Z.fromJSON(r.inSR),N.Z.fromJSON(r.outSR));return{obbData:r.obbData,points:O,rgb:f,attributes:I,pointIdFilterMap:g}}}const n=(0,W.Ue)();function i(){return new B}},67826:($,K,_)=>{_.d(K,{I_:()=>j,W7:()=>a,qM:()=>l});var m=_(57964),M=_(34222),T=_(4703),W=_(42815),A=_(55362);const F=()=>T.Z.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");function N(n,i,d){let r="",u=0;for(;u<d;){const s=n[i+u];if(s<128)r+=String.fromCharCode(s),u++;else if(s>=192&&s<224){if(u+1>=d)throw new m.Z("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");r+=String.fromCharCode((31&s)<<6|63&n[i+u+1]),u+=2}else if(s>=224&&s<240){if(u+2>=d)throw new m.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");r+=String.fromCharCode((15&s)<<12|(63&n[i+u+1])<<6|63&n[i+u+2]),u+=3}else{if(!(s>=240&&s<248))throw new m.Z("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");{if(u+3>=d)throw new m.Z("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");const g=(7&s)<<18|(63&n[i+u+1])<<12|(63&n[i+u+2])<<6|63&n[i+u+3];r+=g>=65536?String.fromCharCode(55296+(g-65536>>10),56320+(1023&g)):String.fromCharCode(g),u+=4}}}return r}function S(n,i){const d={byteOffset:0,byteCount:0,fields:Object.create(null)};let r=0;for(let u=0;u<i.length;u++){const s=i[u],g=s.valueType||s.type;d.fields[s.property]=(0,B[g])(n,r),r+=U[g].BYTES_PER_ELEMENT}return d.byteCount=r,d}function R(n,i,d){const r=[];let u,s,g=0;for(s=0;s<n;s+=1){if(u=i[s],u>0){if(r.push(N(d,g,u-1)),0!==d[g+u-1])throw new m.Z("string-array-error","Invalid string array: missing null termination.")}else r.push(null);g+=u}return r}function j(n,i){return new U[i.valueType](n,i.byteOffset,i.count*i.valuesPerElement)}function Y(n,i,d){if(i!==n&&F().error(`Invalid ${d} buffer size\n expected: ${n}, actual: ${i})`),i<n)throw new m.Z("buffer-too-small","Binary buffer is too small",{expectedSize:n,actualSize:i})}function a(n,i){const d=S(n,i&&i.header);let r=d.byteCount;const u={isDraco:!1,header:d,byteOffset:d.byteCount,byteCount:0,vertexAttributes:{}},s=d.fields,g=null!=s.vertexCount?s.vertexCount:s.count;for(const y of i.ordering){if(!i.vertexAttributes[y])continue;const f={...i.vertexAttributes[y],byteOffset:r,count:g};u.vertexAttributes[L[y]||"_"+y]=f,r+=Z(f.valueType)*f.valuesPerElement*g}const I=s.faceCount;if(i.faces&&I){u.faces={};for(const y of i.ordering){if(!i.faces[y])continue;const f={...i.faces[y],byteOffset:r,count:I};u.faces[y]=f,r+=Z(f.valueType)*f.valuesPerElement*I}}const c=s.featureCount;if(i.featureAttributes&&i.featureAttributeOrder&&c){u.featureAttributes={};for(const y of i.featureAttributeOrder){if(!i.featureAttributes[y])continue;const f={...i.featureAttributes[y],byteOffset:r,count:c};u.featureAttributes[y]=f,r+=("UInt64"===f.valueType?8:Z(f.valueType))*f.valuesPerElement*c}}return Y(r,n.byteLength,"geometry"),u.byteCount=r-u.byteOffset,u}const L={position:A.T.POSITION,normal:A.T.NORMAL,color:A.T.COLOR,uv0:A.T.UV0,region:A.T.UVREGION};function l(n,i,d){if("lepcc-rgb"===n.encoding)return(0,W.IT)(i);if("lepcc-intensity"===n.encoding)return(0,W.ti)(i);if(null!=n.encoding&&""!==n.encoding)throw new m.Z("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");n["attributeByteCounts "]&&!n.attributeByteCounts&&(F().warn("Warning: Trailing space in 'attributeByteCounts '."),n.attributeByteCounts=n["attributeByteCounts "]),"ObjectIds"===n.ordering[0]&&n.hasOwnProperty("objectIds")&&(F().warn("Warning: Case error in objectIds"),n.ordering[0]="objectIds");const r=function x(n,i,d){const r=null!=i.header?S(n,i.header):{byteOffset:0,byteCount:0,fields:{count:d}},u={header:r,byteOffset:r.byteCount,byteCount:0,entries:Object.create(null)};let s=r.byteCount;for(let g=0;g<i.ordering.length;g++){const I=i.ordering[g],c=(0,M.d9)(i[I]);if(c.count=r.fields.count??0,"String"===c.valueType){if(c.byteOffset=s,c.byteCount=r.fields[I+"ByteCount"],"UTF-8"!==c.encoding)throw new m.Z("unsupported-encoding","Unsupported String encoding.",{encoding:c.encoding});if(c.timeEncoding&&"ECMA_ISO8601"!==c.timeEncoding)throw new m.Z("unsupported-time-encoding","Unsupported time encoding.",{timeEncoding:c.timeEncoding})}else{if(!E(c.valueType))throw new m.Z("unsupported-value-type","Unsupported binary valueType",{valueType:c.valueType});{const y=Z(c.valueType);s+=s%y!=0?y-s%y:0,c.byteOffset=s,c.byteCount=y*c.valuesPerElement*c.count}}s+=c.byteCount??0,u.entries[I]=c}return u.byteCount=s-u.byteOffset,u}(i,n,d);Y(r.byteOffset+r.byteCount,i.byteLength,"attribute");const u=r.entries.attributeValues||r.entries.objectIds;if(u){if("String"===u.valueType){const s=r.entries.attributeByteCounts,g=j(i,s),I=function k(n,i){return new Uint8Array(n,i.byteOffset,i.byteCount)}(i,u);return u.timeEncoding?function z(n,i,d){return R(n,i,d).map(r=>{const u=r?Date.parse(r):null;return null==u||Number.isNaN(u)?null:u})}(s.count,g,I):R(s.count,g,I)}return j(i,u)}throw new m.Z("bad-attribute-storage-info","Bad attributeStorageInfo specification.")}const U={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},B={Float32:(n,i)=>new DataView(n,0).getFloat32(i,!0),Float64:(n,i)=>new DataView(n,0).getFloat64(i,!0),UInt8:(n,i)=>new DataView(n,0).getUint8(i),Int8:(n,i)=>new DataView(n,0).getInt8(i),UInt16:(n,i)=>new DataView(n,0).getUint16(i,!0),Int16:(n,i)=>new DataView(n,0).getInt16(i,!0),UInt32:(n,i)=>new DataView(n,0).getUint32(i,!0),Int32:(n,i)=>new DataView(n,0).getInt32(i,!0)};function E(n){return U.hasOwnProperty(n)}function Z(n){return E(n)?U[n].BYTES_PER_ELEMENT:0}},42815:($,K,_)=>{_.d(K,{Gi:()=>N,IT:()=>k,ti:()=>H});var m=_(57964);const M=!0,T={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,byteCount:16};function W(a,h,b){return{identifier:String.fromCharCode.apply(null,new Uint8Array(a,b+T.identifierOffset,T.identifierLength)),version:h.getUint16(b+T.versionOffset,M),checksum:h.getUint32(b+T.checksumOffset,M)}}const A={sizeLo:0,sizeHi:4,minX:8,minY:16,minZ:24,maxX:32,maxY:40,maxZ:48,errorX:56,errorY:64,errorZ:72,count:80,reserved:84,byteCount:88};function N(a){const h=new DataView(a,0);let b=0;const{identifier:C,version:L}=W(a,h,b);if(b+=T.byteCount,"LEPCC     "!==C)throw new m.Z("lepcc-decode-error","Bad identifier");if(L>1)throw new m.Z("lepcc-decode-error","Unknown version");const l=function F(a,h){return{sizeLo:a.getUint32(h+A.sizeLo,M),sizeHi:a.getUint32(h+A.sizeHi,M),minX:a.getFloat64(h+A.minX,M),minY:a.getFloat64(h+A.minY,M),minZ:a.getFloat64(h+A.minZ,M),maxX:a.getFloat64(h+A.maxX,M),maxY:a.getFloat64(h+A.maxY,M),maxZ:a.getFloat64(h+A.maxZ,M),errorX:a.getFloat64(h+A.errorX,M),errorY:a.getFloat64(h+A.errorY,M),errorZ:a.getFloat64(h+A.errorZ,M),count:a.getUint32(h+A.count,M),reserved:a.getUint32(h+A.reserved,M)}}(h,b);if(b+=A.byteCount,l.sizeHi*2**32+l.sizeLo!==a.byteLength)throw new m.Z("lepcc-decode-error","Bad size");const U=new Float64Array(3*l.count),B=[],E=[],Z=[],n=[];if(b=S(a,b,B),b=S(a,b,E),b=S(a,b,Z),b=S(a,b,n),b!==a.byteLength)throw new m.Z("lepcc-decode-error","Bad length");let i=0,d=0;for(let r=0;r<B.length;r++){d+=B[r];let u=0;for(let s=0;s<E[r];s++){u+=Z[i];const g=n[i];U[3*i]=Math.min(l.maxX,l.minX+2*l.errorX*u),U[3*i+1]=Math.min(l.maxY,l.minY+2*l.errorY*d),U[3*i+2]=Math.min(l.maxZ,l.minZ+2*l.errorZ*g),i++}}return{errorX:l.errorX,errorY:l.errorY,errorZ:l.errorZ,result:U}}function S(a,h,b){const C=[];h=z(a,h,C);const L=[];for(let l=0;l<C.length;l++){L.length=0,h=z(a,h,L);for(let U=0;U<L.length;U++)b.push(L[U]+C[l])}return h}function z(a,h,b){const C=new DataView(a,h),L=C.getUint8(0),l=31&L,U=!!(32&L),B=(192&L)>>6;let E=0;if(0===B)E=C.getUint32(1,M),h+=5;else if(1===B)E=C.getUint16(1,M),h+=3;else{if(2!==B)throw new m.Z("lepcc-decode-error","Bad count type");E=C.getUint8(1),h+=2}if(U)throw new m.Z("lepcc-decode-error","LUT not implemented");const Z=Math.ceil(E*l/8),n=new Uint8Array(a,h,Z);let i=0,d=0,r=0;const u=-1>>>32-l;for(let s=0;s<E;s++){for(;d<l;)i|=n[r]<<d,d+=8,r+=1;b[s]=i&u,i>>>=l,d-=l,d+l>32&&(i|=n[r-1]>>8-d)}return h+r}const R={sizeLo:0,sizeHi:4,count:8,colorMapCount:12,lookupMethod:14,compressionMethod:15,byteCount:16};function k(a){const h=new DataView(a,0);let b=0;const{identifier:C,version:L}=W(a,h,b);if(b+=T.byteCount,"ClusterRGB"!==C)throw new m.Z("lepcc-decode-error","Bad identifier");if(L>1)throw new m.Z("lepcc-decode-error","Unknown version");const l=function j(a,h){return{sizeLo:a.getUint32(h+R.sizeLo,M),sizeHi:a.getUint32(h+R.sizeHi,M),count:a.getUint32(h+R.count,M),colorMapCount:a.getUint16(h+R.colorMapCount,M),lookupMethod:a.getUint8(h+R.lookupMethod),compressionMethod:a.getUint8(h+R.compressionMethod)}}(h,b);if(b+=R.byteCount,l.sizeHi*2**32+l.sizeLo!==a.byteLength)throw new m.Z("lepcc-decode-error","Bad size");if((2===l.lookupMethod||1===l.lookupMethod)&&0===l.compressionMethod){if(3*l.colorMapCount+l.count+b!==a.byteLength||l.colorMapCount>256)throw new m.Z("lepcc-decode-error","Bad count");const U=new Uint8Array(a,b,3*l.colorMapCount),B=new Uint8Array(a,b+3*l.colorMapCount,l.count),E=new Uint8Array(3*l.count);for(let Z=0;Z<l.count;Z++){const n=B[Z];E[3*Z]=U[3*n],E[3*Z+1]=U[3*n+1],E[3*Z+2]=U[3*n+2]}return E}if(0===l.lookupMethod&&0===l.compressionMethod){if(3*l.count+b!==a.byteLength||0!==l.colorMapCount)throw new m.Z("lepcc-decode-error","Bad count");return new Uint8Array(a,b).slice()}if(l.lookupMethod<=2&&1===l.compressionMethod){if(b+3!==a.byteLength||1!==l.colorMapCount)throw new m.Z("lepcc-decode-error","Bad count");const U=h.getUint8(b),B=h.getUint8(b+1),E=h.getUint8(b+2),Z=new Uint8Array(3*l.count);for(let n=0;n<l.count;n++)Z[3*n]=U,Z[3*n+1]=B,Z[3*n+2]=E;return Z}throw new m.Z("lepcc-decode-error","Bad method "+l.lookupMethod+","+l.compressionMethod)}const x={sizeLo:0,sizeHi:4,count:8,scaleFactor:12,bitsPerPoint:14,reserved:15,byteCount:16};function H(a){const h=new DataView(a,0);let b=0;const{identifier:C,version:L}=W(a,h,b);if(b+=T.byteCount,"Intensity "!==C)throw new m.Z("lepcc-decode-error","Bad identifier");if(L>1)throw new m.Z("lepcc-decode-error","Unknown version");const l=function Y(a,h){return{sizeLo:a.getUint32(h+x.sizeLo,M),sizeHi:a.getUint32(h+x.sizeHi,M),count:a.getUint32(h+x.count,M),scaleFactor:a.getUint16(h+x.scaleFactor,M),bitsPerPoint:a.getUint8(h+x.bitsPerPoint),reserved:a.getUint8(h+x.reserved)}}(h,b);if(b+=x.byteCount,l.sizeHi*2**32+l.sizeLo!==a.byteLength)throw new m.Z("lepcc-decode-error","Bad size");const U=new Uint16Array(l.count);if(8===l.bitsPerPoint){if(l.count+b!==a.byteLength)throw new m.Z("lepcc-decode-error","Bad size");const B=new Uint8Array(a,b,l.count);for(let E=0;E<l.count;E++)U[E]=B[E]*l.scaleFactor}else if(16===l.bitsPerPoint){if(2*l.count+b!==a.byteLength)throw new m.Z("lepcc-decode-error","Bad size");const B=new Uint16Array(a,b,l.count);for(let E=0;E<l.count;E++)U[E]=B[E]*l.scaleFactor}else{const B=[];if(z(a,b,B)!==a.byteLength)throw new m.Z("lepcc-decode-error","Bad size");for(let E=0;E<l.count;E++)U[E]=B[E]*l.scaleFactor}return U}}}]);