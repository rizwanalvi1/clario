"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[4556,318],{54556:(x,L,e)=>{e.r(L),e.d(L,{default:()=>c});var s,h=e(15861),l=e(50484),y=(e(2189),e(66476)),R=e(57964),O=e(3233),I=e(72578),f=e(6785),n=e(80543),W=(e(14007),e(4703),e(65311),e(62185)),S=e(10141),b=e(7547),i=e(95060),d=e(19855),p=e(80099),M=e(70509),j=e(25836),B=e(29717),C=e(53715),_=e(8321),K=e(30220),H=e(1340),U=e(26894),a=e(43814),o=e(44107);let t=s=class extends((0,d.h7)((0,j.Q)((0,B.M)((0,p.q)((0,M.I)((0,O.R)(i.Z))))))){constructor(...r){super(...r),this.copyright="",this.fullExtent=new U.Z(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,a.Z.WebMercator),this.legendEnabled=!1,this.isReference=null,this.popupEnabled=!1,this.spatialReference=a.Z.WebMercator,this.subDomains=null,this.tileInfo=new K.Z({size:[256,256],dpi:96,format:"png8",compressionQuality:0,origin:new o.Z({x:-20037508.342787,y:20037508.342787,spatialReference:a.Z.WebMercator}),spatialReference:a.Z.WebMercator,lods:[new _.Z({level:0,scale:591657527.591555,resolution:156543.033928}),new _.Z({level:1,scale:295828763.795777,resolution:78271.5169639999}),new _.Z({level:2,scale:147914381.897889,resolution:39135.7584820001}),new _.Z({level:3,scale:73957190.948944,resolution:19567.8792409999}),new _.Z({level:4,scale:36978595.474472,resolution:9783.93962049996}),new _.Z({level:5,scale:18489297.737236,resolution:4891.96981024998}),new _.Z({level:6,scale:9244648.868618,resolution:2445.98490512499}),new _.Z({level:7,scale:4622324.434309,resolution:1222.99245256249}),new _.Z({level:8,scale:2311162.217155,resolution:611.49622628138}),new _.Z({level:9,scale:1155581.108577,resolution:305.748113140558}),new _.Z({level:10,scale:577790.554289,resolution:152.874056570411}),new _.Z({level:11,scale:288895.277144,resolution:76.4370282850732}),new _.Z({level:12,scale:144447.638572,resolution:38.2185141425366}),new _.Z({level:13,scale:72223.819286,resolution:19.1092570712683}),new _.Z({level:14,scale:36111.909643,resolution:9.55462853563415}),new _.Z({level:15,scale:18055.954822,resolution:4.77731426794937}),new _.Z({level:16,scale:9027.977411,resolution:2.38865713397468}),new _.Z({level:17,scale:4513.988705,resolution:1.19432856685505}),new _.Z({level:18,scale:2256.994353,resolution:.597164283559817}),new _.Z({level:19,scale:1128.497176,resolution:.298582141647617}),new _.Z({level:20,scale:564.248588,resolution:.14929107082380833}),new _.Z({level:21,scale:282.124294,resolution:.07464553541190416}),new _.Z({level:22,scale:141.062147,resolution:.03732276770595208}),new _.Z({level:23,scale:70.5310735,resolution:.01866138385297604})]}),this.type="web-tile",this.urlTemplate=null,this.wmtsInfo=null}normalizeCtorArgs(r,u){return"string"==typeof r?{urlTemplate:r,...u}:r}load(r){const u=this.loadFromPortal({supportedTypes:["WMTS"]},r).then(()=>{let E="";if(this.urlTemplate)if(this.spatialReference.equals(this.tileInfo.spatialReference)){const m=new f.R9(this.urlTemplate);!(this.subDomains&&this.subDomains.length>0)&&m.authority?.includes("{subDomain}")&&(E="is missing 'subDomains' property")}else E="spatialReference must match tileInfo.spatialReference";else E="is missing the required 'urlTemplate' property value";if(E)throw new R.Z("web-tile-layer:load",`WebTileLayer (title: '${this.title}', id: '${this.id}') ${E}`)});return this.addResolvingPromise(u),Promise.resolve(this)}get levelValues(){const r=[];if(!this.tileInfo)return null;for(const u of this.tileInfo.lods)r[u.level]=u.levelValue||u.level;return r}readSpatialReference(r,u){return r||a.Z.fromJSON(u.fullExtent?.spatialReference)}get tileServers(){if(!this.urlTemplate)return null;const r=[],{urlTemplate:u,subDomains:E}=this,m=new f.R9(u),g=m.scheme?m.scheme+"://":"//",P=g+m.authority+"/",Z=m.authority;if(Z?.includes("{subDomain}")){if(E&&E.length>0&&Z.split(".").length>1)for(const w of E)r.push(g+Z.replaceAll(/\{subDomain\}/gi,w)+"/")}else r.push(P);return r.map(f.xs)}get urlPath(){if(!this.urlTemplate)return null;const r=this.urlTemplate,u=new f.R9(r);return r.substring(((u.scheme?u.scheme+"://":"//")+u.authority+"/").length)}readUrlTemplate(r,u){return r||u.templateUrl}writeUrlTemplate(r,u){(0,f.oC)(r)&&(r="https:"+r),r&&(r=r.replaceAll(/\{z\}/gi,"{level}").replaceAll(/\{x\}/gi,"{col}").replaceAll(/\{y\}/gi,"{row}"),r=(0,f.Fv)(r)),u.templateUrl=r}fetchTile(r,u,E,m={}){const{signal:g}=m,P=this.getTileUrl(r,u,E),Z={responseType:"image",signal:g,query:{...this.refreshParameters}};return(0,y.Z)(P,Z).then(w=>w.data)}fetchImageBitmapTile(r,u,E,m={}){var g=this;return(0,h.Z)(function*(){const{signal:P}=m;if(g.fetchTile!==s.prototype.fetchTile){const F=yield g.fetchTile(r,u,E,m);return(0,C.V)(F,r,u,E,P)}const Z=g.getTileUrl(r,u,E),w={responseType:"blob",signal:P,query:{...g.refreshParameters}},{data:$}=yield(0,y.Z)(Z,w);return(0,C.V)($,r,u,E,P)})()}getTileUrl(r,u,E){const{levelValues:m,tileServers:g,urlPath:P}=this;if(!m||!g||!P)return"";const Z=m[r];return g[u%g.length]+(0,I.gx)(P,{level:Z,z:Z,col:E,x:E,row:u,y:u})}};(0,l._)([(0,n.Cb)({type:String,value:"",json:{write:!0}})],t.prototype,"copyright",void 0),(0,l._)([(0,n.Cb)({type:U.Z,json:{write:!0},nonNullable:!0})],t.prototype,"fullExtent",void 0),(0,l._)([(0,n.Cb)({readOnly:!0,json:{read:!1,write:!1}})],t.prototype,"legendEnabled",void 0),(0,l._)([(0,n.Cb)({type:["show","hide"]})],t.prototype,"listMode",void 0),(0,l._)([(0,n.Cb)({json:{read:!0,write:!0}})],t.prototype,"blendMode",void 0),(0,l._)([(0,n.Cb)()],t.prototype,"levelValues",null),(0,l._)([(0,n.Cb)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],t.prototype,"isReference",void 0),(0,l._)([(0,n.Cb)({type:["WebTiledLayer"],value:"WebTiledLayer"})],t.prototype,"operationalLayerType",void 0),(0,l._)([(0,n.Cb)({readOnly:!0,json:{read:!1,write:!1}})],t.prototype,"popupEnabled",void 0),(0,l._)([(0,n.Cb)({type:a.Z})],t.prototype,"spatialReference",void 0),(0,l._)([(0,W.r)("spatialReference",["spatialReference","fullExtent.spatialReference"])],t.prototype,"readSpatialReference",null),(0,l._)([(0,n.Cb)({type:[String],json:{write:!0}})],t.prototype,"subDomains",void 0),(0,l._)([(0,n.Cb)({type:K.Z,json:{write:!0}})],t.prototype,"tileInfo",void 0),(0,l._)([(0,n.Cb)({readOnly:!0})],t.prototype,"tileServers",null),(0,l._)([(0,n.Cb)({json:{read:!1}})],t.prototype,"type",void 0),(0,l._)([(0,n.Cb)()],t.prototype,"urlPath",null),(0,l._)([(0,n.Cb)({type:String,json:{origins:{"portal-item":{read:{source:"url"}}}}})],t.prototype,"urlTemplate",void 0),(0,l._)([(0,W.r)("urlTemplate",["urlTemplate","templateUrl"])],t.prototype,"readUrlTemplate",null),(0,l._)([(0,b.c)("urlTemplate",{templateUrl:{type:String}})],t.prototype,"writeUrlTemplate",null),(0,l._)([(0,n.Cb)({type:H.B,json:{write:!0}})],t.prototype,"wmtsInfo",void 0),t=s=(0,l._)([(0,S.j)("esri.layers.WebTileLayer")],t);const c=t},70509:(x,L,e)=>{e.d(L,{I:()=>_});var h=e(15861),l=e(50484),A=e(11931),y=e(26152),R=e(66476),O=e(37636),I=e(57964),f=e(4703),n=e(51172),v=e(79412),D=e(6785),T=e(80543),b=(e(14007),e(65311),e(62185)),i=e(10141),d=e(7547),p=e(85971),M=e(61018),j=e(27835),B=e(57437),C=e(50318);const _=H=>{let U=class extends H{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,n.SC)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(a){a!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",a))}readPortalItem(a,o,s){if(o.itemId)return new j.default({id:o.itemId,portal:s?.portal})}writePortalItem(a,o){a?.id&&(o.itemId=a.id)}loadFromPortal(a,o){var s=this;return(0,h.Z)(function*(){if(s.portalItem?.id)try{const{load:t}=yield Promise.all([e.e(2772),e.e(8592),e.e(6964)]).then(e.bind(e,36964));return(0,v.k_)(o),yield t({instance:s,supportedTypes:a.supportedTypes,validateItem:a.validateItem,supportsData:a.supportsData,layerModuleTypeMap:a.layerModuleTypeMap},o)}catch(t){throw(0,v.D_)(t)||f.Z.getLogger(s).warn(`Failed to load layer (${s.title}, ${s.id}) portal item (${s.portalItem.id})\n  ${t}`),t}})()}finishLoadEditablePortalLayer(a){var o=this;return(0,h.Z)(function*(){o._set("userHasEditingPrivileges",yield o._fetchUserHasEditingPrivileges(a).catch(s=>((0,v.r9)(s),!0)))})()}setUserPrivileges(a,o){var s=this;return(0,h.Z)(function*(){if(!A.default.userPrivilegesApplied)return s.finishLoadEditablePortalLayer(o);if(s.url)try{const{features:{edit:t,fullEdit:c},content:{updateItem:r}}=yield s._fetchUserPrivileges(a,o);s._set("userHasEditingPrivileges",t),s._set("userHasFullEditingPrivileges",c),s._set("userHasUpdateItemPrivileges",r)}catch(t){(0,v.r9)(t)}})()}_fetchUserPrivileges(a,o){var s=this;return(0,h.Z)(function*(){let t=s.portalItem;if(!a||!t||!t.loaded||t.sourceUrl)return s._fetchFallbackUserPrivileges(o);const c=a===t.id;if(c&&t.portal.user)return(0,C.Ss)(t);let r,u;if(c)r=t.portal.url;else try{r=yield(0,p.oP)(s.url,o)}catch(P){(0,v.r9)(P)}if(!r||!(0,D.Zo)(r,t.portal.url))return s._fetchFallbackUserPrivileges(o);try{const P=null!=o?o.signal:null;u=yield y.id?.getCredential(`${r}/sharing`,{prompt:!1,signal:P})}catch(P){(0,v.r9)(P)}if(!u)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(c?yield t.reload():(t=new j.default({id:a,portal:{url:r}}),yield t.load(o)),t.portal.user)return(0,C.Ss)(t)}catch(P){(0,v.r9)(P)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_fetchFallbackUserPrivileges(a){var o=this;return(0,h.Z)(function*(){let s=!0;try{s=yield o._fetchUserHasEditingPrivileges(a)}catch(t){(0,v.r9)(t)}return{features:{edit:s,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(a){var o=this;return(0,h.Z)(function*(){const s=o.url?y.id?.findCredential(o.url):null;if(!s)return!0;const t=K.credential===s?K.user:yield o._fetchEditingUser(a);return K.credential=s,K.user=t,null==t?.privileges||t.privileges.includes("features:user:edit")})()}_fetchEditingUser(a){var o=this;return(0,h.Z)(function*(){const s=o.portalItem?.portal?.user;if(s)return s;const t=y.id?.findServerInfo(o.url??"");if(!t?.owningSystemUrl)return null;const c=`${t.owningSystemUrl}/sharing/rest`,r=M.Z.getDefault();if(r&&r.loaded&&(0,D.Fv)(r.restUrl)===(0,D.Fv)(c))return r.user;const u=`${c}/community/self`,E=null!=a?a.signal:null,m=yield(0,O.q6)((0,R.Z)(u,{authMode:"no-prompt",query:{f:"json"},signal:E}));return m.ok?B.Z.fromJSON(m.value.data):null})()}read(a,o){o&&(o.layer=this),super.read(a,o)}write(a,o){const s=o?.portal,t=this.portalItem?.id&&(this.portalItem.portal||M.Z.getDefault());return s&&t&&!(0,D.tm)(t.restUrl,s.restUrl)?(o.messages&&o.messages.push(new I.Z("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(a,{...o,layer:this})}};return(0,l._)([(0,T.Cb)({type:j.default})],U.prototype,"portalItem",null),(0,l._)([(0,b.r)("web-document","portalItem",["itemId"])],U.prototype,"readPortalItem",null),(0,l._)([(0,d.c)("web-document","portalItem",{itemId:{type:String}})],U.prototype,"writePortalItem",null),(0,l._)([(0,T.Cb)({clonable:!1})],U.prototype,"resourceReferences",void 0),(0,l._)([(0,T.Cb)({type:Boolean,readOnly:!0})],U.prototype,"userHasEditingPrivileges",void 0),(0,l._)([(0,T.Cb)({type:Boolean,readOnly:!0})],U.prototype,"userHasFullEditingPrivileges",void 0),(0,l._)([(0,T.Cb)({type:Boolean,readOnly:!0})],U.prototype,"userHasUpdateItemPrivileges",void 0),U=(0,l._)([(0,i.j)("esri.layers.mixins.PortalLayer")],U),U},K={credential:null,user:null}},25836:(x,L,e)=>{e.d(L,{Q:()=>o});var h=e(15861),l=e(50484),y=(e(14007),e(4703)),R=e(79412),O=e(80543),I=e(73018),n=(e(65311),e(10141)),v=e(76215),D=e(83944),b=(e(37636),e(57964),e(12926),e(43571));const i=new D.Z,d=new WeakMap;function B(s,t){return Number.isFinite(s)&&Number.isFinite(t)?t<=0?s:B(t,s%t):0}let C=0,_=0;function K(){const s=Date.now();let t=!1;for(const c of i){const r=c.deref();r?r.refreshInterval&&s-(d.get(r)??0)+5>=6e4*r.refreshInterval&&(d.set(r,s),r.refresh(s)):t=!0}if(t)for(let c=i.length-1;c>=0;c--)i.at(c).deref()||i.removeAt(c)}(0,b.EH)(()=>{const s=Date.now();let t=0;for(const c of i){const r=c.deref();r&&(t=B(Math.round(6e4*r.refreshInterval),t),r.refreshInterval?d.get(r)||d.set(r,s):d.delete(r))}if(t!==_){if(_=t,clearInterval(C),0===_)return void(C=0);C=setInterval(K,_)}});const o=s=>{let t=class extends s{constructor(...c){super(...c),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,R.Ds)(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||function p(s){(function j(s){return null!=s&&"object"==typeof s&&"refreshInterval"in s&&"refresh"in s})(s)&&i.push(new WeakRef(s))}(this)},()=>{})}destroy(){!function M(s){const t=i.find(c=>c.deref()===s);t&&i.remove(t)}(this)}castRefreshInterval(c){return c>=.1?c:c<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(c=Date.now()){(0,R.R8)(this._debounceHasDataChanged()).then(r=>{r&&this._set("refreshTimestamp",c),this.emit("refresh",{dataChanged:r})},r=>{y.Z.getLogger(this).error(r),this.emit("refresh",{dataChanged:!1,error:r})})}hasDataChanged(){return(0,h.Z)(function*(){return!0})()}get test(){}};return(0,l._)([(0,O.Cb)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:v.C}}}}})],t.prototype,"refreshInterval",void 0),(0,l._)([(0,I.p)("refreshInterval")],t.prototype,"castRefreshInterval",null),(0,l._)([(0,O.Cb)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,l._)([(0,O.Cb)({readOnly:!0})],t.prototype,"refreshParameters",null),t=(0,l._)([(0,n.j)("esri.layers.mixins.RefreshableLayer")],t),t}},1340:(x,L,e)=>{e.d(L,{B:()=>n});var f,h=e(50484),l=e(89317),A=e(34222),y=e(80543),I=(e(14007),e(4703),e(10141));let n=f=class extends l.wq{constructor(v){super(v)}clone(){return new f({customLayerParameters:(0,A.d9)(this.customLayerParameters),customParameters:(0,A.d9)(this.customParameters),layerIdentifier:this.layerIdentifier,tileMatrixSet:this.tileMatrixSet,url:this.url})}};(0,h._)([(0,y.Cb)({json:{type:Object,write:!0}})],n.prototype,"customLayerParameters",void 0),(0,h._)([(0,y.Cb)({json:{type:Object,write:!0}})],n.prototype,"customParameters",void 0),(0,h._)([(0,y.Cb)({type:String,json:{write:!0}})],n.prototype,"layerIdentifier",void 0),(0,h._)([(0,y.Cb)({type:String,json:{write:!0}})],n.prototype,"tileMatrixSet",void 0),(0,h._)([(0,y.Cb)({type:String,json:{write:!0}})],n.prototype,"url",void 0),n=f=(0,h._)([(0,I.j)("esri.layers.support.WMTSLayerInfo")],n)},53715:(x,L,e)=>{e.d(L,{V:()=>O,g:()=>y});var h=e(15861),l=e(57964),A=e(79412);function y(f,n,v){return R.apply(this,arguments)}function R(){return(R=(0,h.Z)(function*(f,n,v){let D;try{D=yield createImageBitmap(f)}catch(T){throw new l.Z("request:server",`Unable to load ${n}`,{url:n,error:T})}return(0,A.k_)(v),D})).apply(this,arguments)}function O(f,n,v,D,T){return I.apply(this,arguments)}function I(){return(I=(0,h.Z)(function*(f,n,v,D,T){let W;try{W=yield createImageBitmap(f)}catch(S){throw new l.Z("request:server",`Unable to load tile ${n}/${v}/${D}`,{error:S,level:n,row:v,col:D})}return(0,A.k_)(T),W})).apply(this,arguments)}},50318:(x,L,e)=>{e.d(L,{$o:()=>T,Fj:()=>n,IW:()=>D,Ss:()=>b,_$:()=>f,ck:()=>v,hz:()=>S,qj:()=>I});var h=e(15861),l=e(83821),A=e(43814),y=e(48230);function O(){return(O=(0,h.Z)(function*(i){const d=i.spatialReference;if(d.isWGS84)return i.clone();if(d.isWebMercator)return(0,y.Sx)(i);const p=A.Z.WGS84;return yield(0,l.initializeProjection)(d,p),(0,l.project)(i,p)})).apply(this,arguments)}function I(i,d){if(!f(i,d)){const p=i.typeKeywords;p?p.push(d):i.typeKeywords=[d]}}function f(i,d){return!!i.typeKeywords?.includes(d)}function n(i){return f(i,S.HOSTED_SERVICE)}function v(i,d){const p=i.typeKeywords;if(p){const M=p.indexOf(d);M>-1&&p.splice(M,1)}}function D(i,d,p){p?I(i,d):v(i,d)}function T(i){return W.apply(this,arguments)}function W(){return W=(0,h.Z)(function*(i){const d=i.clone().normalize();let p;if(d.length>1)for(const M of d)p?M.width>p.width&&(p=M):p=M;else p=d[0];return function R(i){return O.apply(this,arguments)}(p)}),W.apply(this,arguments)}const S={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function b(i){const{portal:d,isOrgItem:p,itemControl:M}=i,j=d.user?.privileges;let B=!j||j.includes("features:user:edit"),C=!!p&&!!j?.includes("features:user:fullEdit");const _="update"===M||"admin"===M;return _?C=B=!0:C&&(B=!0),{features:{edit:B,fullEdit:C},content:{updateItem:_}}}}}]);