"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[6964],{453:(K,E,i)=>{i.d(E,{Y:()=>I,h:()=>P});var c=i(6785),h=i(61018);function P(y,d){return{...g(y,d),readResourcePaths:[]}}function I(y,d,f){const m=(0,c.mN)(y.itemUrl);return{...g(y,d),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:m?{rootPath:m.path,writtenUrls:[]}:null,resources:f?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function g(y,d){return{origin:d,url:(0,c.mN)(y.itemUrl),portal:y.portal||h.Z.getDefault(),portalItem:y}}},36964:(K,E,i)=>{i.r(E),i.d(E,{load:()=>F});var c=i(15861),h=i(57964),P=i(89713),I=i(23933),g=i(81390),y=i(4906),d=i(79936),f=i(61018),m=i(453),_=i(46011),M=i(50318),D=i(39262),Z=i(6661);function F(e,n){return O.apply(this,arguments)}function O(){return O=(0,c.Z)(function*(e,n){const r=e.instance.portalItem;if(r?.id)return yield r.load(n),function w(e){const n=e.instance.portalItem;if(!n?.type||!e.supportedTypes.includes(n.type))throw new h.Z("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}'",{type:n?.type,expectedType:e.supportedTypes.join(", ")})}(e),e.validateItem&&e.validateItem(r),function G(e,n){return L.apply(this,arguments)}(e,n)}),O.apply(this,arguments)}function L(){return L=(0,c.Z)(function*(e,n){const r=e.instance,t=r.portalItem;if(!t)return;const{url:s,title:o}=t,a=(0,m.h)(t,"portal-item");if("group"===r.type)return function $(e,n,r){return v.apply(this,arguments)}(r,a,e);s&&"media"!==r.type&&r.read({url:s},a);const u=new g.L,l=yield B(e,u,n);return l&&r.read(l,a),r.resourceReferences={portalItem:t,paths:a.readResourcePaths??[]},"subtype-group"!==r.type&&r.read({title:o},a),(0,D.y)(r,a)}),L.apply(this,arguments)}function v(){return v=(0,c.Z)(function*(e,n,r){const t=e.portalItem;if(!e.sourceIsPortalItem)return;const{title:s,type:o}=t;if("Group Layer"===o){if(!(0,M._$)(t,"Map"))throw new h.Z("portal:invalid-layer-item-typekeyword","'Group Layer' item without 'Map' type keyword is not supported");return function N(e){return T.apply(this,arguments)}(e)}return e.read({title:s},n),function z(e,n){return x.apply(this,arguments)}(e,r)}),v.apply(this,arguments)}function T(){return(T=(0,c.Z)(function*(e){const n=e.portalItem,r=yield n.fetchData("json");if(!r)return;const t=(0,m.h)(n,"web-map");e.read(r,t),yield(0,y.populateGroupLayer)(e,r,{context:t}),e.resourceReferences={portalItem:n,paths:t.readResourcePaths??[]}})).apply(this,arguments)}function x(){return x=(0,c.Z)(function*(e,n){let r;const{portalItem:t}=e;if(!t)return;const s=t.type,o=n.layerModuleTypeMap;switch(s){case"Feature Service":case"Feature Collection":r=o.FeatureLayer;break;case"Stream Service":r=o.StreamLayer;break;case"Scene Service":r=o.SceneLayer;break;default:throw new h.Z("portal:unsupported-item-type-as-group",`The item type '${s}' is not supported as a 'IGroupLayer'`)}const a=new g.L;let[u,l]=yield Promise.all([r(),B(n,a)]),p=()=>u;if("Feature Service"===s){const q=(0,_.uE)(l)?.customParameters;l=t.url?yield(0,_.$O)(l,t.url,a):{},p=(yield function k(e,n){return b.apply(this,arguments)}(l,o))||p;const ee=yield function X(e,n){return S.apply(this,arguments)}(t.url,{customParameters:q,loadContext:a});return yield C(e,p,l,ee)}return"Scene Service"===s&&t.url&&(l=yield(0,_.CD)(t,l,a)),(0,_.Q4)(l)>0?yield C(e,p,l):yield function J(e,n){return U.apply(this,arguments)}(e,p)}),x.apply(this,arguments)}function U(){return(U=(0,c.Z)(function*(e,n){const{portalItem:r}=e;if(!r?.url)return;const t=yield(0,Z.T)(r.url);t&&C(e,n,{layers:t.layers?.map(_.bS),tables:t.tables?.map(_.bS)})})).apply(this,arguments)}function C(e,n,r,t){return A.apply(this,arguments)}function A(){return(A=(0,c.Z)(function*(e,n,r,t){let s=r.layers||[];const o=r.tables||[];if("Feature Collection"===e.portalItem?.type?(s.forEach((a,u)=>{a.id=u,"Table"===a?.layerDefinition?.type&&o.push(a)}),s=s.filter(a=>"Table"!==a?.layerDefinition?.type)):(s.reverse(),o.reverse()),s.forEach(a=>{const u=t?.(a);if(u||!t){const l=W(e,n(a),r,a,u);e.add(l)}}),o.length){const a=yield d.T.FeatureLayer();o.forEach(u=>{const l=t?.(u);if(l||!t){const p=W(e,a,r,u,l);e.tables.add(p)}})}})).apply(this,arguments)}function W(e,n,r,t,s){const o=e.portalItem,a={portalItem:o.clone(),layerId:t.id};null!=t.url&&(a.url=t.url);const u=new n(a);if("sourceJSON"in u&&(u.sourceJSON=s),"subtype-group"!==u.type&&"catalog"!==u.type&&(u.sublayerTitleMode="service-name"),"Feature Collection"===o.type){const l={origin:"portal-item",portal:o.portal||f.Z.getDefault()};u.read(t,l);const p=r.showLegend;null!=p&&u.read({showLegend:p},l)}return u}function B(e,n,r){return R.apply(this,arguments)}function R(){return R=(0,c.Z)(function*(e,n,r){if(!1===e.supportsData)return;const t=e.instance,s=t.portalItem;if(!s)return;let o=null;try{o=yield s.fetchData("json",r)}catch{}if(function Y(e){return"stream"!==e.type&&"layerId"in e}(t)){let a=null;const u=yield function Q(e,n,r){return j.apply(this,arguments)}(s,o,n);if((o?.layers||o?.tables)&&u>0){if(null==t.layerId){const l=(0,_.ZC)(t.type),p=l?(0,_.r9)(o,l)[0]:(0,_.uE)(o);p&&(t.layerId=p.id)}a=function V(e,n){const{layerId:r}=n,t=e.layers?.find(s=>s.id===r)||e.tables?.find(s=>s.id===r);return t&&function H(e,n){const r="layerType"in e&&e.layerType,{type:t}=n;return!("feature"===t&&r&&"ArcGISFeatureLayer"!==e.layerType||"catalog"===t&&!r||"oriented-imagery"===t&&!r||"subtype-group"===t&&!r)}(t,n)?t:null}(o,t),"OrientedImageryLayer"===a?.layerType&&"oriented-imagery"===t.type&&t.supportedSourceTypes.add("Feature Layer"),a&&null!=o.showLegend&&(a.showLegend=o.showLegend)}return u>1&&"sublayerTitleMode"in t&&"service-name"!==t.sublayerTitleMode&&(t.sublayerTitleMode="item-title-and-service-name"),a}return o}),R.apply(this,arguments)}function j(){return(j=(0,c.Z)(function*(e,n,r){if(n?.layers&&n?.tables)return(0,_.Q4)(n);const t=(0,P.Qc)(e.url);if(!t)return 1;const s=yield r.fetchServiceMetadata(t.url.path,{customParameters:(0,_.uE)(n)?.customParameters}).catch(()=>null);return(n?.layers?.length??s?.layers?.length??0)+(n?.tables?.length??s?.tables?.length??0)})).apply(this,arguments)}function S(){return(S=(0,c.Z)(function*(e,n){const{layersJSON:r}=yield(0,I.V)(e,n);if(!r)return null;const t=[...r.layers,...r.tables];return s=>t.find(o=>o.id===s.id)})).apply(this,arguments)}function b(){return(b=(0,c.Z)(function*(e,n){const{layers:r}=e;if(!r?.length)return;const t=new Set,s=[];for(const{layerType:u}of r){const l=u??"ArcGISFeatureLayer";if(t.has(l))continue;t.add(l);const p=n[(0,_.qT)(l)];s.push(p())}const o=yield Promise.all(s),a=new Map;return Array.from(t).forEach((u,l)=>{a.set(u,o[l])}),({layerType:u})=>a.get(u??"ArcGISFeatureLayer")})).apply(this,arguments)}},39262:(K,E,i)=>{i.d(E,{y:()=>g});var c=i(15861),h=i(37636),P=i(79412),I=i(23206);function g(d,f,m){return y.apply(this,arguments)}function y(){return(y=(0,c.Z)(function*(d,f,m){const _=d&&d.getAtOrigin&&d.getAtOrigin("renderer",f.origin);if(_&&"unique-value"===_.type&&_.styleOrigin){const M=yield(0,h.q6)(_.populateFromStyle());if((0,P.k_)(m),!1===M.ok){const D=M.error;f?.messages&&f.messages.push(new I.Z("renderer:style-reference",`Failed to create unique value renderer from style reference: ${D.message}`,{error:D,context:f})),d.clear("renderer",f?.origin)}}})).apply(this,arguments)}}}]);