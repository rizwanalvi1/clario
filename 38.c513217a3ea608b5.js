"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[38],{33996:(I,N,p)=>{function _(b,u){const g=b.count;u||(u=new b.TypedArrayConstructor(g));for(let h=0;h<g;h++)u[h]=b.get(h);return u}p.d(N,{m:()=>_}),Object.freeze(Object.defineProperty({__proto__:null,makeDense:_},Symbol.toStringTag,{value:"Module"}))},46033:(I,N,p)=>{p.d(N,{a:()=>O,f:()=>u,n:()=>b});var _=p(40271);function O(h,a){b(h.typedBuffer,a.typedBuffer,h.typedBufferStride,a.typedBufferStride)}function b(h,a,d=2,x=d){const r=a.length/2;let i=0,f=0;if((0,_.kJ)(a)||(0,_.Q7)(a)){for(let T=0;T<r;++T)h[i]=a[f],h[i+1]=a[f+1],i+=d,f+=x;return}const m=(0,_.Op)(a);if((0,_.B3)(a))for(let T=0;T<r;++T)h[i]=Math.max(a[f]/m,-1),h[i+1]=Math.max(a[f+1]/m,-1),i+=d,f+=x;else for(let T=0;T<r;++T)h[i]=a[f]/m,h[i+1]=a[f+1]/m,i+=d,f+=x}function u(h,a,d,x){const r=h.typedBuffer,i=h.typedBufferStride,f=x?.count??h.count;let m=(x?.dstIndex??0)*i;for(let T=0;T<f;++T)r[m]=a,r[m+1]=d,m+=i}Object.freeze(Object.defineProperty({__proto__:null,fill:u,normalizeIntegerBuffer:b,normalizeIntegerBufferView:O},Symbol.toStringTag,{value:"Module"}))},52875:(I,N,p)=>{function _(g,h){O(g.typedBuffer,h.typedBuffer,g.typedBufferStride,h.typedBufferStride)}function O(g,h,a=3,d=a){const x=h.length/d;let r=0,i=0;for(let f=0;f<x;++f)g[r]=h[i],g[r+1]=h[i+1],g[r+2]=h[i+2],r+=a,i+=d}function b(g,h,a,d,x){const r=g.typedBuffer,i=g.typedBufferStride,f=x?.count??g.count;let m=(x?.dstIndex??0)*i;for(let T=0;T<f;++T)r[m]=h,r[m+1]=a,r[m+2]=d,m+=i}p.d(N,{a:()=>_,c:()=>O,f:()=>b}),Object.freeze(Object.defineProperty({__proto__:null,copy:O,copyView:_,fill:b},Symbol.toStringTag,{value:"Module"}))},17765:(I,N,p)=>{function _(g,h){O(g.typedBuffer,h,g.typedBufferStride)}function O(g,h,a=4){const d=h.typedBuffer,x=h.typedBufferStride,r=h.count;let i=0,f=0;for(let m=0;m<r;++m)g[i]=d[f],g[i+1]=d[f+1],g[i+2]=d[f+2],g[i+3]=d[f+3],i+=a,f+=x}function b(g,h,a,d,x,r){const i=g.typedBuffer,f=g.typedBufferStride,m=r?.count??g.count;let T=(r?.dstIndex??0)*f;for(let w=0;w<m;++w)i[T]=h,i[T+1]=a,i[T+2]=d,i[T+3]=x,T+=f}p.d(N,{a:()=>_,c:()=>O,f:()=>b}),Object.freeze(Object.defineProperty({__proto__:null,copy:O,copyView:_,fill:b},Symbol.toStringTag,{value:"Module"}))},19840:(I,N,p)=>{function _(g){switch(g){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8}}p.d(N,{n1:()=>_})},73848:(I,N,p)=>{p.d(N,{C:()=>a});var _=p(15861),O=p(66476),b=p(37636),u=p(57964),g=p(79412),h=p(6785);class a{constructor(r){this._streamDataRequester=r}loadJSON(r,i){var f=this;return(0,_.Z)(function*(){return f._load("json",r,i)})()}loadBinary(r,i){var f=this;return(0,_.Z)(function*(){return(0,h.HK)(r)?((0,g.k_)(i),(0,h.AH)(r)):f._load("binary",r,i)})()}loadImage(r,i){var f=this;return(0,_.Z)(function*(){return f._load("image",r,i)})()}_load(r,i,f){var m=this;return(0,_.Z)(function*(){if(null==m._streamDataRequester)return(yield(0,O.Z)(i,{responseType:d[r]})).data;const T=yield(0,b.q6)(m._streamDataRequester.request(i,r,f));if(!0===T.ok)return T.value;throw(0,g.r9)(T.error),new u.Z("",`Request for resource failed: ${T.error}`)})()}}const d={image:"image",binary:"array-buffer",json:"json","image+type":void 0}},22646:(I,N,p)=>{p.d(N,{p:()=>u});var _=p(40271),O=p(58248),b=p(39237);function u(d,x){switch(x){case b.MX.TRIANGLES:return function g(d){return"number"==typeof d?(0,O.KF)(d):(0,_.lq)(d)?new Uint16Array(d):d}(d);case b.MX.TRIANGLE_STRIP:return function h(d){const x="number"==typeof d?d:d.length;if(x<3)return[];const r=x-2,i=(0,O.$z)(3*r);if("number"==typeof d){let f=0;for(let m=0;m<r;m+=1)m%2==0?(i[f++]=m,i[f++]=m+1,i[f++]=m+2):(i[f++]=m+1,i[f++]=m,i[f++]=m+2)}else{let f=0;for(let m=0;m<r;m+=1)m%2==0?(i[f++]=d[m],i[f++]=d[m+1],i[f++]=d[m+2]):(i[f++]=d[m+1],i[f++]=d[m],i[f++]=d[m+2])}return i}(d);case b.MX.TRIANGLE_FAN:return function a(d){const x="number"==typeof d?d:d.length;if(x<3)return new Uint16Array(0);const r=x-2,i=r<=65536?new Uint16Array(3*r):new Uint32Array(3*r);if("number"==typeof d){let w=0;for(let M=0;M<r;++M)i[w++]=0,i[w++]=M+1,i[w++]=M+2;return i}const f=d[0];let m=d[1],T=0;for(let w=0;w<r;++w){const M=d[w+2];i[T++]=f,i[T++]=m,i[T++]=M,m=M}return i}(d)}}},65749:(I,N,p)=>{p.d(N,{$A:()=>g,Ml:()=>d,NM:()=>u,i$:()=>h});var _=p(15861),O=p(14007),b=p(15182);class u{constructor(i){this.data=i,this.type="encoded-mesh-texture",this.encoding=b.Ti.KTX2_ENCODING}}function g(r){return"encoded-mesh-texture"===r?.type}function h(r){return a.apply(this,arguments)}function a(){return(a=(0,_.Z)(function*(r){const i=new Blob([r]),f=yield i.text();return JSON.parse(f)})).apply(this,arguments)}function d(r,i){return x.apply(this,arguments)}function x(){return(x=(0,_.Z)(function*(r,i){if(i===b.Ti.KTX2_ENCODING)return new u(r);const f=new Blob([r],{type:i}),m=URL.createObjectURL(f),T=new Image;if((0,O.Z)("esri-iPhone"))return new Promise((w,M)=>{const K=()=>{D(),w(T)},F=Z=>{D(),M(Z)},D=()=>{URL.revokeObjectURL(m),T.removeEventListener("load",K),T.removeEventListener("error",F)};T.addEventListener("load",K),T.addEventListener("error",F),T.src=m});try{T.src=m,yield T.decode()}catch{console.warn("Failed decoding HTMLImageElement")}return URL.revokeObjectURL(m),T})).apply(this,arguments)}},71807:(I,N,p)=>{p.d(N,{Q:()=>Te});var D,Z,o,_=p(15861),O=p(4703),b=p(41666),u=p(39237),a=p(57964),d=p(8611),x=p(79412),r=p(6785),i=p(93960),f=p(39061),m=p(36510),T=p(686),w=p(11716),M=p(33996);p(14007);class F{constructor(t){this._data=t,this._offset4=0,this._dataUint32=new Uint32Array(this._data,0,Math.floor(this._data.byteLength/4))}readUint32(){const t=this._offset4;return this._offset4+=1,this._dataUint32[t]}readUint8Array(t){const n=4*this._offset4;return this._offset4+=t/4,new Uint8Array(this._data,n,t)}remainingBytes(){return this._data.byteLength-4*this._offset4}}(o=D||(D={})).SCALAR="SCALAR",o.VEC2="VEC2",o.VEC3="VEC3",o.VEC4="VEC4",o.MAT2="MAT2",o.MAT3="MAT3",o.MAT4="MAT4",function(o){o[o.ARRAY_BUFFER=34962]="ARRAY_BUFFER",o[o.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"}(Z||(Z={}));var ne=p(480);const z={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1},oe={pbrMetallicRoughness:z,emissiveFactor:[0,0,0],alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1},se={ESRI_externalColorMixMode:"tint",ESRI_receiveShadows:!0,ESRI_receiveAmbientOcclusion:!0},$=(o={})=>{const t={...z,...o.pbrMetallicRoughness},n=function ae(o){switch(o.ESRI_externalColorMixMode){case"multiply":case"tint":case"ignore":case"replace":break;default:(0,ne.Bg)(o.ESRI_externalColorMixMode),o.ESRI_externalColorMixMode="tint"}return o}({...se,...o.extras});return{...oe,...o,pbrMetallicRoughness:t,extras:n}},ie={magFilter:u.cw.LINEAR,minFilter:u.cw.LINEAR_MIPMAP_LINEAR,wrapS:u.e8.REPEAT,wrapT:u.e8.REPEAT};var G=p(65749);class L{constructor(t,n,s,e){if(this._context=t,this.uri=n,this.json=s,this._glbBuffer=e,this._bufferLoaders=new Map,this._textureLoaders=new Map,this._textureCache=new Map,this._materialCache=new Map,this._nodeParentMap=new Map,this._nodeTransformCache=new Map,this._supportedExtensions=["KHR_texture_basisu","KHR_texture_transform"],this._baseUri=function le(o){let t,n;return o.replace(/^(.*\/)?([^/]*)$/,(s,e,l)=>(t=e||"",n=l||"","")),{dirPart:t,filePart:n}}(this.uri).dirPart,this._checkVersionSupported(),this._checkRequiredExtensionsSupported(),null==s.scenes)throw new a.Z("gltf-loader-unsupported-feature","Scenes must be defined.");if(null==s.meshes)throw new a.Z("gltf-loader-unsupported-feature","Meshes must be defined");if(null==s.nodes)throw new a.Z("gltf-loader-unsupported-feature","Nodes must be defined.");this._computeNodeParents()}static load(t,n,s){var e=this;return(0,_.Z)(function*(){if((0,r.HK)(n)){const y=(0,r.sJ)(n);if(y&&"model/gltf-binary"!==y.mediaType)try{const S=JSON.parse(y.isBase64?atob(y.data):y.data);return new L(t,n,S)}catch{}const v=(0,r.AH)(n);if(L._isGLBData(v))return e._fromGLBData(t,n,v)}if(me.test(n)||"gltf"===s?.expectedType){const y=yield t.loadJSON(n,s);return new L(t,n,y)}const l=yield t.loadBinary(n,s);if(L._isGLBData(l))return e._fromGLBData(t,n,l);if(he.test(n)||"glb"===s?.expectedType)throw new a.Z("gltf-loader-invalid-glb","This is not a valid glb file.");const c=yield t.loadJSON(n,s);return new L(t,n,c)})()}static _isGLBData(t){if(null==t)return!1;const n=new F(t);return n.remainingBytes()>=4&&1179937895===n.readUint32()}static _fromGLBData(t,n,s){return(0,_.Z)(function*(){const e=yield L._parseGLBData(s);return new L(t,n,e.json,e.binaryData)})()}static _parseGLBData(t){return(0,_.Z)(function*(){const n=new F(t);if(n.remainingBytes()<12)throw new a.Z("gltf-loader-error","glb binary data is insufficiently large.");const s=n.readUint32(),e=n.readUint32(),l=n.readUint32();if(1179937895!==s)throw new a.Z("gltf-loader-error","Magic first 4 bytes do not fit to expected glb value.");if(t.byteLength<l)throw new a.Z("gltf-loader-error","glb binary data is smaller than header specifies.");if(2!==e)throw new a.Z("gltf-loader-unsupported-feature","An unsupported glb container version was detected. Only version 2 is supported.");let c,y,v=0;for(;n.remainingBytes()>=8;){const S=n.readUint32(),R=n.readUint32();if(0===v){if(1313821514!==R)throw new a.Z("gltf-loader-error","First glb chunk must be JSON.");if(S<0)throw new a.Z("gltf-loader-error","No JSON data found.");c=yield(0,G.i$)(n.readUint8Array(S))}else if(1===v){if(5130562!==R)throw new a.Z("gltf-loader-unsupported-feature","Second glb chunk expected to be BIN.");y=n.readUint8Array(S)}else O.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] More than 2 glb chunks detected. Skipping.");v+=1}if(!c)throw new a.Z("gltf-loader-error","No glb JSON chunk detected.");return{json:c,binaryData:y}})()}getBuffer(t,n){var s=this;return(0,_.Z)(function*(){const e=s.json.buffers[t];if(null==e.uri){if(null==s._glbBuffer)throw new a.Z("gltf-loader-error","glb buffer not present");return s._glbBuffer}const l=yield s._getBufferLoader(t,n);if(l.byteLength!==e.byteLength)throw new a.Z("gltf-loader-error","Buffer byte lengths should match.");return l})()}_getBufferLoader(t,n){var s=this;return(0,_.Z)(function*(){const e=s._bufferLoaders.get(t);if(e)return e;const c=s._context.loadBinary(s._resolveUri(s.json.buffers[t].uri),n).then(y=>new Uint8Array(y));return s._bufferLoaders.set(t,c),c})()}getAccessor(t,n){var s=this;return(0,_.Z)(function*(){if(!s.json.accessors)throw new a.Z("gltf-loader-unsupported-feature","Accessors missing.");const e=s.json.accessors[t];if(null==e?.bufferView)throw new a.Z("gltf-loader-unsupported-feature","Some accessor does not specify a bufferView.");if(e.type in[D.MAT2,D.MAT3,D.MAT4])throw new a.Z("gltf-loader-unsupported-feature",`AttributeType ${e.type} is not supported`);const l=s.json.bufferViews[e.bufferView],c=yield s.getBuffer(l.buffer,n),y=de[e.type],v=_e[e.componentType],S=y*v,R=l.byteStride||S;return{raw:c.buffer,byteStride:R,byteOffset:c.byteOffset+(l.byteOffset||0)+(e.byteOffset||0),entryCount:e.count,isDenselyPacked:R===S,componentCount:y,componentByteSize:v,componentType:e.componentType,min:e.min,max:e.max,normalized:!!e.normalized}})()}getIndexData(t,n){var s=this;return(0,_.Z)(function*(){if(null==t.indices)return;const e=yield s.getAccessor(t.indices,n);if(e.isDenselyPacked)switch(e.componentType){case u.g.UNSIGNED_BYTE:return new Uint8Array(e.raw,e.byteOffset,e.entryCount);case u.g.UNSIGNED_SHORT:return new Uint16Array(e.raw,e.byteOffset,e.entryCount);case u.g.UNSIGNED_INT:return new Uint32Array(e.raw,e.byteOffset,e.entryCount)}else switch(e.componentType){case u.g.UNSIGNED_BYTE:return(0,M.m)(C(w.D_,e));case u.g.UNSIGNED_SHORT:return(0,M.m)(C(w.av,e));case u.g.UNSIGNED_INT:return(0,M.m)(C(w.Nu,e))}})()}getPositionData(t,n){var s=this;return(0,_.Z)(function*(){if(null==t.attributes.POSITION)throw new a.Z("gltf-loader-unsupported-feature","No POSITION vertex data found.");const e=yield s.getAccessor(t.attributes.POSITION,n);if(e.componentType!==u.g.FLOAT)throw new a.Z("gltf-loader-unsupported-feature","Expected type FLOAT for POSITION vertex attribute, but found "+u.g[e.componentType]);if(3!==e.componentCount)throw new a.Z("gltf-loader-unsupported-feature","POSITION vertex attribute must have 3 components, but found "+e.componentCount.toFixed());return C(w.ct,e)})()}getNormalData(t,n){var s=this;return(0,_.Z)(function*(){if(null==t.attributes.NORMAL)throw new a.Z("gltf-loader-error","No NORMAL vertex data found.");const e=yield s.getAccessor(t.attributes.NORMAL,n);if(e.componentType!==u.g.FLOAT)throw new a.Z("gltf-loader-unsupported-feature","Expected type FLOAT for NORMAL vertex attribute, but found "+u.g[e.componentType]);if(3!==e.componentCount)throw new a.Z("gltf-loader-unsupported-feature","NORMAL vertex attribute must have 3 components, but found "+e.componentCount.toFixed());return C(w.ct,e)})()}getTangentData(t,n){var s=this;return(0,_.Z)(function*(){if(null==t.attributes.TANGENT)throw new a.Z("gltf-loader-error","No TANGENT vertex data found.");const e=yield s.getAccessor(t.attributes.TANGENT,n);if(e.componentType!==u.g.FLOAT)throw new a.Z("gltf-loader-unsupported-feature","Expected type FLOAT for TANGENT vertex attribute, but found "+u.g[e.componentType]);if(4!==e.componentCount)throw new a.Z("gltf-loader-unsupported-feature","TANGENT vertex attribute must have 4 components, but found "+e.componentCount.toFixed());return new w.ek(e.raw,e.byteOffset,e.byteStride,e.byteOffset+e.byteStride*e.entryCount)})()}getTextureCoordinates(t,n){var s=this;return(0,_.Z)(function*(){if(null==t.attributes.TEXCOORD_0)throw new a.Z("gltf-loader-error","No TEXCOORD_0 vertex data found.");const e=yield s.getAccessor(t.attributes.TEXCOORD_0,n);if(2!==e.componentCount)throw new a.Z("gltf-loader-unsupported-feature","TEXCOORD_0 vertex attribute must have 2 components, but found "+e.componentCount.toFixed());if(e.componentType===u.g.FLOAT)return C(w.Eu,e);if(!e.normalized)throw new a.Z("gltf-loader-unsupported-feature","Integer component types are only supported for a normalized accessor for TEXCOORD_0.");return function pe(o){switch(o.componentType){case u.g.BYTE:return new w.Vs(o.raw,o.byteOffset,o.byteStride,o.byteOffset+o.byteStride*o.entryCount);case u.g.UNSIGNED_BYTE:return new w.xA(o.raw,o.byteOffset,o.byteStride,o.byteOffset+o.byteStride*o.entryCount);case u.g.SHORT:return new w.or(o.raw,o.byteOffset,o.byteStride,o.byteOffset+o.byteStride*o.entryCount);case u.g.UNSIGNED_SHORT:return new w.TS(o.raw,o.byteOffset,o.byteStride,o.byteOffset+o.byteStride*o.entryCount);case u.g.UNSIGNED_INT:return new w.qt(o.raw,o.byteOffset,o.byteStride,o.byteOffset+o.byteStride*o.entryCount);case u.g.FLOAT:return new w.Eu(o.raw,o.byteOffset,o.byteStride,o.byteOffset+o.byteStride*o.entryCount)}}(e)})()}getVertexColors(t,n){var s=this;return(0,_.Z)(function*(){if(null==t.attributes.COLOR_0)throw new a.Z("gltf-loader-error","No COLOR_0 vertex data found.");const e=yield s.getAccessor(t.attributes.COLOR_0,n);if(4!==e.componentCount&&3!==e.componentCount)throw new a.Z("gltf-loader-unsupported-feature","COLOR_0 attribute must have 3 or 4 components, but found "+e.componentCount.toFixed());if(4===e.componentCount){if(e.componentType===u.g.FLOAT)return C(w.ek,e);if(e.componentType===u.g.UNSIGNED_BYTE)return C(w.mc,e);if(e.componentType===u.g.UNSIGNED_SHORT)return C(w.v6,e)}else if(3===e.componentCount){if(e.componentType===u.g.FLOAT)return C(w.ct,e);if(e.componentType===u.g.UNSIGNED_BYTE)return C(w.ne,e);if(e.componentType===u.g.UNSIGNED_SHORT)return C(w.mw,e)}throw new a.Z("gltf-loader-unsupported-feature","Unsupported component type for COLOR_0 attribute: "+u.g[e.componentType])})()}hasPositions(t){return void 0!==t.attributes.POSITION}hasNormals(t){return void 0!==t.attributes.NORMAL}hasVertexColors(t){return void 0!==t.attributes.COLOR_0}hasTextureCoordinates(t){return void 0!==t.attributes.TEXCOORD_0}hasTangents(t){return void 0!==t.attributes.TANGENT}getMaterial(t,n,s){var e=this;return(0,_.Z)(function*(){let l=t.material?e._materialCache.get(t.material):void 0;if(!l){const c=null!=t.material?$(e.json.materials[t.material]):$(),y=c.pbrMetallicRoughness,v=e.hasVertexColors(t),S=e.getTexture(y.baseColorTexture,n),R=e.getTexture(c.normalTexture,n),A=s?e.getTexture(c.occlusionTexture,n):void 0,E=s?e.getTexture(c.emissiveTexture,n):void 0,B=s?e.getTexture(y.metallicRoughnessTexture,n):void 0,U=null!=t.material?t.material:-1;l={alphaMode:c.alphaMode,alphaCutoff:c.alphaCutoff,color:y.baseColorFactor,doubleSided:!!c.doubleSided,colorTexture:yield S,normalTexture:yield R,name:c.name,id:U,occlusionTexture:yield A,emissiveTexture:yield E,emissiveFactor:c.emissiveFactor,metallicFactor:y.metallicFactor,roughnessFactor:y.roughnessFactor,metallicRoughnessTexture:yield B,hasVertexColors:v,ESRI_externalColorMixMode:c.extras.ESRI_externalColorMixMode,colorTextureTransform:y?.baseColorTexture?.extensions?.KHR_texture_transform,normalTextureTransform:c.normalTexture?.extensions?.KHR_texture_transform,occlusionTextureTransform:c.occlusionTexture?.extensions?.KHR_texture_transform,emissiveTextureTransform:c.emissiveTexture?.extensions?.KHR_texture_transform,metallicRoughnessTextureTransform:y?.metallicRoughnessTexture?.extensions?.KHR_texture_transform,receiveAmbientOcclusion:c.extras.ESRI_receiveAmbientOcclusion,receiveShadows:c.extras.ESRI_receiveShadows}}return l})()}getTexture(t,n){var s=this;return(0,_.Z)(function*(){if(!t)return;if(0!==(t.texCoord||0))throw new a.Z("gltf-loader-unsupported-feature","Only TEXCOORD with index 0 is supported.");const e=t.index,l=s.json.textures[e],c=(o=>({...ie,...o}))(null!=l.sampler?s.json.samplers[l.sampler]:{}),y=J(l),v=s.json.images[y],S=yield s._loadTextureImageData(e,l,n);return(0,d.s1)(s._textureCache,e,()=>{const R=E=>33071===E||33648===E||10497===E,A=E=>{throw new a.Z("gltf-loader-error",`Unexpected TextureSampler WrapMode: ${E}`)};return{data:S,wrapS:R(c.wrapS)?c.wrapS:A(c.wrapS),wrapT:R(c.wrapT)?c.wrapT:A(c.wrapT),minFilter:c.minFilter,name:v.name,id:e}})})()}getNodeTransform(t){if(void 0===t)return ce;let n=this._nodeTransformCache.get(t);if(!n){const s=this.getNodeTransform(this._getNodeParent(t)),e=this.json.nodes[t];e.matrix?n=(0,f.Jp)((0,b.Ue)(),s,e.matrix):e.translation||e.rotation||e.scale?(n=(0,b.d9)(s),e.translation&&(0,f.Iu)(n,n,e.translation),e.rotation&&(k[3]=(0,m.Bh)(k,e.rotation),(0,f.U1)(n,n,k[3],k)),e.scale&&(0,f.bA)(n,n,e.scale)):n=(0,b.d9)(s),this._nodeTransformCache.set(t,n)}return n}_resolveUri(t){return(0,r.hF)(t,this._baseUri)}_getNodeParent(t){return this._nodeParentMap.get(t)}_checkVersionSupported(){const t=i.G.parse(this.json.asset.version,"glTF");fe.validate(t)}_checkRequiredExtensionsSupported(){const t=this.json;if(t.extensionsRequired&&!t.extensionsRequired.every(n=>this._supportedExtensions.includes(n)))throw new a.Z("gltf-loader-unsupported-feature","gltf loader was not able to load unsupported feature. Required extensions: "+t.extensionsRequired.join(", "))}_computeNodeParents(){this.json.nodes.forEach((t,n)=>{t.children&&t.children.forEach(s=>{this._nodeParentMap.set(s,n)})})}_loadTextureImageData(t,n,s){var e=this;return(0,_.Z)(function*(){const l=e._textureLoaders.get(t);if(l)return l;const c=e._createTextureLoader(n,s);return e._textureLoaders.set(t,c),c})()}_createTextureLoader(t,n){var s=this;return(0,_.Z)(function*(){const e=J(t),l=s.json.images[e];if(l.uri){if(l.uri.endsWith(".ktx2")){const S=yield s._context.loadBinary(s._resolveUri(l.uri),n);return new G.NM(new Uint8Array(S))}return s._context.loadImage(s._resolveUri(l.uri),n)}if(null==l.bufferView)throw new a.Z("gltf-loader-unsupported-feature","Image bufferView must be defined.");if(null==l.mimeType)throw new a.Z("gltf-loader-unsupported-feature","Image mimeType must be defined.");const c=s.json.bufferViews[l.bufferView],y=yield s.getBuffer(c.buffer,n);if(null!=c.byteStride)throw new a.Z("gltf-loader-unsupported-feature","byteStride not supported for image buffer");return(0,G.Ml)(new Uint8Array(y.buffer,y.byteOffset+(c.byteOffset||0),c.byteLength),l.mimeType)})()}getLoadedBuffersSize(){var t=this;return(0,_.Z)(function*(){if(t._glbBuffer)return t._glbBuffer.byteLength;const n=yield(0,x.OT)(Array.from(t._bufferLoaders.values())),s=yield(0,x.OT)(Array.from(t._textureLoaders.values()));return n.reduce((e,l)=>e+(l?.byteLength??0),0)+s.reduce((e,l)=>e+(l?(0,G.$A)(l)?l.data.byteLength:l.width*l.height*4:0),0)})()}}const ce=(0,f.aC)((0,b.Ue)(),Math.PI/2),fe=new i.G(2,0,"glTF"),k=(0,T.Ue)(),de={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_e={[u.g.BYTE]:1,[u.g.UNSIGNED_BYTE]:1,[u.g.SHORT]:2,[u.g.UNSIGNED_SHORT]:2,[u.g.HALF_FLOAT]:2,[u.g.FLOAT]:4,[u.g.INT]:4,[u.g.UNSIGNED_INT]:4};function C(o,t){return new o(t.raw,t.byteOffset,t.byteStride,t.byteOffset+t.byteStride*(t.entryCount-1)+t.componentByteSize*t.componentCount)}function J(o){if(null!=o.extensions?.KHR_texture_basisu)return o.extensions.KHR_texture_basisu.source;if(null!==o.source)return o.source;throw new a.Z("gltf-loader-unsupported-feature","Source is expected to be defined for a texture. It can also be omitted in favour of an KHR_texture_basisu extension tag.")}const me=/\.gltf$/i,he=/\.glb$/i;let ge=0;function Te(o,t){return V.apply(this,arguments)}function V(){return V=(0,_.Z)(function*(o,t,n={},s=!0){const e=yield L.load(o,t,n),l="gltf_"+ge++,c={lods:[],materials:new Map,textures:new Map,meta:ye(e)},y=!(!e.json.asset.extras||"symbolResource"!==e.json.asset.extras.ESRI_type),v=e.json.asset.extras?.ESRI_webstyleSymbol?.webstyle,S=new Map;yield function xe(o,t){return H.apply(this,arguments)}(e,function(){var A=(0,_.Z)(function*(E,B,U,X){const W=S.get(U)??0;S.set(U,W+1);const P=void 0!==E.mode?E.mode:u.MX.TRIANGLES,Y=P===u.MX.TRIANGLES||P===u.MX.TRIANGLE_STRIP||P===u.MX.TRIANGLE_FAN?P:null;if(null==Y)return void O.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] Unsupported primitive mode ("+u.MX[P]+"). Skipping primitive.");if(!e.hasPositions(E))return void O.Z.getLogger("esri.views.3d.glTF").warn("Skipping primitive without POSITION vertex attribute.");const Oe=e.getPositionData(E,n),ve=e.getMaterial(E,n,s),Q=e.hasNormals(E)?e.getNormalData(E,n):null,q=e.hasTangents(E)?e.getTangentData(E,n):null,ee=e.hasTextureCoordinates(E)?e.getTextureCoordinates(E,n):null,te=e.hasVertexColors(E)?e.getVertexColors(E,n):null,Se=e.getIndexData(E,n),Ne={name:X,transform:(0,b.d9)(B),attributes:{position:yield Oe,normal:Q?yield Q:null,texCoord0:ee?yield ee:null,color:te?yield te:null,tangent:q?yield q:null},indices:yield Se,primitiveType:Y,material:we(c,yield ve,l)};let re=null;null!=c.meta?.ESRI_lod&&"screenSpaceRadius"===c.meta.ESRI_lod.metric&&(re=c.meta.ESRI_lod.thresholds[U]),c.lods[U]=c.lods[U]||{parts:[],name:X,lodThreshold:re},c.lods[U].parts[W]=Ne});return function(E,B,U,X){return A.apply(this,arguments)}}());for(const A of c.lods)A.parts=A.parts.filter(E=>!!E);const R=yield e.getLoadedBuffersSize();return{model:c,meta:{isEsriSymbolResource:y,uri:e.uri,ESRI_webstyle:v},customMeta:{},size:R}}),V.apply(this,arguments)}function ye(o){let n=null;return o.json.nodes.forEach(s=>{const e=s.extras;null!=e&&(e.ESRI_proxyEllipsoid||e.ESRI_lod)&&(n=e)}),n}function H(){return H=(0,_.Z)(function*(o,t){const n=o.json,s=n.scenes[n.scene||0].nodes,e=s.length>1,l=[];for(const v of s){const S=n.nodes[v];l.push(c(v,0)),be(S)&&!e&&S.extensions.MSFT_lod.ids.forEach((R,A)=>c(R,A+1))}function c(v,S){return y.apply(this,arguments)}function y(){return(y=(0,_.Z)(function*(v,S){const R=n.nodes[v],A=o.getNodeTransform(v);if(null!=R.weights&&O.Z.getLogger("esri.views.3d.glTF").warn("[Unsupported Feature] Morph targets are not supported."),null!=R.mesh){const E=n.meshes[R.mesh];for(const B of E.primitives)l.push(t(B,A,S,E.name))}for(const E of R.children||[])l.push(c(E,S))})).apply(this,arguments)}yield Promise.all(l)}),H.apply(this,arguments)}function be(o){return o.extensions?.MSFT_lod&&Array.isArray(o.extensions.MSFT_lod.ids)}function we(o,t,n){const s=l=>{const c=`${n}_tex_${l&&l.id}${l?.name?"_"+l.name:""}`;if(l&&!o.textures.has(c)){const y=function h(o,t={}){return{data:o,parameters:{wrap:{s:u.e8.REPEAT,t:u.e8.REPEAT,...t.wrap},noUnpackFlip:!0,mipmap:!1,...t}}}(l.data,{wrap:{s:l.wrapS,t:l.wrapT},mipmap:Ee.has(l.minFilter),noUnpackFlip:!0});o.textures.set(c,y)}return c},e=`${n}_mat_${t.id}_${t.name}`;if(!o.materials.has(e)){const l=function g(o={}){return{color:[1,1,1],opacity:1,alphaMode:"OPAQUE",alphaCutoff:.5,doubleSided:!1,castShadows:!0,receiveShadows:!0,receiveAmbientOcclustion:!0,textureColor:null,textureNormal:null,textureOcclusion:null,textureEmissive:null,textureMetallicRoughness:null,colorTextureTransform:null,normalTextureTransform:null,occlusionTextureTransform:null,emissiveTextureTransform:null,metallicRoughnessTextureTransform:null,emissiveFactor:[0,0,0],metallicFactor:1,roughnessFactor:1,colorMixMode:"multiply",...o}}({color:[t.color[0],t.color[1],t.color[2]],opacity:t.color[3],alphaMode:t.alphaMode,alphaCutoff:t.alphaCutoff,doubleSided:t.doubleSided,colorMixMode:t.ESRI_externalColorMixMode,textureColor:t.colorTexture?s(t.colorTexture):void 0,textureNormal:t.normalTexture?s(t.normalTexture):void 0,textureOcclusion:t.occlusionTexture?s(t.occlusionTexture):void 0,textureEmissive:t.emissiveTexture?s(t.emissiveTexture):void 0,textureMetallicRoughness:t.metallicRoughnessTexture?s(t.metallicRoughnessTexture):void 0,emissiveFactor:[t.emissiveFactor[0],t.emissiveFactor[1],t.emissiveFactor[2]],colorTextureTransform:t.colorTextureTransform,normalTextureTransform:t.normalTextureTransform,occlusionTextureTransform:t.occlusionTextureTransform,emissiveTextureTransform:t.emissiveTextureTransform,metallicRoughnessTextureTransform:t.metallicRoughnessTextureTransform,metallicFactor:t.metallicFactor,roughnessFactor:t.roughnessFactor,receiveShadows:t.receiveShadows,receiveAmbientOcclustion:t.receiveAmbientOcclusion});o.materials.set(e,l)}return e}const Ee=new Set([u.cw.LINEAR_MIPMAP_LINEAR,u.cw.LINEAR_MIPMAP_NEAREST])},15182:(I,N,p)=>{var _,O,b,u,g,h,a,d,x,r;p.d(N,{Gv:()=>O,Iq:()=>d,JJ:()=>a,Rw:()=>u,Ti:()=>x,V_:()=>h,Vr:()=>_,Xx:()=>b,hU:()=>g}),(r=_||(_={}))[r.None=0]="None",r[r.Front=1]="Front",r[r.Back=2]="Back",r[r.COUNT=3]="COUNT",function(r){r[r.Less=0]="Less",r[r.Lequal=1]="Lequal",r[r.COUNT=2]="COUNT"}(O||(O={})),function(r){r[r.BACKGROUND=0]="BACKGROUND",r[r.UPDATE=1]="UPDATE"}(b||(b={})),function(r){r[r.NOT_LOADED=0]="NOT_LOADED",r[r.LOADING=1]="LOADING",r[r.LOADED=2]="LOADED"}(u||(u={})),function(r){r[r.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",r[r.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(g||(g={})),function(r){r[r.Highlight=0]="Highlight",r[r.MaskOccludee=1]="MaskOccludee",r[r.COUNT=2]="COUNT"}(h||(h={})),function(r){r[r.Blend=0]="Blend",r[r.Opaque=1]="Opaque",r[r.Mask=2]="Mask",r[r.MaskBlend=3]="MaskBlend",r[r.COUNT=4]="COUNT"}(a||(a={})),function(r){r[r.OFF=0]="OFF",r[r.ON=1]="ON"}(d||(d={})),function(r){r.DDS_ENCODING="image/vnd-ms.dds",r.KTX2_ENCODING="image/ktx2",r.BASIS_ENCODING="image/x.basis"}(x||(x={}))},77891:(I,N,p)=>{p.d(N,{j:()=>_});const _=2.1}}]);