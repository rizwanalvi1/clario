"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[4823],{5710:(V,z,c)=>{c.d(z,{a:()=>a,b:()=>u,c:()=>G,e:()=>n,f:()=>F,g:()=>M,i:()=>w,j:()=>g,l:()=>d,n:()=>X,s:()=>L,t:()=>i});var C=c(89612);function G(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function L(e,t,r,p,E){return e[0]=t,e[1]=r,e[2]=p,e[3]=E,e}function F(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Z(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function Y(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function K(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function u(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function P(e,t){const r=t[0]-e[0],p=t[1]-e[1],E=t[2]-e[2],R=t[3]-e[3];return Math.sqrt(r*r+p*p+E*E+R*R)}function T(e,t){const r=t[0]-e[0],p=t[1]-e[1],E=t[2]-e[2],R=t[3]-e[3];return r*r+p*p+E*E+R*R}function w(e){const t=e[0],r=e[1],p=e[2],E=e[3];return Math.sqrt(t*t+r*r+p*p+E*E)}function g(e){const t=e[0],r=e[1],p=e[2],E=e[3];return t*t+r*r+p*p+E*E}function X(e,t){const r=t[0],p=t[1],E=t[2],R=t[3];let O=r*r+p*p+E*E+R*R;return O>0&&(O=1/Math.sqrt(O),e[0]=r*O,e[1]=p*O,e[2]=E*O,e[3]=R*O),e}function M(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function d(e,t,r,p){const E=t[0],R=t[1],O=t[2],Q=t[3];return e[0]=E+p*(r[0]-E),e[1]=R+p*(r[1]-R),e[2]=O+p*(r[2]-O),e[3]=Q+p*(r[3]-Q),e}function i(e,t,r){const p=t[0],E=t[1],R=t[2],O=t[3];return e[0]=r[0]*p+r[4]*E+r[8]*R+r[12]*O,e[1]=r[1]*p+r[5]*E+r[9]*R+r[13]*O,e[2]=r[2]*p+r[6]*E+r[10]*R+r[14]*O,e[3]=r[3]*p+r[7]*E+r[11]*R+r[15]*O,e}function a(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function n(e,t){const r=e[0],p=e[1],E=e[2],R=e[3],O=t[0],Q=t[1],J=t[2],H=t[3],$=(0,C.bn)();return Math.abs(r-O)<=$*Math.max(1,Math.abs(r),Math.abs(O))&&Math.abs(p-Q)<=$*Math.max(1,Math.abs(p),Math.abs(Q))&&Math.abs(E-J)<=$*Math.max(1,Math.abs(E),Math.abs(J))&&Math.abs(R-H)<=$*Math.max(1,Math.abs(R),Math.abs(H))}Object.freeze(Object.defineProperty({__proto__:null,add:F,ceil:function D(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},copy:G,copyVec3:function b(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},dist:P,distance:P,div:K,divide:K,dot:M,equals:n,exactEquals:a,floor:function f(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},inverse:function S(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},len:w,length:w,lerp:d,max:function A(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},min:function I(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},mul:Y,multiply:Y,negate:function B(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},normalize:X,random:function h(e,t){const r=C.FD;let p,E,R,O,Q,J;t=t||1;do{p=2*r()-1,E=2*r()-1,Q=p*p+E*E}while(Q>=1);do{R=2*r()-1,O=2*r()-1,J=R*R+O*O}while(J>=1);const H=Math.sqrt((1-Q)/J);return e[0]=t*p,e[1]=t*E,e[2]=t*R*H,e[3]=t*O*H,e},round:function W(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},scale:u,scaleAndAdd:function m(e,t,r,p){return e[0]=t[0]+r[0]*p,e[1]=t[1]+r[1]*p,e[2]=t[2]+r[2]*p,e[3]=t[3]+r[3]*p,e},set:L,sqrDist:T,sqrLen:g,squaredDistance:T,squaredLength:g,str:function N(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},sub:Z,subtract:Z,transformMat4:i,transformQuat:function j(e,t,r){const p=t[0],E=t[1],R=t[2],O=r[0],Q=r[1],J=r[2],H=r[3],$=H*p+Q*R-J*E,q=H*E+J*p-O*R,k=H*R+O*E-Q*p,ee=-O*p-Q*E-J*R;return e[0]=$*H+ee*-O+q*-J-k*-Q,e[1]=q*H+ee*-Q+k*-O-$*-J,e[2]=k*H+ee*-J+$*-Q-q*-O,e[3]=t[3],e}},Symbol.toStringTag,{value:"Module"}))},23515:(V,z,c)=>{function C(){return[0,0,0,0]}function b(g,B,S,X){return[g,B,S,X]}function Y(){return b(1,1,1,1)}function K(){return b(1,0,0,0)}function D(){return b(0,1,0,0)}function f(){return b(0,0,1,0)}function I(){return b(0,0,0,1)}c.d(z,{Ue:()=>C,al:()=>b});const W=Y(),u=K(),m=D(),P=f(),T=I();Object.freeze(Object.defineProperty({__proto__:null,ONES:W,UNIT_W:T,UNIT_X:u,UNIT_Y:m,UNIT_Z:P,ZEROS:[0,0,0,0],clone:function G(g){return[g[0],g[1],g[2],g[3]]},create:C,createView:function F(g,B){return new Float64Array(g,B,4)},fromArray:function L(g,B=[0,0,0,0]){const S=Math.min(4,g.length);for(let X=0;X<S;++X)B[X]=g[X];return B},fromValues:b,ones:Y,unitW:I,unitX:K,unitY:D,unitZ:f,zeros:function Z(){return[0,0,0,0]}},Symbol.toStringTag,{value:"Module"}))},26540:(V,z,c)=>{c.d(z,{Q:()=>F});var C=c(57678),b=(c(14007),c(43029)),L=c(4758);class F{constructor(n=9,s){this._compareMinX=A,this._compareMinY=W,this._toBBox=o=>o,this._maxEntries=Math.max(4,n||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),s&&("function"==typeof s?this._toBBox=s:this._initFormat(s)),this.clear()}destroy(){this.clear(),S.prune(),X.prune(),M.prune(),d.prune()}all(n){Y(this._data,n)}search(n,s){let o=this._data;const _=this._toBBox;if(g(n,o))for(S.clear();o;){for(let l=0,y=o.children.length;l<y;l++){const x=o.children[l],v=o.leaf?_(x):x;g(n,v)&&(o.leaf?s(x):w(n,v)?Y(x,s):S.push(x))}o=S.pop()}}collides(n){let s=this._data;const o=this._toBBox;if(!g(n,s))return!1;for(S.clear();s;){for(let _=0,l=s.children.length;_<l;_++){const y=s.children[_],x=s.leaf?o(y):y;if(g(n,x)){if(s.leaf||w(n,x))return!0;S.push(y)}}s=S.pop()}return!1}load(n){if(!n.length)return this;if(n.length<this._minEntries){for(let o=0,_=n.length;o<_;o++)this.insert(n[o]);return this}let s=this._build(n.slice(0,n.length),0,n.length-1,0);if(this._data.children.length)if(this._data.height===s.height)this._splitRoot(this._data,s);else{if(this._data.height<s.height){const o=this._data;this._data=s,s=o}this._insert(s,this._data.height-s.height-1,!0)}else this._data=s;return this}insert(n){return n&&this._insert(n,this._data.height-1),this}clear(){return this._data=new j([]),this}remove(n){if(!n)return this;let s,o=this._data,_=null,l=0,y=!1;const x=this._toBBox(n);for(M.clear(),d.clear();o||M.length>0;){if(o||(o=M.pop(),_=M.data[M.length-1],l=d.pop()??0,y=!0),o.leaf&&(s=(0,C.cq)(o.children,n,o.children.length,o.indexHint),-1!==s))return o.children.splice(s,1),M.push(o),this._condense(M),this;y||o.leaf||!w(o,x)?_?(l++,o=_.children[l],y=!1):o=null:(M.push(o),d.push(l),l=0,_=o,o=o.children[0])}return this}toJSON(){return this._data}fromJSON(n){return this._data=n,this}_build(n,s,o,_){const l=o-s+1;let y=this._maxEntries;if(l<=y){const e=new j(n.slice(s,o+1));return D(e,this._toBBox),e}_||(_=Math.ceil(Math.log(l)/Math.log(y)),y=Math.ceil(l/y**(_-1)));const x=new N([]);x.height=_;const v=Math.ceil(l/y),U=v*Math.ceil(Math.sqrt(y));B(n,s,o,U,this._compareMinX);for(let e=s;e<=o;e+=U){const t=Math.min(e+U-1,o);B(n,e,t,v,this._compareMinY);for(let r=e;r<=t;r+=v){const p=Math.min(r+v-1,t);x.children.push(this._build(n,r,p,_-1))}}return D(x,this._toBBox),x}_insert(n,s,o){const l=o?n:(0,this._toBBox)(n);M.clear();const y=function Z(a,n,s,o){for(;o.push(n),!0!==n.leaf&&o.length-1!==s;){let _,l=1/0,y=1/0;for(let x=0,v=n.children.length;x<v;x++){const U=n.children[x],e=u(U),t=P(a,U)-e;t<y?(y=t,l=e<l?e:l,_=U):t===y&&e<l&&(l=e,_=U)}n=_||n.children[0]}return n}(l,this._data,s,M);for(y.children.push(n),I(y,l);s>=0&&M.data[s].children.length>this._maxEntries;)this._split(M,s),s--;!function K(a,n,s){for(let o=s;o>=0;o--)I(n.data[o],a)}(l,M,s)}_split(n,s){const o=n.data[s],_=o.children.length,l=this._minEntries;this._chooseSplitAxis(o,l,_);const y=this._chooseSplitIndex(o,l,_);if(!y)return;const x=o.children.splice(y,o.children.length-y),v=o.leaf?new j(x):new N(x);v.height=o.height,D(o,this._toBBox),D(v,this._toBBox),s?n.data[s-1].children.push(v):this._splitRoot(o,v)}_splitRoot(n,s){this._data=new N([n,s]),this._data.height=n.height+1,D(this._data,this._toBBox)}_chooseSplitIndex(n,s,o){let _,l,y;_=l=1/0;for(let x=s;x<=o-s;x++){const v=f(n,0,x,this._toBBox),U=f(n,x,o,this._toBBox),e=T(v,U),t=u(v)+u(U);e<_?(_=e,y=x,l=t<l?t:l):e===_&&t<l&&(l=t,y=x)}return y}_chooseSplitAxis(n,s,o){const _=n.leaf?this._compareMinX:A,l=n.leaf?this._compareMinY:W;this._allDistMargin(n,s,o,_)<this._allDistMargin(n,s,o,l)&&n.children.sort(_)}_allDistMargin(n,s,o,_){n.children.sort(_);const l=this._toBBox,y=f(n,0,s,l),x=f(n,o-s,o,l);let v=m(y)+m(x);for(let U=s;U<o-s;U++){const e=n.children[U];I(y,n.leaf?l(e):e),v+=m(y)}for(let U=o-s-1;U>=s;U--){const e=n.children[U];I(x,n.leaf?l(e):e),v+=m(x)}return v}_condense(n){for(let s=n.length-1;s>=0;s--){const o=n.data[s];if(0===o.children.length)if(s>0){const _=n.data[s-1],l=_.children;l.splice((0,C.cq)(l,o,l.length,_.indexHint),1)}else this.clear();else D(o,this._toBBox)}}_initFormat(n){const s=["return a"," - b",";"];this._compareMinX=new Function("a","b",s.join(n[0])),this._compareMinY=new Function("a","b",s.join(n[1])),this._toBBox=new Function("a","return {minX: a"+n[0]+", minY: a"+n[1]+", maxX: a"+n[2]+", maxY: a"+n[3]+"};")}}function Y(a,n){let s=a;for(X.clear();s;){if(!0===s.leaf)for(const o of s.children)n(o);else X.pushArray(s.children);s=X.pop()??null}}function D(a,n){f(a,0,a.children.length,n,a)}function f(a,n,s,o,_){_||(_=new j([])),_.minX=1/0,_.minY=1/0,_.maxX=-1/0,_.maxY=-1/0;for(let l,y=n;y<s;y++)l=a.children[y],I(_,a.leaf?o(l):l);return _}function I(a,n){a.minX=Math.min(a.minX,n.minX),a.minY=Math.min(a.minY,n.minY),a.maxX=Math.max(a.maxX,n.maxX),a.maxY=Math.max(a.maxY,n.maxY)}function A(a,n){return a.minX-n.minX}function W(a,n){return a.minY-n.minY}function u(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function m(a){return a.maxX-a.minX+(a.maxY-a.minY)}function P(a,n){return(Math.max(n.maxX,a.maxX)-Math.min(n.minX,a.minX))*(Math.max(n.maxY,a.maxY)-Math.min(n.minY,a.minY))}function T(a,n){const s=Math.max(a.minX,n.minX),o=Math.max(a.minY,n.minY),_=Math.min(a.maxX,n.maxX),l=Math.min(a.maxY,n.maxY);return Math.max(0,_-s)*Math.max(0,l-o)}function w(a,n){return a.minX<=n.minX&&a.minY<=n.minY&&n.maxX<=a.maxX&&n.maxY<=a.maxY}function g(a,n){return n.minX<=a.maxX&&n.minY<=a.maxY&&n.maxX>=a.minX&&n.maxY>=a.minY}function B(a,n,s,o,_){const l=[n,s];for(;l.length;){const y=l.pop(),x=l.pop();if(y-x<=o)continue;const v=x+Math.ceil((y-x)/o/2)*o;(0,L.q)(a,v,x,y,_),l.push(x,v,v,y)}}const S=new b.Z,X=new b.Z,M=new b.Z,d=new b.Z({deallocator:void 0});class h{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class i extends h{constructor(){super(...arguments),this.height=1,this.indexHint=new C.SO}}class j extends i{constructor(n){super(),this.children=n,this.leaf=!0}}class N extends i{constructor(n){super(),this.children=n,this.leaf=!1}}},46872:(V,z,c)=>{c.d(z,{H:()=>K});var C=c(14007),G=c(26540),b=c(45425);const F={minX:0,minY:0,maxX:0,maxY:0};class K{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new G.Q(9,(0,C.Z)("esri-csp-restrictions")?f=>({minX:f[0],minY:f[1],maxX:f[2],maxY:f[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const f=new Array(this._idByBounds.size);let I=0;this._idByBounds.forEach((A,W)=>{f[I++]=W}),this._indexInvalid=!1,this._index.clear(),this._index.load(f)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(f=>this._idByBounds.has(f))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const f=(0,b.cS)();for(const I of this._boundsById.values())I&&(f[0]=Math.min(I[0],f[0]),f[1]=Math.min(I[1],f[1]),f[2]=Math.max(I[2],f[2]),f[3]=Math.max(I[3],f[3]));return f}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(f){const I=this._boundsById.get(f);this._boundsById.delete(f),I&&(this._idByBounds.delete(I),this._indexInvalid||this._index.remove(I))}forEachInBounds(f,I){this._loadIndex(),function Y(D,f,I){(function Z(D){F.minX=D[0],F.minY=D[1],F.maxX=D[2],F.maxY=D[3]})(f),D.search(F,I)}(this._index,f,A=>I(this._idByBounds.get(A)))}get(f){return this._boundsById.get(f)}has(f){return this._boundsById.has(f)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(f,I){if(!this._indexInvalid){const A=this._boundsById.get(f);A&&(this._index.remove(A),this._idByBounds.delete(A))}this._boundsById.set(f,I),I&&(this._idByBounds.set(I,f),this._indexInvalid||(this._boundsToLoad.push(I),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},84726:(V,z,c)=>{c.d(z,{Z:()=>A});var C=c(57678),G=c(57964),b=c(88278),L=c(4703),F=c(27048),Z=c(45425),Y=c(10842),K=c(46872),D=c(29085),f=c(14309);const I=(0,F.Ue)();class A{constructor(u){this.geometryInfo=u,this._boundsStore=new K.H,this._featuresById=new Map,this._markedIds=new Set,this.events=new b.Z,this.featureAdapter=f.n}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let u=0;return this._featuresById.forEach(m=>{null!=m.geometry&&m.geometry.coords&&(u+=m.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:u/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(u){if(null==this.fullBounds)return null;const[m,P,T,w]=this.fullBounds;return{xmin:m,ymin:P,xmax:T,ymax:w,spatialReference:(0,D.S2)(u)}}add(u){this._add(u),this._emitChanged()}addMany(u){for(const m of u)this._add(m);this._emitChanged()}upsertMany(u){const m=u.map(P=>this._upsert(P));return this._emitChanged(),m.filter(C.pC)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(u){const m=this._featuresById.get(u);return m?(this._remove(m),this._emitChanged(),m):null}removeManyById(u){this._boundsStore.invalidateIndex();for(const m of u){const P=this._featuresById.get(m);P&&this._remove(P)}this._emitChanged()}forEachBounds(u,m){for(const P of u){const T=this._boundsStore.get(P.objectId);T&&m((0,F.JR)(I,T))}}getFeature(u){return this._featuresById.get(u)}has(u){return this._featuresById.has(u)}forEach(u){this._featuresById.forEach(m=>u(m))}forEachInBounds(u,m){this._boundsStore.forEachInBounds(u,P=>{m(this._featuresById.get(P))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let u=!1;this._featuresById.forEach((m,P)=>{this._markedIds.has(P)||(u=!0,this._remove(m))}),this._markedIds.clear(),u&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(u){if(!u)return;const m=u.objectId;if(null==m)return void L.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new G.Z("featurestore:invalid-feature","feature id is missing",{feature:u}));const P=this._featuresById.get(m);let T;if(this._markedIds.add(m),P?(u.displayId=P.displayId,T=this._boundsStore.get(m),this._boundsStore.delete(m)):null!=this.onFeatureAdd&&this.onFeatureAdd(u),!u.geometry?.coords?.length)return this._boundsStore.set(m,null),void this._featuresById.set(m,u);T=(0,Y.$)(T??(0,Z.Ue)(),u.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=T&&this._boundsStore.set(m,T),this._featuresById.set(m,u)}_upsert(u){const m=u?.objectId;if(null==m)return L.Z.getLogger("esri.layers.graphics.data.FeatureStore").error(new G.Z("featurestore:invalid-feature","feature id is missing",{feature:u})),null;const P=this._featuresById.get(m);if(!P)return this._add(u),u;this._markedIds.add(m);const{geometry:T,attributes:w}=u;for(const g in w)P.attributes[g]=w[g];return T&&(P.geometry=T,this._boundsStore.set(m,(0,Y.$)((0,Z.Ue)(),T,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),P}_remove(u){null!=this.onFeatureRemove&&this.onFeatureRemove(u);const m=u.objectId;return this._markedIds.delete(m),this._boundsStore.delete(m),this._featuresById.delete(m),u}}},62631:(V,z,c)=>{c.r(z),c.d(z,{default:()=>w});var C=c(15861),G=c(37636),b=c(57964),L=c(4703),F=c(79412),Z=c(23206),Y=c(33721),K=c(10842),D=c(84726),f=c(58829),I=c(48238),A=c(78642),W=c(42726),u=c(21970),m=c(40100),P=c(764);const T="esri.layers.WFSLayer";class w{constructor(){this._customParameters=null,this._queryEngine=null,this._supportsPagination=!0}destroy(){this._queryEngine?.destroy(),this._queryEngine=null}load(d,h={}){var i=this;return(0,C.Z)(function*(){const{getFeatureUrl:j,getFeatureOutputFormat:N,fields:a,geometryType:n,featureType:s,maxRecordCount:o,maxTotalRecordCount:_,maxPageCount:l,objectIdField:y,customParameters:x}=d,{spatialReference:v,getFeatureSpatialReference:U}=(0,u.fU)(j,s,d.spatialReference);try{yield(0,f._W)(U,v)}catch{throw new b.Z("unsupported-projection","Projection not supported",{inSpatialReference:U,outSpatialReference:v})}(0,F.k_)(h),i._customParameters=x,i._featureType=s,i._fieldsIndex=m.Z.fromLayerJSON({fields:a,dateFieldsTimeReference:a.some(t=>"esriFieldTypeDate"===t.type)?{timeZoneIANA:P.pt}:null}),i._geometryType=n,i._getFeatureUrl=j,i._getFeatureOutputFormat=N,i._getFeatureSpatialReference=U,i._maxRecordCount=o,i._maxTotalRecordCount=_,i._maxPageCount=l,i._objectIdField=y,i._spatialReference=v;let e=yield i._snapshotFeatures(h);if(e.errors.length>0&&(i._supportsPagination=!1,e=yield i._snapshotFeatures(h),e.errors.length>0))throw e.errors[0];return i._queryEngine=new I.q({fieldsIndex:i._fieldsIndex,geometryType:n,hasM:!1,hasZ:!1,objectIdField:y,spatialReference:v,timeInfo:null,featureStore:new D.Z({geometryType:n,hasM:!1,hasZ:!1})}),i._queryEngine.featureStore.addMany(e.features),{warnings:X(e),extent:(yield i._queryEngine.fetchRecomputedExtents()).fullExtent}})()}applyEdits(){return(0,C.Z)(function*(){throw new b.Z("wfs-source:editing-not-supported","applyEdits() is not supported on WFSLayer")})()}queryFeatures(d={},h={}){var i=this;return(0,C.Z)(function*(){return yield i._waitSnapshotComplete(),i._queryEngine.executeQuery(d,h.signal)})()}queryFeatureCount(d={},h={}){var i=this;return(0,C.Z)(function*(){return yield i._waitSnapshotComplete(),i._queryEngine.executeQueryForCount(d,h.signal)})()}queryObjectIds(d={},h={}){var i=this;return(0,C.Z)(function*(){return yield i._waitSnapshotComplete(),i._queryEngine.executeQueryForIds(d,h.signal)})()}queryExtent(d={},h={}){var i=this;return(0,C.Z)(function*(){return yield i._waitSnapshotComplete(),i._queryEngine.executeQueryForExtent(d,h.signal)})()}querySnapping(d,h={}){var i=this;return(0,C.Z)(function*(){return yield i._waitSnapshotComplete(),i._queryEngine.executeQueryForSnapping(d,h.signal)})()}refresh(d){var h=this;return(0,C.Z)(function*(){return h._customParameters=d.customParameters,h._maxRecordCount=d.maxRecordCount,h._maxTotalRecordCount=d.maxTotalRecordCount,h._maxPageCount=d.maxPageCount,h._snapshotTask?.abort(),h._snapshotTask=(0,G.vr)(i=>h._snapshotFeatures({signal:i})),h._snapshotTask.promise.then(i=>{h._queryEngine.featureStore.clear(),h._queryEngine.featureStore.addMany(i.features);for(const j of X(i))L.Z.getLogger(T).warn(new Z.Z("wfs-layer:refresh-warning",j.message,j.details));i.errors?.length&&L.Z.getLogger(T).warn(new Z.Z("wfs-layer:refresh-error","Refresh completed with errors",{errors:i.errors}))},()=>{h._queryEngine.featureStore.clear()}),yield h._waitSnapshotComplete(),{extent:(yield h._queryEngine.fetchRecomputedExtents()).fullExtent}})()}_waitSnapshotComplete(){var d=this;return(0,C.Z)(function*(){if(d._snapshotTask&&!d._snapshotTask.finished){try{yield d._snapshotTask.promise}catch{}return d._waitSnapshotComplete()}})()}_snapshotFeatures(d){var h=this;return(0,C.Z)(function*(){const i=d?.signal,j=h._maxTotalRecordCount,N=h._maxPageCount,a=h._supportsPagination?yield(0,u.bx)(h._getFeatureUrl,h._featureType.typeName,{customParameters:h._customParameters,signal:i}):void 0;let n=[];const s=[];if(null==a)try{n=yield h._singleQuery(i)}catch(o){(0,F.D_)(o)||s.push(o)}else{const o=Math.min(a,j),_=function*g(M,d,h){for(let i=0;i<d;i++)yield M._pageQuery(i,h)}(h,Math.max(1,Math.min(Math.ceil(o/h._maxRecordCount),N)),i);yield Promise.allSettled(Array.from({length:10}).map(()=>function B(M,d,h){return S.apply(this,arguments)}(_,n,s)))}return(0,F.k_)(i),{features:n,totalRecordCount:a,maxTotalRecordCount:j,maxPageCount:N,errors:s}})()}_singleQuery(d){var h=this;return(0,C.Z)(function*(){const i=yield(0,u.Bm)(h._getFeatureUrl,h._featureType.typeName,h._getFeatureSpatialReference,h._getFeatureOutputFormat,{customParameters:h._customParameters,signal:d});return h._processGeoJSON(i,{signal:d})})()}_pageQuery(d,h){var i=this;return(0,C.Z)(function*(){const j=d*i._maxRecordCount,N=yield(0,u.Bm)(i._getFeatureUrl,i._featureType.typeName,i._getFeatureSpatialReference,i._getFeatureOutputFormat,{customParameters:i._customParameters,startIndex:j,count:i._maxRecordCount,signal:h});return i._processGeoJSON(N,{startIndex:j,signal:h})})()}_processGeoJSON(d,h){(0,A.O3)(d,this._getFeatureSpatialReference.wkid);const{startIndex:i,signal:j}=h;(0,F.k_)(j);const N=(0,A.lG)(d,{geometryType:this._geometryType,hasZ:!1,objectIdField:this._objectIdField});if(!(0,Y.fS)(this._spatialReference,this._getFeatureSpatialReference))for(const n of N)null!=n.geometry&&(n.geometry=(0,K.GH)((0,f.iV)((0,K.di)(n.geometry,this._geometryType,!1,!1),this._getFeatureSpatialReference,this._spatialReference)));let a=i??1;for(const n of N){const s={};(0,W.O0)(this._fieldsIndex,s,n.attributes,!0),n.attributes=s,null==s[this._objectIdField]&&(n.objectId=s[this._objectIdField]=a++)}return N}}function S(){return(S=(0,C.Z)(function*(M,d,h){let i=M.next();for(;!i.done;){try{const j=yield i.value;d.push(...j)}catch(j){(0,F.D_)(j)||h.push(j)}i=M.next()}})).apply(this,arguments)}function X(M){const d=[];return null!=M.totalRecordCount&&(M.features.length<M.totalRecordCount&&d.push({name:"wfs-layer:maxRecordCount-too-low",message:`Could only fetch ${M.features.length} of ${M.totalRecordCount} in ${M.maxPageCount} queries. Try increasing the value of WFSLayer.maxRecordCount.`,details:{recordCount:M.features.length,totalRecordCount:M.totalRecordCount}}),M.totalRecordCount>M.maxTotalRecordCount&&d.push({name:"wfs-layer:large-dataset",message:`The number of ${M.totalRecordCount} features exceeds the maximum allowed of ${M.maxTotalRecordCount}.`,details:{recordCount:M.features.length,totalRecordCount:M.totalRecordCount,maxTotalRecordCount:M.maxTotalRecordCount}})),d}},42726:(V,z,c)=>{c.d(z,{O0:()=>I,av:()=>Y,b:()=>T,d1:()=>D,og:()=>u});var C=c(15861),G=c(51310),b=c(33721),L=c(85295);class F{constructor(){this.code=null,this.description=null}}class Z{constructor(B){this.error=new F,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=B}}function Y(g){return new Z(g)}class K{constructor(B){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=B}}function D(g){return new K(g)}const f=new Set;function I(g,B,S,X=!1){f.clear();for(const M in S){const d=g.get(M);if(!d)continue;const h=A(d,S[M]);if(f.add(d.name),d&&(X||d.editable)){const i=(0,L.Qc)(d,h);if(i)return Y((0,L.vP)(i,d,h));B[d.name]=h}}for(const M of g?.requiredFields??[])if(!f.has(M.name))return Y(`missing required field "${M.name}"`);return null}function A(g,B){let S=B;return(0,L.H7)(g)&&"string"==typeof B?S=parseFloat(B):(0,L.qN)(g)&&null!=B&&"string"!=typeof B?S=String(B):(0,L.y2)(g)&&"string"==typeof B&&(S=(0,G.sG)(B)),(0,L.Pz)(S)}let W;function u(g,B){if(!g||!(0,b.JY)(B))return g;if("rings"in g||"paths"in g){if(null==W)throw new TypeError("geometry engine not loaded");return W.simplify(B,g)}return g}function P(){return(P=(0,C.Z)(function*(){return null==W&&(W=yield Promise.all([c.e(9465),c.e(8592),c.e(7545)]).then(c.bind(c,49574))),W})).apply(this,arguments)}function T(g,B){return w.apply(this,arguments)}function w(){return w=(0,C.Z)(function*(g,B){!(0,b.JY)(g)||"esriGeometryPolygon"!==B&&"esriGeometryPolyline"!==B||(yield function m(){return P.apply(this,arguments)}())}),w.apply(this,arguments)}}}]);