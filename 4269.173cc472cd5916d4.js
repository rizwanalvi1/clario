"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[4269,5398,1519,9005],{52540:(se,X,h)=>{h.d(X,{z:()=>T});var N=h(39921);class T{constructor(b,w){this._storage=new N.WJ,this.id="",this.name="",this.size=0,this._storage.maxSize=b,this._storage.register(this),w&&this._storage.registerRemoveFunc("",w)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(b,w,C=1){this._storage.put(this,b,w,C,1)}pop(b){return this._storage.pop(this,b)}get(b){return this._storage.get(this,b)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(b){this._storage.maxSize=b}resetHitRate(){}}},39921:(se,X,h)=>{h.d(X,{WJ:()=>C,Xq:()=>w});var b,V,N=h(43029);(V=b||(b={}))[V.ALL=0]="ALL",V[V.SOME=1]="SOME";class w{constructor(E,m,_){this.name=E,this._storage=m,this.id=j+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),_&&(this._storage.registerRemoveFunc(this.id,_),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(E){return this._storage.getSize(this,E)}resetHitRate(){this._hit=this._miss=0}put(E,m,_,S=0){this._storage.put(this,E,m,_,S)}pop(E){const m=this._storage.pop(this,E);return void 0===m?++this._miss:++this._hit,m}get(E){const m=this._storage.get(this,E);return void 0===m?++this._miss:++this._hit,m}peek(E){return this._storage.peek(this,E)}updateSize(E,m,_){this._storage.updateSize(this,E,m,_)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class C{get size(){return this._size}constructor(E=10485760){this._maxSize=E,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new N.Z,this._users=new N.Z}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(E){this._users.push(E)}deregister(E){this._users.removeUnordered(E)}registerRemoveFunc(E,m){this._removeFuncs.push([E,m])}deregisterRemoveFunc(E){this._removeFuncs.filterInPlace(m=>m[0]!==E)}get maxSize(){return this._maxSize}set maxSize(E){this._maxSize=Math.max(E,-1),this._checkSize()}getSize(E,m){return this._db.get(E.id+m)?.size??0}put(E,m,_,S,I){const D=this._db.get(m=E.id+m);if(D&&(this._size-=D.size,E.size-=D.size,this._db.delete(m),D.entry!==_&&this._notifyRemove(m,D.entry,D.size,b.ALL)),S>this._maxSize)return void this._notifyRemove(m,_,S,b.ALL);if(void 0===_)return void console.warn("Refusing to cache undefined entry ");if(!S||S<0)return console.warn(`Refusing to cache entry with size ${S} for key ${m}`),void this._notifyRemove(m,_,0,b.ALL);const A=1+Math.max(I,-4)- -3;this._db.set(m,new $(_,S,A)),this._size+=S,E.size+=S,this._checkSize()}updateSize(E,m,_,S){const I=this._db.get(m=E.id+m);if(I&&I.entry===_){for(this._size-=I.size,E.size-=I.size;S>this._maxSize;){const D=this._notifyRemove(m,_,S,b.SOME);if(!(null!=D&&D>0))return void this._db.delete(m);S=D}I.size=S,this._size+=S,E.size+=S,this._checkSize()}}pop(E,m){const _=this._db.get(m=E.id+m);if(_)return this._size-=_.size,E.size-=_.size,this._db.delete(m),++this._hit,_.entry;++this._miss}get(E,m){const _=this._db.get(m=E.id+m);if(void 0!==_)return this._db.delete(m),_.lives=_.lifetime,this._db.set(m,_),++this._hit,_.entry;++this._miss}peek(E,m){const _=this._db.get(E.id+m);return _?++this._hit:++this._miss,_?.entry}get performanceInfo(){const E={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},m={},_=new Array;this._db.forEach((D,A)=>{const d=D.lifetime;_[d]=(_[d]||0)+D.size,this._users.forAll(f=>{const{id:u,name:y}=f;A.startsWith(u)&&(m[y]=(m[y]||0)+D.size)})});const S={};this._users.forAll(D=>{const A=D.name;"hitRate"in D&&"number"==typeof D.hitRate&&!isNaN(D.hitRate)&&D.hitRate>0?(m[A]=m[A]||0,S[A]=Math.round(100*D.hitRate)+"%"):S[A]="0%"});const I=Object.keys(m);I.sort((D,A)=>m[A]-m[D]),I.forEach(D=>E[D]=Math.round(m[D]/2**20)+"MB / "+S[D]);for(let D=_.length-1;D>=0;--D){const A=_[D];A&&(E["Priority "+(D+-3-1)]=Math.round(A/this._size*100)+"%")}return E}resetStats(){this._hit=this._miss=0,this._users.forAll(E=>E.resetHitRate())}clear(E){const m=E.id;this._db.forEach((_,S)=>{S.startsWith(m)&&(this._size-=_.size,this._db.delete(S),this._notifyRemove(S,_.entry,_.size,b.ALL))}),E.size=0}clearAll(){this._db.forEach((E,m)=>this._notifyRemove(m,E.entry,E.size,b.ALL)),this._users.forAll(E=>E.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(E,m,_,S){let I;return this._removeFuncs.some(D=>{if(E.startsWith(D[0])){const A=D[1](m,S,_);return"number"==typeof A&&(I=A),!0}return!1}),I}_checkSize(){this._users.forAll(E=>this._checkSizeLimits(E)),this._checkSizeLimits()}_checkSizeLimits(E){const m=E??this;if(m.maxSize<0||m.size<=m.maxSize)return;const _=E?.id;let S=!0;for(;S;){S=!1;for(const[I,D]of this._db)if(0===D.lifetime&&(!_||I.startsWith(_))){if(this._purgeItem(I,D,E),m.size<=.9*m.maxSize)return;S||=this._db.has(I)}}for(const[I,D]of this._db)if((!_||I.startsWith(_))&&(this._purgeItem(I,D,E),m.size<=.9*m.maxSize))return}_purgeItem(E,m,_=this._users.find(S=>E.startsWith(S.id))){if(this._db.delete(E),m.lives<=1){this._size-=m.size,_&&(_.size-=m.size);const S=this._notifyRemove(E,m.entry,m.size,b.SOME);null!=S&&S>0&&(this._size+=S,_&&(_.size+=S),m.lives=m.lifetime,m.size=S,this._db.set(E,m))}else--m.lives,this._db.set(E,m)}}let j=0;class ${constructor(E,m,_){this.entry=E,this.size=m,this.lifetime=_,this.lives=_}}},657:(se,X,h)=>{h.d(X,{$c:()=>I,Hg:()=>D,jW:()=>m,uD:()=>_});var N=h(73514),T=h(83944),Q=h(49301);const b=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function w(d){return d instanceof N.Z}function C(d){return d instanceof T.Z?Object.keys(d.items):w(d)?(0,Q.vw)(d).keys():d?Object.keys(d):[]}function j(d,f){return d instanceof T.Z?d.items[f]:d[f]}function V(d){return d?d.declaredClass:null}function E(d,f){const u=d.diff;if(u&&"function"==typeof u)return u(d,f);const y=C(d),L=C(f);if(0===y.length&&0===L.length)return;if(!y.length||!L.length||function $(d,f){return!(!Array.isArray(d)||!Array.isArray(f))&&d.length!==f.length}(d,f))return{type:"complete",oldValue:d,newValue:f};const P=L.filter(F=>!y.includes(F)),p=y.filter(F=>!L.includes(F)),M=y.filter(F=>L.includes(F)&&j(d,F)!==j(f,F)).concat(P,p).sort(),v=V(d);if(v&&b.has(v)&&M.length)return{type:"complete",oldValue:d,newValue:f};let z;const H=w(d)&&w(f);for(const F of M){const O=j(d,F),B=j(f,F);let U;if((H||"function"!=typeof O&&"function"!=typeof B)&&O!==B&&(null!=O||null!=B)){if(u&&u[F]&&"function"==typeof u[F])U=u[F]?.(O,B);else if(O instanceof Date&&B instanceof Date){if(O.getTime()===B.getTime())continue;U={type:"complete",oldValue:O,newValue:B}}else U="object"==typeof O&&"object"==typeof B&&V(O)===V(B)?E(O,B):{type:"complete",oldValue:O,newValue:B};null!=U&&(null!=z?z.diff[F]=U:z={type:"partial",diff:{[F]:U}})}}return z}function m(d,f){return _(d,f)}function _(d,f){if(null==d)return!1;const u=f.split(".");let y=d;for(const L of u){if("complete"===y.type)return!0;if("partial"!==y.type)return!1;{const P=y.diff[L];if(!P)return!1;y=P}}return!0}function I(d,f){if(!d)return!1;if("partial"===d.type){const u=Object.keys(d.diff);return 1===u.length&&u[0]===f}return!1}function D(d,f){if("function"!=typeof d&&"function"!=typeof f&&(null!=d||null!=f))return null==d||null==f||"object"==typeof d&&"object"==typeof f&&V(d)!==V(f)?{type:"complete",oldValue:d,newValue:f}:E(d,f)}},15398:(se,X,h)=>{h.d(X,{A4:()=>Q,L9:()=>b,yV:()=>T});var N=h(25037);class T{}function Q(C){return C instanceof N.ld?C===T.instance:"unknown"===C?.toString().toLowerCase()}function b(C){return Q(C)?T.instance:C}T.instance=new N.vF("Etc/UTC")},66398:(se,X,h)=>{function T(l){return l?{originPosition:"upper-left"===l.originPosition?"upperLeft":"lower-left"===l.originPosition?"lowerLeft":l.originPosition,scale:l.tolerance?[l.tolerance,l.tolerance,1,1]:[1,1,1,1],translate:null!=l.extent?[l.extent.xmin,l.extent.ymax,l.extent.zmin??0,l.extent.mmin??0]:[0,0,0,0]}:null}function b(l){if(function Q(l){return"lowerLeft"===l.originPosition&&4===l.scale.length&&4===l.translate.length}(l))return l;const{originPosition:i,scale:s,translate:a}=l,g=s[1]??1;return{originPosition:"lowerLeft",scale:[s[0]??1,"lowerLeft"===i?g:-g,s[2]??1,s[3]??1],translate:[a[0]??0,a[1]??0,a[2]??0,a[3]??0]}}function d({scale:l,translate:i},s){return s*l[0]+i[0]}function f({scale:l,translate:i},s){return s*l[1]+i[1]}function u({scale:l,translate:i},s){return(s??0)*l[2]+i[2]}function y({scale:l,translate:i},s){return s?s*l[3]+i[3]:0}function L(l,i){return l&&i?v:l&&!i?p:!l&&i?M:P}h.d(X,{G6:()=>oe,Ie:()=>te,J9:()=>_e,RF:()=>re,U1:()=>fe,vY:()=>T}),h(40637);const P=(l,i)=>{const s=new Array(i.length);if(!i.length)return s;const a=i[0];let c=d(l,a[0]),g=f(l,a[1]);s[0]=[c,g];const{scale:R,originPosition:x}=l,W=R[0],Z="lowerLeft"===x?R[1]:-R[1];for(let K=1;K<i.length;K++){const[G,k]=i[K];c+=W*G,g+=Z*k,s[K]=[c,g]}return s},p=(l,i)=>{const s=new Array(i.length);if(!i.length)return s;const a=i[0];let c=d(l,a[0]),g=f(l,a[1]);s[0]=[c,g,u(l,a[2])];const{scale:R,originPosition:x}=l,W=R[0],Z="lowerLeft"===x?R[1]:-R[1];for(let K=1;K<i.length;K++){const[G,k,q]=i[K];c+=W*G,g+=Z*k,s[K]=[c,g,u(l,q)]}return s},M=(l,i)=>{const s=new Array(i.length);if(!i.length)return s;const a=i[0];let c=d(l,a[0]),g=f(l,a[1]);s[0]=[c,g,y(l,a[2])];const{scale:R,originPosition:x}=l,W=R[0],Z="lowerLeft"===x?R[1]:-R[1];for(let K=1;K<i.length;K++){const[G,k,q]=i[K];c+=W*G,g+=Z*k,s[K]=[c,g,y(l,q)]}return s},v=(l,i)=>{const s=new Array(i.length);if(!i.length)return s;const a=i[0];let c=d(l,a[0]),g=f(l,a[1]);s[0]=[c,g,u(l,a[2]),y(l,a[3])];const{scale:R,originPosition:x}=l,W=R[0],Z="lowerLeft"===x?R[1]:-R[1];for(let K=1;K<i.length;K++){const[G,k,q,ne]=i[K];c+=W*G,g+=Z*k,s[K]=[c,g,u(l,q),y(l,ne)]}return s};function z(l,i,s){const a=new Array(s.length);for(let c=0;c<s.length;c++)a[c]=i(l,s[c]);return a}function re(l,i,s){const a=b(l);return i.x=function w({scale:l,translate:i},s){return Math.round((s-i[0])/l[0])}(a,s.x),i.y=function C({scale:l,translate:i},s){return Math.round((s-i[1])/l[1])}(a,s.y),null!=s.z&&(i.z=function j({scale:l,translate:i},s){return Math.round(((s??0)-i[2])/l[2])}(a,s.z)),null!=s.m&&(i.m=function $({scale:l,translate:i},s){return s?Math.round((s-i[3])/l[3]):0}(a,s.m)),i}function _e(l,i,s,a=s?.hasZ??!1,c=s?.hasM??!1){if(null!=s){const g=b(l);i.points=L(a,c)(g,s.points),i.hasZ=a,i.hasM=c}return i}function fe(l,i,s,a=null!=s?.z,c=null!=s?.m){if(null==s)return i;const g=b(l);return i.x=d(g,s.x),i.y=f(g,s.y),a&&(i.z=u(g,s.z)),c&&(i.m=y(g,s.m)),i}function te(l,i,s,a=s?.hasZ??!1,c=s?.hasM??!1){if(null!=s){const g=b(l);i.rings=z(g,L(a,c),s.rings),i.hasZ=a,i.hasM=c}return i}function oe(l,i,s,a=s?.hasZ??!1,c=s?.hasM??!1){if(null!=s){const g=b(l);i.paths=z(g,L(a,c),s.paths),i.hasZ=a,i.hasM=c}return i}},18191:(se,X,h)=>{h.r(X),h.d(X,{default:()=>i});var N=h(15861),T=h(50484),b=(h(2189),h(35458)),C=(h(71950),h(83944)),j=h(57964),$=h(34222),V=h(3233),E=h(71763),m=h(23206),_=h(80543),D=(h(14007),h(4703),h(62185)),A=h(10141),d=h(7547),f=h(83821),u=h(45425),y=h(93566),L=h(33721),P=h(90373),p=h(45049),M=h(95060),v=h(64761),z=h(19855),H=h(80099),F=h(70509),O=h(29717),B=h(81247),U=h(89481),J=h(66637),ee=h(35451),Y=h(52248),re=h(43814),ue=h(26894);function ie(s){return"markup"===s.featureCollectionType||s.layers.some(a=>null!=a.layerDefinition.visibilityField||!ce(a))}function ce({layerDefinition:s,featureSet:a}){const c=s.geometryType??a.geometryType;return oe.find(g=>c===g.geometryTypeJSON&&s.drawingInfo?.renderer?.symbol?.type===g.identifyingSymbol.type)}function he(){return new ue.Z({xmin:-180,ymin:-90,xmax:180,ymax:90})}const _e=new B.Z({name:"OBJECTID",alias:"OBJECTID",type:"oid",nullable:!1,editable:!1}),fe=new B.Z({name:"title",alias:"Title",type:"string",nullable:!0,editable:!0,length:255});let te=class extends p.Z{constructor(s){super(s),this.visibilityMode="inherited"}initialize(){for(const s of this.graphics)s.sourceLayer=this.layer;this.graphics.on("after-add",s=>{s.item.sourceLayer=this.layer}),this.graphics.on("after-remove",s=>{s.item.sourceLayer=null})}get fullExtent(){const s=this.layer?.spatialReference,a=this.fullBounds;return s?null==a?(0,f.projectOrLoad)(he(),s).geometry:(0,u.HH)(a,s):null}get fullBounds(){const s=this.layer?.spatialReference;if(!s)return null;const a=(0,u.cS)();return this.graphics.forEach(c=>{const g=null!=c.geometry?(0,f.projectOrLoad)(c.geometry,s).geometry:null;null!=g&&(0,u.jn)(a,"point"===g.type?g:g.extent,a)}),(0,u.fS)(a,u.G_)?null:a}get sublayers(){return this.graphics}};(0,T._)([(0,_.Cb)({readOnly:!0})],te.prototype,"fullExtent",null),(0,T._)([(0,_.Cb)({readOnly:!0})],te.prototype,"fullBounds",null),(0,T._)([(0,_.Cb)({readOnly:!0})],te.prototype,"sublayers",null),(0,T._)([(0,_.Cb)()],te.prototype,"layer",void 0),(0,T._)([(0,_.Cb)()],te.prototype,"layerId",void 0),(0,T._)([(0,_.Cb)({readOnly:!0})],te.prototype,"visibilityMode",void 0),te=(0,T._)([(0,A.j)("esri.layers.MapNotesLayer.MapNotesSublayer")],te);const oe=[{geometryType:"polygon",geometryTypeJSON:"esriGeometryPolygon",id:"polygonLayer",layerId:0,title:"Polygons",identifyingSymbol:(new U.Z).toJSON()},{geometryType:"polyline",geometryTypeJSON:"esriGeometryPolyline",id:"polylineLayer",layerId:1,title:"Polylines",identifyingSymbol:(new J.Z).toJSON()},{geometryType:"multipoint",geometryTypeJSON:"esriGeometryMultipoint",id:"multipointLayer",layerId:2,title:"Multipoints",identifyingSymbol:(new ee.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"pointLayer",layerId:3,title:"Points",identifyingSymbol:(new ee.Z).toJSON()},{geometryType:"point",geometryTypeJSON:"esriGeometryPoint",id:"textLayer",layerId:4,title:"Text",identifyingSymbol:(new Y.Z).toJSON()}];let l=class extends((0,z.h7)((0,O.M)((0,H.q)((0,F.I)((0,V.R)(M.Z)))))){constructor(s){super(s),this.capabilities={operations:{supportsMapNotesEditing:!0}},this.featureCollections=null,this.featureCollectionJSON=null,this.featureCollectionType="notes",this.legendEnabled=!1,this.listMode="hide-children",this.minScale=0,this.maxScale=0,this.spatialReference=re.Z.WGS84,this.sublayers=new C.Z(oe.map(a=>new te({id:a.id,layerId:a.layerId,title:a.title,layer:this}))),this.title="Map Notes",this.type="map-notes",this.visibilityMode="inherited"}readCapabilities(s,a,c){return{operations:{supportsMapNotesEditing:!ie(a)&&"portal-item"!==c?.origin}}}readFeatureCollections(s,a,c){if(!ie(a))return null;const g=a.layers.map(R=>{const x=new P.default;return x.read(R,c),x});return new C.Z({items:g})}readLegacyfeatureCollectionJSON(s,a){return ie(a)?(0,$.d9)(a.featureCollection):null}get fullExtent(){const s=this.spatialReference,a=(0,u.cS)();return null!=this.sublayers?this.sublayers.forEach(({fullBounds:c})=>null!=c?(0,u.jn)(a,c,a):a,a):this.featureCollectionJSON?.layers.some(c=>c.layerDefinition.extent)&&this.featureCollectionJSON.layers.forEach(c=>{const g=(0,f.projectOrLoad)(c.layerDefinition.extent,s).geometry;null!=g&&(0,u.jn)(a,g,a)}),(0,u.fS)(a,u.G_)?(0,f.projectOrLoad)(he(),s).geometry:(0,u.HH)(a,s)}readMinScale(s,a){for(const c of a.layers)if(null!=c.layerDefinition.minScale)return c.layerDefinition.minScale;return 0}readMaxScale(s,a){for(const c of a.layers)if(null!=c.layerDefinition.maxScale)return c.layerDefinition.maxScale;return 0}get multipointLayer(){return this._findSublayer("multipointLayer")}get pointLayer(){return this._findSublayer("pointLayer")}get polygonLayer(){return this._findSublayer("polygonLayer")}get polylineLayer(){return this._findSublayer("polylineLayer")}readSpatialReference(s,a){return a.layers.length?re.Z.fromJSON(a.layers[0].layerDefinition.spatialReference):re.Z.WGS84}readSublayers(s,a,c){if(ie(a))return null;const g=[];let R=a.layers.reduce((x,W)=>Math.max(x,W.layerDefinition.id??-1),-1)+1;for(const x of a.layers){const{layerDefinition:W,featureSet:Z}=x,K=W.id??R++,G=ce(x);if(null!=G){const k=new te({id:G.id,title:W.name,layerId:K,layer:this,graphics:Z.features.map(({geometry:q,symbol:ne,attributes:le,popupInfo:ae})=>b.Z.fromJSON({attributes:le,geometry:q,symbol:ne,popupTemplate:ae}))});g.push(k)}}return new C.Z(g)}writeSublayers(s,a,c,g){const{minScale:R,maxScale:x}=this;if(null==s)return;const W=s.some(G=>G.graphics.length>0);if(!this.capabilities.operations.supportsMapNotesEditing)return void(W&&g?.messages?.push(new j.Z("map-notes-layer:editing-not-supported","New map notes cannot be added to this layer")));const Z=[];let K=this.spatialReference.toJSON();e:for(const G of s)for(const k of G.graphics)if(null!=k.geometry){K=k.geometry.spatialReference.toJSON();break e}for(const G of oe){const k=s.find(q=>G.id===q.id);this._writeMapNoteSublayer(Z,k,G,R,x,K,g)}(0,E.RB)("featureCollection.layers",Z,a)}get textLayer(){return this._findSublayer("textLayer")}load(s){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},s)),Promise.resolve(this)}read(s,a){"featureCollection"in s&&(s=(0,$.d9)(s),Object.assign(s,s.featureCollection)),super.read(s,a)}beforeSave(){var s=this;return(0,N.Z)(function*(){if(null==s.sublayers)return;let a=null;const c=[];for(const R of s.sublayers)for(const x of R.graphics)if(null!=x.geometry){const W=x.geometry;a?(0,L.fS)(W.spatialReference,a)||((0,f.canProjectWithoutEngine)(W.spatialReference,a)||(0,f.isLoaded)()||(yield(0,f.load)()),x.geometry=(0,f.project)(W,a)):a=W.spatialReference,c.push(x)}const g=yield(0,y.aX)(c.map(R=>R.geometry));c.forEach((R,x)=>R.geometry=g[x])})()}_findSublayer(s){return null==this.sublayers?null:this.sublayers?.find(a=>a.id===s)??null}_writeMapNoteSublayer(s,a,c,g,R,x,W){const Z=[];if(null!=a){for(const K of a.graphics)this._writeMapNote(Z,K,c.geometryType,W);this._normalizeObjectIds(Z,_e),s.push({layerDefinition:{name:a.title,drawingInfo:{renderer:{type:"simple",symbol:(0,$.d9)(c.identifyingSymbol)}},id:a.layerId,geometryType:c.geometryTypeJSON,minScale:g,maxScale:R,objectIdField:"OBJECTID",fields:[_e.toJSON(),fe.toJSON()],spatialReference:x},featureSet:{features:Z,geometryType:c.geometryTypeJSON}})}}_writeMapNote(s,a,c,g){if(null==a)return;const{geometry:R,symbol:x,popupTemplate:W}=a;if(null==R)return;if(R.type!==c)return void g?.messages?.push(new m.Z("map-notes-layer:invalid-geometry-type",`Geometry "${R.type}" cannot be saved in "${c}" layer`,{graphic:a}));if(null==x)return void g?.messages?.push(new m.Z("map-notes-layer:no-symbol","Skipping map notes with no symbol",{graphic:a}));const Z={attributes:{...a.attributes},geometry:R.toJSON(),symbol:x.toJSON()};null!=W&&(Z.popupInfo=W.toJSON()),s.push(Z)}_normalizeObjectIds(s,a){const c=a.name;let g=(0,v.S)(c,s)+1;const R=new Set;for(const x of s){x.attributes||(x.attributes={});const{attributes:W}=x;(null==W[c]||R.has(W[c]))&&(W[c]=g++),R.add(W[c])}}};(0,T._)([(0,_.Cb)({readOnly:!0})],l.prototype,"capabilities",void 0),(0,T._)([(0,D.r)(["portal-item","web-map"],"capabilities",["layers"])],l.prototype,"readCapabilities",null),(0,T._)([(0,_.Cb)({readOnly:!0})],l.prototype,"featureCollections",void 0),(0,T._)([(0,D.r)(["web-map","portal-item"],"featureCollections",["layers"])],l.prototype,"readFeatureCollections",null),(0,T._)([(0,_.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{enabled:!0,target:"featureCollection"}}}}})],l.prototype,"featureCollectionJSON",void 0),(0,T._)([(0,D.r)(["web-map","portal-item"],"featureCollectionJSON",["featureCollection"])],l.prototype,"readLegacyfeatureCollectionJSON",null),(0,T._)([(0,_.Cb)({readOnly:!0,json:{read:!0,write:{enabled:!0,ignoreOrigin:!0}}})],l.prototype,"featureCollectionType",void 0),(0,T._)([(0,_.Cb)({readOnly:!0})],l.prototype,"fullExtent",null),(0,T._)([(0,_.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{target:"featureCollection.showLegend",overridePolicy(){return{enabled:null!=this.featureCollectionJSON}}}}}}})],l.prototype,"legendEnabled",void 0),(0,T._)([(0,_.Cb)({type:["show","hide","hide-children"]})],l.prototype,"listMode",void 0),(0,T._)([(0,_.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],l.prototype,"minScale",void 0),(0,T._)([(0,D.r)(["web-map","portal-item"],"minScale",["layers"])],l.prototype,"readMinScale",null),(0,T._)([(0,_.Cb)({type:Number,nonNullable:!0,json:{write:!1}})],l.prototype,"maxScale",void 0),(0,T._)([(0,D.r)(["web-map","portal-item"],"maxScale",["layers"])],l.prototype,"readMaxScale",null),(0,T._)([(0,_.Cb)({readOnly:!0})],l.prototype,"multipointLayer",null),(0,T._)([(0,_.Cb)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],l.prototype,"operationalLayerType",void 0),(0,T._)([(0,_.Cb)({readOnly:!0})],l.prototype,"pointLayer",null),(0,T._)([(0,_.Cb)({readOnly:!0})],l.prototype,"polygonLayer",null),(0,T._)([(0,_.Cb)({readOnly:!0})],l.prototype,"polylineLayer",null),(0,T._)([(0,_.Cb)({type:re.Z})],l.prototype,"spatialReference",void 0),(0,T._)([(0,D.r)(["web-map","portal-item"],"spatialReference",["layers"])],l.prototype,"readSpatialReference",null),(0,T._)([(0,_.Cb)({readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],l.prototype,"sublayers",void 0),(0,T._)([(0,D.r)("web-map","sublayers",["layers"])],l.prototype,"readSublayers",null),(0,T._)([(0,d.c)("web-map","sublayers")],l.prototype,"writeSublayers",null),(0,T._)([(0,_.Cb)({readOnly:!0})],l.prototype,"textLayer",null),(0,T._)([(0,_.Cb)()],l.prototype,"title",void 0),(0,T._)([(0,_.Cb)({readOnly:!0,json:{read:!1}})],l.prototype,"type",void 0),l=(0,T._)([(0,A.j)("esri.layers.MapNotesLayer")],l);const i=l},50243:(se,X,h)=>{h.d(X,{Z:()=>I});var N=h(50484),T=h(25387),Q=h(89317),b=h(80543),$=(h(14007),h(4703),h(65311),h(62185)),V=h(10141),E=h(7547),m=h(59300),_=h(30457);let S=class extends((0,T.J)(Q.wq)){constructor(D){super(D),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(D){const A={};for(const d of Object.keys(D))A[d]=(0,m.im)(D[d]);return A}writeDomains(D,A){const d={};for(const f of Object.keys(D))D[f]&&(d[f]=D[f]?.toJSON());A.domains=d}};(0,N._)([(0,b.Cb)({json:{write:!0}})],S.prototype,"id",void 0),(0,N._)([(0,b.Cb)({json:{write:!0}})],S.prototype,"name",void 0),(0,N._)([(0,b.Cb)({json:{write:!0}})],S.prototype,"domains",void 0),(0,N._)([(0,$.r)("domains")],S.prototype,"readDomains",null),(0,N._)([(0,E.c)("domains")],S.prototype,"writeDomains",null),(0,N._)([(0,b.Cb)({type:[_.Z],json:{write:!0}})],S.prototype,"templates",void 0),S=(0,N._)([(0,V.j)("esri.layers.support.FeatureType")],S);const I=S},40100:(se,X,h)=>{h.d(X,{Z:()=>S});var N=h(57964),T=h(89317),Q=h(4703),b=h(8611),w=h(15398),C=h(85295),j=h(764),$=h(25037);const _=new Map;class S{static fromJSON(u){return new S(u.fields,u.timeZoneByFieldName)}static fromLayer(u){return new S(u.fields??[],d(u))}static fromLayerJSON(u){return new S(u.fields??[],d(u))}constructor(u=[],y){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=u||[],this._timeZoneByFieldName=y?new Map(y):null;const L=[];for(const P of this.fields){const p=P?.name,M=D(p);if(p&&M){const v=I(p);this._fieldsMap.set(p,P),this._fieldsMap.set(v,P),this._normalizedFieldsMap.set(M,P),L.push(`${v}:${P.type}:${this._timeZoneByFieldName?.get(p)}`),(0,C.y2)(P)?(this.dateFields.push(P),this._dateFieldsSet.add(P)):(0,C.H7)(P)&&(this._numericFieldsSet.add(P),this.numericFields.push(P)),(0,C.Dl)(P)||(0,C.Se)(P)||(P.editable=null==P.editable||!!P.editable,P.nullable=null==P.nullable||!!P.nullable)}}L.sort(),this.uid=L.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const u of this.fields)(0,C.Dl)(u)||(0,C.Se)(u)||u.nullable||void 0!==(0,C.os)(u)||this._requiredFields.push(u)}return this._requiredFields}equals(u){return this.uid===u?.uid}has(u){return null!=this.get(u)}get(u){if(!u)return;let y=this._fieldsMap.get(u);return y||(y=this._fieldsMap.get(I(u))??this._normalizedFieldsMap.get(D(u)),y&&this._fieldsMap.set(u,y),y)}getTimeZone(u){const y=this.get(u&&"string"!=typeof u?u.name:u);return y?this._timeZoneByFieldName?this._timeZoneByFieldName.get(y.name):"date"===y.type||"esriFieldTypeDate"===y.type?(Q.Z.getLogger("esri.layers.support.FieldsIndex").error(new N.Z("getTimeZone:no-timezone-information",`no time zone information for field '${y.name}'`)),j.pt):A.has(y.type)?j._4:null:null}getLuxonTimeZone(u){const y=this.getTimeZone(u);return y?y===j._4?w.yV.instance:y===j.pt?$.Qf.utcInstance:(0,b.s1)(_,y,()=>$.vF.create(y)):null}isDateField(u){return this._dateFieldsSet.has(this.get(u))}isTimeOnlyField(u){return(0,C.sX)(this.get(u))}isNumericField(u){return this._numericFieldsSet.has(this.get(u))}normalizeFieldName(u){return this.get(u)?.name??void 0}toJSON(){return{fields:this.fields.map(u=>(0,T.AK)(u)?u.toJSON():u),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function I(f){return f.trim().toLowerCase()}function D(f){return(0,C.q6)(f)?.toLowerCase()??""}const A=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function d(f){const u=new Map;if(!f.fields)return u;const y=!0===f.datesInUnknownTimezone,{timeInfo:L,editFieldsInfo:P}=f,p=(L?"startField"in L?L.startField:L.startTimeField:"")??"",M=(L?"endField"in L?L.endField:L.endTimeField:"")??"",v=function m(f){return"dateFieldsTimeZone"in f}(f)?f.dateFieldsTimeZone??null:f.dateFieldsTimeReference?(0,j.Jv)(f.dateFieldsTimeReference):null,z=P?function V(f){return"timeZone"in f}(P)?P.timeZone??v:P.dateFieldsTimeReference?(0,j.Jv)(P.dateFieldsTimeReference):v??j.pt:null,H=L?function E(f){return"timeZone"in f}(L)?L.timeZone??v:L.timeReference?(0,j.Jv)(L.timeReference):v:null,F=new Map([[I(P?.creationDateField??""),z],[I(P?.editDateField??""),z],[I(p),H],[I(M),H]]);for(const{name:O,type:B}of f.fields)if(A.has(B))u.set(O,j._4);else if("date"!==B&&"esriFieldTypeDate"!==B)u.set(O,null);else if(y)u.set(O,j._4);else{const U=F.get(I(O??""))??v;u.set(O,U)}return u}},56761:(se,X,h)=>{h.d(X,{UG:()=>m,UO:()=>D,YI:()=>I,dI:()=>A,el:()=>P,hV:()=>S,z7:()=>_});var N=h(72578);const T="__begin__",Q="__end__",b=new RegExp(T,"ig"),w=new RegExp(Q,"ig"),C=new RegExp("^"+T,"i"),j=new RegExp(Q+"$","i"),$='"',V=$+" + ",E=" + "+$;function m(p){return p.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function _(p){return p.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function S(p){const M={expression:"",type:"none"};return p.labelExpressionInfo?p.labelExpressionInfo.value?(M.expression=p.labelExpressionInfo.value,M.type="conventional"):p.labelExpressionInfo.expression&&(M.expression=p.labelExpressionInfo.expression,M.type="arcade"):null!=p.labelExpression&&(M.expression=m(p.labelExpression),M.type="conventional"),M}function I(p){const M=S(p);if(!M)return null;switch(M.type){case"conventional":return A(M.expression);case"arcade":return M.expression}return null}function D(p){const M=S(p);if(!M)return null;switch(M.type){case"conventional":return function f(p){return p?.match(d)?.[1].trim()||null}(M.expression);case"arcade":return P(M.expression)}return null}function A(p){let M;return p?(M=(0,N.gx)(p,v=>T+'$feature["'+v+'"]'+Q),M=C.test(M)?M.replace(C,""):$+M,M=j.test(M)?M.replace(j,""):M+$,M=M.replaceAll(b,V).replaceAll(w,E)):M='""',M}const d=/^\s*\{([^}]+)\}\s*$/i,u=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,y=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,L=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function P(p){if(!p)return null;let M=u.exec(p)||y.exec(p);return M?M[1]||M[3]:(M=L.exec(p),M?M[2]:null)}},96043:(se,X,h)=>{h.d(X,{AJ:()=>j,If:()=>E,k0:()=>C,uI:()=>V,ul:()=>w,wx:()=>m});var N=h(55117),T=h(55768),Q=h(5710),b=h(23515);const w=2.4;function C(_){return(0,T.Wz)(_*w)}function j(_){return(0,T.F2)(_)/w}function $(_,S,I,D){let{color:A,ratio:d}=S,{color:f,ratio:u}=I;u===d&&(1===u?d-=1e-6:u+=1e-6);const y=(0,N.uZ)((D-d)/(u-d),0,1);(0,Q.l)(_,A.toArray(),f.toArray(),y)}function V(_){const I=new Uint8ClampedArray(2048);if((_=_.filter(({ratio:u})=>u>=0&&u<=1).sort((u,y)=>u.ratio-y.ratio).map(({color:u,ratio:y})=>({color:u,ratio:Math.max(y,.001)}))).length<1)return I;let D=_[0],A=_[0],d=1;const f=(0,b.Ue)();for(let u=0;u<512;u++){const y=(u+.5)/512;for(;y>A.ratio&&d<_.length;)D=A,A=_[d++];$(f,D,A,y),I.set(f,4*u)}return I}function E(_,S,I){const D=Math.sqrt(_**2+S**2)/I;return D>1?0:3/(Math.PI*I**2)*(1-D**2)**2}function m(_){return"function"==typeof _?_:_?S=>+S[_]:()=>1}},8295:(se,X,h)=>{h.d(X,{p:()=>T});var N=h(53456);function T(Q,b,w){if(!w?.features||!w.hasZ)return;const C=(0,N.k)(w.geometryType,b,Q.outSpatialReference);if(null!=C)for(const j of w.features)C(j.geometry)}},93792:(se,X,h)=>{h.d(X,{Z:()=>u});var A,N=h(50484),T=h(2189),Q=h(35458),b=h(84303),w=h(89317),C=h(34222),j=h(80543),E=(h(14007),h(4703),h(62185)),m=h(10141),_=h(7547),S=h(43814),I=h(40637),D=h(81247);const d=new b.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let f=A=class extends w.wq{constructor(y){super(y),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(y,L){const P=S.Z.fromJSON(L.spatialReference),p=[];for(let M=0;M<y.length;M++){const v=y[M],z=Q.Z.fromJSON(v),H=v.geometry?.spatialReference;null==z.geometry||H||(z.geometry.spatialReference=P);const F=v.aggregateGeometries,O=z.aggregateGeometries;if(F&&null!=O)for(const B in O){const U=O[B],J=F[B],ee=J?.spatialReference;null==U||ee||(U.spatialReference=P)}p.push(z)}return p}writeGeometryType(y,L,P,p){if(y)return void d.write(y,L,P,p);const{features:M}=this;if(M)for(const v of M)if(null!=v?.geometry)return void d.write(v.geometry.type,L,P,p)}readQueryGeometry(y,L){if(!y)return null;const P=!!y.spatialReference,p=(0,I.im)(y);return p&&!P&&L.spatialReference&&(p.spatialReference=S.Z.fromJSON(L.spatialReference)),p}writeSpatialReference(y,L){if(y)return void(L.spatialReference=y.toJSON());const{features:P}=this;if(P)for(const p of P)if(p&&null!=p.geometry&&p.geometry.spatialReference)return void(L.spatialReference=p.geometry.spatialReference.toJSON())}clone(){return new A(this.cloneProperties())}cloneProperties(){return(0,C.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(y){const L=this.write();if(L.features&&Array.isArray(y)&&y.length>0)for(let P=0;P<L.features.length;P++){const p=L.features[P];if(p.geometry){const M=y?.[P];p.geometry=M?.toJSON()||p.geometry}}return L}quantize(y){const{scale:[L,P],translate:[p,M]}=y,H=this.features,F=this._getQuantizationFunction(this.geometryType,O=>Math.round((O-p)/L),O=>Math.round((M-O)/P));for(let O=0,B=H.length;O<B;O++)F?.(H[O].geometry)||(H.splice(O,1),O--,B--);return this.transform=y,this}unquantize(){const{geometryType:y,features:L,transform:P}=this;if(!P)return this;const{translate:[p,M],scale:[v,z]}=P;let O=null,B=null;if(this.hasZ&&null!=P?.scale?.[2]){const{translate:[,,J],scale:[,,ee]}=P;O=Y=>Y*ee+J}if(this.hasM&&null!=P?.scale?.[3]){const{translate:[,,,J],scale:[,,,ee]}=P;B=Y=>null==Y?Y:Y*ee+J}const U=this._getHydrationFunction(y,J=>J*v+p,J=>M-J*z,O,B);for(const{geometry:J}of L)null!=J&&U&&U(J);return this.transform=null,this}_quantizePoints(y,L,P){let p,M;const v=[];for(let z=0,H=y.length;z<H;z++){const F=y[z];if(z>0){const O=L(F[0]),B=P(F[1]);O===p&&B===M||(v.push([O-p,B-M]),p=O,M=B)}else p=L(F[0]),M=P(F[1]),v.push([p,M])}return v.length>0?v:null}_getQuantizationFunction(y,L,P){return"point"===y?p=>(p.x=L(p.x),p.y=P(p.y),p):"polyline"===y||"polygon"===y?p=>{const M=(0,I.oU)(p)?p.rings:p.paths,v=[];for(let z=0,H=M.length;z<H;z++){const O=this._quantizePoints(M[z],L,P);O&&v.push(O)}return v.length>0?((0,I.oU)(p)?p.rings=v:p.paths=v,p):null}:"multipoint"===y?p=>{const M=this._quantizePoints(p.points,L,P);return M&&M.length>0?(p.points=M,p):null}:"extent"===y?p=>p:null}_getHydrationFunction(y,L,P,p,M){return"point"===y?v=>{v.x=L(v.x),v.y=P(v.y),p&&(v.z=p(v.z))}:"polyline"===y||"polygon"===y?v=>{const z=(0,I.oU)(v)?v.rings:v.paths;let H,F;for(let O=0,B=z.length;O<B;O++){const U=z[O];for(let J=0,ee=U.length;J<ee;J++){const Y=U[J];J>0?(H+=Y[0],F+=Y[1]):(H=Y[0],F=Y[1]),Y[0]=L(H),Y[1]=P(F)}}if(p&&M)for(let O=0,B=z.length;O<B;O++){const U=z[O];for(let J=0,ee=U.length;J<ee;J++){const Y=U[J];Y[2]=p(Y[2]),Y[3]=M(Y[3])}}else if(p)for(let O=0,B=z.length;O<B;O++){const U=z[O];for(let J=0,ee=U.length;J<ee;J++){const Y=U[J];Y[2]=p(Y[2])}}else if(M)for(let O=0,B=z.length;O<B;O++){const U=z[O];for(let J=0,ee=U.length;J<ee;J++){const Y=U[J];Y[2]=M(Y[2])}}}:"extent"===y?v=>{v.xmin=L(v.xmin),v.ymin=P(v.ymin),v.xmax=L(v.xmax),v.ymax=P(v.ymax),p&&null!=v.zmax&&null!=v.zmin&&(v.zmax=p(v.zmax),v.zmin=p(v.zmin)),M&&null!=v.mmax&&null!=v.mmin&&(v.mmax=M(v.mmax),v.mmin=M(v.mmin))}:"multipoint"===y?v=>{const z=v.points;let H,F;for(let O=0,B=z.length;O<B;O++){const U=z[O];O>0?(H+=U[0],F+=U[1]):(H=U[0],F=U[1]),U[0]=L(H),U[1]=P(F)}if(p&&M)for(let O=0,B=z.length;O<B;O++){const U=z[O];U[2]=p(U[2]),U[3]=M(U[3])}else if(p)for(let O=0,B=z.length;O<B;O++){const U=z[O];U[2]=p(U[2])}else if(M)for(let O=0,B=z.length;O<B;O++){const U=z[O];U[2]=M(U[2])}}:null}};(0,N._)([(0,j.Cb)({type:String,json:{write:!0}})],f.prototype,"displayFieldName",void 0),(0,N._)([(0,j.Cb)({type:Boolean,json:{write:{overridePolicy:y=>({enabled:y})}}})],f.prototype,"exceededTransferLimit",void 0),(0,N._)([(0,j.Cb)({type:[Q.Z],json:{write:!0}})],f.prototype,"features",void 0),(0,N._)([(0,E.r)("features")],f.prototype,"readFeatures",null),(0,N._)([(0,j.Cb)({type:[D.Z],json:{write:!0}})],f.prototype,"fields",void 0),(0,N._)([(0,j.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:d.read}}})],f.prototype,"geometryType",void 0),(0,N._)([(0,_.c)("geometryType")],f.prototype,"writeGeometryType",null),(0,N._)([(0,j.Cb)({type:Boolean,json:{write:{overridePolicy:y=>({enabled:y})}}})],f.prototype,"hasM",void 0),(0,N._)([(0,j.Cb)({type:Boolean,json:{write:{overridePolicy:y=>({enabled:y})}}})],f.prototype,"hasZ",void 0),(0,N._)([(0,j.Cb)({types:T.qM,json:{write:!0}})],f.prototype,"queryGeometry",void 0),(0,N._)([(0,E.r)("queryGeometry")],f.prototype,"readQueryGeometry",null),(0,N._)([(0,j.Cb)({type:S.Z,json:{write:!0}})],f.prototype,"spatialReference",void 0),(0,N._)([(0,_.c)("spatialReference")],f.prototype,"writeSpatialReference",null),(0,N._)([(0,j.Cb)({json:{write:!0}})],f.prototype,"transform",void 0),f=A=(0,N._)([(0,m.j)("esri.rest.support.FeatureSet")],f),f.prototype.toJSON.isDefaultToJSON=!0;const u=f}}]);