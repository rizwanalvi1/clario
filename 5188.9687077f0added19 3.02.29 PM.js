"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[5188],{46988:(ie,F,p)=>{p.d(F,{c:()=>G,f:()=>P});var S=p(72578);function P(B,R){let A;if("string"==typeof B)A=(0,S.hP)(B+`-seed(${R})`);else{let U=12;A=B^R;do{A=107*(A>>8^A)+U|0}while(0!=--U)}return(1+A/(1<<31))/2}function G(B){return Math.floor(P(B,z)*O)}const z=53290320,O=10},75188:(ie,F,p)=>{p.d(F,{a:()=>Ge});var S=p(15861),P=p(75399),G=p(11223),z=p(62693),O=p(78426),B=p(20325),R=p(69794),A=p(10659),U=p(34501),ve=p(23990),ye=p(8611),$=p(55768),Y=p(60902),J=p(78332),I=p(29726),ae=p(93266),D=p(89014),K=p(10842),Q=p(62209),oe=p(13948),V=p(35935),xe=p(79865),j=p(74699),k=p(33820);function le(o,e,r){return o[0]=e[0]-r[0],o[1]=e[1]-r[1],o}function ce(o,e){return Math.sqrt(o*o+e*e)}function he(o){const e=ce(o[0],o[1]);o[0]/=e,o[1]/=e}function Me(o,e){return ce(o[0]-e[0],o[1]-e[1])}function ue(o){return o.length-1}function _e(o,e,r=1){let[s,t]=function Pe(o,e){return o[e+1]}(o,e);return[s,t]=[Math.round(s),Math.round(t)],Math.sqrt(s*s+t*t)*r}class T{constructor(e,r,s,t,n){this._segments=e,this._index=r,this._distance=s,this._xStart=t,this._yStart=n,this._done=!1}static create(e){return new T(e,0,0,e[0][0],e[0][1])}clone(){return new T(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)}leq(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}geq(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}get _segment(){return this._segments[this._index+1]}get angle(){const e=this.dy;let s=Math.acos((0*e+-1*-this.dx)/(1*this.length));return e>0&&(s=2*Math.PI-s),s}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:e,dy:r}=this;return Math.sqrt(e*e+r*r)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<ue(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(e,r){const s=this.backwardLength;if(e<=s)return this._distance=(s-e)/this.length,this;let t=this.backwardLength;for(;this.prev();){if(t+this.length>e)return this._seekBackwards(e-t);t+=this.length}return this._distance=0,r?this:null}seek(e,r=!1){if(e<0)return this._seekBackwards(Math.abs(e),r);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;let s=this.remainingLength;for(;this.next();){if(s+this.length>e)return this.seek(e-s,r);s+=this.length}return this._distance=1,r?this:null}}function q(o,e,r,s=!0){const t=function de(o){let e=0;for(let r=0;r<ue(o);r++)e+=_e(o,r);return e}(o),n=T.create(o),i=t/2;if(!s)return n.seek(i),void(Math.abs(n.x)<k.L&&Math.abs(n.y)<k.L&&r(n.clone(),0,i+0*e,t));const h=Math.max((t-e)/2,0),c=Math.floor(h/e);n.seek(i-c*e);for(let l=-c;l<=c;l++)Math.abs(n.x)<k.L&&Math.abs(n.y)<k.L&&r(n.clone(),l,i+l*e,t),n.seek(e)}function te(o,e){const r=e;for(let s=0;s<o.length;s++){let t=o[s];Ie(t,r);const n=[];n.push(t[0]);for(let i=1;i<t.length;i++){const[h,c]=t[i-1],[d,l]=t[i];n.push([d-h,l-c])}o[s]=n,t=n}return o}function Ie(o,e){if(e<=0)return;const s=o.length;if(s<3)return;const t=[];let n=0;t.push(0);for(let a=1;a<s;a++)n+=Me(o[a],o[a-1]),t.push(n);e=Math.min(e,.2*n);const i=[];i.push(o[0][0]),i.push(o[0][1]);const h=o[s-1][0],c=o[s-1][1],d=le([0,0],o[0],o[1]);he(d),o[0][0]+=e*d[0],o[0][1]+=e*d[1],le(d,o[s-1],o[s-2]),he(d),o[s-1][0]+=e*d[0],o[s-1][1]+=e*d[1];for(let a=1;a<s;a++)t[a]+=e;t[s-1]+=e;const l=.5*e;for(let a=1;a<s-1;a++){let u=0,g=0,x=0;for(let m=a-1;m>=0&&!(t[m+1]<t[a]-l);m--){const f=l+t[m+1]-t[a],v=t[m+1]-t[m],y=t[a]-t[m]<l?1:f/v;if(Math.abs(y)<1e-6)break;const M=y*y,E=y*f-.5*M*v,b=y*v/e,_=o[m+1],L=o[m][0]-_[0],w=o[m][1]-_[1];u+=b/E*(_[0]*y*f+.5*M*(f*L-v*_[0])-M*y*v*L/3),g+=b/E*(_[1]*y*f+.5*M*(f*w-v*_[1])-M*y*v*w/3),x+=b}for(let m=a+1;m<s&&!(t[m-1]>t[a]+l);m++){const f=l-t[m-1]+t[a],v=t[m]-t[m-1],y=t[m]-t[a]<l?1:f/v;if(Math.abs(y)<1e-6)break;const M=y*y,E=y*f-.5*M*v,b=y*v/e,_=o[m-1],L=o[m][0]-_[0],w=o[m][1]-_[1];u+=b/E*(_[0]*y*f+.5*M*(f*L-v*_[0])-M*y*v*L/3),g+=b/E*(_[1]*y*f+.5*M*(f*w-v*_[1])-M*y*v*w/3),x+=b}i.push(u/x),i.push(g/x)}i.push(h),i.push(c);for(let a=0,u=0;a<s;a++)o[a][0]=i[u++],o[a][1]=i[u++]}var me=p(35089),Z=p(26372);const be=(0,ye.HP)(o=>{let e=0;if(0===o)return 1/0;for(;!(o%2);)e++,o/=2;return e});class we extends Z.lW{constructor(){super(...arguments),this._zoomLevel=0}_write(e,r,s,t){if(this._zoomLevel=t||0,null!=s)throw new Error("InternalError: EffectGeometry not support for LabelMeshWriter");switch(r.geometryType){case"esriGeometryPoint":{const n=r.readXForDisplay(),i=r.readYForDisplay();return this._writePoint(e,n,i,r)}case"esriGeometryEnvelope":case"esriGeometryPolygon":case"esriGeometryMultipoint":{const n=r.readCentroidForDisplay();if(!n)return;const[i,h]=n.coords;return this._writePoint(e,i,h,r)}case"esriGeometryPolyline":this._writeLines(e,r)}}_writePoint(e,r,s,t){const n=this._getShaping();if(!n)return;let i=this._getPointReferenceBounds();i||(i={offsetX:0,offsetY:0,size:0});const h=n.boundsT,c=(0,oe.kH)(this.evaluatedMeshParams.horizontalAlignment),d=(0,oe.b7)(this.evaluatedMeshParams.verticalAlignment),l=this.evaluatedMeshParams.scaleInfo?.maxScale??0,a=this.evaluatedMeshParams.scaleInfo?.minScale??0,u=(0,V.jL)(t.getDisplayId());e.metricStart(new j.O(u,r,s,c,d,l,a,i)),e.metricBoxWrite(h),this._writeGlyphs(e,t.getDisplayId(),r,s,n,0,i),e.metricEnd()}_getPointReferenceBounds(){if(!this._references)return null;for(const e of this._references){const r=e.getBoundsInfo();if(r)return r}return null}_writeLines(e,r){const{scaleInfo:s,verticalAlignment:t}=this.evaluatedMeshParams,n=this.evaluatedMeshParams.repeatLabelDistance||128,i=this._getShaping("middle");if(!i)return;const h=(d,l,a,u)=>this._placeSubdivGlyphs(d,l,a,u),c=(i.bounds.width+n)/2;this._current={out:e,id:r.getDisplayId(),shaping:i,zoomRange:(0,me._f)(s,this.getTileInfo()),referenceBounds:this._getPointReferenceBounds()||{offsetX:0,offsetY:0,size:0},offsetDirection:null},this._verticalPlacement="bottom"===t?"above":"top"===t?"below":null,this._verticalPlacement?this._writeAboveAndBelowAlong(r,h,c):this._writeCenterAlong(r,h,c)}_writeAboveAndBelowAlong(e,r,s){const{repeatLabel:t,fontSize:n}=this.evaluatedMeshParams,{shaping:i}=this._current,h=(0,$.F2)(n),c=e.readGeometryForDisplay();if(!c)return;const d=new Q.Z;(0,K.zj)(d,c,!1,!1,"esriGeometryPolyline",1);const l=fe(new Q.Z,d,h),a=fe(new Q.Z,d,-h),u=(0,K.di)(a,"esriGeometryPolyline",!1,!1),x=te((0,K.di)(l,"esriGeometryPolyline",!1,!1).paths,i.bounds.width),m=te(u.paths,i.bounds.width);this._current.offsetDirection="above";for(const f of x)q(f,s,r,!!t);this._current.offsetDirection="below";for(const f of m)q(f,s,r,!!t)}_writeCenterAlong(e,r,s){const{repeatLabel:t}=this.evaluatedMeshParams,{shaping:n}=this._current,i=te(e.readLegacyGeometryForDisplay().paths,n.bounds.width);for(const h of i)q(h,s,r,!!t)}_placeSubdivGlyphs(e,r,s,t){const{allowOverrun:n,labelPosition:i,repeatLabelDistance:h}=this.evaluatedMeshParams,c=this._current.zoomRange[0],d=be(r),l=this._current.shaping.bounds.width/2,a=Math.sqrt(h||128)/2,u=Math.min(s,t-s),g=this._current.shaping.isMultiline?Z.PW:Math.log2(u/(a+l/2)),x=0===r?g:Math.min(d,g),m=Math.max(c,this._zoomLevel+1-x),f=this._zoomLevel-m,v=this._current.shaping.bounds.width/2*2**f;this._current.shaping.isMultiline?0===r&&this._placeStraight(e,m):n&&f<0?this._placeStraightAlong(e,c):"parallel"===i?this._placeStraightAlong(e,m):"curved"===i&&this._placeCurved(e,m,v)}_placeStraight(e,r){const{out:s,id:t,shaping:n,referenceBounds:i}=this._current,{x:h,y:c}=e,d=(0,V.jL)(t);s.metricStart(new j.O(d,e.x,e.y,0,0,this.evaluatedMeshParams.scaleInfo?.maxScale??0,this.evaluatedMeshParams.scaleInfo?.minScale??0,null)),s.metricBoxWrite(n.boundsT);const u=e.angle*(180/Math.PI)%360,g=(e.angle*(180/Math.PI)+180)%360;this._writeGlyphs(s,t,h,c,n,0,i,{clipAngle:u,mapAligned:!0,isLineLabel:!0,minZoom:r}),this._writeGlyphs(s,t,h,c,n,0,i,{clipAngle:g,mapAligned:!0,isLineLabel:!0,minZoom:r}),s.metricEnd()}_placeCurved(e,r,s){const{out:t,id:n}=this._current,i=e.clone(),h=e.angle*(180/Math.PI)%360,c=(e.angle*(180/Math.PI)+180)%360,d=(0,V.jL)(n);t.metricStart(new j.O(d,e.x,e.y,0,0,this.evaluatedMeshParams.scaleInfo?.maxScale??0,this.evaluatedMeshParams.scaleInfo?.minScale??0,null)),this._verticalPlacement&&this._verticalPlacement!==this._current.offsetDirection||(this._placeFirst(i,r,1,h),this._placeBack(e,i,r,s,1,h),this._placeForward(e,i,r,s,1,h)),this._verticalPlacement&&this._verticalPlacement===this._current.offsetDirection||(this._placeFirst(i,r,0,c),this._placeBack(e,i,r,s,0,c),this._placeForward(e,i,r,s,0,c)),t.metricEnd()}_placeStraightAlong(e,r){const{out:s,id:t,shaping:n,zoomRange:i,referenceBounds:h}=this._current,{boxBorderLineColor:c,boxBackgroundColor:d}=this.evaluatedMeshParams,l=e.clone(),a=e.angle*(180/Math.PI)%360,u=(e.angle*(180/Math.PI)+180)%360;if(n.glyphs.length>0&&(c||d)){const f=Math.max(r,i[0],0),v=Math.min(Z.PW,i[1]),y=(0,Y.Us)((0,J.Ue)(),-e.angle),M={minZoom:f,maxZoom:v,clipAngle:a,mapAligned:!0,isLineLabel:!0},E=(0,$.F2)(this.evaluatedMeshParams.offsetX),b=(0,$.F2)(this.evaluatedMeshParams.offsetY);if(!this._verticalPlacement||this._verticalPlacement===this._current.offsetDirection){const _=(0,ae.al)(E,-1*b),[L,w]=n.shapeBackground((0,Y.Iu)((0,J.Ue)(),y,_));s.recordStart(this.instanceId,this.attributeLayout,n.glyphs[0].textureBinding);const C=2*Math.max(L.width,L.height);s.recordBounds(e.x+L.x,e.y+L.y,C,C),this._writeTextBox(s,t,e.x,e.y,w,h,M),s.recordEnd()}if(!this._verticalPlacement||this._verticalPlacement!==this._current.offsetDirection){const _=(0,ae.al)(E,b),[L,w]=n.shapeBackground((0,Y.Iu)((0,J.Ue)(),y,_));M.clipAngle=u,s.recordStart(this.instanceId,this.attributeLayout,n.glyphs[0].textureBinding);const C=2*Math.max(L.width,L.height);s.recordBounds(e.x+L.x,e.y+L.y,C,C),this._writeTextBox(s,t,e.x,e.y,w,h,M),s.recordEnd()}}const g=(0,V.jL)(t);s.metricStart(new j.O(g,e.x,e.y,0,0,this.evaluatedMeshParams.scaleInfo?.maxScale??0,this.evaluatedMeshParams.scaleInfo?.minScale??0,null)),this._verticalPlacement&&this._verticalPlacement!==this._current.offsetDirection||this._placeFirst(l,r,1,a,!0),this._verticalPlacement&&this._verticalPlacement===this._current.offsetDirection||this._placeFirst(l,r,0,u,!0),s.metricEnd()}_placeBack(e,r,s,t,n,i){const h=e.clone();let c=e.backwardLength+0;for(;h.prev()&&!(c>=t);)this._placeOnSegment(h,r,c,s,-1,n,i),c+=h.length+0}_placeForward(e,r,s,t,n,i){const h=e.clone();let c=e.remainingLength+0;for(;h.next()&&!(c>=t);)this._placeOnSegment(h,r,c,s,1,n,i),c+=h.length+0}_placeFirst(e,r,s,t,n=!1){const{out:i,id:h,shaping:c,zoomRange:d,referenceBounds:l}=this._current,a=c.glyphs;for(const u of a){const g=u.x>c.bounds.x?s:1-s,x=g*e.remainingLength+(1-g)*e.backwardLength,m=Math.abs(u.x+u.width/2-c.bounds.x),f=Math.max(0,this._zoomLevel+Math.log2(m/(x+0))),v=Math.max(r,n?0:f);u.maxZoom=Math.min(d[1],Z.PW),u.angle=e.angle+(1-s)*Math.PI,u.minZoom=Math.max(d[0],v),this._writeLineGlyph(i,h,e.x,e.y,c.bounds,u,t,l,!0),s&&this._isVisible(u.minZoom,u.maxZoom)&&i.metricBoxWrite(u.bounds)}}_placeOnSegment(e,r,s,t,n,i,h){const{out:c,id:d,shaping:l,referenceBounds:a}=this._current,u=l.glyphs,m={x:e.x+s*-n*(e.dx/e.length),y:e.y+s*-n*(e.dy/e.length)};for(const f of u){const v=f.x>l.bounds.x?i:1-i;if(!(v&&1===n||!v&&-1===n))continue;const y=Math.abs(f.x+f.width/2-l.bounds.x),M=Math.max(0,this._zoomLevel+Math.log2(y/s)-.1),E=Math.max(t,this._zoomLevel+Math.log2(y/(s+e.length+0)));if(0!==M&&(f.angle=e.angle+(1-i)*Math.PI,f.minZoom=E,f.maxZoom=M,this._writeLineGlyph(c,d,m.x,m.y,l.bounds,f,h,a,!0),i&&this._isVisible(f.minZoom,f.maxZoom))){const b=f.bounds,w=new xe.Z(b.center[0]+(e.x-r.x),b.center[1]+(e.y-r.y),b.width,b.height);c.metricBoxWrite(w)}}}_writeLineGlyph(e,r,s,t,n,i,h,c,d){const l=s+n.x,a=t+n.y,u=2*(this.evaluatedMeshParams.minPixelBuffer?this.evaluatedMeshParams.minPixelBuffer/this._textMeshTransformProps.fontSize:1),g=Math.max(n.width,n.height)*u;e.recordStart(this.instanceId,this.attributeLayout,i.textureBinding),e.recordBounds(l,a,g,g);const{texcoords:x,offsets:m}=i;this._writeQuad(e,r,s,t,{texcoords:x,offsets:m,fontSize:this._textMeshTransformProps.fontSize,color:(0,me.G7)(this.evaluatedMeshParams.color),isBackground:!1,referenceBounds:c,minZoom:Math.max(this._current.zoomRange[0],i.minZoom),maxZoom:Math.min(this._current.zoomRange[1],i.maxZoom),clipAngle:h,mapAligned:d,isLineLabel:!0}),e.recordEnd()}_isVisible(e,r){const s=this._zoomLevel;return e<=s&&s<=r}}function fe(o,e,r){const{coords:s,lengths:t}=e,n=(0,D.Ue)(),i=(0,D.Ue)(),h=(0,D.Ue)(),c=(0,D.Ue)(),d=(0,D.Ue)(),l=(0,D.Ue)();let u=0;for(let g=0;g<t.length;g++){const x=t[g];for(let m=0;m<x;m++){const f=2*(m+u-1),v=2*(m+u),y=2*(m+u+1);m>0?(0,I.t8)(n,s[f],s[f+1]):(0,I.t8)(n,0,0),(0,I.t8)(i,s[v],s[v+1]),m<x-1?(0,I.t8)(h,s[y],s[y+1]):(0,I.t8)(h,0,0),0===m?(0,I.t8)(c,0,0):((0,I.lu)(c,i,n),(0,I.Fv)(c,c),(0,I.t8)(c,c[1],-c[0])),m===x-1?(0,I.t8)(d,0,0):((0,I.lu)(d,h,i),(0,I.Fv)(d,d),(0,I.t8)(d,d[1],-d[0])),(0,I.IH)(l,c,d),(0,I.Fv)(l,l);const M=l[0]*d[0]+l[1]*d[1];0!==M&&(0,I.bA)(l,l,M),(0,I.bA)(l,l,r),o.coords.push(i[0]+l[0],i[1]+l[1])}o.lengths.push(x),u+=x}return o}var Se=p(98201),Ee=p(36397),ze=p(82758),H=p(57678),Be=p(57964),Ae=p(34222),De=p(4703),We=p(46988),Fe=p(51059),Oe=p(86497);function X(o,e){return se.apply(this,arguments)}function se(){return(se=(0,S.Z)(function*(o,e,r=!1){const{defaultValue:s,valueExpressionInfo:t,value:n}=e;if(t){const{expression:i}=t,h=yield o.createComputedField({expression:i},r);return h?{...e,computed:h,defaultValue:s}:null}return{...e,computed:new Oe.J(n),defaultValue:s}})).apply(this,arguments)}function pe(o,e){return re.apply(this,arguments)}function re(){return(re=(0,S.Z)(function*(o,e){const{defaultValue:r,valueExpressionInfo:s}=e,{expression:t}=s,n=yield o.createComputedField({expression:t});return n?{...e,computed:n,defaultValue:r}:null})).apply(this,arguments)}const ge=o=>"boolean"!=typeof o&&"number"!=typeof o&&"valueExpressionInfo"in o;class ne{static create(e,r,s){return(0,S.Z)(function*(){const t={},n=new Map,i=new Map,h=new Map,c=new Map,d=new Map;for(const l in s){const a=s[l];if(null!=a&&"object"==typeof a)if(Array.isArray(a)){if("object"==typeof a[0])throw new Error(`InternalError: Cannot handle ${l}. Nested array params are not supported`);t[l]=a}else if("valueExpressionInfo"in a){if(a.value){t[l]=a.value;continue}const u=yield pe(e,a);if(!u){t[l]=a.defaultValue;continue}n.set(l,u),t[l]=null}else switch(a.type){case"cim-effect-infos":if(a.effectInfos.some(u=>u.overrides.length)){i.set(l,{effects:yield Promise.all(a.effectInfos.map(function(){var u=(0,S.Z)(function*(g){const x=g.overrides.map(m=>X(e,m));return{effect:g.effect,compiledOverrides:(yield Promise.all(x)).filter(H.pC)}});return function(g){return u.apply(this,arguments)}}()))});break}t[l]=a.effectInfos.map(u=>u.effect);break;case"cim-marker-placement-param":a.overrides.length&&h.set(l,{placementInfo:a,compiledOverrides:(yield Promise.all(a.overrides.map(u=>X(e,u)))).filter(H.pC)}),t[l]=a.placement;break;case"text-rasterization-param":{if(a.overrides.length){const g=a.overrides.map(x=>X(e,x,a.useLegacyLabelEvaluationRules));c.set(l,{compiledOverrides:(yield Promise.all(g)).filter(H.pC),rasterizationParam:a,objectIdToResourceId:new Map});continue}const u={type:"cim-rasterization-info",resource:a.resource};t[l]=(yield r.fetchResourceImmediate(u))??null;break}case"sprite-rasterization-param":{if(a.overrides.length){const g=a.overrides.map(x=>X(e,x));c.set(l,{compiledOverrides:(yield Promise.all(g)).filter(H.pC),rasterizationParam:a,objectIdToResourceId:new Map});continue}if("animated"===a.resource.type){c.set(l,{compiledOverrides:[],rasterizationParam:a,objectIdToResourceId:new Map});continue}const u={type:"cim-rasterization-info",resource:a.resource};t[l]=(yield r.fetchResourceImmediate(u))??null;break}case"cim-marker-transform-param":{const{params:u}=a;if(u.some(e=>{for(const r in e)if(ge(e[r]))return!0;return!1})){const g={compiledMarkerInfos:[]};yield Promise.all(u.map(function(){var x=(0,S.Z)(function*(m){const f={props:{}};for(const v in m)if(ge(m[v])){const y=yield pe(e,m[v]);f.compiledExpressionMap||(f.compiledExpressionMap=new Map),y&&f.compiledExpressionMap.set(v,y)}else f.props[v]=m[v];g.compiledMarkerInfos.push(f)});return function(m){return x.apply(this,arguments)}}())),d.set(l,g)}else t[l]={type:"cim-marker-transform-info",infos:u};break}default:t[l]=a}else t[l]=a}return new ne(s,t,n,i,h,c,d)})()}constructor(e,r,s,t,n,i,h){this.inputMeshParams=e,this._resolvedMeshParams=r,this._dynamicProperties=s,this._dynamicEffectProperties=t,this._dynamicPlacementProperties=n,this._dynamicAsyncProperties=i,this._dynamicTransformProperties=h,this.evaluator=c=>c}get hasDynamicProperties(){return!!(this._dynamicProperties.size||this._dynamicAsyncProperties.size||this._dynamicEffectProperties.size||this._dynamicTransformProperties.size||this._dynamicPlacementProperties.size)}get evaluatedMeshParams(){return this._evaluatedMeshParams||(this._evaluatedMeshParams=this.evaluator(this._resolvedMeshParams)),this._evaluatedMeshParams}enqueueRequest(e,r,s){for(const t of this._dynamicAsyncProperties.values()){const n=(0,Ae.d9)(t.rasterizationParam.resource);"animated"===t.rasterizationParam.resource.type&&t.rasterizationParam.resource.randomizeStartTime&&(n.primitiveName="__RESERVED__PRIMITIVE__NAME__",n.startGroup=(0,We.c)(r.getObjectId()||0));for(const{primitiveName:h,propertyName:c,computed:d,defaultValue:l,valueExpressionInfo:a}of t.compiledOverrides)try{(0,Fe.mx)(n,"animated"===t.rasterizationParam.resource.type?n.primitiveName:h,c,d,r,s,l)}catch(u){De.Z.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.mesh.MeshWriterInputEvaluator").errorOnce(new Be.Z("invalid-arcade-expression",`Encountered an error when evaluating the arcade expression '${a?.expression}' (primitive: '${h}', property: '${c}')`,u))}const i=e.enqueueRequest({type:"cim-rasterization-info",resource:n});t.objectIdToResourceId.set(r.getObjectId(),i)}}evaluateMeshParams(e,r,s){for(const[t,n]of this._dynamicProperties.entries())this._resolvedMeshParams[t]=n.computed.readWithDefault(r,s,n.defaultValue);for(const[t,n]of this._dynamicPlacementProperties.entries())for(const{computed:i,defaultValue:h,propertyName:c}of n.compiledOverrides){const d=i.readWithDefault(r,s,h);n.placementInfo.placement[c]=d,this._resolvedMeshParams[t]=n.placementInfo.placement}for(const[t,n]of this._dynamicEffectProperties.entries())for(const i of n.effects){for(const{computed:h,defaultValue:c,propertyName:d}of i.compiledOverrides){const l=h.readWithDefault(r,s,c);i.effect[d]=l}this._resolvedMeshParams[t]=n.effects.map(h=>h.effect)}for(const[t,n]of this._dynamicTransformProperties.entries()){const i={type:"cim-marker-transform-info",infos:[]};for(const h of n.compiledMarkerInfos){const c={...h.props};if(h.compiledExpressionMap)for(const[d,l]of h.compiledExpressionMap){const a=l.computed.readWithDefault(r,s,l.defaultValue);c[d]="number"==typeof a||"boolean"==typeof a?a:l.defaultValue}i.infos.push(c)}this._resolvedMeshParams[t]=i}for(const[t,n]of this._dynamicAsyncProperties.entries()){const i=n.objectIdToResourceId.get(r.getObjectId());if(null==i)continue;const h=e.getResource(i);this._resolvedMeshParams[t]=h}return this._evaluatedMeshParams=this.evaluator(this._resolvedMeshParams),this.evaluatedMeshParams}}var Ce=p(79484);class Ge{createMeshWriter(e,r,s,t){var n=this;return(0,S.Z)(function*(){const i=n._getMeshWriter(t.techniqueType),h=yield ne.create(e,r,t.inputParams),c=new i(t.id,h,t.optionalAttributes,s);return yield c.loadDependencies(),c})()}_getMeshWriter(e){switch(e){case P.t.Fill:return B.Q;case P.t.DotDensity:return G.Z;case P.t.ComplexFill:return z.h5;case P.t.PatternFill:return A.H;case P.t.OutlineFill:return R.nT;case P.t.PatternOutlineFill:return U.i;case P.t.ComplexOutlineFill:return O.f;case P.t.Marker:return ze.A;case P.t.PieChart:return Ce.q;case P.t.Text:return Z.lW;case P.t.Line:return Se.ti;case P.t.TexturedLine:return Ee.I;case P.t.Heatmap:return ve.E;case P.t.Label:return we;case P.t.Test:throw new Error("Internal Error: Found invalid mesh writer")}}}},86497:(ie,F,p)=>{p.d(F,{J:()=>P});var S=p(66572);class P extends S.X{constructor(z){super(),this._value=z}resize(z){}read(z,O){return this._value}readWithDefault(z,O,B){return this._value}referencesScale(){return!1}referencesGeometry(){return!1}}}}]);