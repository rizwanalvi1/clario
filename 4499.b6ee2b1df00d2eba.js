"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[4499],{84499:(N,x,e)=>{e.r(x),e.d(x,{default:()=>G});var M,I=e(15861),n=e(50484),R=(e(2189),e(66476)),u=e(57964),L=e(84303),U=e(3233),o=e(80543),w=(e(14007),e(4703),e(65311),e(10141)),b=e(43814),O=e(26894),A=e(45425),y=e(95060),Z=e(19855),W=e(25836),K=e(29717),S=e(53715),j=e(30220);const C=new(e(74901).f)("0/0/0",0,0,0,void 0);let T=M=class extends((0,Z.h7)((0,K.M)((0,W.Q)(y.Z)))){constructor(){super(...arguments),this.tileInfo=j.Z.create({spatialReference:b.Z.WebMercator,size:256}),this.type="base-tile",this.fullExtent=new O.Z(-20037508.342787,-20037508.34278,20037508.34278,20037508.342787,b.Z.WebMercator),this.spatialReference=b.Z.WebMercator}getTileBounds(s,d,l,p){const g=p||(0,A.Ue)();return C.level=s,C.row=d,C.col=l,C.extent=g,this.tileInfo.updateTileInfo(C),C.extent=void 0,g}fetchTile(s,d,l,p={}){const{signal:g}=p,c=this.getTileUrl(s,d,l),D={responseType:"image",signal:g,query:{...this.refreshParameters}};return(0,R.Z)(c??"",D).then(z=>z.data)}fetchImageBitmapTile(s,d,l,p={}){var g=this;return(0,I.Z)(function*(){const{signal:c}=p;if(g.fetchTile!==M.prototype.fetchTile){const Q=yield g.fetchTile(s,d,l,p);return(0,S.V)(Q,s,d,l,c)}const D=g.getTileUrl(s,d,l)??"",z={responseType:"blob",signal:c,query:{...g.refreshParameters}},{data:H}=yield(0,R.Z)(D,z);return(0,S.V)(H,s,d,l,c)})()}getTileUrl(){throw new u.Z("basetilelayer:gettileurl-not-implemented","getTileUrl() is not implemented")}};(0,n._)([(0,o.Cb)({type:j.Z})],T.prototype,"tileInfo",void 0),(0,n._)([(0,o.Cb)({type:["show","hide"]})],T.prototype,"listMode",void 0),(0,n._)([(0,o.Cb)({readOnly:!0,value:"base-tile"})],T.prototype,"type",void 0),(0,n._)([(0,o.Cb)({nonNullable:!0})],T.prototype,"fullExtent",void 0),(0,n._)([(0,o.Cb)()],T.prototype,"spatialReference",void 0),T=M=(0,n._)([(0,w.j)("esri.layers.BaseTileLayer")],T);const $=T;var E=e(80099),i=e(8321),r=e(44107);const a=new L.X({BingMapsAerial:"aerial",BingMapsRoad:"road",BingMapsHybrid:"hybrid"});let t=class extends((0,Z.h7)((0,E.q)((0,U.R)($)))){constructor(s){super(s),this.type="bing-maps",this.tileInfo=new j.Z({size:[256,256],dpi:96,origin:new r.Z({x:-20037508.342787,y:20037508.342787,spatialReference:b.Z.WebMercator}),spatialReference:b.Z.WebMercator,lods:[new i.Z({level:1,resolution:78271.5169639999,scale:295828763.795777}),new i.Z({level:2,resolution:39135.7584820001,scale:147914381.897889}),new i.Z({level:3,resolution:19567.8792409999,scale:73957190.948944}),new i.Z({level:4,resolution:9783.93962049996,scale:36978595.474472}),new i.Z({level:5,resolution:4891.96981024998,scale:18489297.737236}),new i.Z({level:6,resolution:2445.98490512499,scale:9244648.868618}),new i.Z({level:7,resolution:1222.99245256249,scale:4622324.434309}),new i.Z({level:8,resolution:611.49622628138,scale:2311162.217155}),new i.Z({level:9,resolution:305.748113140558,scale:1155581.108577}),new i.Z({level:10,resolution:152.874056570411,scale:577790.554289}),new i.Z({level:11,resolution:76.4370282850732,scale:288895.277144}),new i.Z({level:12,resolution:38.2185141425366,scale:144447.638572}),new i.Z({level:13,resolution:19.1092570712683,scale:72223.819286}),new i.Z({level:14,resolution:9.55462853563415,scale:36111.909643}),new i.Z({level:15,resolution:4.77731426794937,scale:18055.954822}),new i.Z({level:16,resolution:2.38865713397468,scale:9027.977411}),new i.Z({level:17,resolution:1.19432856685505,scale:4513.988705}),new i.Z({level:18,resolution:.597164283559817,scale:2256.994353}),new i.Z({level:19,resolution:.298582141647617,scale:1128.497176}),new i.Z({level:20,resolution:.1492910708238085,scale:564.248588})]}),this.key=null,this.style="road",this.culture="en-US",this.region=null,this.portalUrl=null,this.hasAttributionData=!0}get bingMetadata(){return this._get("bingMetadata")}set bingMetadata(s){this._set("bingMetadata",s)}get copyright(){return null!=this.bingMetadata?this.bingMetadata.copyright:null}get operationalLayerType(){return a.toJSON(this.style)}get bingLogo(){return null!=this.bingMetadata?this.bingMetadata.brandLogoUri:null}load(s){return this.addResolvingPromise(this.key?this._getMetadata():this.portalUrl?this._getPortalBingKey().then(()=>this._getMetadata()):Promise.reject(new u.Z("bingmapslayer:load","Bing layer must have bing key."))),Promise.resolve(this)}getTileUrl(s,d,l){if(!this.loaded||null==this.bingMetadata)return null;const p=this.bingMetadata.resourceSets[0].resources[0],g=p.imageUrlSubdomains[d%p.imageUrlSubdomains.length],c=this._getQuadKey(s,d,l);return p.imageUrl.replace("{subdomain}",g).replace("{quadkey}",c)}fetchAttributionData(){var s=this;return(0,I.Z)(function*(){return s.load().then(()=>null==s.bingMetadata?null:{contributors:s.bingMetadata.resourceSets[0].resources[0].imageryProviders.map(d=>({attribution:d.attribution,coverageAreas:d.coverageAreas.map(l=>({zoomMin:l.zoomMin,zoomMax:l.zoomMax,score:1,bbox:[l.bbox[0],l.bbox[1],l.bbox[2],l.bbox[3]]}))}))})})()}_getMetadata(){return(0,R.Z)(`https://dev.virtualearth.net/REST/v1/Imagery/Metadata/${{road:"roadOnDemand",aerial:"aerial",hybrid:"aerialWithLabelsOnDemand"}[this.style]}`,{responseType:"json",query:{include:"ImageryProviders",uriScheme:"https",key:this.key,suppressStatus:!0,output:"json",culture:this.culture,userRegion:this.region}}).then(d=>{const l=d.data;if(200!==l.statusCode)throw new u.Z("bingmapslayer:getmetadata",l.statusDescription);if(this.bingMetadata=l,0===this.bingMetadata.resourceSets.length)throw new u.Z("bingmapslayer:getmetadata","no bing resourcesets");if(0===this.bingMetadata.resourceSets[0].resources.length)throw new u.Z("bingmapslayer:getmetadata","no bing resources")}).catch(d=>{throw new u.Z("bingmapslayer:getmetadata",d.message)})}_getPortalBingKey(){return(0,R.Z)(this.portalUrl??"",{responseType:"json",authMode:"no-prompt",query:{f:"json"}}).then(s=>{if(!s.data.bingKey)throw new u.Z("bingmapslayer:getportalbingkey","The referenced Portal does not contain a valid bing key");this.key=s.data.bingKey}).catch(s=>{throw new u.Z("bingmapslayer:getportalbingkey",s.message)})}_getQuadKey(s,d,l){let p="";for(let g=s;g>0;g--){let c=0;const D=1<<g-1;l&D&&(c+=1),d&D&&(c+=2),p+=c.toString()}return p}};(0,n._)([(0,o.Cb)({json:{read:!1,write:!1},value:null})],t.prototype,"bingMetadata",null),(0,n._)([(0,o.Cb)({json:{read:!1,write:!1},value:"bing-maps",readOnly:!0})],t.prototype,"type",void 0),(0,n._)([(0,o.Cb)({type:j.Z})],t.prototype,"tileInfo",void 0),(0,n._)([(0,o.Cb)({type:String,readOnly:!0,json:{read:!1,write:!1}})],t.prototype,"copyright",null),(0,n._)([(0,o.Cb)({type:String,json:{write:!1,read:!1}})],t.prototype,"key",void 0),(0,n._)([(0,o.Cb)({type:a.apiValues,nonNullable:!0,json:{read:{source:"layerType",reader:a.read}}})],t.prototype,"style",void 0),(0,n._)([(0,o.Cb)({type:["BingMapsAerial","BingMapsHybrid","BingMapsRoad"]})],t.prototype,"operationalLayerType",null),(0,n._)([(0,o.Cb)({type:String,json:{write:!1,read:!1}})],t.prototype,"culture",void 0),(0,n._)([(0,o.Cb)({type:String,json:{write:!1,read:!1}})],t.prototype,"region",void 0),(0,n._)([(0,o.Cb)({type:String,json:{write:!0,read:!0}})],t.prototype,"portalUrl",void 0),(0,n._)([(0,o.Cb)({type:Boolean,json:{write:!1,read:!1}})],t.prototype,"hasAttributionData",void 0),(0,n._)([(0,o.Cb)({type:String,readOnly:!0})],t.prototype,"bingLogo",null),t=(0,n._)([(0,w.j)("esri.layers.BingMapsLayer")],t);const G=t},25836:(N,x,e)=>{e.d(x,{Q:()=>i});var I=e(15861),n=e(50484),R=(e(14007),e(4703)),u=e(79412),L=e(80543),U=e(73018),v=(e(65311),e(10141)),f=e(76215),m=e(83944),A=(e(37636),e(57964),e(12926),e(43571));const y=new m.Z,Z=new WeakMap;function j(r,a){return Number.isFinite(r)&&Number.isFinite(a)?a<=0?r:j(a,r%a):0}let B=0,M=0;function C(){const r=Date.now();let a=!1;for(const h of y){const t=h.deref();t?t.refreshInterval&&r-(Z.get(t)??0)+5>=6e4*t.refreshInterval&&(Z.set(t,r),t.refresh(r)):a=!0}if(a)for(let h=y.length-1;h>=0;h--)y.at(h).deref()||y.removeAt(h)}(0,A.EH)(()=>{const r=Date.now();let a=0;for(const h of y){const t=h.deref();t&&(a=j(Math.round(6e4*t.refreshInterval),a),t.refreshInterval?Z.get(t)||Z.set(t,r):Z.delete(t))}if(a!==M){if(M=a,clearInterval(B),0===M)return void(B=0);B=setInterval(C,M)}});const i=r=>{let a=class extends r{constructor(...h){super(...h),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,u.Ds)(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||function W(r){(function S(r){return null!=r&&"object"==typeof r&&"refreshInterval"in r&&"refresh"in r})(r)&&y.push(new WeakRef(r))}(this)},()=>{})}destroy(){!function K(r){const a=y.find(h=>h.deref()===r);a&&y.remove(a)}(this)}castRefreshInterval(h){return h>=.1?h:h<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(h=Date.now()){(0,u.R8)(this._debounceHasDataChanged()).then(t=>{t&&this._set("refreshTimestamp",h),this.emit("refresh",{dataChanged:t})},t=>{R.Z.getLogger(this).error(t),this.emit("refresh",{dataChanged:!1,error:t})})}hasDataChanged(){return(0,I.Z)(function*(){return!0})()}get test(){}};return(0,n._)([(0,L.Cb)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:f.C}}}}})],a.prototype,"refreshInterval",void 0),(0,n._)([(0,U.p)("refreshInterval")],a.prototype,"castRefreshInterval",null),(0,n._)([(0,L.Cb)({readOnly:!0})],a.prototype,"refreshTimestamp",void 0),(0,n._)([(0,L.Cb)({readOnly:!0})],a.prototype,"refreshParameters",null),a=(0,n._)([(0,v.j)("esri.layers.mixins.RefreshableLayer")],a),a}},53715:(N,x,e)=>{e.d(x,{V:()=>L,g:()=>R});var I=e(15861),n=e(57964),P=e(79412);function R(o,v,f){return u.apply(this,arguments)}function u(){return(u=(0,I.Z)(function*(o,v,f){let m;try{m=yield createImageBitmap(o)}catch(w){throw new n.Z("request:server",`Unable to load ${v}`,{url:v,error:w})}return(0,P.k_)(f),m})).apply(this,arguments)}function L(o,v,f,m,w){return U.apply(this,arguments)}function U(){return(U=(0,I.Z)(function*(o,v,f,m,w){let b;try{b=yield createImageBitmap(o)}catch(O){throw new n.Z("request:server",`Unable to load tile ${v}/${f}/${m}`,{error:O,level:v,row:f,col:m})}return(0,P.k_)(w),b})).apply(this,arguments)}}}]);