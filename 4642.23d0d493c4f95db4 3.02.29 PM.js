"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[4642],{657:(k,L,_)=>{_.d(L,{$c:()=>W,Hg:()=>X,jW:()=>g,uD:()=>T});var F=_(73514),z=_(83944),y=_(49301);const h=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function x(l){return l instanceof F.Z}function E(l){return l instanceof z.Z?Object.keys(l.items):x(l)?(0,y.vw)(l).keys():l?Object.keys(l):[]}function C(l,b){return l instanceof z.Z?l.items[b]:l[b]}function M(l){return l?l.declaredClass:null}function o(l,b){const O=l.diff;if(O&&"function"==typeof O)return O(l,b);const Z=E(l),G=E(b);if(0===Z.length&&0===G.length)return;if(!Z.length||!G.length||function R(l,b){return!(!Array.isArray(l)||!Array.isArray(b))&&l.length!==b.length}(l,b))return{type:"complete",oldValue:l,newValue:b};const N=G.filter(S=>!Z.includes(S)),j=Z.filter(S=>!G.includes(S)),a=Z.filter(S=>G.includes(S)&&C(l,S)!==C(b,S)).concat(N,j).sort(),p=M(l);if(p&&h.has(p)&&a.length)return{type:"complete",oldValue:l,newValue:b};let m;const D=x(l)&&x(b);for(const S of a){const v=C(l,S),U=C(b,S);let B;if((D||"function"!=typeof v&&"function"!=typeof U)&&v!==U&&(null!=v||null!=U)){if(O&&O[S]&&"function"==typeof O[S])B=O[S]?.(v,U);else if(v instanceof Date&&U instanceof Date){if(v.getTime()===U.getTime())continue;B={type:"complete",oldValue:v,newValue:U}}else B="object"==typeof v&&"object"==typeof U&&M(v)===M(U)?o(v,U):{type:"complete",oldValue:v,newValue:U};null!=B&&(null!=m?m.diff[S]=B:m={type:"partial",diff:{[S]:B}})}}return m}function g(l,b){return T(l,b)}function T(l,b){if(null==l)return!1;const O=b.split(".");let Z=l;for(const G of O){if("complete"===Z.type)return!0;if("partial"!==Z.type)return!1;{const N=Z.diff[G];if(!N)return!1;Z=N}}return!0}function W(l,b){if(!l)return!1;if("partial"===l.type){const O=Object.keys(l.diff);return 1===O.length&&O[0]===b}return!1}function X(l,b){if("function"!=typeof l&&"function"!=typeof b&&(null!=l||null!=b))return null==l||null==b||"object"==typeof l&&"object"==typeof b&&M(l)!==M(b)?{type:"complete",oldValue:l,newValue:b}:o(l,b)}},62765:(k,L,_)=>{_.d(L,{SI:()=>y,qF:()=>x,s_:()=>h}),_(14007);var z=_(4703);function y(E,C,R){if(null==E)return null;const M=C.readArcadeFeature();C.contextTimeZone=R.$view?.timeZone;try{return E.evaluate({...R,$feature:M},E.services)}catch(o){return z.Z.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",o),null}}function h(E){return null==E||E===1/0||E===-1/0||"number"==typeof E&&isNaN(E)}function x(E,C,R,M){if(null==E)return M??null;const o=C.readArcadeFeature();C.contextTimeZone=R.$view?.timeZone;const g=E.evaluate({...R,$feature:o},E.services);return h(g)?M??null:g}},41267:(k,L,_)=>{_.d(L,{_:()=>R});var F=_(32087),z=_(57354);class h{get length(){return this._pos}constructor(o,g){this._pos=0;const T=g?this._roundToNearest(g,o.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(T),this._buffer=new o(this._array),this._ctor=o,this._i16View=new Int16Array(this._array)}_roundToNearest(o,g){const T=Math.round(o);return 1===g?T:T+(g-T%g)}_ensureSize(o){if(this._pos+o>=this._buffer.length){const g=this._roundToNearest(1.25*(this._array.byteLength+o*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),T=new ArrayBuffer(g),P=new this._ctor(T);P.set(this._buffer,0),this._array=T,this._buffer=P,this._i16View=new Int16Array(this._array)}}ensureSize(o){this._ensureSize(o)}writeF32(o){this._ensureSize(1);const g=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=o,this._pos++,g}push(o){this._ensureSize(1);const g=this._pos;return this._buffer[this._pos++]=o,g}writeFixed(o){this._buffer[this._pos++]=o}setValue(o,g){this._buffer[o]=g}i1616Add(o,g,T){this._i16View[2*o]+=g,this._i16View[2*o+1]+=T}getValue(o){return this._buffer[o]}getValueF32(o){return new Float32Array(this._array,4*o,1)[0]}incr(o){if(this._buffer.length<o)throw new Error("Increment index overflows the target buffer");this._buffer[o]++}decr(o){this._buffer[o]--}writeRegion(o){this._ensureSize(o.length);const g=this._pos;return this._buffer.set(o,this._pos),this._pos+=o.length,g}writeManyFrom(o,g,T){this._ensureSize(T-g);for(let P=g;P!==T;P++)this.writeFixed(o._buffer[P])}buffer(){const o=this._array.slice(0,4*this._pos);return this.destroy(),o}toArray(){return[...this._buffer]}seek(o){this._pos=o}destroy(){this._array=null,this._buffer=null}}class C{constructor(o,g,T=0){const P=6*T*Uint32Array.BYTES_PER_ELEMENT,W=4*T*g.stride,X=g.stride/4,I=g.attributes.find(l=>"pos"===l.name||"position"===l.name);if(!I)throw new Error("InternalError: Unable to find position attribute");this.layout={...g,position:I},this._indices=new h(Uint32Array,P),this._vertices=new h(Uint32Array,W),this._metrics=new h(Uint32Array,0),this._metricCountOffset=this._metrics.push(0),this._strideInt=X,this._instanceId=o}serialize(o){const g=this._indices.buffer(),T=this._vertices.buffer(),P=this._metrics.length?this._metrics.buffer():null;return o.push(g,T),{instanceId:this._instanceId,layout:this.layout,indices:g,vertices:T,metrics:P}}get strideInt(){return this._strideInt}get vertexCount(){return this._vertices.length/this._strideInt}get indexCount(){return this._indices.length}get indexWriter(){return this._indices}get vertexWriter(){return this._vertices}get metricWriter(){return this._metrics}vertexEnsureSize(o){this._vertices.ensureSize(o)}indexEnsureSize(o){this._indices.ensureSize(o)}writeIndex(o){this._indices.push(o)}writeVertex(o){this._vertices.push(o)}writeVertexRegion(o){this._vertices.writeRegion(o)}writeVertexF32(o){this._vertices.writeF32(o)}writeMetric(o){this._metrics.incr(this._metricCountOffset),o.serialize(this._metrics)}}class R{constructor(o,g=0){this._id=o,this._sizeHint=g,this._entityRecordCountOffset=0,this._entityCountOffset=0,this._entityIdIndex=0,this._entitySortKeyIndex=0,this._didEntityStart=!1,this._instanceIdToVertexData=new Map,this._recordIndexStart=0,this._recordIndexCount=0,this._recordVertexStart=0,this._recordVertexCount=0,this._current={metric:null,writer:null,start:0,sortKey:0,instanceId:0,layoutHash:0,indexStart:0,vertexStart:0,textureKey:0,metricBoxLenPointer:0},this._entities=new h(Uint32Array,this._sizeHint*F.Z.byteSizeHint),this._entityCountOffset=this._entities.push(0)}get id(){return this._id}serialize(){const o=new Array,g=[],T=this._entities.buffer();for(const P of this._instanceIdToVertexData.values())g.push(P.serialize(o));return{message:{data:g,entities:T},transferList:o}}vertexCount(){return this._current.writer?.vertexCount??0}indexCount(){return this._current.writer?.indexCount??0}vertexEnsureSize(o){this._current.writer.vertexEnsureSize(o)}indexEnsureSize(o){this._current.writer.indexEnsureSize(o)}vertexWrite(o){this._current.writer.writeVertex(o)}vertexWriteRegion(o){this._current.writer.writeVertexRegion(o)}vertexWriteF32(o){this._current.writer.writeVertexF32(o)}recordBounds(o,g,T,P){}indexWrite(o){this._current.writer.writeIndex(o)}metricStart(o){this._current.metric=o}metricEnd(){this._current.metric.bounds.length&&this._current.writer.writeMetric(this._current.metric)}metricBoxWrite(o){this._current.metric.bounds.push(o)}entityStart(o,g=o){this._entityIdIndex=this._entities.push(o),this._entitySortKeyIndex=this._entities.writeF32(g),this._entityRecordCountOffset=this._entities.push(0),this._didEntityStart=!0}entityRecordCount(){return this._entities.getValue(this._entityRecordCountOffset)}entityEnd(){this._didEntityStart&&(0===this.entityRecordCount()?this._entities.seek(this._entityIdIndex):this._entities.incr(this._entityCountOffset),this._didEntityStart=!1)}recordCount(){return this._entities.getValue(this._entityRecordCountOffset)}recordStart(o,g,T=0){this._current.writer=this._getVertexWriter(o,g),this._current.indexStart=this._current.writer.indexCount,this._current.vertexStart=this._current.writer.vertexCount,this._current.instanceId=o,this._current.layoutHash=g.hash,this._current.textureKey=T}recordEnd(o=0){const g=this._current.vertexStart,T=this._current.writer.vertexCount-g;if(!T)return!1;const P=this._current.indexStart,W=this._current.writer.indexCount-P;return this._recordIndexStart=P,this._recordIndexCount=W,this._recordVertexStart=g,this._recordVertexCount=T,this._entities.incr(this._entityRecordCountOffset),z.Z.write(this._entities,this._current.instanceId,this._current.textureKey,P,W,g,T,o),!0}copyLast(o,g){const T=this._recordVertexStart+this._recordVertexCount;this._entities.incr(this._entityRecordCountOffset),z.Z.write(this._entities,this._current.instanceId,this._current.textureKey,this._recordIndexStart+this._recordIndexCount,this._recordIndexCount,T,this._recordVertexCount,0);const P=this._current.writer.indexWriter,W=this._current.writer.vertexWriter,X=this._recordIndexStart+this._recordIndexCount,I=this._recordVertexCount;for(let p=this._recordIndexStart;p!==X;p++){const m=P.getValue(p);P.push(m+I)}const l=this._current.writer.layout.stride/Uint32Array.BYTES_PER_ELEMENT,O=(this._recordVertexStart+this._recordVertexCount)*l;for(let p=this._recordVertexStart*l;p!==O;p++){const m=W.getValue(p);W.push(m)}const Z=this._current.writer.layout.position,G=Z.packPrecisionFactor??1,N=Z.offset/Uint32Array.BYTES_PER_ELEMENT,j=o*G,a=g*G;for(let p=T*l;p<=W.length;p+=l)W.i1616Add(p+N,j,a)}copyLastFrom(o,g,T){const P=o._entities.getValue(o._entityIdIndex);if(P!==this._entities.getValue(this._entityIdIndex)){const m=o._entities.getValueF32(o._entitySortKeyIndex);this.entityStart(P,m)}this.recordStart(o._current.instanceId,o._current.writer.layout,o._current.textureKey);const W=this._current.writer.layout.stride/Uint32Array.BYTES_PER_ELEMENT,X=this._current.vertexStart,I=o._current.vertexStart-X,l=this._current.writer.indexWriter,b=this._current.writer.vertexWriter,O=o._current.writer.indexWriter,Z=o._current.writer.vertexWriter;for(let m=o._current.indexStart;m!==O.length;m++){const D=O.getValue(m);l.push(D-I)}for(let m=o._current.vertexStart*W;m!==Z.length;m++){const D=Z.getValue(m);b.push(D)}const G=this._current.writer.layout.position,N=G.packPrecisionFactor??1,j=G.offset/Uint32Array.BYTES_PER_ELEMENT,a=g*N,p=T*N;for(let m=X*W;m<=b.length;m+=W)b.i1616Add(m+j,a,p);this.recordEnd()}_getVertexWriter(o,g){const T=this._instanceIdToVertexData;return T.has(o)||T.set(o,new C(o,g,this._sizeHint)),T.get(o)}}},32117:(k,L,_)=>{_.d(L,{f:()=>x});var F=_(15861),z=_(72578),y=_(32196);class h{}class x extends h{constructor(C){super(),this._fetcher=C,this._controller=new AbortController,this._pendingIds=new Set,this._pendingRequests=[],this._resourceIdToResource=new Map}destroy(){this._controller.abort()}get _abortOptions(){return{signal:this._controller.signal}}enqueueRequest(C){const R=(0,y.IS)(C.resource),M=(0,z.hP)(JSON.stringify(R));return this._pendingIds.has(M)||(this._pendingIds.add(M),this._pendingRequests.push({...C,resourceId:M})),M}fetchEnqueuedResources(){var C=this;return(0,F.Z)(function*(){const R=C._pendingRequests;C._pendingIds.clear(),C._pendingRequests=[];const M=yield C._fetcher.fetch(R,C._abortOptions);for(let o=0;o<M.length;o++)C._resourceIdToResource.set(R[o].resourceId,M[o])})()}fetchResourceImmediate(C){var R=this;return(0,F.Z)(function*(){const M=yield R._fetcher.fetch([C],R._abortOptions);if(1!==M.length)throw new Error("FeaturePipelineResourceProxy: failed to fetch resources");return M[0]})()}fetchDictionaryResourceImmediate(C){var R=this;return(0,F.Z)(function*(){const M=yield R._fetcher.fetchDictionary([C],R._abortOptions);if(1!==M.length)throw new Error("FeaturePipelineResourceProxy: failed to fetch dictionary resources");return M[0]})()}getResource(C){return this._resourceIdToResource.get(C)}}},69984:(k,L,_)=>{_.d(L,{t:()=>F});class F{getObjectId(y){return y.getObjectId()}getAttributes(y){return y.readAttributes()}getAttribute(y,h){return y.readAttribute(h)}getAttributeAsTimestamp(y,h){return y.readAttributeAsTimestamp(h)}cloneWithGeometry(y,h){return y}getGeometry(y){return y.readGeometryWorldSpace()}getCentroid(y,h){return y.readCentroidForDisplay()}}F.Shared=new F},66572:(k,L,_)=>{_.d(L,{X:()=>F});class F{destroy(){}}},80680:(k,L,_)=>{_.d(L,{p:()=>N});var F=_(15861),z=_(57964),y=_(14007),h=_(4703),x=_(657),E=_(5633),C=_(99657),R=_(35935),M=_(32196),o=_(90450);class P{constructor(a){this.data=a,this._referenceCount=0}increment(){this._referenceCount+=1}decrement(){this._referenceCount-=1}empty(){return 0===this._referenceCount}}class W{constructor(){this._freeIdsGenerationA=[],this._freeIdsGenerationB=[],this._idCounter=1,this._freeIds=this._freeIdsGenerationA,this._objectIdToDisplayId=new Map}createIdForObjectId(a){let p=this._objectIdToDisplayId.get(a);return p?p.increment():(p=new P((0,R.QS)(this._getFreeId(),!1)),p.increment(),this._objectIdToDisplayId.set(a,p)),p.data}releaseIdForObjectId(a){const p=this._objectIdToDisplayId.get(a);p&&(p.decrement(),p.empty()&&(this._objectIdToDisplayId.delete(a),this._freeIds.push(p.data)))}releaseAll(){for(const a of this._objectIdToDisplayId.values())this._freeIds.push(a.data);this._objectIdToDisplayId.clear()}incrementGeneration(){this._freeIds=this._freeIds===this._freeIdsGenerationA?this._freeIdsGenerationB:this._freeIdsGenerationA}_getFreeId(){return this._freeIds.length?this._freeIds.pop():this._idCounter++}}var X=_(91239),I=_(39237);const b=()=>h.Z.getLogger("esri.views.layers.2d.features.support.AttributeStore"),O=(!1,b(),()=>null),Z_sharedArrayBuffer=(0,y.Z)("esri-shared-array-buffer");(0,y.Z)("esri-atomics");class G{constructor(a,p,m){this.size=0,this.texelSize=4,this.dirtyStart=0,this.dirtyEnd=0;const{pixelType:D,layout:S,textureOnly:v}=p;this.textureOnly=v||!1,this.pixelType=D,this.layout=S,this._resetRange(),this.size=a,this.isLocal=m,v||(this.data=this._initData(D,a))}get buffer(){return this.data?.buffer}unsetComponentAllTexels(a,p){const m=this.data;for(let D=0;D<this.size*this.size;D++)m[D*this.texelSize+a]&=~p;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}setComponentAllTexels(a,p){const m=this.data;for(let D=0;D<this.size*this.size;D++)m[D*this.texelSize+a]|=255&p;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}setComponent(a,p,m){const D=this.data;for(const S of m)D[S*this.texelSize+a]|=p,this.dirtyStart=Math.min(this.dirtyStart,S),this.dirtyEnd=Math.max(this.dirtyEnd,S)}setComponentTexel(a,p,m){this.data[m*this.texelSize+a]|=p,this.dirtyStart=Math.min(this.dirtyStart,m),this.dirtyEnd=Math.max(this.dirtyEnd,m)}unsetComponentTexel(a,p,m){this.data[m*this.texelSize+a]&=~p,this.dirtyStart=Math.min(this.dirtyStart,m),this.dirtyEnd=Math.max(this.dirtyEnd,m)}getData(a,p){const m=(0,R.jL)(a);return this.data[m*this.texelSize+p]}setData(a,p,m){const D=(0,R.jL)(a);this.layout&1<<p?null!=this.data&&(this.data[D*this.texelSize+p]=m,this.dirtyStart=Math.min(this.dirtyStart,D),this.dirtyEnd=Math.max(this.dirtyEnd,D)):b().error("mapview-attributes-store","Tried to set a value for a texel's readonly component")}expand(a){if(this.size=a,!this.textureOnly){const p=this._initData(this.pixelType,a);p.set(this.data),this.data=p}}toMessage(){const a=this.dirtyStart,p=this.dirtyEnd,m=this.texelSize;if(a>p)return null;this._resetRange();const S=this.pixelType,v=this.layout;return{start:a,end:p,data:!this.isLocal&&this.data.slice(a*m,(p+1)*m)||null,pixelType:S,layout:v}}_initData(a,p){const m=ArrayBuffer,D=(0,M.UK)(a),S=new D(new m(p*p*4*D.BYTES_PER_ELEMENT));for(let v=0;v<S.length;v+=4)S[v+1]=255;return S}_resetRange(){this.dirtyStart=2147483647,this.dirtyEnd=0}}class N{constructor(a){this._client=a,this._filters=[],this._blocks=new Array,this._attributeComputeInfo=null,this._abortController=new AbortController,this._size=C._8,this._idsToHighlight=new Map,this._referencesScale=!1,this._referencesGeometry=!1,this._initialized=!1,this.version=0,this._idGenerator=new W,this._epoch=1}destroy(){this._abortController.abort()}_initialize(){if(null!=this._blockDescriptors)return;const a=I.Br.FLOAT;O(`Creating AttributeStore ${Z_sharedArrayBuffer?"with":"without"} shared memory`),this._blockDescriptors=[{pixelType:I.Br.UNSIGNED_BYTE,layout:1},{pixelType:I.Br.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:I.Br.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:a,layout:15},{pixelType:a,layout:15},{pixelType:a,layout:15},{pixelType:a,layout:15}],this._blocks=this._blockDescriptors.map(()=>null)}get referencesScale(){return this._referencesScale}get referencesGeometry(){return this._referencesGeometry}get hasHighlight(){return this._idsToHighlight.size>0}createDisplayIdForObjectId(a){return this._idGenerator.createIdForObjectId(a)}releaseDisplayIdForObjectId(a){return this._idGenerator.releaseIdForObjectId(a)}incrementDisplayIdGeneration(){this._idGenerator.incrementGeneration()}releaseAllIds(){this._idGenerator.releaseAll()}update(a,p,m,D,S=0){var v=this;return(0,F.Z)(function*(){const U=(0,x.Hg)(v._schema,a);if(v.version=S,U&&((0,y.Z)("esri-2d-update-debug")&&console.debug(`Version[${S}] AttributeStore.update`,{changed:U}),v._schema=a,v._attributeComputeInfo=null,v._initialize(),null!=a))if(m&&(v._filters=yield Promise.all(a.filters.map(B=>B?X.Z.create({geometryType:m.geometryType,hasM:!1,hasZ:!1,timeInfo:m.timeInfo,fieldsIndex:m.fieldsIndex,spatialReference:D??m.spatialReference,filterJSON:B}):null))),"subtype"!==a.type)v._attributeComputeInfo={isSubtype:!1,map:new Map},yield Promise.all(a.bindings.map(function(){var B=(0,F.Z)(function*(n){const i=yield v._bind(p,n);v._referencesGeometry=v._referencesGeometry||(i?.referencesGeometry()??!1),v._referencesScale=v._referencesScale||(i?.referencesScale()??!1)});return function(n){return B.apply(this,arguments)}}()));else{v._attributeComputeInfo={isSubtype:!0,subtypeField:a.subtypeField,map:new Map},v._referencesScale=!1,v._referencesGeometry=!1;for(const B in a.bindings){const n=a.bindings[B];yield Promise.all(n.map(function(){var i=(0,F.Z)(function*(s){const d=yield v._bind(p,s,parseInt(B,10));v._referencesGeometry=v._referencesGeometry||(d?.referencesGeometry()??!1),v._referencesScale=v._referencesScale||(d?.referencesScale()??!1)});return function(s){return i.apply(this,arguments)}}()))}}})()}setHighlight(a,p){const m=this._getBlock(0);m.unsetComponentAllTexels(0,(1<<E.Oo.length)-1);for(const{displayId:D,highlightFlags:S}of a){if(null==D)continue;const v=(0,R.jL)(D);m.setComponent(0,S,[v])}this._idsToHighlight.clear();for(const{objectId:D,highlightFlags:S}of a)this._idsToHighlight.set(D,S);for(const{objectId:D,highlightFlags:S}of p)this._idsToHighlight.set(D,S)}setData(a,p,m,D){const S=(0,R.jL)(a);this._ensureSizeForTexel(S),this._getBlock(p).setData(a,m,D)}getData(a,p,m){return this._getBlock(p).getData(a,m)}getHighlightFlags(a){return this._idsToHighlight.get(a)||0}unsetAttributeData(a){const p=(0,R.jL)(a);this._getBlock(0).setData(p,0,0)}setAttributeData(a,p,m){const D=(0,R.jL)(a);this._ensureSizeForTexel(D),this._getBlock(0).setData(D,0,this.getFilterFlags(p));const S=this._attributeComputeInfo;let B=null;S&&(B=S.isSubtype?S.map.get(p.readAttribute(S.subtypeField)):S.map,B?.size&&B.forEach((n,i)=>{const s=1*i%4,d=Math.floor(1*i/4),w=this._getBlock(d+C.wi.VV);let A=n.field?.read(p,m);n.valueRepresentation&&(A=function l(j,a){if(!j||!a)return j;switch(a){case"radius":case"distance":return 2*j;case"diameter":case"width":return j;case"area":return Math.sqrt(j)}return j}(A,n.valueRepresentation)),(null===A||isNaN(A)||A===1/0||A===-1/0)&&(A=o.k9),w.setData(D,s,A)}))}get epoch(){return this._epoch}sendUpdates(){const a=this._blocks.map(m=>null!=m?m.toMessage():null),p=this._getInitArgs();(0,y.Z)("esri-2d-log-updating")&&console.log("AttributeStore: _doSendUpdate.start"),this._client.update({initArgs:p,blockData:a,version:this.version,sendUpdateEpoch:this._epoch}),this._epoch+=1,(0,y.Z)("esri-2d-log-updating")&&console.log("AttributeStore: _doSendUpdate.end")}_ensureSizeForTexel(a){for(;a>=this._size*this._size;)if(this._expand())return}_bind(a,p,m){var D=this;return(0,F.Z)(function*(){const S=yield a.createComputedField(p),{valueRepresentation:v}=p,U=D._attributeComputeInfo;if(U.isSubtype){const B=U.map.get(m)??new Map;B.set(p.binding,{field:S,valueRepresentation:v}),U.map.set(m,B)}else U.map.set(p.binding,{field:S,valueRepresentation:v});return S})()}_getInitArgs(){return this._initialized?null:(this._initialized=!0,this._getBlock(C.wi.Animation),this._getBlock(C.wi.GPGPU),{blockSize:this._size,blockDescriptors:this._blocks.map(a=>null!=a?{textureOnly:a.textureOnly,buffer:a.buffer,pixelType:a.pixelType}:null)})}_getBlock(a){const p=this._blocks[a];if(null!=p)return p;O(`Initializing AttributeBlock at index ${a}`);const m=new G(this._size,this._blockDescriptors[a],this._client.isLocal);return this._blocks[a]=m,this._initialized=!1,m}_expand(){if(this._size<this._schema.capabilities.maxTextureSize){const a=this._size<<=1;O("Expanding block size to",a,this._blocks);for(const p of this._blocks)p?.expand(a);return this._initialized=!1,this._size=a,0}return b().error(new z.Z("mapview-limitations","Maximum number of onscreen features exceeded.")),-1}isVisible(a){return!!(this._getBlock(0).getData(a,0)&1<<E.Oo.length)}getFilterFlags(a){let p=0;for(let D=0;D<this._filters.length;D++){const v=this._filters[D];p|=(1<<D&&null!=v&&!v.check(a)?0:1)<<D}let m=0;if(this._idsToHighlight.size){const D=a.getObjectId();m=this.getHighlightFlags(D)}return p<<E.Oo.length|m}}},70158:(k,L,_)=>{_.d(L,{O:()=>U});var F=_(15861),z=_(57964),y=_(4703),h=_(27048),x=_(35935),E=_(66572);class C extends E.X{constructor(n){super(),this._field=n}resize(n){throw new Error("Method not implemented.")}read(n,i){return n.readAttribute(this._field)}readWithDefault(n,i){return n.readAttribute(this._field)}referencesScale(){return!1}referencesGeometry(){return!1}}var R=_(72578),M=_(4978),o=_(62765);class g extends E.X{static create(n,i){return(0,F.Z)(function*(){const s=yield(0,M.Yi)(n,i.spatialReference,i.fields),d=(0,R.hP)(n);return new g(s,d)})()}constructor(n,i){super(),this._compiled=n,this._cacheKey=i}resize(n){}read(n,i){return this.referencesScale()||"system"!==i.$view.timeZone?(0,o.SI)(this._compiled,n,i):this._readCached(n,i)}readWithDefault(n,i,s){return this.referencesScale()||"system"!==i.$view.timeZone?(0,o.qF)(this._compiled,n,i,s):this._readWithDefaultCached(n,i,s)}referencesScale(){return this._compiled?.referencesScale()??!1}referencesGeometry(){return this._compiled?.referencesGeometry()??!1}_readCached(n,i){if(n.setCache(this._cacheKey),n.hasCachedValue())return n.getCachedValue();const s=(0,o.SI)(this._compiled,n,i);return n.setCachedValue(s),s}_readWithDefaultCached(n,i,s){if(n.setCache(this._cacheKey),n.hasCachedValue())return n.getCachedValue();const d=(0,o.qF)(this._compiled,n,i,s);return n.setCachedValue(d),d}}var T=_(94678),P=_(37689),W=_(43647),X=_(85295),I=_(56761);class j extends E.X{static create(n,i){return(0,F.Z)(function*(){const s=(0,I.UG)(n);return new j(d=>s.replaceAll(/{[^}]*}/g,w=>{const A=w.slice(1,-1),H=d.metadata.fieldsIndex.get(A);if(null==H)return w;const V=d.readAttribute(A);return null==V?"":function N(B,n){if(null==B)return"";const i=n.domain;if(i)if("codedValue"===i.type||"coded-value"===i.type){const d=B;for(const w of i.codedValues)if(w.code===d)return w.name}else if("range"===i.type){const{max:d,min:w}=(0,W.D3)(n),A=+B;if(null!=w&&null!=d&&w<=A&&A<=d)return i.name}let s=B;return(0,X.y2)(n)?s=(0,T.p6)(s,(0,T.Ze)("short-date")):(0,X.H7)(n)&&(s=(0,P.uf)(+s)),s||""}(V,H)}))})()}constructor(n){super(),this._evaluator=n}resize(n){}read(n,i){return this._evaluator(n)}readWithDefault(n,i,s){const d=this._evaluator(n);return(0,o.s_)(d)?s:d}referencesScale(){return!1}referencesGeometry(){return!1}}class a extends E.X{constructor(n,i){super(),this._field=n,this._normalizationInfo=i}resize(n){throw new Error("Method not implemented.")}read(n,i){return this._readNormalized(n)}readWithDefault(n,i){return this._readNormalized(n)}referencesScale(){return!1}referencesGeometry(){return!1}_readNormalized(n){const i=n.readAttribute(this._field);if(null==i)return null;const{normalizationField:s,normalizationTotal:d,normalizationType:w}=this._normalizationInfo,A=n.readAttribute(s);switch(w??"esriNormalizeByField"){case"esriNormalizeByField":return A?A?i/A:void 0:null;case"esriNormalizeByLog":return Math.log(i)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return d?i/d*100:null}}}var p=_(84249),m=_(65113);const D=()=>y.Z.getLogger("esri.views.2d.layers.features.support.ComputedAttributeStorage"),S=4294967295;function v(B,n,i){if(!(B.length>n))for(;B.length<=n;)B.push(i)}class U{constructor(n){this._numerics=[],this._strings=[],this._allocatedSize=256,this._bitsets=[],this._instanceIds=[],this._bounds=[],this._dirtyBitset=this.getBitset(this.createBitset()),this.compilationOptions=n}createBitset(){const n=this._bitsets.length;return this._bitsets.push(p.p.create(this._allocatedSize,x.Ht)),n+1}createComputedField(n,i=!1){var s=this;return(0,F.Z)(function*(){if(n.expression)try{if(!s.compilationOptions)throw new Error("InternalError: Compilation options not defined");return i?j.create(n.expression,s.compilationOptions):yield g.create(n.expression,s.compilationOptions)}catch(w){const A=new z.Z("featurelayer","Failed to compile arcade expression",{error:w,expression:n.expression});return D().error(A),null}if(n.normalizationType||n.normalizationField)return new a(n.field,n);if(n.field)return new C(n.field);const d=new z.Z("featurelayer","Unable to create computed field. No expression or field found",{info:n});return D().error(d),null})()}createWhereClause(n){var i=this;return(0,F.Z)(function*(){return n?(0,m.y)(n,i.compilationOptions.fields):null})()}getBitset(n){return this._bitsets[n-1]}getComputedNumeric(n,i){return this.getComputedNumericAtIndex(n&x.Ht,0)}setComputedNumeric(n,i,s){return this.setComputedNumericAtIndex(n&x.Ht,s,0)}getComputedString(n,i){return this.getComputedStringAtIndex(n&x.Ht,0)}setComputedString(n,i,s){return this.setComputedStringAtIndex(n&x.Ht,0,s)}getComputedNumericAtIndex(n,i){const s=n&x.Ht;return this._ensureNumeric(i,s),this._numerics[i][s]}setComputedNumericAtIndex(n,i,s){const d=n&x.Ht;this._ensureNumeric(i,d),this._numerics[i][d]=s}getPackedChunkId(n){const i=n&x.Ht;return this._ensureInstanceId(i),this._instanceIds[i]}setPackedChunkId(n,i){const s=n&x.Ht;this._ensureInstanceId(s),this._instanceIds[s]=i}getComputedStringAtIndex(n,i){const s=n&x.Ht;return this._ensureString(i,s),this._strings[i][s]}setComputedStringAtIndex(n,i,s){const d=n&x.Ht;this._ensureString(i,d),this._strings[i][d]=s}getXMin(n){return this._bounds[4*(n&x.Ht)]}getYMin(n){return this._bounds[4*(n&x.Ht)+1]}getXMax(n){return this._bounds[4*(n&x.Ht)+2]}getYMax(n){return this._bounds[4*(n&x.Ht)+3]}setBounds(n,i,s=!1){const d=n&x.Ht;if(!s&&!this._dirtyBitset.has(n))return this._bounds[4*d]!==S;this._dirtyBitset.unset(n);const w=i.readGeometryWorldSpace();if(v(this._bounds,4*d+4,0),!w||!w.coords.length)return this._bounds[4*d]=S,this._bounds[4*d+1]=S,this._bounds[4*d+2]=S,this._bounds[4*d+3]=S,!1;let A=1/0,H=1/0,V=-1/0,K=-1/0;return w.forEachVertex((Y,J)=>{A=Math.min(A,Y),H=Math.min(H,J),V=Math.max(V,Y),K=Math.max(K,J)}),this._bounds[4*d]=A,this._bounds[4*d+1]=H,this._bounds[4*d+2]=V,this._bounds[4*d+3]=K,!0}getBounds(n,i){const s=this.getXMin(i),d=this.getYMin(i),w=this.getXMax(i),A=this.getYMax(i);return(0,h.bZ)(n,s,d,w,A),s!==S}_ensureNumeric(n,i){this._numerics[n]||(this._numerics[n]=[]),v(this._numerics[n],i,0)}_ensureInstanceId(n){v(this._instanceIds,n,0)}_ensureString(n,i){this._strings[n]||(this._strings[n]=[]),v(this._strings[n],i,null)}}},91239:(k,L,_)=>{_.d(L,{Z:()=>W});var F=_(15861),z=_(57964),y=_(4703),h=_(45425),x=_(43585),E=_(44452),C=_(51089),R=_(21418),M=_(91866),o=_(69984),g=_(65113);class W{constructor(I){this._geometryBounds=(0,h.Ue)(),this._idToVisibility=new Map,this._serviceInfo=I}static create(I){return(0,F.Z)(function*(){const l=new W(I);return yield l.update(I.filterJSON,I.spatialReference),l})()}get hash(){return this._hash}check(I){return this._applyFilter(I)}clear(){const I=this._resetAllHiddenIds();return this.update(),{show:I,hide:[]}}invalidate(){this._idToVisibility.forEach((I,l)=>{this._idToVisibility.set(l,0)})}setKnownIds(I){for(const l of I)this._idToVisibility.set(l,1)}setTrue(I){const l=[],b=[],O=new Set(I);return this._idToVisibility.forEach((Z,G)=>{const N=!!(1&this._idToVisibility.get(G)),j=O.has(G);!N&&j?l.push(G):N&&!j&&b.push(G),this._idToVisibility.set(G,j?3:0)}),{show:l,hide:b}}createQuery(){const{geometry:I,spatialRel:l,where:b,timeExtent:O,objectIds:Z}=this;return M.Z.fromJSON({geometry:I,spatialRel:l,where:b,timeExtent:O,objectIds:Z})}update(I,l){var b=this;return(0,F.Z)(function*(){b._hash=JSON.stringify(I);const O=yield(0,E.j6)(I,null,l);yield Promise.all([b._setGeometryFilter(O),b._setIdFilter(O),b._setAttributeFilter(O),b._setTimeFilter(O)])})()}_setAttributeFilter(I){var l=this;return(0,F.Z)(function*(){if(!I?.where)return l._clause=null,void(l.where=null);l._clause=yield(0,g.y)(I.where,l._serviceInfo.fieldsIndex),l.where=I.where})()}_setIdFilter(I){this._idsToShow=I?.objectIds&&new Set(I.objectIds),this._idsToHide=I?.hiddenIds&&new Set(I.hiddenIds),this.objectIds=I?.objectIds}_setGeometryFilter(I){var l=this;return(0,F.Z)(function*(){if(!I?.geometry)return l._spatialQueryOperator=null,l.geometry=null,void(l.spatialRel=null);const b=I.geometry,O=I.spatialRel||"esriSpatialRelIntersects",Z=yield(0,C.cW)(O,b,l._serviceInfo.geometryType,l._serviceInfo.hasZ,l._serviceInfo.hasM);(0,x.$P)(l._geometryBounds,b),l._spatialQueryOperator=Z,l.geometry=b,l.spatialRel=O})()}_setTimeFilter(I){if(this.timeExtent=this._timeOperator=null,I?.timeExtent)if(this._serviceInfo.timeInfo)this.timeExtent=I.timeExtent,this._timeOperator=(0,R.y)(this._serviceInfo.timeInfo,I.timeExtent,o.t.Shared);else{const l=new z.Z("feature-layer-view:time-filter-not-available","Unable to apply time filter, as layer doesn't have time metadata.",I.timeExtent);y.Z.getLogger("esri.views.2d.layers.features.controllers.FeatureFilter").error(l)}}_applyFilter(I){return this._filterByGeometry(I)&&this._filterById(I)&&this._filterByTime(I)&&this._filterByExpression(I)}_filterByExpression(I){return!this.where||this._clause(I)}_filterById(I){return(!this._idsToHide?.size||!this._idsToHide.has(I.getObjectId()))&&(!this._idsToShow?.size||this._idsToShow.has(I.getObjectId()))}_filterByGeometry(I){if(!this.geometry)return!0;const l=I.readGeometryWorldSpace();return!!l&&this._spatialQueryOperator(l)}_filterByTime(I){return null==this._timeOperator||this._timeOperator(I)}_resetAllHiddenIds(){const I=[];return this._idToVisibility.forEach((l,b)=>{1&l||(this._idToVisibility.set(b,1),I.push(b))}),I}}},37994:(k,L,_)=>{_.d(L,{A:()=>y,m:()=>h});var F=_(43814),z=_(40100);class y{static minimal(E,C,R=[]){return new y({geometryType:E,fields:R,objectIdField:C,subtypes:null,subtypeField:null,types:null,globalIdField:null,spatialReference:null,timeInfo:null,timeReferenceUnknownClient:null,typeIdField:null})}constructor(E){this._options=E,this._fieldsIndex="fieldsIndex"in E?z.Z.fromJSON(E.fieldsIndex):new z.Z(E.fields),E.spatialReference&&(this._spatialReference=F.Z.fromJSON(E.spatialReference)),this._arcadeSchema={fields:this.fieldsIndex.fields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,objectIdField:this.objectIdField,globalIdField:this._options.globalIdField,spatialReference:this._spatialReference,timeInfo:this._options.timeInfo,typeIdField:this._options.typeIdField??void 0,types:this._options.types??void 0,subtypeField:this._options.subtypeField,subtypes:this._options.subtypes??void 0}}get fieldsIndex(){return this._fieldsIndex}get geometryType(){return this._options.geometryType}get subtypeField(){return this._options.subtypeField}get timeInfo(){return this._options.timeInfo}get objectIdField(){return this._options.objectIdField}get globalIdField(){return this._options.globalIdField}get arcadeSchema(){return this._arcadeSchema}get spatialReference(){return this._spatialReference}get timeReferenceUnknownClient(){return this._options.timeReferenceUnknownClient}}class h extends y{static create(E){return new h({fields:[],objectIdField:"uid",geometryType:null,spatialReference:E,globalIdField:null,subtypeField:null,subtypes:null,timeInfo:null,typeIdField:null,types:null,timeReferenceUnknownClient:null})}}},39623:(k,L,_)=>{_.d(L,{j:()=>z});var F=_(84249);class z{constructor(h){this._valid=F.p.create(h),this._data=new Array(h)}has(h){return this._valid.has(h)}set(h,x){this._valid.set(h),this._data[h]=x}get(h){return this._data[h]}}},14050:(k,L,_)=>{_.d(L,{s:()=>B}),_(2189);var z=_(93630),y=_(14007),h=_(51172),x=_(88781),E=_(81429),C=_(7587),R=_(27048),M=_(81321),o=_(70587),g=_(10842),T=_(83502),P=_(62209),W=_(764),X=_(39623),I=_(84249),l=_(40637);const b=(0,y.Z)("featurelayer-simplify-thresholds")??[.5,.5,.5,.5],O=b[0],Z=b[1],G=b[2],N=b[3],j=(0,y.Z)("featurelayer-simplify-payload-size-factors")??[1,2,4],a=j[0],p=j[1],m=j[2],D=(0,y.Z)("featurelayer-simplify-mobile-factor")??2,S=(0,y.Z)("esri-mobile"),v=4294967295;class B{constructor(i){this.metadata=i,this.type="FeatureSetReader",this._deleted=null,this._joined=[],this._objectIdToIndex=null,this._boundsBuffer=[],this._caches=new Map,this.arcadeDeclaredClass="esri.arcade.Feature",this._contextTimeZone=null}get isEmpty(){return null!=this._deleted&&this._deleted.countSet()===this.getSize()}getAreaSimplificationThreshold(i,s){let d=1;const w=S?D:1;s>4e6?d=m*w:s>1e6?d=p*w:s>5e5?d=a*w:s>1e5&&(d=w);let A=0;return i>4e3?A=N*d:i>2e3?A=G*d:i>100?A=Z:i>15&&(A=O),A}parseTimestampOffset(i){return i}getBounds(i){if(function U(n,i,s){if(!(n.length>i))for(;n.length<=i;)n.push(s)}(this._boundsBuffer,4*this.getIndex()+4,0),this.getBoundsXMin()===v)return!1;if(0===this.getBoundsXMin()){const H=this.readGeometryWorldSpace();if(!H)return this.setBoundsXMin(v),!1;let V=1/0,K=1/0,Y=-1/0,J=-1/0;return H.forEachVertex((Q,$)=>{V=Math.min(V,Q),K=Math.min(K,$),Y=Math.max(Y,Q),J=Math.max(J,$)}),this.setBoundsXMin(V),this.setBoundsYMin(K),this.setBoundsXMax(Y),this.setBoundsYMax(J),(0,R.bZ)(i,V,K,Y,J),!0}const s=this.getBoundsXMin(),d=this.getBoundsYMin(),w=this.getBoundsXMax(),A=this.getBoundsYMax();return(0,R.bZ)(i,s,d,w,A),!0}getBoundsXMin(){return this._boundsBuffer[4*this.getIndex()]}setBoundsXMin(i){this._boundsBuffer[4*this.getIndex()]=i}getBoundsYMin(){return this._boundsBuffer[4*this.getIndex()+1]}setBoundsYMin(i){this._boundsBuffer[4*this.getIndex()+1]=i}getBoundsXMax(){return this._boundsBuffer[4*this.getIndex()+2]}setBoundsXMax(i){this._boundsBuffer[4*this.getIndex()+2]=i}getBoundsYMax(){return this._boundsBuffer[4*this.getIndex()+3]}setBoundsYMax(i){this._boundsBuffer[4*this.getIndex()+3]=i}readAttributeAsTimestamp(i){const s=this.readAttribute(i);return"string"==typeof s?new Date(s).getTime():"number"==typeof s||null==s?s:null}readAttribute(i,s=!1){const d=this._readAttribute(i,s);if(void 0!==d)return d;for(const w of this._joined){w.setIndex(this.getIndex());const A=w._readAttribute(i,s);if(void 0!==A)return A}}readAttributes(){const i=this._readAttributes();for(const s of this._joined){s.setIndex(this.getIndex());const d=s._readAttributes();for(const w of Object.keys(d))i[w]=d[w]}return i}joinAttributes(i){this._joined.push(i)}removeIds(i){if(null==this._objectIdToIndex){const d=new Map,w=this.getCursor();for(;w.next();){const A=w.getObjectId();(0,h.O3)(A),d.set(A,w.getIndex())}this._objectIdToIndex=d}const s=this._objectIdToIndex;for(const d of i.values())s.has(d)&&this._removeAtIndex(s.get(d))}readOptimizedFeatureWorldSpace(){const i=this.readGeometryWorldSpace(),s=this.readAttributes(),d=this.readCentroidWorldSpace(),w=new T.u_(i,s,d);return w.objectId=this.getObjectId(),w.displayId=this.getDisplayId(),w}readLegacyFeatureForDisplay(){const i=this.readCentroidForDisplay();return{attributes:this.readAttributes(),geometry:this.readLegacyGeometryForDisplay(),centroid:(i&&{x:i.coords[0],y:i.coords[1]})??null}}readLegacyFeatureWorldSpace(){const i=this.readCentroidWorldSpace();return{attributes:this.readAttributes(),geometry:this._readLegacyGeometryWorldSpace(),centroid:(i&&{x:i.coords[0],y:i.coords[1]})??null}}readLegacyGeometryForDisplay(){const i=this.readGeometryForDisplay();return(0,g.di)(i,this.geometryType,!1,!1)}readXForDisplay(){return this._readX()}readYForDisplay(){return this._readY()}readXWorldSpace(){const i=this._readX(),s=this.getInTransform();return null==s?i:i*s.scale[0]+s.translate[0]}readYWorldSpace(){const i=this._readY(),s=this.getInTransform();return null==s?i:s.translate[1]-i*s.scale[1]}readGeometryForDisplay(){const i=this._readGeometryDeltaDecoded(!0);if(!i){const s=this._createGeometryFromServerCentroid();return s?s.deltaDecode():null}return i}readGeometryWorldSpace(){let i=this._readGeometry();if(i||(i=this._createGeometryFromServerCentroid()),!i)return null;const s=i.clone(),d=this.getInTransform();return null!=d&&(0,g.$g)(s,s,this.hasZ,this.hasM,d),s}readCentroidForDisplay(){const i=this.readGeometryForDisplay();return i?this._computeDisplayCentroid(i):this._readServerCentroid()}readCentroidWorldSpace(){const i=this.readGeometryForDisplay(),s=i?this._computeDisplayCentroid(i):this._readServerCentroid();if(!s)return null;const d=s.clone(),w=this.getInTransform();return null!=w&&(0,g.$g)(d,d,this.hasZ,this.hasM,w),d}setCache(i){let s=this._caches.get(i);null==s&&(s=new X.j(this.getSize()),this._caches.set(i,s)),this._activeCache=s}setCachedValue(i){this._activeCache.set(this.getIndex(),i)}hasCachedValue(){return this._activeCache.has(this.getIndex())}getCachedValue(){return this._activeCache.get(this.getIndex())}_readGeometryDeltaDecoded(i){const s=this._readGeometry(i);return"esriGeometryPoint"!==this.geometryType&&s&&this.getInTransform()?s.deltaDecode():s}get contextTimeZone(){return this._contextTimeZone}set contextTimeZone(i){this._contextTimeZone=i}readArcadeFeature(){return this}hasField(i){return this.fields.has(i)||this._joined.some(s=>s.hasField(i))}geometry(){const i=this.readGeometryWorldSpace(),s=(0,g.di)(i,this.geometryType,this.hasZ,this.hasM),d=(0,l.im)(s);if(d){if(!this.metadata.spatialReference)throw new Error("InternalError: Expected spatial reference to be defined");d.spatialReference=this.metadata.spatialReference}return d}autocastArcadeDate(i,s){return s&&s instanceof Date?this.isUnknownDateTimeField(i)?z.iG.unknownDateJSToArcadeDate(s):z.iG.dateJSAndZoneToArcadeDate(s,this.contextTimeZone??W.By):s}isUnknownDateTimeField(i){return this.metadata.fieldsIndex.getTimeZone(i)===W._4}field(i){let s=this.fields.get(i);if(s)switch(s.type){case"date-only":case"esriFieldTypeDateOnly":return x.u.fromReader(this.readAttribute(i,!1));case"time-only":case"esriFieldTypeTimeOnly":return E.n.fromReader(this.readAttribute(i,!1));case"esriFieldTypeTimestampOffset":case"timestamp-offset":return z.iG.fromReaderAsTimeStampOffset(this.readAttribute(i,!1));case"date":case"esriFieldTypeDate":return this.autocastArcadeDate(i,this.readAttribute(i,!0));default:return this.readAttribute(i,!1)}for(const d of this._joined)if(d.setIndex(this.getIndex()),s=d.fields.get(i),s)switch(s.type){case"date-only":case"esriFieldTypeDateOnly":return x.u.fromReader(d._readAttribute(i,!1));case"time-only":case"esriFieldTypeTimeOnly":return E.n.fromReader(d._readAttribute(i,!1));case"esriFieldTypeTimestampOffset":case"timestamp-offset":return z.iG.fromReaderAsTimeStampOffset(d._readAttribute(i,!1));case"date":case"esriFieldTypeDate":return this.autocastArcadeDate(i,d._readAttribute(i,!0));default:return this.readAttribute(i,!1)}throw new Error(`Field ${i} does not exist`)}setField(i,s){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this.fields.fields.map(i=>i.name)}castToText(i=!1){if(!i)return JSON.stringify(this.readLegacyFeatureForDisplay());const s=this.readLegacyFeatureForDisplay();if(!s)return JSON.stringify(null);const d={geometry:s.geometry,attributes:{...s.attributes??{}}};for(const w in d.attributes){const A=d.attributes[w];A instanceof Date&&(d.attributes[w]=A.getTime())}return JSON.stringify(d)}gdbVersion(){return null}fullSchema(){return this.metadata.arcadeSchema}castAsJson(i=null){return{attributes:this._readAttributes(),geometry:!0===i?.keepGeometryType?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(i=null,s=null){return Promise.resolve(this.castAsJson(s))}_getExists(){return null==this._deleted||!this._deleted.has(this.getIndex())}_computeDisplayCentroid(i){if(null==this.getInTransform())return(0,o.Y)(new P.Z,i,this.hasM,this.hasZ);const s=C.z.fromOptimized(i,this.geometryType);s.yFactor*=-1;const d=(0,M.r)(s);return d?(d[1]*=-1,new P.Z([],d)):null}copyInto(i){i._joined=this._joined,i._deleted=this._deleted,i._objectIdToIndex=this._objectIdToIndex,i._boundsBuffer=this._boundsBuffer,i._activeCache=this._activeCache,i._caches=this._caches,i._contextTimeZone=this._contextTimeZone}_readLegacyGeometryWorldSpace(){const i=this.readGeometryWorldSpace();return(0,g.di)(i,this.geometryType,!1,!1)}_createGeometryFromServerCentroid(){const i=this._readServerCentroid();if(!i)return null;const[s,d]=i.coords;return this._createQuantizedExtrudedGeometry(s,d)}_createQuantizedExtrudedGeometry(i,s){return"esriGeometryPolyline"===this.geometryType?this._createQuantizedExtrudedLine(i,s):this._createQuantizedExtrudedQuad(i,s)}_createQuantizedExtrudedQuad(i,s){return new P.Z([5],[i-1,s,1,-1,1,1,-1,1,-1,-1])}_createQuantizedExtrudedLine(i,s){return new P.Z([2],[i-1,s+1,1,-1])}_removeAtIndex(i){null==this._deleted&&(this._deleted=I.p.create(this.getSize())),this._deleted.set(i)}}},84249:(k,L,_)=>{_.d(L,{p:()=>F});class F{static fromBuffer(y,h){return new F(y,h)}static create(y,h=4294967295){const x=new Uint32Array(Math.ceil(y/32));return new F(x,h)}constructor(y,h){this._mask=0,this._buf=y,this._mask=h}_getIndex(y){return Math.floor(y/32)}has(y){const h=this._mask&y;return!!(this._buf[this._getIndex(h)]&1<<h%32)}hasRange(y,h){let x=y,E=h;for(;x%32&&x!==E;){if(this.has(x))return!0;x++}for(;E%32&&x!==E;){if(this.has(x))return!0;E--}if(x===E)return!1;for(let C=x/32;C!==E/32;C++)if(this._buf[C])return!0;return!1}set(y){const h=this._mask&y,x=this._getIndex(h);this._buf[x]|=1<<h%32}setRange(y,h){let x=y,E=h;for(;x%32&&x!==E;)this.set(x++);for(;E%32&&x!==E;)this.set(E--);if(x!==E)for(let C=x/32;C!==E/32;C++)this._buf[C]=4294967295}unset(y){const h=this._mask&y,x=this._getIndex(h);this._buf[x]&=4294967295^1<<h%32}resize(y){const h=this._buf,x=new Uint32Array(Math.ceil(y/32));x.set(h),this._buf=x}or(y){for(let h=0;h<this._buf.length;h++)this._buf[h]|=y._buf[h];return this}and(y){for(let h=0;h<this._buf.length;h++)this._buf[h]&=y._buf[h];return this}xor(y){for(let h=0;h<this._buf.length;h++)this._buf[h]^=y._buf[h];return this}ior(y){for(let h=0;h<this._buf.length;h++)this._buf[h]|=~y._buf[h];return this}iand(y){for(let h=0;h<this._buf.length;h++)this._buf[h]&=~y._buf[h];return this}ixor(y){for(let h=0;h<this._buf.length;h++)this._buf[h]^=~y._buf[h];return this}any(){for(let y=0;y<this._buf.length;y++)if(this._buf[y])return!0;return!1}copy(y){for(let h=0;h<this._buf.length;h++)this._buf[h]=y._buf[h];return this}clone(){return new F(this._buf.slice(),this._mask)}clear(){for(let y=0;y<this._buf.length;y++)this._buf[y]=0;return this}forEachSet(y){for(let h=0;h<this._buf.length;h++){let x=this._buf[h],E=32*h;if(x)for(;x;)1&x&&y(E),x>>>=1,E++}}countSet(){let y=0;return this.forEachSet(h=>{y++}),y}}},65113:(k,L,_)=>{_.d(L,{y:()=>C});var F=_(15861),z=_(57964),y=_(4703),h=_(38955);const x=()=>y.Z.getLogger("esri.views.2d.layers.features.support.whereUtils"),E={getAttribute:(M,o)=>M.readAttribute(o)};function C(M,o){return R.apply(this,arguments)}function R(){return(R=(0,F.Z)(function*(M,o){try{const g=yield(0,h.E)(M,o);if(!g.isStandardized){const T=new z.Z("mapview - bad input","Unable to apply filter's definition expression, as expression is not standardized.",g);x().error(T)}return T=>{const P=T.readArcadeFeature();try{return g.testFeature(P,E)}catch{return x().warn("mapview-bad-where-clause","Encountered an error when evaluating where clause",M),!0}}}catch{return x().warn("mapview-bad-where-clause","Encountered an error when evaluating where clause",M),T=>!0}})).apply(this,arguments)}}}]);