"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[6573,5251,2046],{60084:(b,E,r)=>{r.d(E,{D:()=>d});var a=r(26496);function d(g){g?.writtenProperties&&g.writtenProperties.forEach(({target:u,propName:m,newOrigin:_})=>{(0,a.l)(u)&&_&&u.originOf(m)!==_&&u.updateOrigin(m,_)})}},26496:(b,E,r)=>{function a(d){return d&&"getAtOrigin"in d&&"originOf"in d}r.d(E,{l:()=>a})},16473:(b,E,r)=>{r.r(E),r.d(E,{save:()=>c,saveAs:()=>R});var a=r(15861),d=r(85155),g=r(453),u=r(50318),m=r(89055);const _="Media Layer",f="media-layer-save",D="media-layer-save-as",y=["media-layer:unsupported-source"];function p(t){return{isValid:"media"===t.type,errorMessage:"Layer.type should be 'media'"}}function v(t){return(0,g.Y)(t,"portal-item",!0)}function x(t){return t.layerJSON}function M(t,s){return o.apply(this,arguments)}function o(){return(o=(0,a.Z)(function*(t,s){s.extent=t.fullExtent?yield(0,u.$o)(t.fullExtent):null})).apply(this,arguments)}function l(t,s){return h.apply(this,arguments)}function h(){return(h=(0,a.Z)(function*(t,s){s.title||=t.title,yield M(t,s),(0,u.ck)(s,u.hz.METADATA)})).apply(this,arguments)}function c(t,s){return U.apply(this,arguments)}function U(){return(U=(0,a.Z)(function*(t,s){return(0,d.a1)({layer:t,itemType:_,validateLayer:p,createJSONContext:i=>v(i),createItemData:x,errorNamePrefix:f,supplementalUnsupportedErrors:y,setItemProperties:M,saveResources:(i,P)=>(0,m.H)(t.resourceReferences,P)},s)})).apply(this,arguments)}function R(t,s,i){return e.apply(this,arguments)}function e(){return(e=(0,a.Z)(function*(t,s,i){return(0,d.po)({layer:t,itemType:_,validateLayer:p,createJSONContext:P=>v(P),createItemData:x,errorNamePrefix:D,supplementalUnsupportedErrors:y,newItem:s,setItemProperties:l,saveResources:(P,n)=>(0,m.H)(t.resourceReferences,n)},i)})).apply(this,arguments)}},453:(b,E,r)=>{r.d(E,{Y:()=>u,h:()=>g});var a=r(6785),d=r(61018);function g(_,f){return{...m(_,f),readResourcePaths:[]}}function u(_,f,D){const y=(0,a.mN)(_.itemUrl);return{...m(_,f),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:y?{rootPath:y.path,writtenUrls:[]}:null,resources:D?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function m(_,f){return{origin:f,url:(0,a.mN)(_.itemUrl),portal:_.portal||d.Z.getDefault(),portalItem:_}}},5251:(b,E,r)=>{r.r(E),r.d(E,{addOrUpdateResources:()=>f,contentToBlob:()=>h,fetchResources:()=>m,getSiblingOfSameType:()=>U,getSiblingOfSameTypeI:()=>R,removeAllResources:()=>v,removeResource:()=>y,splitPrefixFileNameAndExtension:()=>o});var a=r(15861),d=r(66476),g=r(57964),u=r(6785);function m(e){return _.apply(this,arguments)}function _(){return(_=(0,a.Z)(function*(e,t={},s){yield e.load(s);const i=(0,u.v_)(e.itemUrl,"resources"),{start:P=1,num:n=10,sortOrder:O="asc",sortField:C="resource"}=t,T={query:{start:P,num:n,sortOrder:O,sortField:C,token:e.apiKey},signal:s?.signal},I=yield e.portal.request(i,T);return{total:I.total,nextStart:I.nextStart,resources:I.resources.map(({created:B,size:A,resource:j})=>({created:new Date(B),size:A,resource:e.resourceFromPath(j)}))}})).apply(this,arguments)}function f(e,t,s,i){return D.apply(this,arguments)}function D(){return(D=(0,a.Z)(function*(e,t,s,i){const P=new Map;for(const{resource:O,content:C,compress:T,access:I}of t){if(!O.hasPath())throw new g.Z(`portal-item-resource-${s}:invalid-path`,"Resource does not have a valid path");const[B,A]=M(O.path),j=`${B}/${T??""}/${I??""}`;P.has(j)||P.set(j,{prefix:B,compress:T,access:I,files:[]}),P.get(j).files.push({fileName:A,content:C})}yield e.load(i);const n=(0,u.v_)(e.userItemUrl,"add"===s?"addResources":"updateResources");for(const{prefix:O,compress:C,access:T,files:I}of P.values())for(let A=0;A<I.length;A+=25){const j=I.slice(A,A+25),w=new FormData;O&&"."!==O&&w.append("resourcesPrefix",O),C&&w.append("compress","true"),T&&w.append("access",T);let K=0;for(const{fileName:L,content:S}of j)w.append("file"+ ++K,S,L);w.append("f","json"),yield e.portal.request(n,{method:"post",body:w,signal:i?.signal})}})).apply(this,arguments)}function y(e,t,s){return p.apply(this,arguments)}function p(){return(p=(0,a.Z)(function*(e,t,s){if(!t.hasPath())throw new g.Z("portal-item-resources-remove:invalid-path","Resource does not have a valid path");yield e.load(s);const i=(0,u.v_)(e.userItemUrl,"removeResources");yield e.portal.request(i,{method:"post",query:{resource:t.path},signal:s?.signal}),t.portalItem=null})).apply(this,arguments)}function v(e,t){return x.apply(this,arguments)}function x(){return(x=(0,a.Z)(function*(e,t){yield e.load(t);const s=(0,u.v_)(e.userItemUrl,"removeResources");return e.portal.request(s,{method:"post",query:{deleteAll:!0},signal:t?.signal})})).apply(this,arguments)}function M(e){const t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function o(e){const[t,s]=function l(e){const t=(0,u.Ml)(e);return null==t?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}(e),[i,P]=M(t);return[i,P,s]}function h(e){return c.apply(this,arguments)}function c(){return(c=(0,a.Z)(function*(e){return"blob"===e.type?e.blob:"json"===e.type?new Blob([e.jsonString],{type:"application/json"}):(yield(0,d.Z)(e.url,{responseType:"blob"})).data})).apply(this,arguments)}function U(e,t){if(!e.hasPath())return null;const[s,,i]=o(e.path);return e.portalItem.resourceFromPath((0,u.v_)(s,t+i))}function R(e,t){if(!e.hasPath())return null;const[s,,i]=o(e.path);return e.portalItem.resourceFromPath((0,u.v_)(s,t+i))}},89055:(b,E,r)=>{r.d(E,{H:()=>_,b:()=>D});var a=r(15861),d=r(57964),g=r(79412),u=r(19986),m=r(5251);function _(o,l,h){return f.apply(this,arguments)}function f(){return(f=(0,a.Z)(function*(o,l,h){const c=yield p(o,l,h);yield x(c,l,h)})).apply(this,arguments)}function D(o,l,h,c,U){return y.apply(this,arguments)}function y(){return(y=(0,a.Z)(function*(o,l,h,c,U){const R=yield p(h,c,U);yield o.update({data:l}),yield x(R,c,U)})).apply(this,arguments)}function p(o,l,h){return v.apply(this,arguments)}function v(){return(v=(0,a.Z)(function*(o,l,h){if(!l?.resources)return;const c=l.portalItem===o.portalItem?new Set(o.paths):new Set;o.paths.length=0,o.portalItem=l.portalItem;const U=new Set(l.resources.toKeep.map(n=>n.resource.path)),R=new Set,e=[];U.forEach(n=>{c.delete(n),o.paths.push(n)});const t=[],s=[],i=[];for(const n of l.resources.toUpdate)if(c.delete(n.resource.path),U.has(n.resource.path)||R.has(n.resource.path)){const{resource:O,content:C,finish:T}=n,I=(0,m.getSiblingOfSameTypeI)(O,(0,u.DO)());o.paths.push(I.path),t.push({resource:I,content:yield(0,m.contentToBlob)(C),compress:n.compress}),T&&i.push(()=>T(I))}else{o.paths.push(n.resource.path),s.push({resource:n.resource,content:yield(0,m.contentToBlob)(n.content),compress:n.compress});const O=n.finish;O&&i.push(()=>O(n.resource)),R.add(n.resource.path)}for(const n of l.resources.toAdd)if(o.paths.push(n.resource.path),c.has(n.resource.path))c.delete(n.resource.path);else{t.push({resource:n.resource,content:yield(0,m.contentToBlob)(n.content),compress:n.compress});const O=n.finish;O&&i.push(()=>O(n.resource))}if(t.length||s.length){const{addOrUpdateResources:n}=yield Promise.resolve().then(r.bind(r,5251));yield n(l.portalItem,t,"add",h),yield n(l.portalItem,s,"update",h)}if(i.forEach(n=>n()),0===e.length)return c;const P=yield(0,g.UO)(e);if((0,g.k_)(h),P.length>0)throw new d.Z("save:resources","Failed to save one or more resources",{errors:P});return c})).apply(this,arguments)}function x(o,l,h){return M.apply(this,arguments)}function M(){return(M=(0,a.Z)(function*(o,l,h){if(!o||!l.portalItem)return;const c=[];for(const U of o){const R=l.portalItem.resourceFromPath(U);c.push(R.portalItem.removeResource(R,h))}yield(0,g.as)(c)})).apply(this,arguments)}},88911:(b,E,r)=>{r.d(E,{w:()=>u});var a=r(11931),d=r(57964),g=r(40907);function u(m){if(a.default.apiKey&&(0,g.r)(m.portal.url))throw new d.Z("save-api-key-utils:api-key-not-supported",`Saving is not supported on ${m.portal.url} when using an api key`)}},46018:(b,E,r)=>{r.d(E,{P:()=>g,z:()=>_});var a=r(15861),d=r(57964);function g(f){return u.apply(this,arguments)}function u(){return(u=(0,a.Z)(function*(f){const D=[];for(const y of f.allLayers)if("beforeSave"in y&&"function"==typeof y.beforeSave){const p=y.beforeSave();p&&D.push(p)}yield Promise.allSettled(D)})).apply(this,arguments)}const m=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function _(f,D,y){let p=(f.messages??[]).filter(({type:v})=>"error"===v).map(({name:v,message:x,details:M})=>new d.Z(v,x,M));if(f.blockedRelativeUrls&&(p=p.concat(f.blockedRelativeUrls.map(v=>new d.Z("url:unsupported",`Relative url '${v}' is not supported`)))),y){const{ignoreUnsupported:v,supplementalUnsupportedErrors:x=[],requiredPropertyChecksDisabled:M}=y;v&&(p=p.filter(({name:o})=>!(m.has(o)||x.includes(o)))),M&&(p=p.filter(o=>"web-document-write:property-required"!==o.name))}if(p.length>0)throw new d.Z(D.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:p})}}}]);