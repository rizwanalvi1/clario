"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[9762,318,5398],{52540:(oe,$,s)=>{s.d($,{z:()=>p});var S=s(39921);class p{constructor(R,z){this._storage=new S.WJ,this.id="",this.name="",this.size=0,this._storage.maxSize=R,this._storage.register(this),z&&this._storage.registerRemoveFunc("",z)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(R,z,P=1){this._storage.put(this,R,z,P,1)}pop(R){return this._storage.pop(this,R)}get(R){return this._storage.get(this,R)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(R){this._storage.maxSize=R}resetHitRate(){}}},39921:(oe,$,s)=>{s.d($,{WJ:()=>P,Xq:()=>z});var R,K,S=s(43029);(K=R||(R={}))[K.ALL=0]="ALL",K[K.SOME=1]="SOME";class z{constructor(f,y,m){this.name=f,this._storage=y,this.id=T+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),m&&(this._storage.registerRemoveFunc(this.id,m),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(f){return this._storage.getSize(this,f)}resetHitRate(){this._hit=this._miss=0}put(f,y,m,I=0){this._storage.put(this,f,y,m,I)}pop(f){const y=this._storage.pop(this,f);return void 0===y?++this._miss:++this._hit,y}get(f){const y=this._storage.get(this,f);return void 0===y?++this._miss:++this._hit,y}peek(f){return this._storage.peek(this,f)}updateSize(f,y,m){this._storage.updateSize(this,f,y,m)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class P{get size(){return this._size}constructor(f=10485760){this._maxSize=f,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new S.Z,this._users=new S.Z}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(f){this._users.push(f)}deregister(f){this._users.removeUnordered(f)}registerRemoveFunc(f,y){this._removeFuncs.push([f,y])}deregisterRemoveFunc(f){this._removeFuncs.filterInPlace(y=>y[0]!==f)}get maxSize(){return this._maxSize}set maxSize(f){this._maxSize=Math.max(f,-1),this._checkSize()}getSize(f,y){return this._db.get(f.id+y)?.size??0}put(f,y,m,I,w){const j=this._db.get(y=f.id+y);if(j&&(this._size-=j.size,f.size-=j.size,this._db.delete(y),j.entry!==m&&this._notifyRemove(y,j.entry,j.size,R.ALL)),I>this._maxSize)return void this._notifyRemove(y,m,I,R.ALL);if(void 0===m)return void console.warn("Refusing to cache undefined entry ");if(!I||I<0)return console.warn(`Refusing to cache entry with size ${I} for key ${y}`),void this._notifyRemove(y,m,0,R.ALL);const C=1+Math.max(w,-4)- -3;this._db.set(y,new G(m,I,C)),this._size+=I,f.size+=I,this._checkSize()}updateSize(f,y,m,I){const w=this._db.get(y=f.id+y);if(w&&w.entry===m){for(this._size-=w.size,f.size-=w.size;I>this._maxSize;){const j=this._notifyRemove(y,m,I,R.SOME);if(!(null!=j&&j>0))return void this._db.delete(y);I=j}w.size=I,this._size+=I,f.size+=I,this._checkSize()}}pop(f,y){const m=this._db.get(y=f.id+y);if(m)return this._size-=m.size,f.size-=m.size,this._db.delete(y),++this._hit,m.entry;++this._miss}get(f,y){const m=this._db.get(y=f.id+y);if(void 0!==m)return this._db.delete(y),m.lives=m.lifetime,this._db.set(y,m),++this._hit,m.entry;++this._miss}peek(f,y){const m=this._db.get(f.id+y);return m?++this._hit:++this._miss,m?.entry}get performanceInfo(){const f={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},y={},m=new Array;this._db.forEach((j,C)=>{const d=j.lifetime;m[d]=(m[d]||0)+j.size,this._users.forAll(a=>{const{id:h,name:_}=a;C.startsWith(h)&&(y[_]=(y[_]||0)+j.size)})});const I={};this._users.forAll(j=>{const C=j.name;"hitRate"in j&&"number"==typeof j.hitRate&&!isNaN(j.hitRate)&&j.hitRate>0?(y[C]=y[C]||0,I[C]=Math.round(100*j.hitRate)+"%"):I[C]="0%"});const w=Object.keys(y);w.sort((j,C)=>y[C]-y[j]),w.forEach(j=>f[j]=Math.round(y[j]/2**20)+"MB / "+I[j]);for(let j=m.length-1;j>=0;--j){const C=m[j];C&&(f["Priority "+(j+-3-1)]=Math.round(C/this._size*100)+"%")}return f}resetStats(){this._hit=this._miss=0,this._users.forAll(f=>f.resetHitRate())}clear(f){const y=f.id;this._db.forEach((m,I)=>{I.startsWith(y)&&(this._size-=m.size,this._db.delete(I),this._notifyRemove(I,m.entry,m.size,R.ALL))}),f.size=0}clearAll(){this._db.forEach((f,y)=>this._notifyRemove(y,f.entry,f.size,R.ALL)),this._users.forAll(f=>f.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(f,y,m,I){let w;return this._removeFuncs.some(j=>{if(f.startsWith(j[0])){const C=j[1](y,I,m);return"number"==typeof C&&(w=C),!0}return!1}),w}_checkSize(){this._users.forAll(f=>this._checkSizeLimits(f)),this._checkSizeLimits()}_checkSizeLimits(f){const y=f??this;if(y.maxSize<0||y.size<=y.maxSize)return;const m=f?.id;let I=!0;for(;I;){I=!1;for(const[w,j]of this._db)if(0===j.lifetime&&(!m||w.startsWith(m))){if(this._purgeItem(w,j,f),y.size<=.9*y.maxSize)return;I||=this._db.has(w)}}for(const[w,j]of this._db)if((!m||w.startsWith(m))&&(this._purgeItem(w,j,f),y.size<=.9*y.maxSize))return}_purgeItem(f,y,m=this._users.find(I=>f.startsWith(I.id))){if(this._db.delete(f),y.lives<=1){this._size-=y.size,m&&(m.size-=y.size);const I=this._notifyRemove(f,y.entry,y.size,R.SOME);null!=I&&I>0&&(this._size+=I,m&&(m.size+=I),y.lives=y.lifetime,y.size=I,this._db.set(f,y))}else--y.lives,this._db.set(f,y)}}let T=0;class G{constructor(f,y,m){this.entry=f,this.size=y,this.lifetime=m,this.lives=m}}},657:(oe,$,s)=>{s.d($,{$c:()=>w,Hg:()=>j,jW:()=>y,uD:()=>m});var S=s(73514),p=s(83944),Y=s(49301);const R=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function z(d){return d instanceof S.Z}function P(d){return d instanceof p.Z?Object.keys(d.items):z(d)?(0,Y.vw)(d).keys():d?Object.keys(d):[]}function T(d,a){return d instanceof p.Z?d.items[a]:d[a]}function K(d){return d?d.declaredClass:null}function f(d,a){const h=d.diff;if(h&&"function"==typeof h)return h(d,a);const _=P(d),L=P(a);if(0===_.length&&0===L.length)return;if(!_.length||!L.length||function G(d,a){return!(!Array.isArray(d)||!Array.isArray(a))&&d.length!==a.length}(d,a))return{type:"complete",oldValue:d,newValue:a};const M=L.filter(D=>!_.includes(D)),g=_.filter(D=>!L.includes(D)),O=_.filter(D=>L.includes(D)&&T(d,D)!==T(a,D)).concat(M,g).sort(),U=K(d);if(U&&R.has(U)&&O.length)return{type:"complete",oldValue:d,newValue:a};let W;const Z=z(d)&&z(a);for(const D of O){const c=T(d,D),v=T(a,D);let F;if((Z||"function"!=typeof c&&"function"!=typeof v)&&c!==v&&(null!=c||null!=v)){if(h&&h[D]&&"function"==typeof h[D])F=h[D]?.(c,v);else if(c instanceof Date&&v instanceof Date){if(c.getTime()===v.getTime())continue;F={type:"complete",oldValue:c,newValue:v}}else F="object"==typeof c&&"object"==typeof v&&K(c)===K(v)?f(c,v):{type:"complete",oldValue:c,newValue:v};null!=F&&(null!=W?W.diff[D]=F:W={type:"partial",diff:{[D]:F}})}}return W}function y(d,a){return m(d,a)}function m(d,a){if(null==d)return!1;const h=a.split(".");let _=d;for(const L of h){if("complete"===_.type)return!0;if("partial"!==_.type)return!1;{const M=_.diff[L];if(!M)return!1;_=M}}return!0}function w(d,a){if(!d)return!1;if("partial"===d.type){const h=Object.keys(d.diff);return 1===h.length&&h[0]===a}return!1}function j(d,a){if("function"!=typeof d&&"function"!=typeof a&&(null!=d||null!=a))return null==d||null==a||"object"==typeof d&&"object"==typeof a&&K(d)!==K(a)?{type:"complete",oldValue:d,newValue:a}:f(d,a)}},15398:(oe,$,s)=>{s.d($,{A4:()=>Y,L9:()=>R,yV:()=>p});var S=s(25037);class p{}function Y(P){return P instanceof S.ld?P===p.instance:"unknown"===P?.toString().toLowerCase()}function R(P){return Y(P)?p.instance:P}p.instance=new S.vF("Etc/UTC")},66398:(oe,$,s)=>{function p(u){return u?{originPosition:"upper-left"===u.originPosition?"upperLeft":"lower-left"===u.originPosition?"lowerLeft":u.originPosition,scale:u.tolerance?[u.tolerance,u.tolerance,1,1]:[1,1,1,1],translate:null!=u.extent?[u.extent.xmin,u.extent.ymax,u.extent.zmin??0,u.extent.mmin??0]:[0,0,0,0]}:null}function R(u){if(function Y(u){return"lowerLeft"===u.originPosition&&4===u.scale.length&&4===u.translate.length}(u))return u;const{originPosition:i,scale:l,translate:E}=u,B=l[1]??1;return{originPosition:"lowerLeft",scale:[l[0]??1,"lowerLeft"===i?B:-B,l[2]??1,l[3]??1],translate:[E[0]??0,E[1]??0,E[2]??0,E[3]??0]}}function d({scale:u,translate:i},l){return l*u[0]+i[0]}function a({scale:u,translate:i},l){return l*u[1]+i[1]}function h({scale:u,translate:i},l){return(l??0)*u[2]+i[2]}function _({scale:u,translate:i},l){return l?l*u[3]+i[3]:0}function L(u,i){return u&&i?U:u&&!i?g:!u&&i?O:M}s.d($,{G6:()=>Ee,Ie:()=>ve,J9:()=>_e,RF:()=>ue,U1:()=>ge,vY:()=>p}),s(40637);const M=(u,i)=>{const l=new Array(i.length);if(!i.length)return l;const E=i[0];let A=d(u,E[0]),B=a(u,E[1]);l[0]=[A,B];const{scale:H,originPosition:Q}=u,te=H[0],q="lowerLeft"===Q?H[1]:-H[1];for(let X=1;X<i.length;X++){const[ee,se]=i[X];A+=te*ee,B+=q*se,l[X]=[A,B]}return l},g=(u,i)=>{const l=new Array(i.length);if(!i.length)return l;const E=i[0];let A=d(u,E[0]),B=a(u,E[1]);l[0]=[A,B,h(u,E[2])];const{scale:H,originPosition:Q}=u,te=H[0],q="lowerLeft"===Q?H[1]:-H[1];for(let X=1;X<i.length;X++){const[ee,se,ne]=i[X];A+=te*ee,B+=q*se,l[X]=[A,B,h(u,ne)]}return l},O=(u,i)=>{const l=new Array(i.length);if(!i.length)return l;const E=i[0];let A=d(u,E[0]),B=a(u,E[1]);l[0]=[A,B,_(u,E[2])];const{scale:H,originPosition:Q}=u,te=H[0],q="lowerLeft"===Q?H[1]:-H[1];for(let X=1;X<i.length;X++){const[ee,se,ne]=i[X];A+=te*ee,B+=q*se,l[X]=[A,B,_(u,ne)]}return l},U=(u,i)=>{const l=new Array(i.length);if(!i.length)return l;const E=i[0];let A=d(u,E[0]),B=a(u,E[1]);l[0]=[A,B,h(u,E[2]),_(u,E[3])];const{scale:H,originPosition:Q}=u,te=H[0],q="lowerLeft"===Q?H[1]:-H[1];for(let X=1;X<i.length;X++){const[ee,se,ne,J]=i[X];A+=te*ee,B+=q*se,l[X]=[A,B,h(u,ne),_(u,J)]}return l};function W(u,i,l){const E=new Array(l.length);for(let A=0;A<l.length;A++)E[A]=i(u,l[A]);return E}function ue(u,i,l){const E=R(u);return i.x=function z({scale:u,translate:i},l){return Math.round((l-i[0])/u[0])}(E,l.x),i.y=function P({scale:u,translate:i},l){return Math.round((l-i[1])/u[1])}(E,l.y),null!=l.z&&(i.z=function T({scale:u,translate:i},l){return Math.round(((l??0)-i[2])/u[2])}(E,l.z)),null!=l.m&&(i.m=function G({scale:u,translate:i},l){return l?Math.round((l-i[3])/u[3]):0}(E,l.m)),i}function _e(u,i,l,E=l?.hasZ??!1,A=l?.hasM??!1){if(null!=l){const B=R(u);i.points=L(E,A)(B,l.points),i.hasZ=E,i.hasM=A}return i}function ge(u,i,l,E=null!=l?.z,A=null!=l?.m){if(null==l)return i;const B=R(u);return i.x=d(B,l.x),i.y=a(B,l.y),E&&(i.z=h(B,l.z)),A&&(i.m=_(B,l.m)),i}function ve(u,i,l,E=l?.hasZ??!1,A=l?.hasM??!1){if(null!=l){const B=R(u);i.rings=W(B,L(E,A),l.rings),i.hasZ=E,i.hasM=A}return i}function Ee(u,i,l,E=l?.hasZ??!1,A=l?.hasM??!1){if(null!=l){const B=R(u);i.paths=W(B,L(E,A),l.paths),i.hasZ=E,i.hasM=A}return i}},18504:(oe,$,s)=>{s.r($),s.d($,{default:()=>ye});var S=s(15861),p=s(50484),R=(s(2189),s(62691)),w=(s(36699),s(12610),s(53722),s(82752),s(28999),s(38748),s(50923),s(42212),s(91963),s(41007)),j=s(3233),C=s(71763),d=s(6785),a=s(80543),h=s(1535),L=(s(65311),s(14007)),M=s(10141),g=s(7547),O=s(31709),U=s(95060),W=s(57964),Z=s(67016),D=s(4703),c=s(79412),v=s(36885),F=s(60324),b=s(21970),re=s(93792),k=s(764),ue=s(26894);let le=class extends Z.Z{constructor(){var x;super(...arguments),x=this,this._connection=null,this._workerHandler=null,this.capabilities=(0,F.MS)(!1,!1),this.type="wfs",this.refresh=(0,c.Ds)((0,S.Z)(function*(){yield x.load();const N={customParameters:x.layer.customParameters,maxRecordCount:x.layer.maxRecordCount,maxTotalRecordCount:x.layer.maxTotalRecordCount,maxPageCount:x.layer.maxPageCount},{extent:V}=yield x._workerHandler.refresh(N);return V&&(x.sourceJSON.extent=V),{dataChanged:!0,updates:{extent:x.sourceJSON.extent}}}))}load(x){return this.addResolvingPromise(this._startWorker({signal:null!=x?x.signal:null})),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null,this._workerHandler=null}openPorts(){var x=this;return(0,S.Z)(function*(){return yield x.load(),x._connection.openPorts()})()}queryFeatures(x,N={}){var V=this;return(0,S.Z)(function*(){const ie=yield V.queryFeaturesJSON(x,N);return re.Z.fromJSON(ie)})()}queryFeaturesJSON(x,N={}){var V=this;return(0,S.Z)(function*(){return yield V.load(N),V._workerHandler.queryFeatures(x?x.toJSON():void 0,N)})()}queryFeatureCount(x,N={}){var V=this;return(0,S.Z)(function*(){return yield V.load(N),V._workerHandler.queryFeatureCount(x?x.toJSON():void 0,N)})()}queryObjectIds(x,N={}){var V=this;return(0,S.Z)(function*(){return yield V.load(N),V._workerHandler.queryObjectIds(x?x.toJSON():void 0,N)})()}queryExtent(x,N={}){var V=this;return(0,S.Z)(function*(){yield V.load(N);const ie=yield V._workerHandler.queryExtent(x?x.toJSON():void 0,N);return{count:ie.count,extent:ue.Z.fromJSON(ie.extent)}})()}querySnapping(x,N={}){var V=this;return(0,S.Z)(function*(){return yield V.load(N),V._workerHandler.querySnapping(x,N)})()}_createLoadOptions(x){var N=this;return(0,S.Z)(function*(){const{url:V,customParameters:ie,name:de,namespaceUri:pe,fields:ae,geometryType:fe,maxRecordCount:me,maxPageCount:Pe,maxTotalRecordCount:Oe,swapXY:Me}=N.layer,De="defaults"===N.layer.originOf("spatialReference")?void 0:N.layer.spatialReference;if(!V)throw new W.Z("wfs-layer:missing-url","WFSLayer must be created with a url");N.wfsCapabilities||(N.wfsCapabilities=yield(0,b.FU)(V,{customParameters:ie,...x}));const he=["fields","geometryType","name","namespaceUri","swapXY"].some(Ie=>null==N.layer[Ie])?yield(0,b.be)(N.wfsCapabilities,de,pe,{spatialReference:De,customParameters:ie,signal:x?.signal}):{...(0,b.eB)(ae??[]),geometryType:fe,name:de,namespaceUri:pe,spatialReference:De,swapXY:Me},Se=(0,b.ft)(N.wfsCapabilities.readFeatureTypes(),he.name,he.namespaceUri),Le=O.M.toJSON(he.geometryType),{operations:Te}=N.wfsCapabilities,Fe=Te.GetFeature.url,Ue=Te.GetFeature.outputFormat;return{customParameters:ie,featureType:Se,fields:he.fields?.map(Ie=>Ie.toJSON())??[],geometryField:he.geometryField,geometryType:Le,getFeatureUrl:Fe,getFeatureOutputFormat:Ue,maxRecordCount:me,maxPageCount:Pe,maxTotalRecordCount:Oe,objectIdField:he.objectIdField,spatialReference:he.spatialReference?.toJSON(),swapXY:!!he.swapXY}})()}_startWorker(x){var N=this;return(0,S.Z)(function*(){const[V,ie]=yield(0,c.as)([N._createLoadOptions(x),(0,v.bA)("WFSSourceWorker",{...x,strategy:(0,L.Z)("feature-layers-workers")?"dedicated":"local",registryTarget:N})]),de=V.error||ie.error||null,pe=ie.value||null;if(de)throw pe&&pe.close(),de;const ae=V.value;N._connection=ie.value,N._workerHandler=N._connection.createInvokeProxy();const fe=yield N._workerHandler.load(ae,x);for(const me of fe.warnings)D.Z.getLogger(N.layer).warn("#load()",`${me.message} (title: '${N.layer.title||"no title"}', id: '${N.layer.id??"no id"}')`,{warning:me});N.sourceJSON={dateFieldsTimeReference:{timeZoneIANA:k.pt},extent:fe.extent,fields:ae.fields,geometryType:ae.geometryType,objectIdField:ae.objectIdField,geometryField:ae.geometryField,drawingInfo:(0,F.bU)(ae.geometryType),name:ae.featureType.title,wfsInfo:{name:ae.featureType.name,featureUrl:ae.getFeatureUrl,maxFeatures:ae.maxRecordCount,swapXY:ae.swapXY,supportedSpatialReferences:ae.featureType.supportedSpatialReferences,version:"2.0.0",wfsNamespace:ae.featureType.namespaceUri}}})()}};(0,p._)([(0,a.Cb)()],le.prototype,"capabilities",void 0),(0,p._)([(0,a.Cb)({constructOnly:!0})],le.prototype,"layer",void 0),(0,p._)([(0,a.Cb)()],le.prototype,"sourceJSON",void 0),(0,p._)([(0,a.Cb)()],le.prototype,"type",void 0),(0,p._)([(0,a.Cb)()],le.prototype,"wfsCapabilities",void 0),le=(0,p._)([(0,M.j)("esri.layers.graphics.sources.WFSSource")],le);var se,ce=s(19855),Ce=s(27426),Re=s(12621),_e=s(78601),ge=s(80099),ve=s(32250),Ee=s(70509),u=s(25836),i=s(29717),l=s(12522),E=s(56956),A=s(81247),B=s(27969),H=s(85295),Q=s(40591),te=s(75421),q=s(91866),X=s(33331),ee=s(43814);const ne=(0,B.v)();let J=se=class extends((0,ve.c)((0,Ce.N)((0,_e.M)((0,Re.b)((0,ce.h7)((0,l.n)((0,u.Q)((0,i.M)((0,ge.q)((0,Ee.I)((0,j.R)(U.Z)))))))))))){static fromWFSLayerInfo(x){const{customParameters:N,fields:V,geometryField:ie,geometryType:de,name:pe,namespaceUri:ae,objectIdField:fe,spatialReference:me,swapXY:Pe,url:Oe,wfsCapabilities:Me}=x;return new se({customParameters:N,fields:V,geometryField:ie,geometryType:de,name:pe,namespaceUri:ae,objectIdField:fe,spatialReference:me,swapXY:Pe,url:Oe,wfsCapabilities:Me})}constructor(x){super(x),this.copyright=null,this.customParameters=null,this.dateFieldsTimeZone=null,this.definitionExpression=null,this.displayField=null,this.elevationInfo=null,this.featureUrl=void 0,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="WFS",this.maxRecordCount=3e3,this.maxPageCount=10,this.maxTotalRecordCount=2e5,this.mode=0,this.name=null,this.namespaceUri=null,this.outFields=null,this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new le({layer:this}),this.spatialReference=ee.Z.WGS84,this.spatialReferences=[4326],this.swapXY=void 0,this.title="WFS",this.type="wfs",this.url=null,this.version=void 0}destroy(){this.source?.destroy()}load(x){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WFS"]},x).then(()=>this.source.load(x)).then(()=>{this.read(this.source.sourceJSON,{origin:"service",url:this.parsedUrl}),this.revert(["objectIdField","fields","timeInfo","spatialReference","name","namespaceUri"],"service"),(0,H.YN)(this.renderer,this.fieldsIndex),(0,H.UF)(this.timeInfo,this.fieldsIndex)})),Promise.resolve(this)}get capabilities(){return this.source?.capabilities}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("capabilities"),(this._get("createQueryVersion")||0)+1}get defaultPopupTemplate(){return this.createPopupTemplate()}writeFields(x,N,V){const ie=x.filter(de=>de.name!==b.u2);this.geometryField&&ie.unshift(new A.Z({name:this.geometryField,alias:this.geometryField,type:"geometry"})),(0,C.RB)(V,ie.map(de=>de.toJSON()),N)}get parsedUrl(){return(0,d.mN)(this.url)}set renderer(x){(0,H.YN)(x,this.fieldsIndex),this._set("renderer",x)}get wfsCapabilities(){return this.source?.wfsCapabilities}set wfsCapabilities(x){this.source&&(this.source.wfsCapabilities=x)}createPopupTemplate(x){return(0,X.eZ)(this,x)}createQuery(){const x=new q.Z({returnGeometry:!0,outFields:["*"],where:this.definitionExpression||"1=1"}),{timeOffset:N,timeExtent:V}=this;return x.timeExtent=null!=N&&null!=V?V.offset(-N.value,N.unit):V||null,x}getFieldDomain(x,N){return this.getField(x)?.domain}getField(x){return this.fieldsIndex?.get(x)}queryFeatures(x,N){return this.load().then(()=>this.source.queryFeatures(q.Z.from(x)||this.createQuery(),N)).then(V=>{if(V?.features)for(const ie of V.features)ie.layer=ie.sourceLayer=this;return V})}queryObjectIds(x,N){return this.load().then(()=>this.source.queryObjectIds(q.Z.from(x)||this.createQuery(),N))}queryFeatureCount(x,N){return this.load().then(()=>this.source.queryFeatureCount(q.Z.from(x)||this.createQuery(),N))}queryExtent(x,N){return this.load().then(()=>this.source.queryExtent(q.Z.from(x)||this.createQuery(),N))}hasDataChanged(){var x=this;return(0,S.Z)(function*(){try{const{dataChanged:N,updates:V}=yield x.source.refresh();return null!=V&&x.read(V,{origin:"service",url:x.parsedUrl,ignoreDefaults:!0}),N}catch{}return!1})()}};(0,p._)([(0,a.Cb)({readOnly:!0})],J.prototype,"capabilities",null),(0,p._)([(0,a.Cb)({type:String})],J.prototype,"copyright",void 0),(0,p._)([(0,a.Cb)({readOnly:!0})],J.prototype,"createQueryVersion",null),(0,p._)([(0,a.Cb)({json:{name:"wfsInfo.customParameters",write:{overridePolicy:x=>({enabled:!!(x&&Object.keys(x).length>0),ignoreOrigin:!0})}}})],J.prototype,"customParameters",void 0),(0,p._)([(0,a.Cb)((0,k.mi)("dateFieldsTimeReference"))],J.prototype,"dateFieldsTimeZone",void 0),(0,p._)([(0,a.Cb)({readOnly:!0})],J.prototype,"defaultPopupTemplate",null),(0,p._)([(0,a.Cb)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],J.prototype,"definitionExpression",void 0),(0,p._)([(0,a.Cb)({type:String})],J.prototype,"displayField",void 0),(0,p._)([(0,a.Cb)(E.PV)],J.prototype,"elevationInfo",void 0),(0,p._)([(0,a.Cb)({type:String,readOnly:!0,json:{name:"wfsInfo.featureUrl",write:{ignoreOrigin:!0,isRequired:!0}}})],J.prototype,"featureUrl",void 0),(0,p._)([(0,a.Cb)({type:[A.Z],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],J.prototype,"fields",void 0),(0,p._)([(0,g.c)("fields")],J.prototype,"writeFields",null),(0,p._)([(0,a.Cb)(ne.fieldsIndex)],J.prototype,"fieldsIndex",void 0),(0,p._)([(0,a.Cb)({type:ue.Z,json:{name:"extent"}})],J.prototype,"fullExtent",void 0),(0,p._)([(0,a.Cb)()],J.prototype,"geometryField",void 0),(0,p._)([(0,a.Cb)({type:String,json:{read:{source:"layerDefinition.geometryType",reader:O.M.read},write:{target:"layerDefinition.geometryType",writer:O.M.write,ignoreOrigin:!0},origins:{service:{read:O.M.read}}}})],J.prototype,"geometryType",void 0),(0,p._)([(0,a.Cb)({type:String})],J.prototype,"id",void 0),(0,p._)([(0,a.Cb)(E.iR)],J.prototype,"labelsVisible",void 0),(0,p._)([(0,a.Cb)({type:[Q.Z],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:te.r},write:!0}})],J.prototype,"labelingInfo",void 0),(0,p._)([(0,a.Cb)(E.rn)],J.prototype,"legendEnabled",void 0),(0,p._)([(0,a.Cb)({type:["show","hide"]})],J.prototype,"listMode",void 0),(0,p._)([(0,a.Cb)({type:String})],J.prototype,"objectIdField",void 0),(0,p._)([(0,a.Cb)({type:["WFS"]})],J.prototype,"operationalLayerType",void 0),(0,p._)([(0,a.Cb)({type:h.z8,json:{name:"wfsInfo.maxFeatures",write:{ignoreOrigin:!0,isRequired:!0}}})],J.prototype,"maxRecordCount",void 0),(0,p._)([(0,a.Cb)({type:h.z8})],J.prototype,"maxPageCount",void 0),(0,p._)([(0,a.Cb)({type:h.z8})],J.prototype,"maxTotalRecordCount",void 0),(0,p._)([(0,a.Cb)({type:[0],readOnly:!0,json:{origins:{"web-map":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],J.prototype,"mode",void 0),(0,p._)([(0,a.Cb)({type:String,json:{name:"wfsInfo.name",write:{ignoreOrigin:!0,isRequired:!0}}})],J.prototype,"name",void 0),(0,p._)([(0,a.Cb)({type:String,json:{name:"wfsInfo.wfsNamespace",write:{ignoreOrigin:!0,isRequired:!0}}})],J.prototype,"namespaceUri",void 0),(0,p._)([(0,a.Cb)(E.bT)],J.prototype,"opacity",void 0),(0,p._)([(0,a.Cb)(ne.outFields)],J.prototype,"outFields",void 0),(0,p._)([(0,a.Cb)({readOnly:!0})],J.prototype,"parsedUrl",null),(0,p._)([(0,a.Cb)(E.C_)],J.prototype,"popupEnabled",void 0),(0,p._)([(0,a.Cb)({type:R.Z,json:{name:"popupInfo",write:!0}})],J.prototype,"popupTemplate",void 0),(0,p._)([(0,a.Cb)({types:w.A,json:{origins:{service:{name:"drawingInfo.renderer"},"web-scene":{types:w.o,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:{ignoreOrigin:!0}}})],J.prototype,"renderer",null),(0,p._)([(0,a.Cb)(E.YI)],J.prototype,"screenSizePerspectiveEnabled",void 0),(0,p._)([(0,a.Cb)({readOnly:!0})],J.prototype,"source",void 0),(0,p._)([(0,a.Cb)({type:ee.Z,json:{name:"layerDefinition.spatialReference",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"extent.spatialReference"}}}})],J.prototype,"spatialReference",void 0),(0,p._)([(0,a.Cb)({readOnly:!0,type:[h.z8],json:{name:"wfsInfo.supportedSpatialReferences",write:{ignoreOrigin:!0,isRequired:!0}}})],J.prototype,"spatialReferences",void 0),(0,p._)([(0,a.Cb)({type:Boolean,value:!1,json:{name:"wfsInfo.swapXY",write:{ignoreOrigin:!0,isRequired:!0}}})],J.prototype,"swapXY",void 0),(0,p._)([(0,a.Cb)({json:{write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"name"}}}})],J.prototype,"title",void 0),(0,p._)([(0,a.Cb)({json:{read:!1},readOnly:!0})],J.prototype,"type",void 0),(0,p._)([(0,a.Cb)(E.HQ)],J.prototype,"url",void 0),(0,p._)([(0,a.Cb)({type:String,readOnly:!0,json:{name:"wfsInfo.version",write:{ignoreOrigin:!0,isRequired:!0}}})],J.prototype,"version",void 0),(0,p._)([(0,a.Cb)()],J.prototype,"wfsCapabilities",null),J=se=(0,p._)([(0,M.j)("esri.layers.WFSLayer")],J);const ye=J},83502:(oe,$,s)=>{s.d($,{S6:()=>Y,u_:()=>p});var S=s(62209);class p{constructor(P=null,T={},G,K){this.geometry=P,this.attributes=T,this.centroid=G,this.objectId=K,this.displayId=0,this.geohashX=0,this.geohashY=0}static fromJSON(P,T){const G=P.geometry?S.Z.fromJSON(P.geometry):null,K=P.centroid?S.Z.fromJSON(P.centroid):null;return new p(G,P.attributes,K,P.attributes[T])}weakClone(){const P=new p(this.geometry,this.attributes,this.centroid,this.objectId);return P.displayId=this.displayId,P.geohashX=this.geohashX,P.geohashY=this.geohashY,P}clone(){const P=this.geometry?.clone(),T=new p(P,{...this.attributes},this.centroid?.clone(),this.objectId);return T.displayId=this.displayId,T.geohashX=this.geohashX,T.geohashY=this.geohashY,T}}function Y(z){return!!z.geometry?.coords?.length}},62209:(oe,$,s)=>{s.d($,{Z:()=>p});class p{constructor(R=[],z=[],P=!1){this.lengths=R??[],this.coords=z??[],this.hasIndeterminateRingOrder=P}static fromJSON(R){return new p(R.lengths,R.coords,R.hasIndeterminateRingOrder)}static fromRect(R){const[z,P,T,G]=R,K=T-z,f=G-P;return new p([5],[z,P,K,0,0,f,-K,0,0,-f])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((R,z)=>R+z)}forEachVertex(R){let z=0;this.lengths.length||R(this.coords[0],this.coords[1]);for(let P=0;P<this.lengths.length;P++){const T=this.lengths[P];for(let G=0;G<T;G++)R(this.coords[2*(G+z)],this.coords[2*(G+z)+1]);z+=T}}deltaDecode(){const R=this.clone(),{coords:z,lengths:P}=R;let T=0;for(const G of P){for(let K=1;K<G;K++)z[2*(T+K)]+=z[2*(T+K)-2],z[2*(T+K)+1]+=z[2*(T+K)-1];T+=G}return R}clone(R){if(0===this.lengths.length)return new p([],[this.coords[0],this.coords[1]]);const z=2*(0===this.lengths.length?1:this.lengths.reduce((T,G)=>T+G)),P=this.coords.slice(0,z);return R?(R.set(P),new p(this.lengths,R,this.hasIndeterminateRingOrder)):new p(Array.from(this.lengths),Array.from(P),this.hasIndeterminateRingOrder)}}},85559:(oe,$,s)=>{s.d($,{g:()=>S});const S={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},60324:(oe,$,s)=>{s.d($,{Dm:()=>G,Hq:()=>f,MS:()=>y,bU:()=>z});var S=s(14007),p=s(34222),Y=s(85559),R=s(19579);function z(m){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===m||"esriGeometryMultipoint"===m?R.I4:"esriGeometryPolyline"===m?R.ET:R.lF}}}const P=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let T=1;function G(m,I){if((0,S.Z)("esri-csp-restrictions"))return()=>({[I]:null,...m});try{let w=`this${K(I)} = null;`;for(const C in m)w+=`this${K(C)} = ${JSON.stringify(m[C])};`;const j=new Function(`\n      return class AttributesClass$${T++} {\n        constructor() {\n          ${w};\n        }\n      }\n    `)();return()=>new j}catch{return()=>({[I]:null,...m})}}function K(m){return P.test(m)?`.${m}`:`["${m}"]`}function f(m={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,p.d9)(m)}}]}function y(m,I){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:m},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:I,supportsDelete:I,supportsEditing:I,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:I,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:Y.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:I,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},27426:(oe,$,s)=>{s.d($,{N:()=>T});var S=s(50484),p=s(80543),P=(s(14007),s(4703),s(65311),s(10141));const T=G=>{let K=class extends G{constructor(){super(...arguments),this.customParameters=null}};return(0,S._)([(0,p.Cb)({type:Object,json:{write:{overridePolicy:f=>({enabled:!!(f&&Object.keys(f).length>0)})}}})],K.prototype,"customParameters",void 0),K=(0,S._)([(0,P.j)("esri.layers.mixins.CustomParametersMixin")],K),K}},32250:(oe,$,s)=>{s.d($,{c:()=>m,l:()=>y});var S=s(50484),p=s(71763),Y=s(80543),T=(s(14007),s(4703),s(65311),s(10141)),G=s(35469);const y={type:[G.Z],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:function K(I,w,j){if(!I)return null;const C=I.find(a=>!!a.field);if(!C)return null;const d=new G.Z;return d.read(C,j),[d]}},write:{writer:function f(I,w,j,C){const d=I.find(a=>!!a.field);d&&(0,p.RB)(j,[d.toJSON()],w)}}}},m=I=>{let w=class extends I{constructor(){super(...arguments),this.orderBy=null}};return(0,S._)([(0,Y.Cb)(y)],w.prototype,"orderBy",void 0),w=(0,S._)([(0,T.j)("esri.layers.mixins.OrderedLayer")],w),w}},70509:(oe,$,s)=>{s.d($,{I:()=>g});var S=s(15861),p=s(50484),Y=s(11931),R=s(26152),z=s(66476),P=s(37636),T=s(57964),G=s(4703),K=s(51172),f=s(79412),y=s(6785),m=s(80543),j=(s(14007),s(65311),s(62185)),C=s(10141),d=s(7547),a=s(85971),h=s(61018),_=s(27835),L=s(57437),M=s(50318);const g=U=>{let W=class extends U{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,K.SC)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(Z){Z!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",Z))}readPortalItem(Z,D,c){if(D.itemId)return new _.default({id:D.itemId,portal:c?.portal})}writePortalItem(Z,D){Z?.id&&(D.itemId=Z.id)}loadFromPortal(Z,D){var c=this;return(0,S.Z)(function*(){if(c.portalItem?.id)try{const{load:v}=yield Promise.all([s.e(2772),s.e(8592),s.e(6964)]).then(s.bind(s,36964));return(0,f.k_)(D),yield v({instance:c,supportedTypes:Z.supportedTypes,validateItem:Z.validateItem,supportsData:Z.supportsData,layerModuleTypeMap:Z.layerModuleTypeMap},D)}catch(v){throw(0,f.D_)(v)||G.Z.getLogger(c).warn(`Failed to load layer (${c.title}, ${c.id}) portal item (${c.portalItem.id})\n  ${v}`),v}})()}finishLoadEditablePortalLayer(Z){var D=this;return(0,S.Z)(function*(){D._set("userHasEditingPrivileges",yield D._fetchUserHasEditingPrivileges(Z).catch(c=>((0,f.r9)(c),!0)))})()}setUserPrivileges(Z,D){var c=this;return(0,S.Z)(function*(){if(!Y.default.userPrivilegesApplied)return c.finishLoadEditablePortalLayer(D);if(c.url)try{const{features:{edit:v,fullEdit:F},content:{updateItem:b}}=yield c._fetchUserPrivileges(Z,D);c._set("userHasEditingPrivileges",v),c._set("userHasFullEditingPrivileges",F),c._set("userHasUpdateItemPrivileges",b)}catch(v){(0,f.r9)(v)}})()}_fetchUserPrivileges(Z,D){var c=this;return(0,S.Z)(function*(){let v=c.portalItem;if(!Z||!v||!v.loaded||v.sourceUrl)return c._fetchFallbackUserPrivileges(D);const F=Z===v.id;if(F&&v.portal.user)return(0,M.Ss)(v);let b,re;if(F)b=v.portal.url;else try{b=yield(0,a.oP)(c.url,D)}catch(ce){(0,f.r9)(ce)}if(!b||!(0,y.Zo)(b,v.portal.url))return c._fetchFallbackUserPrivileges(D);try{const ce=null!=D?D.signal:null;re=yield R.id?.getCredential(`${b}/sharing`,{prompt:!1,signal:ce})}catch(ce){(0,f.r9)(ce)}if(!re)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(F?yield v.reload():(v=new _.default({id:Z,portal:{url:b}}),yield v.load(D)),v.portal.user)return(0,M.Ss)(v)}catch(ce){(0,f.r9)(ce)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_fetchFallbackUserPrivileges(Z){var D=this;return(0,S.Z)(function*(){let c=!0;try{c=yield D._fetchUserHasEditingPrivileges(Z)}catch(v){(0,f.r9)(v)}return{features:{edit:c,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(Z){var D=this;return(0,S.Z)(function*(){const c=D.url?R.id?.findCredential(D.url):null;if(!c)return!0;const v=O.credential===c?O.user:yield D._fetchEditingUser(Z);return O.credential=c,O.user=v,null==v?.privileges||v.privileges.includes("features:user:edit")})()}_fetchEditingUser(Z){var D=this;return(0,S.Z)(function*(){const c=D.portalItem?.portal?.user;if(c)return c;const v=R.id?.findServerInfo(D.url??"");if(!v?.owningSystemUrl)return null;const F=`${v.owningSystemUrl}/sharing/rest`,b=h.Z.getDefault();if(b&&b.loaded&&(0,y.Fv)(b.restUrl)===(0,y.Fv)(F))return b.user;const re=`${F}/community/self`,k=null!=Z?Z.signal:null,ue=yield(0,P.q6)((0,z.Z)(re,{authMode:"no-prompt",query:{f:"json"},signal:k}));return ue.ok?L.Z.fromJSON(ue.value.data):null})()}read(Z,D){D&&(D.layer=this),super.read(Z,D)}write(Z,D){const c=D?.portal,v=this.portalItem?.id&&(this.portalItem.portal||h.Z.getDefault());return c&&v&&!(0,y.tm)(v.restUrl,c.restUrl)?(D.messages&&D.messages.push(new T.Z("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(Z,{...D,layer:this})}};return(0,p._)([(0,m.Cb)({type:_.default})],W.prototype,"portalItem",null),(0,p._)([(0,j.r)("web-document","portalItem",["itemId"])],W.prototype,"readPortalItem",null),(0,p._)([(0,d.c)("web-document","portalItem",{itemId:{type:String}})],W.prototype,"writePortalItem",null),(0,p._)([(0,m.Cb)({clonable:!1})],W.prototype,"resourceReferences",void 0),(0,p._)([(0,m.Cb)({type:Boolean,readOnly:!0})],W.prototype,"userHasEditingPrivileges",void 0),(0,p._)([(0,m.Cb)({type:Boolean,readOnly:!0})],W.prototype,"userHasFullEditingPrivileges",void 0),(0,p._)([(0,m.Cb)({type:Boolean,readOnly:!0})],W.prototype,"userHasUpdateItemPrivileges",void 0),W=(0,p._)([(0,C.j)("esri.layers.mixins.PortalLayer")],W),W},O={credential:null,user:null}},25836:(oe,$,s)=>{s.d($,{Q:()=>D});var S=s(15861),p=s(50484),R=(s(14007),s(4703)),z=s(79412),P=s(80543),T=s(73018),K=(s(65311),s(10141)),f=s(76215),y=s(83944),j=(s(37636),s(57964),s(12926),s(43571));const C=new y.Z,d=new WeakMap;function L(c,v){return Number.isFinite(c)&&Number.isFinite(v)?v<=0?c:L(v,c%v):0}let M=0,g=0;function O(){const c=Date.now();let v=!1;for(const F of C){const b=F.deref();b?b.refreshInterval&&c-(d.get(b)??0)+5>=6e4*b.refreshInterval&&(d.set(b,c),b.refresh(c)):v=!0}if(v)for(let F=C.length-1;F>=0;F--)C.at(F).deref()||C.removeAt(F)}(0,j.EH)(()=>{const c=Date.now();let v=0;for(const F of C){const b=F.deref();b&&(v=L(Math.round(6e4*b.refreshInterval),v),b.refreshInterval?d.get(b)||d.set(b,c):d.delete(b))}if(v!==g){if(g=v,clearInterval(M),0===g)return void(M=0);M=setInterval(O,g)}});const D=c=>{let v=class extends c{constructor(...F){super(...F),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,z.Ds)(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||function a(c){(function _(c){return null!=c&&"object"==typeof c&&"refreshInterval"in c&&"refresh"in c})(c)&&C.push(new WeakRef(c))}(this)},()=>{})}destroy(){!function h(c){const v=C.find(F=>F.deref()===c);v&&C.remove(v)}(this)}castRefreshInterval(F){return F>=.1?F:F<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(F=Date.now()){(0,z.R8)(this._debounceHasDataChanged()).then(b=>{b&&this._set("refreshTimestamp",F),this.emit("refresh",{dataChanged:b})},b=>{R.Z.getLogger(this).error(b),this.emit("refresh",{dataChanged:!1,error:b})})}hasDataChanged(){return(0,S.Z)(function*(){return!0})()}get test(){}};return(0,p._)([(0,P.Cb)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:f.C}}}}})],v.prototype,"refreshInterval",void 0),(0,p._)([(0,T.p)("refreshInterval")],v.prototype,"castRefreshInterval",null),(0,p._)([(0,P.Cb)({readOnly:!0})],v.prototype,"refreshTimestamp",void 0),(0,p._)([(0,P.Cb)({readOnly:!0})],v.prototype,"refreshParameters",null),v=(0,p._)([(0,K.j)("esri.layers.mixins.RefreshableLayer")],v),v}},40100:(oe,$,s)=>{s.d($,{Z:()=>I});var S=s(57964),p=s(89317),Y=s(4703),R=s(8611),z=s(15398),P=s(85295),T=s(764),G=s(25037);const m=new Map;class I{static fromJSON(h){return new I(h.fields,h.timeZoneByFieldName)}static fromLayer(h){return new I(h.fields??[],d(h))}static fromLayerJSON(h){return new I(h.fields??[],d(h))}constructor(h=[],_){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=h||[],this._timeZoneByFieldName=_?new Map(_):null;const L=[];for(const M of this.fields){const g=M?.name,O=j(g);if(g&&O){const U=w(g);this._fieldsMap.set(g,M),this._fieldsMap.set(U,M),this._normalizedFieldsMap.set(O,M),L.push(`${U}:${M.type}:${this._timeZoneByFieldName?.get(g)}`),(0,P.y2)(M)?(this.dateFields.push(M),this._dateFieldsSet.add(M)):(0,P.H7)(M)&&(this._numericFieldsSet.add(M),this.numericFields.push(M)),(0,P.Dl)(M)||(0,P.Se)(M)||(M.editable=null==M.editable||!!M.editable,M.nullable=null==M.nullable||!!M.nullable)}}L.sort(),this.uid=L.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const h of this.fields)(0,P.Dl)(h)||(0,P.Se)(h)||h.nullable||void 0!==(0,P.os)(h)||this._requiredFields.push(h)}return this._requiredFields}equals(h){return this.uid===h?.uid}has(h){return null!=this.get(h)}get(h){if(!h)return;let _=this._fieldsMap.get(h);return _||(_=this._fieldsMap.get(w(h))??this._normalizedFieldsMap.get(j(h)),_&&this._fieldsMap.set(h,_),_)}getTimeZone(h){const _=this.get(h&&"string"!=typeof h?h.name:h);return _?this._timeZoneByFieldName?this._timeZoneByFieldName.get(_.name):"date"===_.type||"esriFieldTypeDate"===_.type?(Y.Z.getLogger("esri.layers.support.FieldsIndex").error(new S.Z("getTimeZone:no-timezone-information",`no time zone information for field '${_.name}'`)),T.pt):C.has(_.type)?T._4:null:null}getLuxonTimeZone(h){const _=this.getTimeZone(h);return _?_===T._4?z.yV.instance:_===T.pt?G.Qf.utcInstance:(0,R.s1)(m,_,()=>G.vF.create(_)):null}isDateField(h){return this._dateFieldsSet.has(this.get(h))}isTimeOnlyField(h){return(0,P.sX)(this.get(h))}isNumericField(h){return this._numericFieldsSet.has(this.get(h))}normalizeFieldName(h){return this.get(h)?.name??void 0}toJSON(){return{fields:this.fields.map(h=>(0,p.AK)(h)?h.toJSON():h),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function w(a){return a.trim().toLowerCase()}function j(a){return(0,P.q6)(a)?.toLowerCase()??""}const C=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function d(a){const h=new Map;if(!a.fields)return h;const _=!0===a.datesInUnknownTimezone,{timeInfo:L,editFieldsInfo:M}=a,g=(L?"startField"in L?L.startField:L.startTimeField:"")??"",O=(L?"endField"in L?L.endField:L.endTimeField:"")??"",U=function y(a){return"dateFieldsTimeZone"in a}(a)?a.dateFieldsTimeZone??null:a.dateFieldsTimeReference?(0,T.Jv)(a.dateFieldsTimeReference):null,W=M?function K(a){return"timeZone"in a}(M)?M.timeZone??U:M.dateFieldsTimeReference?(0,T.Jv)(M.dateFieldsTimeReference):U??T.pt:null,Z=L?function f(a){return"timeZone"in a}(L)?L.timeZone??U:L.timeReference?(0,T.Jv)(L.timeReference):U:null,D=new Map([[w(M?.creationDateField??""),W],[w(M?.editDateField??""),W],[w(g),Z],[w(O),Z]]);for(const{name:c,type:v}of a.fields)if(C.has(v))h.set(c,T._4);else if("date"!==v&&"esriFieldTypeDate"!==v)h.set(c,null);else if(_)h.set(c,T._4);else{const F=D.get(w(c??""))??U;h.set(c,F)}return h}},35469:(oe,$,s)=>{s.d($,{Z:()=>m});var K,S=s(50484),p=s(84303),Y=s(89317),R=s(80543),G=(s(14007),s(4703),s(65311),s(10141));const f=new p.X({asc:"ascending",desc:"descending"});let y=K=class extends Y.wq{constructor(I){super(I),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new K({field:this.field,valueExpression:this.valueExpression,order:this.order})}};(0,S._)([(0,R.Cb)({type:String,json:{write:!0}})],y.prototype,"field",void 0),(0,S._)([(0,R.Cb)({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],y.prototype,"valueExpression",void 0),(0,S._)([(0,R.Cb)({type:f.apiValues,json:{type:f.jsonValues,read:f.read,write:f.write}})],y.prototype,"order",void 0),y=K=(0,S._)([(0,G.j)("esri.layers.support.OrderByInfo")],y);const m=y},56761:(oe,$,s)=>{s.d($,{UG:()=>y,UO:()=>j,YI:()=>w,dI:()=>C,el:()=>M,hV:()=>I,z7:()=>m});var S=s(72578);const p="__begin__",Y="__end__",R=new RegExp(p,"ig"),z=new RegExp(Y,"ig"),P=new RegExp("^"+p,"i"),T=new RegExp(Y+"$","i"),G='"',K=G+" + ",f=" + "+G;function y(g){return g.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function m(g){return g.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function I(g){const O={expression:"",type:"none"};return g.labelExpressionInfo?g.labelExpressionInfo.value?(O.expression=g.labelExpressionInfo.value,O.type="conventional"):g.labelExpressionInfo.expression&&(O.expression=g.labelExpressionInfo.expression,O.type="arcade"):null!=g.labelExpression&&(O.expression=y(g.labelExpression),O.type="conventional"),O}function w(g){const O=I(g);if(!O)return null;switch(O.type){case"conventional":return C(O.expression);case"arcade":return O.expression}return null}function j(g){const O=I(g);if(!O)return null;switch(O.type){case"conventional":return function a(g){return g?.match(d)?.[1].trim()||null}(O.expression);case"arcade":return M(O.expression)}return null}function C(g){let O;return g?(O=(0,S.gx)(g,U=>p+'$feature["'+U+'"]'+Y),O=P.test(O)?O.replace(P,""):G+O,O=T.test(O)?O.replace(T,""):O+G,O=O.replaceAll(R,K).replaceAll(z,f)):O='""',O}const d=/^\s*\{([^}]+)\}\s*$/i,h=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,_=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,L=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function M(g){if(!g)return null;let O=h.exec(g)||_.exec(g);return O?O[1]||O[3]:(O=L.exec(g),O?O[2]:null)}},50318:(oe,$,s)=>{s.d($,{$o:()=>m,Fj:()=>K,IW:()=>y,Ss:()=>j,_$:()=>G,ck:()=>f,hz:()=>w,qj:()=>T});var S=s(15861),p=s(83821),Y=s(43814),R=s(48230);function P(){return(P=(0,S.Z)(function*(C){const d=C.spatialReference;if(d.isWGS84)return C.clone();if(d.isWebMercator)return(0,R.Sx)(C);const a=Y.Z.WGS84;return yield(0,p.initializeProjection)(d,a),(0,p.project)(C,a)})).apply(this,arguments)}function T(C,d){if(!G(C,d)){const a=C.typeKeywords;a?a.push(d):C.typeKeywords=[d]}}function G(C,d){return!!C.typeKeywords?.includes(d)}function K(C){return G(C,w.HOSTED_SERVICE)}function f(C,d){const a=C.typeKeywords;if(a){const h=a.indexOf(d);h>-1&&a.splice(h,1)}}function y(C,d,a){a?T(C,d):f(C,d)}function m(C){return I.apply(this,arguments)}function I(){return I=(0,S.Z)(function*(C){const d=C.clone().normalize();let a;if(d.length>1)for(const h of d)a?h.width>a.width&&(a=h):a=h;else a=d[0];return function z(C){return P.apply(this,arguments)}(a)}),I.apply(this,arguments)}const w={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function j(C){const{portal:d,isOrgItem:a,itemControl:h}=C,_=d.user?.privileges;let L=!_||_.includes("features:user:edit"),M=!!a&&!!_?.includes("features:user:fullEdit");const g="update"===h||"admin"===h;return g?M=L=!0:M&&(L=!0),{features:{edit:L,fullEdit:M},content:{updateItem:g}}}},96043:(oe,$,s)=>{s.d($,{AJ:()=>T,If:()=>f,k0:()=>P,uI:()=>K,ul:()=>z,wx:()=>y});var S=s(55117),p=s(55768),Y=s(5710),R=s(23515);const z=2.4;function P(m){return(0,p.Wz)(m*z)}function T(m){return(0,p.F2)(m)/z}function G(m,I,w,j){let{color:C,ratio:d}=I,{color:a,ratio:h}=w;h===d&&(1===h?d-=1e-6:h+=1e-6);const _=(0,S.uZ)((j-d)/(h-d),0,1);(0,Y.l)(m,C.toArray(),a.toArray(),_)}function K(m){const w=new Uint8ClampedArray(2048);if((m=m.filter(({ratio:h})=>h>=0&&h<=1).sort((h,_)=>h.ratio-_.ratio).map(({color:h,ratio:_})=>({color:h,ratio:Math.max(_,.001)}))).length<1)return w;let j=m[0],C=m[0],d=1;const a=(0,R.Ue)();for(let h=0;h<512;h++){const _=(h+.5)/512;for(;_>C.ratio&&d<m.length;)j=C,C=m[d++];G(a,j,C,_),w.set(a,4*h)}return w}function f(m,I,w){const j=Math.sqrt(m**2+I**2)/w;return j>1?0:3/(Math.PI*w**2)*(1-j**2)**2}function y(m){return"function"==typeof m?m:m?I=>+I[m]:()=>1}},93792:(oe,$,s)=>{s.d($,{Z:()=>h});var C,S=s(50484),p=s(2189),Y=s(35458),R=s(84303),z=s(89317),P=s(34222),T=s(80543),f=(s(14007),s(4703),s(62185)),y=s(10141),m=s(7547),I=s(43814),w=s(40637),j=s(81247);const d=new R.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let a=C=class extends z.wq{constructor(_){super(_),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(_,L){const M=I.Z.fromJSON(L.spatialReference),g=[];for(let O=0;O<_.length;O++){const U=_[O],W=Y.Z.fromJSON(U),Z=U.geometry?.spatialReference;null==W.geometry||Z||(W.geometry.spatialReference=M);const D=U.aggregateGeometries,c=W.aggregateGeometries;if(D&&null!=c)for(const v in c){const F=c[v],b=D[v],re=b?.spatialReference;null==F||re||(F.spatialReference=M)}g.push(W)}return g}writeGeometryType(_,L,M,g){if(_)return void d.write(_,L,M,g);const{features:O}=this;if(O)for(const U of O)if(null!=U?.geometry)return void d.write(U.geometry.type,L,M,g)}readQueryGeometry(_,L){if(!_)return null;const M=!!_.spatialReference,g=(0,w.im)(_);return g&&!M&&L.spatialReference&&(g.spatialReference=I.Z.fromJSON(L.spatialReference)),g}writeSpatialReference(_,L){if(_)return void(L.spatialReference=_.toJSON());const{features:M}=this;if(M)for(const g of M)if(g&&null!=g.geometry&&g.geometry.spatialReference)return void(L.spatialReference=g.geometry.spatialReference.toJSON())}clone(){return new C(this.cloneProperties())}cloneProperties(){return(0,P.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(_){const L=this.write();if(L.features&&Array.isArray(_)&&_.length>0)for(let M=0;M<L.features.length;M++){const g=L.features[M];if(g.geometry){const O=_?.[M];g.geometry=O?.toJSON()||g.geometry}}return L}quantize(_){const{scale:[L,M],translate:[g,O]}=_,Z=this.features,D=this._getQuantizationFunction(this.geometryType,c=>Math.round((c-g)/L),c=>Math.round((O-c)/M));for(let c=0,v=Z.length;c<v;c++)D?.(Z[c].geometry)||(Z.splice(c,1),c--,v--);return this.transform=_,this}unquantize(){const{geometryType:_,features:L,transform:M}=this;if(!M)return this;const{translate:[g,O],scale:[U,W]}=M;let c=null,v=null;if(this.hasZ&&null!=M?.scale?.[2]){const{translate:[,,b],scale:[,,re]}=M;c=k=>k*re+b}if(this.hasM&&null!=M?.scale?.[3]){const{translate:[,,,b],scale:[,,,re]}=M;v=k=>null==k?k:k*re+b}const F=this._getHydrationFunction(_,b=>b*U+g,b=>O-b*W,c,v);for(const{geometry:b}of L)null!=b&&F&&F(b);return this.transform=null,this}_quantizePoints(_,L,M){let g,O;const U=[];for(let W=0,Z=_.length;W<Z;W++){const D=_[W];if(W>0){const c=L(D[0]),v=M(D[1]);c===g&&v===O||(U.push([c-g,v-O]),g=c,O=v)}else g=L(D[0]),O=M(D[1]),U.push([g,O])}return U.length>0?U:null}_getQuantizationFunction(_,L,M){return"point"===_?g=>(g.x=L(g.x),g.y=M(g.y),g):"polyline"===_||"polygon"===_?g=>{const O=(0,w.oU)(g)?g.rings:g.paths,U=[];for(let W=0,Z=O.length;W<Z;W++){const c=this._quantizePoints(O[W],L,M);c&&U.push(c)}return U.length>0?((0,w.oU)(g)?g.rings=U:g.paths=U,g):null}:"multipoint"===_?g=>{const O=this._quantizePoints(g.points,L,M);return O&&O.length>0?(g.points=O,g):null}:"extent"===_?g=>g:null}_getHydrationFunction(_,L,M,g,O){return"point"===_?U=>{U.x=L(U.x),U.y=M(U.y),g&&(U.z=g(U.z))}:"polyline"===_||"polygon"===_?U=>{const W=(0,w.oU)(U)?U.rings:U.paths;let Z,D;for(let c=0,v=W.length;c<v;c++){const F=W[c];for(let b=0,re=F.length;b<re;b++){const k=F[b];b>0?(Z+=k[0],D+=k[1]):(Z=k[0],D=k[1]),k[0]=L(Z),k[1]=M(D)}}if(g&&O)for(let c=0,v=W.length;c<v;c++){const F=W[c];for(let b=0,re=F.length;b<re;b++){const k=F[b];k[2]=g(k[2]),k[3]=O(k[3])}}else if(g)for(let c=0,v=W.length;c<v;c++){const F=W[c];for(let b=0,re=F.length;b<re;b++){const k=F[b];k[2]=g(k[2])}}else if(O)for(let c=0,v=W.length;c<v;c++){const F=W[c];for(let b=0,re=F.length;b<re;b++){const k=F[b];k[2]=O(k[2])}}}:"extent"===_?U=>{U.xmin=L(U.xmin),U.ymin=M(U.ymin),U.xmax=L(U.xmax),U.ymax=M(U.ymax),g&&null!=U.zmax&&null!=U.zmin&&(U.zmax=g(U.zmax),U.zmin=g(U.zmin)),O&&null!=U.mmax&&null!=U.mmin&&(U.mmax=O(U.mmax),U.mmin=O(U.mmin))}:"multipoint"===_?U=>{const W=U.points;let Z,D;for(let c=0,v=W.length;c<v;c++){const F=W[c];c>0?(Z+=F[0],D+=F[1]):(Z=F[0],D=F[1]),F[0]=L(Z),F[1]=M(D)}if(g&&O)for(let c=0,v=W.length;c<v;c++){const F=W[c];F[2]=g(F[2]),F[3]=O(F[3])}else if(g)for(let c=0,v=W.length;c<v;c++){const F=W[c];F[2]=g(F[2])}else if(O)for(let c=0,v=W.length;c<v;c++){const F=W[c];F[2]=O(F[2])}}:null}};(0,S._)([(0,T.Cb)({type:String,json:{write:!0}})],a.prototype,"displayFieldName",void 0),(0,S._)([(0,T.Cb)({type:Boolean,json:{write:{overridePolicy:_=>({enabled:_})}}})],a.prototype,"exceededTransferLimit",void 0),(0,S._)([(0,T.Cb)({type:[Y.Z],json:{write:!0}})],a.prototype,"features",void 0),(0,S._)([(0,f.r)("features")],a.prototype,"readFeatures",null),(0,S._)([(0,T.Cb)({type:[j.Z],json:{write:!0}})],a.prototype,"fields",void 0),(0,S._)([(0,T.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:d.read}}})],a.prototype,"geometryType",void 0),(0,S._)([(0,m.c)("geometryType")],a.prototype,"writeGeometryType",null),(0,S._)([(0,T.Cb)({type:Boolean,json:{write:{overridePolicy:_=>({enabled:_})}}})],a.prototype,"hasM",void 0),(0,S._)([(0,T.Cb)({type:Boolean,json:{write:{overridePolicy:_=>({enabled:_})}}})],a.prototype,"hasZ",void 0),(0,S._)([(0,T.Cb)({types:p.qM,json:{write:!0}})],a.prototype,"queryGeometry",void 0),(0,S._)([(0,f.r)("queryGeometry")],a.prototype,"readQueryGeometry",null),(0,S._)([(0,T.Cb)({type:I.Z,json:{write:!0}})],a.prototype,"spatialReference",void 0),(0,S._)([(0,m.c)("spatialReference")],a.prototype,"writeSpatialReference",null),(0,S._)([(0,T.Cb)({json:{write:!0}})],a.prototype,"transform",void 0),a=C=(0,S._)([(0,y.j)("esri.rest.support.FeatureSet")],a),a.prototype.toJSON.isDefaultToJSON=!0;const h=a}}]);