"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[6066,9005],{51955:(re,G,r)=>{r.d(G,{K:()=>D});var g=r(73145),t=r(83821),M=r(83639);function D(B,A,R,K){if((0,t.canProjectWithoutEngine)(B.spatialReference,R))return I[0]=B.x,I[1]=B.y,I[2]=B.z??K??0,(0,M.projectBuffer)(I,B.spatialReference,0,A,R,0,1);const s=(0,t.tryProjectWithZConversion)(B,R);return!!s&&(A[0]=s?.x,A[1]=s?.y,A[2]=s?.z??K??0,!0)}const I=(0,g.Ue)()},23080:(re,G,r)=>{r.r(G),r.d(G,{default:()=>gt});var g=r(15861),t=r(50484),M=r(83944),D=r(5603),T=r(57964),_=r(34222),I=r(30352),B=r(4703),A=r(3233),R=r(79412),K=r(6785),s=r(80543),Z=(r(14007),r(62185)),S=r(10141),N=r(43814),W=r(95060),O=r(35458),pe=r(62691),a=(r(36699),r(12610),r(53722),r(82752),r(28999),r(38748),r(50923),r(42212),r(91963),r(41007)),C=r(66476),f=r(84303),b=r(67016),F=r(47868),Ie=(r(65311),r(21070)),we=r(26894),Pe=r(90373),Ke=r(84373),Ne=r(1535),H=r(56956);let U=class extends((0,Ke.IG)(A.w)){constructor(e){super(e),this.title="",this.id=-1,this.modelName=null,this.isEmpty=null,this.legendEnabled=!0,this.visible=!0,this.opacity=1}readTitle(e,i){return"string"==typeof i.alias?i.alias:"string"==typeof i.name?i.name:""}readIdOnlyOnce(e){return-1!==this.id?this.id:"number"==typeof e?e:-1}};(0,t._)([(0,s.Cb)({type:String,json:{origins:{"web-scene":{write:!0},"portal-item":{write:!0}}}})],U.prototype,"title",void 0),(0,t._)([(0,Z.r)("service","title",["alias","name"])],U.prototype,"readTitle",null),(0,t._)([(0,s.Cb)()],U.prototype,"layer",void 0),(0,t._)([(0,s.Cb)({type:Ne.z8,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],U.prototype,"id",void 0),(0,t._)([(0,Z.r)("service","id")],U.prototype,"readIdOnlyOnce",null),(0,t._)([(0,s.Cb)((0,H.Lx)(String))],U.prototype,"modelName",void 0),(0,t._)([(0,s.Cb)((0,H.Lx)(Boolean))],U.prototype,"isEmpty",void 0),(0,t._)([(0,s.Cb)({type:Boolean,nonNullable:!0})],U.prototype,"legendEnabled",void 0),(0,t._)([(0,s.Cb)({type:Boolean,json:{name:"visibility",write:!0}})],U.prototype,"visible",void 0),(0,t._)([(0,s.Cb)({type:Number,json:{write:!0}})],U.prototype,"opacity",void 0),U=(0,t._)([(0,S.j)("esri.layers.buildingSublayers.BuildingSublayer")],U);const _e=U;var We=r(36297),Ge=r(27969),Je=r(40100),Qe=r(85295),ze=r(7741),se=r(46637),Ve=r(91866),He=r(33331),Xe=r(86516),$e=r(13643),Be=r(96696);const Le=(0,Ge.v)();let p=class extends(b.Z.LoadableMixin((0,F.v)(_e))){constructor(e){super(e),this.type="building-component",this.nodePages=null,this.materialDefinitions=[],this.textureSetDefinitions=[],this.geometryDefinitions=[],this.indexInfo=null,this.serviceUpdateTimeStamp=null,this.store=null,this.attributeStorageInfo=[],this.fields=[],this.associatedLayer=null,this.outFields=null,this.listMode="show",this.renderer=null,this.definitionExpression=null,this.popupEnabled=!0,this.popupTemplate=null,this.layerType="3d-object"}get parsedUrl(){return this.layer?{path:`${this.layer.parsedUrl?.path}/sublayers/${this.id}`,query:this.layer.parsedUrl?.query}:{path:""}}get fieldsIndex(){return new Je.Z(this.fields)}readAssociatedLayer(e,i){const n=this.layer.associatedFeatureServiceItem,u=i.associatedLayerID;return null!=n&&"number"==typeof u?new Pe.default({portalItem:n,customParameters:this.customParameters,layerId:u}):null}get objectIdField(){if(null!=this.fields)for(const e of this.fields)if("oid"===e.type)return e.name;return null}get displayField(){return null!=this.associatedLayer?this.associatedLayer.displayField:void 0}get apiKey(){return this.layer.apiKey}get customParameters(){return this.layer.customParameters}get fullExtent(){return this.layer.fullExtent}get spatialReference(){return this.layer.spatialReference}get version(){return this.layer.version}get elevationInfo(){return this.layer.elevationInfo}get minScale(){return this.layer.minScale}get maxScale(){return this.layer.maxScale}get effectiveScaleRange(){return this.layer.effectiveScaleRange}get defaultPopupTemplate(){return this.createPopupTemplate()}load(e){const i=null!=e?e.signal:null,n=this._fetchService(i).then(()=>{this.indexInfo=(0,ze.T)(this.parsedUrl.path,this.rootNode,this.nodePages,this.customParameters,this.apiKey,B.Z.getLogger(this),i)});return this.addResolvingPromise(n),Promise.resolve(this)}createPopupTemplate(e){return(0,He.eZ)(this,e)}_fetchService(e){var i=this;return(0,g.Z)(function*(){const n=(yield(0,C.Z)(i.parsedUrl.path,{query:{f:"json",...i.customParameters,token:i.apiKey},responseType:"json",signal:e})).data;i.read(n,{origin:"service",url:i.parsedUrl})})()}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,i){const n=this.getFeatureType(i?.feature)?.domains?.[e];return n&&"inherited"!==n.type?n:this.getField(e)?.domain??null}getFeatureType(e){return e&&null!=this.associatedLayer?this.associatedLayer.getFeatureType(e):null}get types(){return null!=this.associatedLayer?this.associatedLayer.types??[]:[]}get typeIdField(){return null!=this.associatedLayer?this.associatedLayer.typeIdField:null}get geometryType(){return"3d-object"===this.layerType?"mesh":"point"}get profile(){return"3d-object"===this.layerType?"mesh-pyramids":"points"}get capabilities(){const e=null!=this.associatedLayer&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:We.C,{query:i,data:{supportsZ:n,supportsM:u,isVersioned:w}}=e;return{query:i,data:{supportsZ:n,supportsM:u,isVersioned:w}}}createQuery(){const e=new Ve.Z;return"mesh"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||"1=1",e.sqlFormat="standard",e}queryExtent(e,i){return this._getAssociatedLayerForQuery().then(n=>n.queryExtent(e||this.createQuery(),i))}queryFeatureCount(e,i){return this._getAssociatedLayerForQuery().then(n=>n.queryFeatureCount(e||this.createQuery(),i))}queryFeatures(e,i){return this._getAssociatedLayerForQuery().then(n=>n.queryFeatures(e||this.createQuery(),i)).then(n=>{if(n?.features)for(const u of n.features)u.layer=this.layer,u.sourceLayer=this;return n})}queryObjectIds(e,i){return this._getAssociatedLayerForQuery().then(n=>n.queryObjectIds(e||this.createQuery(),i))}queryCachedAttributes(e,i){var n=this;return(0,g.Z)(function*(){const u=(0,Qe.Lk)(n.fieldsIndex,yield(0,Be.e7)(n,(0,Be.V5)(n)));return(0,$e.xe)(n.parsedUrl.path,n.attributeStorageInfo,e,i,u,n.apiKey,n.customParameters)})()}queryCachedFeature(e,i){var n=this;return(0,g.Z)(function*(){const u=yield n.queryCachedAttributes(e,[i]);if(!u||0===u.length)throw new T.Z("scenelayer:feature-not-in-cached-data","Feature not found in cached data");return new O.Z({attributes:u[0],layer:n,sourceLayer:n})})()}getFieldUsageInfo(e){return this.fieldsIndex.has(e)?{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}:{supportsLabelingInfo:!1,supportsRenderer:!0,supportsPopupTemplate:!0,supportsLayerQuery:null!=this.associatedLayer}}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return null!=e&&e.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}_loadAssociatedLayerForQuery(){var e=this;return(0,g.Z)(function*(){if(yield e.load(),null==e.associatedLayer)throw new T.Z("buildingscenelayer:query-not-available","BuildingSceneLayer component layer queries are not available without an associated feature layer",{layer:e});try{yield e.associatedLayer.load()}catch(i){throw new T.Z("buildingscenelayer:query-not-available","BuildingSceneLayer associated feature layer could not be loaded",{layer:e,error:i})}return e.associatedLayer})()}};(0,t._)([(0,s.Cb)({readOnly:!0})],p.prototype,"parsedUrl",null),(0,t._)([(0,s.Cb)({type:se.U4,readOnly:!0})],p.prototype,"nodePages",void 0),(0,t._)([(0,s.Cb)({type:[se.QI],readOnly:!0})],p.prototype,"materialDefinitions",void 0),(0,t._)([(0,s.Cb)({type:[se.Yh],readOnly:!0})],p.prototype,"textureSetDefinitions",void 0),(0,t._)([(0,s.Cb)({type:[se.H3],readOnly:!0})],p.prototype,"geometryDefinitions",void 0),(0,t._)([(0,s.Cb)({readOnly:!0})],p.prototype,"serviceUpdateTimeStamp",void 0),(0,t._)([(0,s.Cb)({readOnly:!0})],p.prototype,"store",void 0),(0,t._)([(0,s.Cb)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],p.prototype,"rootNode",void 0),(0,t._)([(0,s.Cb)({readOnly:!0})],p.prototype,"attributeStorageInfo",void 0),(0,t._)([(0,s.Cb)(Le.fields)],p.prototype,"fields",void 0),(0,t._)([(0,s.Cb)({readOnly:!0})],p.prototype,"fieldsIndex",null),(0,t._)([(0,s.Cb)({readOnly:!0,type:Pe.default})],p.prototype,"associatedLayer",void 0),(0,t._)([(0,Z.r)("service","associatedLayer",["associatedLayerID"])],p.prototype,"readAssociatedLayer",null),(0,t._)([(0,s.Cb)(Le.outFields)],p.prototype,"outFields",void 0),(0,t._)([(0,s.Cb)({type:String,readOnly:!0})],p.prototype,"objectIdField",null),(0,t._)([(0,s.Cb)({readOnly:!0,type:String,json:{read:!1}})],p.prototype,"displayField",null),(0,t._)([(0,s.Cb)({readOnly:!0,type:String})],p.prototype,"apiKey",null),(0,t._)([(0,s.Cb)({readOnly:!0,type:String})],p.prototype,"customParameters",null),(0,t._)([(0,s.Cb)({readOnly:!0,type:we.Z})],p.prototype,"fullExtent",null),(0,t._)([(0,s.Cb)({readOnly:!0,type:N.Z})],p.prototype,"spatialReference",null),(0,t._)([(0,s.Cb)({readOnly:!0})],p.prototype,"version",null),(0,t._)([(0,s.Cb)({readOnly:!0,type:Xe.Z})],p.prototype,"elevationInfo",null),(0,t._)([(0,s.Cb)({readOnly:!0,type:Number})],p.prototype,"minScale",null),(0,t._)([(0,s.Cb)({readOnly:!0,type:Number})],p.prototype,"maxScale",null),(0,t._)([(0,s.Cb)({readOnly:!0,type:Number})],p.prototype,"effectiveScaleRange",null),(0,t._)([(0,s.Cb)({type:["hide","show"],json:{write:!0}})],p.prototype,"listMode",void 0),(0,t._)([(0,s.Cb)({types:a.o,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],p.prototype,"renderer",void 0),(0,t._)([(0,s.Cb)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],p.prototype,"definitionExpression",void 0),(0,t._)([(0,s.Cb)(H.C_)],p.prototype,"popupEnabled",void 0),(0,t._)([(0,s.Cb)({type:pe.Z,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],p.prototype,"popupTemplate",void 0),(0,t._)([(0,s.Cb)({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],p.prototype,"normalReferenceFrame",void 0),(0,t._)([(0,s.Cb)({readOnly:!0,json:{read:!1}})],p.prototype,"defaultPopupTemplate",null),(0,t._)([(0,s.Cb)()],p.prototype,"types",null),(0,t._)([(0,s.Cb)()],p.prototype,"typeIdField",null),(0,t._)([(0,s.Cb)({json:{write:!1}}),(0,Ie.J)(new f.X({"3DObject":"3d-object",Point:"point"}))],p.prototype,"layerType",void 0),(0,t._)([(0,s.Cb)()],p.prototype,"geometryType",null),(0,t._)([(0,s.Cb)()],p.prototype,"profile",null),(0,t._)([(0,s.Cb)({readOnly:!0,json:{read:!1}})],p.prototype,"capabilities",null),(0,t._)([(0,s.Cb)({readOnly:!0})],p.prototype,"statisticsInfo",void 0),p=(0,t._)([(0,S.j)("esri.layers.buildingSublayers.BuildingComponentSublayer")],p);const ue=p;var ce,Ye=r(23206);const xe={type:M.Z,readOnly:!0,json:{origins:{service:{read:{source:"sublayers",reader:Fe}}},read:!1}};function Fe(e,i,n){if(e&&Array.isArray(e))return new M.Z(e.map(u=>{const w=function qe(e){return"group"===e.layerType?Q:ue}(u);if(w){const te=new w;return te.read(u,n),te}return n?.messages&&u&&n.messages.push(new Ye.Z("building-scene-layer:unsupported-sublayer-type","Building scene sublayer of type '"+(u.type||"unknown")+"' are not supported",{definition:u,context:n})),null}))}let Q=ce=class extends _e{constructor(e){super(e),this.type="building-group",this.listMode="show",this.sublayers=null}loadAll(){return(0,I.w)(this,e=>ce.forEachSublayer(this.sublayers,i=>{"building-group"!==i.type&&e(i)}))}};var e;(0,t._)([(0,s.Cb)({type:["hide","show","hide-children"],json:{write:!0}})],Q.prototype,"listMode",void 0),(0,t._)([(0,s.Cb)(xe)],Q.prototype,"sublayers",void 0),Q=ce=(0,t._)([(0,S.j)("esri.layers.buildingSublayers.BuildingGroupSublayer")],Q),(e=Q||(Q={})).sublayersProperty=xe,e.readSublayers=Fe,e.forEachSublayer=function i(n,u){n.forEach(w=>{u(w),"building-group"===w.type&&i(w.sublayers,u)})};const X=Q;var ke=r(29674),et=r(4257),tt=r(27426),rt=r(80099),st=r(70509),ot=r(29717),he=r(38866),it=r(63724),z=r(89317),nt=r(19986);let oe=class extends z.wq{constructor(){super(...arguments),this.type=null}};(0,t._)([(0,s.Cb)({type:String,readOnly:!0,json:{write:!0}})],oe.prototype,"type",void 0),oe=(0,t._)([(0,S.j)("esri.layers.support.BuildingFilterAuthoringInfo")],oe);const Me=oe;var fe;let Y=fe=class extends z.wq{constructor(){super(...arguments),this.filterType=null,this.filterValues=null}clone(){return new fe({filterType:this.filterType,filterValues:(0,_.d9)(this.filterValues)})}};var ge;(0,t._)([(0,s.Cb)({type:String,json:{write:!0}})],Y.prototype,"filterType",void 0),(0,t._)([(0,s.Cb)({type:[String],json:{write:!0}})],Y.prototype,"filterValues",void 0),Y=fe=(0,t._)([(0,S.j)("esri.layers.support.BuildingFilterAuthoringInfoType")],Y);const at=M.Z.ofType(Y);let ie=ge=class extends z.wq{clone(){return new ge({filterTypes:(0,_.d9)(this.filterTypes)})}};var me;(0,t._)([(0,s.Cb)({type:at,json:{write:!0}})],ie.prototype,"filterTypes",void 0),ie=ge=(0,t._)([(0,S.j)("esri.layers.support.BuildingFilterAuthoringInfoBlock")],ie);const dt=M.Z.ofType(ie);let q=me=class extends Me{constructor(){super(...arguments),this.type="checkbox"}clone(){return new me({filterBlocks:(0,_.d9)(this.filterBlocks)})}};(0,t._)([(0,s.Cb)({type:["checkbox"]})],q.prototype,"type",void 0),(0,t._)([(0,s.Cb)({type:dt,json:{write:!0}})],q.prototype,"filterBlocks",void 0),q=me=(0,t._)([(0,S.j)("esri.layers.support.BuildingFilterAuthoringInfoCheckbox")],q);const Te=q;let ne=class extends z.wq{};(0,t._)([(0,s.Cb)({readOnly:!0,json:{read:!1}})],ne.prototype,"type",void 0),ne=(0,t._)([(0,S.j)("esri.layers.support.BuildingFilterMode")],ne);const le=ne;var ve;let ae=ve=class extends le{constructor(){super(...arguments),this.type="solid"}clone(){return new ve}};(0,t._)([(0,s.Cb)({type:["solid"],readOnly:!0,json:{write:!0}})],ae.prototype,"type",void 0),ae=ve=(0,t._)([(0,S.j)("esri.layers.support.BuildingFilterModeSolid")],ae);const be=ae;var Ce,pt=r(43284);let k=Ce=class extends le{constructor(){super(...arguments),this.type="wire-frame",this.edges=null}clone(){return new Ce({edges:(0,_.d9)(this.edges)})}};(0,t._)([(0,Ie.J)({wireFrame:"wire-frame"})],k.prototype,"type",void 0),(0,t._)([(0,s.Cb)(pt.Z)],k.prototype,"edges",void 0),k=Ce=(0,t._)([(0,S.j)("esri.layers.support.BuildingFilterModeWireFrame")],k);const Re=k;var Se;let ye=Se=class extends le{constructor(){super(...arguments),this.type="x-ray"}clone(){return new Se}};(0,t._)([(0,s.Cb)({type:["x-ray"],readOnly:!0,json:{write:!0}})],ye.prototype,"type",void 0),ye=Se=(0,t._)([(0,S.j)("esri.layers.support.BuildingFilterModeXRay")],ye);const De=ye;var Oe;const ut={nonNullable:!0,types:{key:"type",base:le,typeMap:{solid:be,"wire-frame":Re,"x-ray":De}},json:{read:e=>{switch(e?.type){case"solid":return be.fromJSON(e);case"wireFrame":return Re.fromJSON(e);case"x-ray":return De.fromJSON(e);default:return}},write:{enabled:!0,isRequired:!0}}};let $=Oe=class extends z.wq{constructor(){super(...arguments),this.filterExpression=null,this.filterMode=new be,this.title=""}clone(){return new Oe({filterExpression:this.filterExpression,filterMode:(0,_.d9)(this.filterMode),title:this.title})}};var Ee;(0,t._)([(0,s.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],$.prototype,"filterExpression",void 0),(0,t._)([(0,s.Cb)(ut)],$.prototype,"filterMode",void 0),(0,t._)([(0,s.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],$.prototype,"title",void 0),$=Oe=(0,t._)([(0,S.j)("esri.layers.support.BuildingFilterBlock")],$);const ht=M.Z.ofType($);let V=Ee=class extends z.wq{constructor(){super(...arguments),this.description=null,this.filterBlocks=null,this.id=(0,nt.DO)(),this.name=null}clone(){return new Ee({description:this.description,filterBlocks:(0,_.d9)(this.filterBlocks),id:this.id,name:this.name,filterAuthoringInfo:(0,_.d9)(this.filterAuthoringInfo)})}};(0,t._)([(0,s.Cb)({type:String,json:{write:!0}})],V.prototype,"description",void 0),(0,t._)([(0,s.Cb)({type:ht,json:{write:{enabled:!0,isRequired:!0}}})],V.prototype,"filterBlocks",void 0),(0,t._)([(0,s.Cb)({types:{key:"type",base:Me,typeMap:{checkbox:Te}},json:{read:e=>"checkbox"===e?.type?Te.fromJSON(e):null,write:!0}})],V.prototype,"filterAuthoringInfo",void 0),(0,t._)([(0,s.Cb)({type:String,constructOnly:!0,json:{write:{enabled:!0,isRequired:!0}}})],V.prototype,"id",void 0),(0,t._)([(0,s.Cb)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],V.prototype,"name",void 0),V=Ee=(0,t._)([(0,S.j)("esri.layers.support.BuildingFilter")],V);const ft=V;let J=class extends z.wq{constructor(){super(...arguments),this.fieldName=null,this.modelName=null,this.label=null,this.min=null,this.max=null,this.mostFrequentValues=null,this.subLayerIds=null}};(0,t._)([(0,s.Cb)({type:String})],J.prototype,"fieldName",void 0),(0,t._)([(0,s.Cb)({type:String})],J.prototype,"modelName",void 0),(0,t._)([(0,s.Cb)({type:String})],J.prototype,"label",void 0),(0,t._)([(0,s.Cb)({type:Number})],J.prototype,"min",void 0),(0,t._)([(0,s.Cb)({type:Number})],J.prototype,"max",void 0),(0,t._)([(0,s.Cb)({json:{read:e=>Array.isArray(e)&&(e.every(i=>"string"==typeof i)||e.every(i=>"number"==typeof i))?e.slice():null}})],J.prototype,"mostFrequentValues",void 0),(0,t._)([(0,s.Cb)({type:[Number]})],J.prototype,"subLayerIds",void 0),J=(0,t._)([(0,S.j)("esri.layers.support.BuildingSummaryStatistics.BuildingFieldStatistics")],J);let ee=class extends(b.Z.LoadableMixin((0,F.v)(z.wq))){constructor(){super(...arguments),this.url=null}get fields(){return this.loaded||"loading"===this.loadStatus?this._get("fields"):(B.Z.getLogger(this).error("building summary statistics are not loaded"),null)}load(e){return this.addResolvingPromise(this._fetchService(null!=e?e.signal:null)),Promise.resolve(this)}_fetchService(e){var i=this;return(0,g.Z)(function*(){const n=(yield(0,C.Z)(i.url,{query:{f:"json"},responseType:"json",signal:e})).data;i.read(n,{origin:"service"})})()}};(0,t._)([(0,s.Cb)({constructOnly:!0,type:String})],ee.prototype,"url",void 0),(0,t._)([(0,s.Cb)({readOnly:!0,type:[J],json:{read:{source:"summary"}}})],ee.prototype,"fields",null),ee=(0,t._)([(0,S.j)("esri.layers.support.BuildingSummaryStatistics")],ee);const Ae=ee;var de=r(43688);const Ue=M.Z.ofType(ft),Ze=(0,_.d9)(X.sublayersProperty),je=Ze.json?.origins;je&&(je["web-scene"]={type:[ue],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}},je["portal-item"]={type:[ue],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}});let L=class extends((0,he.Vt)((0,et.Y)((0,rt.q)((0,st.I)((0,ot.M)((0,A.R)((0,tt.N)((0,ke.V)(W.Z))))))))){constructor(e){super(e),this.operationalLayerType="BuildingSceneLayer",this.allSublayers=new D.Z({getCollections:()=>[this.sublayers],getChildrenFunction:i=>"building-group"===i.type?i.sublayers:null}),this.sublayers=null,this._sublayerOverrides=null,this.filters=new Ue,this.activeFilterId=null,this.summaryStatistics=null,this.outFields=null,this.legendEnabled=!0,this.type="building-scene"}normalizeCtorArgs(e){return"string"==typeof e?{url:e}:e??{}}destroy(){this.allSublayers.destroy()}readSublayers(e,i,n){const u=X.readSublayers(e,i,n);return X.forEachSublayer(u,w=>w.layer=this),this._sublayerOverrides&&(this.applySublayerOverrides(u,this._sublayerOverrides),this._sublayerOverrides=null),u}applySublayerOverrides(e,{overrides:i,context:n}){X.forEachSublayer(e,u=>u.read(i.get(u.id),n))}readSublayerOverrides(e,i){const n=new Map;for(const u of e)null!=u&&"object"==typeof u&&"number"==typeof u.id?n.set(u.id,u):i.messages?.push(new T.Z("building-scene-layer:invalid-sublayer-override","Invalid value for sublayer override. Not an object or no id specified.",{value:u}));return{overrides:n,context:i}}writeSublayerOverrides(e,i,n){const u=[];X.forEachSublayer(this.sublayers,w=>{const te=w.write({},n);Object.keys(te).length>1&&u.push(te)}),u.length>0&&(i.sublayers=u)}writeUnappliedOverrides(e,i){i.sublayers=[],e.overrides.forEach(n=>{i.sublayers.push((0,_.d9)(n))})}write(e,i){return e=super.write(e,i),!i||"web-scene"!==i.origin&&"portal-item"!==i.origin||(this.sublayers?this.writeSublayerOverrides(this.sublayers,e,i):this._sublayerOverrides&&this.writeUnappliedOverrides(this._sublayerOverrides,e)),e}read(e,i){if(super.read(e,i),i&&("web-scene"===i.origin||"portal-item"===i.origin)&&null!=e&&Array.isArray(e.sublayers)){const n=this.readSublayerOverrides(e.sublayers,i);this.sublayers?this.applySublayerOverrides(this.sublayers,n):this._sublayerOverrides=n}}readSummaryStatistics(e,i){if("string"==typeof i.statisticsHRef){const n=(0,K.v_)(this.parsedUrl?.path,i.statisticsHRef);return new Ae({url:n})}return null}set elevationInfo(e){this._set("elevationInfo",e),this._validateElevationInfo()}load(e){const i=null!=e?e.signal:null,n=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(R.r9).then(()=>this._fetchService(i)).then(()=>this._fetchAssociatedFeatureService(i));return this.addResolvingPromise(n),Promise.resolve(this)}loadAll(){return(0,I.G)(this,e=>{X.forEachSublayer(this.sublayers,i=>{"building-group"!==i.type&&e(i)}),this.summaryStatistics&&e(this.summaryStatistics)})}saveAs(e,i){var n=this;return(0,g.Z)(function*(){return n._debouncedSaveOperations(he.xp.SAVE_AS,{...i,getTypeKeywords:()=>n._getTypeKeywords(),portalItemLayerType:"building-scene"},e)})()}save(){var e=this;return(0,g.Z)(function*(){const i={getTypeKeywords:()=>e._getTypeKeywords(),portalItemLayerType:"building-scene"};return e._debouncedSaveOperations(he.xp.SAVE,i)})()}validateLayer(e){if(!e.layerType||"Building"!==e.layerType)throw new T.Z("buildingscenelayer:layer-type-not-supported","BuildingSceneLayer does not support this layer type",{layerType:e.layerType})}_getTypeKeywords(){return["Building"]}_fetchAssociatedFeatureService(e){var i=this;return(0,g.Z)(function*(){try{const{portalItem:n}=yield(0,it.w)(`${i.url}/layers/${i.layerId}`,{sceneLayerItem:i.portalItem,customParameters:i.customParameters,apiKey:i.apiKey,signal:e});i.associatedFeatureServiceItem=n}catch(n){B.Z.getLogger(i).warn("Associated feature service item could not be loaded",n)}})()}_validateElevationInfo(){const e=this.elevationInfo,i="Building scene layers";(0,de.LR)(B.Z.getLogger(this),(0,de.Uy)(i,"absolute-height",e)),(0,de.LR)(B.Z.getLogger(this),(0,de.kf)(i,e))}};(0,t._)([(0,s.Cb)({type:["BuildingSceneLayer"]})],L.prototype,"operationalLayerType",void 0),(0,t._)([(0,s.Cb)({readOnly:!0})],L.prototype,"allSublayers",void 0),(0,t._)([(0,s.Cb)(Ze)],L.prototype,"sublayers",void 0),(0,t._)([(0,Z.r)("service","sublayers")],L.prototype,"readSublayers",null),(0,t._)([(0,s.Cb)({type:Ue,nonNullable:!0,json:{write:!0}})],L.prototype,"filters",void 0),(0,t._)([(0,s.Cb)({type:String,json:{write:!0}})],L.prototype,"activeFilterId",void 0),(0,t._)([(0,s.Cb)({readOnly:!0,type:Ae})],L.prototype,"summaryStatistics",void 0),(0,t._)([(0,Z.r)("summaryStatistics",["statisticsHRef"])],L.prototype,"readSummaryStatistics",null),(0,t._)([(0,s.Cb)({type:[String],json:{read:!1}})],L.prototype,"outFields",void 0),(0,t._)([(0,s.Cb)(H.vg)],L.prototype,"fullExtent",void 0),(0,t._)([(0,s.Cb)(H.rn)],L.prototype,"legendEnabled",void 0),(0,t._)([(0,s.Cb)({type:["show","hide","hide-children"]})],L.prototype,"listMode",void 0),(0,t._)([(0,s.Cb)((0,H.Lx)(N.Z))],L.prototype,"spatialReference",void 0),(0,t._)([(0,s.Cb)(H.PV)],L.prototype,"elevationInfo",null),(0,t._)([(0,s.Cb)({json:{read:!1},readOnly:!0})],L.prototype,"type",void 0),(0,t._)([(0,s.Cb)()],L.prototype,"associatedFeatureServiceItem",void 0),L=(0,t._)([(0,S.j)("esri.layers.BuildingSceneLayer")],L);const gt=L},50243:(re,G,r)=>{r.d(G,{Z:()=>Z});var g=r(50484),t=r(25387),M=r(89317),D=r(80543),B=(r(14007),r(4703),r(65311),r(62185)),A=r(10141),R=r(7547),K=r(59300),s=r(30457);let x=class extends((0,t.J)(M.wq)){constructor(S){super(S),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(S){const N={};for(const W of Object.keys(S))N[W]=(0,K.im)(S[W]);return N}writeDomains(S,N){const W={};for(const O of Object.keys(S))S[O]&&(W[O]=S[O]?.toJSON());N.domains=W}};(0,g._)([(0,D.Cb)({json:{write:!0}})],x.prototype,"id",void 0),(0,g._)([(0,D.Cb)({json:{write:!0}})],x.prototype,"name",void 0),(0,g._)([(0,D.Cb)({json:{write:!0}})],x.prototype,"domains",void 0),(0,g._)([(0,B.r)("domains")],x.prototype,"readDomains",null),(0,g._)([(0,R.c)("domains")],x.prototype,"writeDomains",null),(0,g._)([(0,D.Cb)({type:[s.Z],json:{write:!0}})],x.prototype,"templates",void 0),x=(0,g._)([(0,A.j)("esri.layers.support.FeatureType")],x);const Z=x},8295:(re,G,r)=>{r.d(G,{p:()=>t});var g=r(53456);function t(M,D,T){if(!T?.features||!T.hasZ)return;const _=(0,g.k)(T.geometryType,D,M.outSpatialReference);if(null!=_)for(const I of T.features)_(I.geometry)}},93792:(re,G,r)=>{r.d(G,{Z:()=>pe});var N,g=r(50484),t=r(2189),M=r(35458),D=r(84303),T=r(89317),_=r(34222),I=r(80543),R=(r(14007),r(4703),r(62185)),K=r(10141),s=r(7547),x=r(43814),Z=r(40637),S=r(81247);const W=new D.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let O=N=class extends T.wq{constructor(d){super(d),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(d,v){const c=x.Z.fromJSON(v.spatialReference),l=[];for(let h=0;h<d.length;h++){const y=d[h],m=M.Z.fromJSON(y),P=y.geometry?.spatialReference;null==m.geometry||P||(m.geometry.spatialReference=c);const j=y.aggregateGeometries,a=m.aggregateGeometries;if(j&&null!=a)for(const C in a){const f=a[C],b=j[C],F=b?.spatialReference;null==f||F||(f.spatialReference=c)}l.push(m)}return l}writeGeometryType(d,v,c,l){if(d)return void W.write(d,v,c,l);const{features:h}=this;if(h)for(const y of h)if(null!=y?.geometry)return void W.write(y.geometry.type,v,c,l)}readQueryGeometry(d,v){if(!d)return null;const c=!!d.spatialReference,l=(0,Z.im)(d);return l&&!c&&v.spatialReference&&(l.spatialReference=x.Z.fromJSON(v.spatialReference)),l}writeSpatialReference(d,v){if(d)return void(v.spatialReference=d.toJSON());const{features:c}=this;if(c)for(const l of c)if(l&&null!=l.geometry&&l.geometry.spatialReference)return void(v.spatialReference=l.geometry.spatialReference.toJSON())}clone(){return new N(this.cloneProperties())}cloneProperties(){return(0,_.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(d){const v=this.write();if(v.features&&Array.isArray(d)&&d.length>0)for(let c=0;c<v.features.length;c++){const l=v.features[c];if(l.geometry){const h=d?.[c];l.geometry=h?.toJSON()||l.geometry}}return v}quantize(d){const{scale:[v,c],translate:[l,h]}=d,P=this.features,j=this._getQuantizationFunction(this.geometryType,a=>Math.round((a-l)/v),a=>Math.round((h-a)/c));for(let a=0,C=P.length;a<C;a++)j?.(P[a].geometry)||(P.splice(a,1),a--,C--);return this.transform=d,this}unquantize(){const{geometryType:d,features:v,transform:c}=this;if(!c)return this;const{translate:[l,h],scale:[y,m]}=c;let a=null,C=null;if(this.hasZ&&null!=c?.scale?.[2]){const{translate:[,,b],scale:[,,F]}=c;a=E=>E*F+b}if(this.hasM&&null!=c?.scale?.[3]){const{translate:[,,,b],scale:[,,,F]}=c;C=E=>null==E?E:E*F+b}const f=this._getHydrationFunction(d,b=>b*y+l,b=>h-b*m,a,C);for(const{geometry:b}of v)null!=b&&f&&f(b);return this.transform=null,this}_quantizePoints(d,v,c){let l,h;const y=[];for(let m=0,P=d.length;m<P;m++){const j=d[m];if(m>0){const a=v(j[0]),C=c(j[1]);a===l&&C===h||(y.push([a-l,C-h]),l=a,h=C)}else l=v(j[0]),h=c(j[1]),y.push([l,h])}return y.length>0?y:null}_getQuantizationFunction(d,v,c){return"point"===d?l=>(l.x=v(l.x),l.y=c(l.y),l):"polyline"===d||"polygon"===d?l=>{const h=(0,Z.oU)(l)?l.rings:l.paths,y=[];for(let m=0,P=h.length;m<P;m++){const a=this._quantizePoints(h[m],v,c);a&&y.push(a)}return y.length>0?((0,Z.oU)(l)?l.rings=y:l.paths=y,l):null}:"multipoint"===d?l=>{const h=this._quantizePoints(l.points,v,c);return h&&h.length>0?(l.points=h,l):null}:"extent"===d?l=>l:null}_getHydrationFunction(d,v,c,l,h){return"point"===d?y=>{y.x=v(y.x),y.y=c(y.y),l&&(y.z=l(y.z))}:"polyline"===d||"polygon"===d?y=>{const m=(0,Z.oU)(y)?y.rings:y.paths;let P,j;for(let a=0,C=m.length;a<C;a++){const f=m[a];for(let b=0,F=f.length;b<F;b++){const E=f[b];b>0?(P+=E[0],j+=E[1]):(P=E[0],j=E[1]),E[0]=v(P),E[1]=c(j)}}if(l&&h)for(let a=0,C=m.length;a<C;a++){const f=m[a];for(let b=0,F=f.length;b<F;b++){const E=f[b];E[2]=l(E[2]),E[3]=h(E[3])}}else if(l)for(let a=0,C=m.length;a<C;a++){const f=m[a];for(let b=0,F=f.length;b<F;b++){const E=f[b];E[2]=l(E[2])}}else if(h)for(let a=0,C=m.length;a<C;a++){const f=m[a];for(let b=0,F=f.length;b<F;b++){const E=f[b];E[2]=h(E[2])}}}:"extent"===d?y=>{y.xmin=v(y.xmin),y.ymin=c(y.ymin),y.xmax=v(y.xmax),y.ymax=c(y.ymax),l&&null!=y.zmax&&null!=y.zmin&&(y.zmax=l(y.zmax),y.zmin=l(y.zmin)),h&&null!=y.mmax&&null!=y.mmin&&(y.mmax=h(y.mmax),y.mmin=h(y.mmin))}:"multipoint"===d?y=>{const m=y.points;let P,j;for(let a=0,C=m.length;a<C;a++){const f=m[a];a>0?(P+=f[0],j+=f[1]):(P=f[0],j=f[1]),f[0]=v(P),f[1]=c(j)}if(l&&h)for(let a=0,C=m.length;a<C;a++){const f=m[a];f[2]=l(f[2]),f[3]=h(f[3])}else if(l)for(let a=0,C=m.length;a<C;a++){const f=m[a];f[2]=l(f[2])}else if(h)for(let a=0,C=m.length;a<C;a++){const f=m[a];f[2]=h(f[2])}}:null}};(0,g._)([(0,I.Cb)({type:String,json:{write:!0}})],O.prototype,"displayFieldName",void 0),(0,g._)([(0,I.Cb)({type:Boolean,json:{write:{overridePolicy:d=>({enabled:d})}}})],O.prototype,"exceededTransferLimit",void 0),(0,g._)([(0,I.Cb)({type:[M.Z],json:{write:!0}})],O.prototype,"features",void 0),(0,g._)([(0,R.r)("features")],O.prototype,"readFeatures",null),(0,g._)([(0,I.Cb)({type:[S.Z],json:{write:!0}})],O.prototype,"fields",void 0),(0,g._)([(0,I.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:W.read}}})],O.prototype,"geometryType",void 0),(0,g._)([(0,s.c)("geometryType")],O.prototype,"writeGeometryType",null),(0,g._)([(0,I.Cb)({type:Boolean,json:{write:{overridePolicy:d=>({enabled:d})}}})],O.prototype,"hasM",void 0),(0,g._)([(0,I.Cb)({type:Boolean,json:{write:{overridePolicy:d=>({enabled:d})}}})],O.prototype,"hasZ",void 0),(0,g._)([(0,I.Cb)({types:t.qM,json:{write:!0}})],O.prototype,"queryGeometry",void 0),(0,g._)([(0,R.r)("queryGeometry")],O.prototype,"readQueryGeometry",null),(0,g._)([(0,I.Cb)({type:x.Z,json:{write:!0}})],O.prototype,"spatialReference",void 0),(0,g._)([(0,s.c)("spatialReference")],O.prototype,"writeSpatialReference",null),(0,g._)([(0,I.Cb)({json:{write:!0}})],O.prototype,"transform",void 0),O=N=(0,g._)([(0,K.j)("esri.rest.support.FeatureSet")],O),O.prototype.toJSON.isDefaultToJSON=!0;const pe=O}}]);