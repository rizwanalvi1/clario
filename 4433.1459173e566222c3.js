"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[4433],{5710:(Ut,lt,G)=>{G.d(lt,{a:()=>nt,b:()=>Y,c:()=>z,e:()=>_t,f:()=>c,g:()=>vt,i:()=>Et,j:()=>$,l:()=>yt,n:()=>Q,s:()=>D,t:()=>V});var B=G(89612);function z(u,f){return u[0]=f[0],u[1]=f[1],u[2]=f[2],u[3]=f[3],u}function D(u,f,l,_,d){return u[0]=f,u[1]=l,u[2]=_,u[3]=d,u}function c(u,f,l){return u[0]=f[0]+l[0],u[1]=f[1]+l[1],u[2]=f[2]+l[2],u[3]=f[3]+l[3],u}function g(u,f,l){return u[0]=f[0]-l[0],u[1]=f[1]-l[1],u[2]=f[2]-l[2],u[3]=f[3]-l[3],u}function y(u,f,l){return u[0]=f[0]*l[0],u[1]=f[1]*l[1],u[2]=f[2]*l[2],u[3]=f[3]*l[3],u}function b(u,f,l){return u[0]=f[0]/l[0],u[1]=f[1]/l[1],u[2]=f[2]/l[2],u[3]=f[3]/l[3],u}function Y(u,f,l){return u[0]=f[0]*l,u[1]=f[1]*l,u[2]=f[2]*l,u[3]=f[3]*l,u}function et(u,f){const l=f[0]-u[0],_=f[1]-u[1],d=f[2]-u[2],w=f[3]-u[3];return Math.sqrt(l*l+_*_+d*d+w*w)}function mt(u,f){const l=f[0]-u[0],_=f[1]-u[1],d=f[2]-u[2],w=f[3]-u[3];return l*l+_*_+d*d+w*w}function Et(u){const f=u[0],l=u[1],_=u[2],d=u[3];return Math.sqrt(f*f+l*l+_*_+d*d)}function $(u){const f=u[0],l=u[1],_=u[2],d=u[3];return f*f+l*l+_*_+d*d}function Q(u,f){const l=f[0],_=f[1],d=f[2],w=f[3];let I=l*l+_*_+d*d+w*w;return I>0&&(I=1/Math.sqrt(I),u[0]=l*I,u[1]=_*I,u[2]=d*I,u[3]=w*I),u}function vt(u,f){return u[0]*f[0]+u[1]*f[1]+u[2]*f[2]+u[3]*f[3]}function yt(u,f,l,_){const d=f[0],w=f[1],I=f[2],S=f[3];return u[0]=d+_*(l[0]-d),u[1]=w+_*(l[1]-w),u[2]=I+_*(l[2]-I),u[3]=S+_*(l[3]-S),u}function V(u,f,l){const _=f[0],d=f[1],w=f[2],I=f[3];return u[0]=l[0]*_+l[4]*d+l[8]*w+l[12]*I,u[1]=l[1]*_+l[5]*d+l[9]*w+l[13]*I,u[2]=l[2]*_+l[6]*d+l[10]*w+l[14]*I,u[3]=l[3]*_+l[7]*d+l[11]*w+l[15]*I,u}function nt(u,f){return u[0]===f[0]&&u[1]===f[1]&&u[2]===f[2]&&u[3]===f[3]}function _t(u,f){const l=u[0],_=u[1],d=u[2],w=u[3],I=f[0],S=f[1],O=f[2],j=f[3],ut=(0,B.bn)();return Math.abs(l-I)<=ut*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(_-S)<=ut*Math.max(1,Math.abs(_),Math.abs(S))&&Math.abs(d-O)<=ut*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(w-j)<=ut*Math.max(1,Math.abs(w),Math.abs(j))}Object.freeze(Object.defineProperty({__proto__:null,add:c,ceil:function T(u,f){return u[0]=Math.ceil(f[0]),u[1]=Math.ceil(f[1]),u[2]=Math.ceil(f[2]),u[3]=Math.ceil(f[3]),u},copy:z,copyVec3:function N(u,f){return u[0]=f[0],u[1]=f[1],u[2]=f[2],u},dist:et,distance:et,div:b,divide:b,dot:vt,equals:_t,exactEquals:nt,floor:function x(u,f){return u[0]=Math.floor(f[0]),u[1]=Math.floor(f[1]),u[2]=Math.floor(f[2]),u[3]=Math.floor(f[3]),u},inverse:function C(u,f){return u[0]=1/f[0],u[1]=1/f[1],u[2]=1/f[2],u[3]=1/f[3],u},len:Et,length:Et,lerp:yt,max:function F(u,f,l){return u[0]=Math.max(f[0],l[0]),u[1]=Math.max(f[1],l[1]),u[2]=Math.max(f[2],l[2]),u[3]=Math.max(f[3],l[3]),u},min:function U(u,f,l){return u[0]=Math.min(f[0],l[0]),u[1]=Math.min(f[1],l[1]),u[2]=Math.min(f[2],l[2]),u[3]=Math.min(f[3],l[3]),u},mul:y,multiply:y,negate:function q(u,f){return u[0]=-f[0],u[1]=-f[1],u[2]=-f[2],u[3]=-f[3],u},normalize:Q,random:function Rt(u,f){const l=B.FD;let _,d,w,I,S,O;f=f||1;do{_=2*l()-1,d=2*l()-1,S=_*_+d*d}while(S>=1);do{w=2*l()-1,I=2*l()-1,O=w*w+I*I}while(O>=1);const j=Math.sqrt((1-S)/O);return u[0]=f*_,u[1]=f*d,u[2]=f*w*j,u[3]=f*I*j,u},round:function M(u,f){return u[0]=Math.round(f[0]),u[1]=Math.round(f[1]),u[2]=Math.round(f[2]),u[3]=Math.round(f[3]),u},scale:Y,scaleAndAdd:function H(u,f,l,_){return u[0]=f[0]+l[0]*_,u[1]=f[1]+l[1]*_,u[2]=f[2]+l[2]*_,u[3]=f[3]+l[3]*_,u},set:D,sqrDist:mt,sqrLen:$,squaredDistance:mt,squaredLength:$,str:function W(u){return"vec4("+u[0]+", "+u[1]+", "+u[2]+", "+u[3]+")"},sub:g,subtract:g,transformMat4:V,transformQuat:function rt(u,f,l){const _=f[0],d=f[1],w=f[2],I=l[0],S=l[1],O=l[2],j=l[3],ut=j*_+S*w-O*d,Lt=j*d+O*_-I*w,Nt=j*w+I*d-S*_,xt=-I*_-S*d-O*w;return u[0]=ut*j+xt*-I+Lt*-O-Nt*-S,u[1]=Lt*j+xt*-S+Nt*-I-ut*-O,u[2]=Nt*j+xt*-O+ut*-S-Lt*-I,u[3]=f[3],u}},Symbol.toStringTag,{value:"Module"}))},70794:(Ut,lt,G)=>{G.d(lt,{EX:()=>_t,Y3:()=>V,_Y:()=>Rt,jQ:()=>D,sJ:()=>rt,xr:()=>yt});var B=G(66599);function D(l){return"r"in l&&"g"in l&&"b"in l}function c(l){return"h"in l&&"s"in l&&"v"in l}function g(l){return"l"in l&&"a"in l&&"b"in l}function y(l){return"l"in l&&"c"in l&&"h"in l}G(5710),G(23515);const T=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],x=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function U(l,_){const d=[];let w,I;if(l[0].length!==_.length)throw new Error("dimensions do not match");const S=l.length,O=l[0].length;let j=0;for(w=0;w<S;w++){for(j=0,I=0;I<O;I++)j+=l[w][I]*_[I];d.push(j)}return d}function F(l){const _=[l.r/255,l.g/255,l.b/255].map(w=>w<=.04045?w/12.92:((w+.055)/1.055)**2.4),d=U(T,_);return{x:100*d[0],y:100*d[1],z:100*d[2]}}function M(l){const _=U(x,[l.x/100,l.y/100,l.z/100]).map(d=>Math.min(1,Math.max(d<=.0031308?12.92*d:1.055*d**.4166666666666667-.055,0)));return{r:Math.round(255*_[0]),g:Math.round(255*_[1]),b:Math.round(255*_[2])}}function Y(l){const _=[l.x/95.047,l.y/100,l.z/108.883].map(d=>d>.008856451679035631?d**.3333333333333333:7.787037037037035*d+.13793103448275862);return{l:116*_[1]-16,a:500*(_[0]-_[1]),b:200*(_[1]-_[2])}}function H(l){const _=l.l,d=[(_+16)/116+l.a/500,(_+16)/116,(_+16)/116-l.b/200].map(w=>w>6/29?w**3:3*(6/29)**2*(w-4/29));return{x:95.047*d[0],y:100*d[1],z:108.883*d[2]}}function yt(l){return D(l)?l:y(l)?function C(l){return M(H(function mt(l){const d=l.c,w=l.h;return{l:l.l,a:d*Math.cos(w),b:d*Math.sin(w)}}(l)))}(l):g(l)?function $(l){return M(H(l))}(l):function b(l){return"x"in l&&"y"in l&&"z"in l}(l)?M(l):c(l)?function vt(l){const _=(l.h+360)%360/60,w=l.v/100*255,I=w*(l.s/100),S=I*(1-Math.abs(_%2-1));let O;switch(Math.floor(_)){case 0:O={r:I,g:S,b:0};break;case 1:O={r:S,g:I,b:0};break;case 2:O={r:0,g:I,b:S};break;case 3:O={r:0,g:S,b:I};break;case 4:O={r:S,g:0,b:I};break;case 5:case 6:O={r:I,g:0,b:S};break;default:O={r:0,g:0,b:0}}return O.r=Math.round(O.r+w-I),O.g=Math.round(O.g+w-I),O.b=Math.round(O.b+w-I),O}(l):l}function Rt(l){return c(l)?l:function Q(l){const _=l.r,d=l.g,w=l.b,I=Math.max(_,d,w),S=I-Math.min(_,d,w);let O=I,j=0===S?0:I===_?(d-w)/S%6:I===d?(w-_)/S+2:(_-d)/S+4,ut=0===S?0:S/O;return j<0&&(j+=6),j*=60,ut*=100,O*=100/255,{h:j,s:ut,v:O}}(yt(l))}function V(l){return g(l)?l:function Et(l){return Y(F(l))}(yt(l))}function rt(l){return y(l)?l:function q(l){return function et(l){const _=l.l,d=l.a,w=l.b,I=Math.sqrt(d*d+w*w);let S=Math.atan2(w,d);return S=S>0?S:S+2*Math.PI,{l:_,c:I,h:S}}(Y(F(l)))}(yt(l))}function _t(l,_){const{r:d,g:w,b:I}=_?.ignoreAlpha?l:function nt(l){let{r:_,g:d,b:w,a:I}=l;return I<1&&(_=Math.round(I*_+255*(1-I)),d=Math.round(I*d+255*(1-I)),w=Math.round(I*w+255*(1-I))),new B.Z({r:_,g:d,b:w})}(l);return.2126*d+.7152*w+.0722*I}var at,l;(l=at||(at={}))[l.Low=160]="Low",l[l.High=225]="High"},23515:(Ut,lt,G)=>{function B(){return[0,0,0,0]}function N($,q,C,Q){return[$,q,C,Q]}function y(){return N(1,1,1,1)}function b(){return N(1,0,0,0)}function T(){return N(0,1,0,0)}function x(){return N(0,0,1,0)}function U(){return N(0,0,0,1)}G.d(lt,{Ue:()=>B,al:()=>N});const M=y(),Y=b(),H=T(),et=x(),mt=U();Object.freeze(Object.defineProperty({__proto__:null,ONES:M,UNIT_W:mt,UNIT_X:Y,UNIT_Y:H,UNIT_Z:et,ZEROS:[0,0,0,0],clone:function z($){return[$[0],$[1],$[2],$[3]]},create:B,createView:function c($,q){return new Float64Array($,q,4)},fromArray:function D($,q=[0,0,0,0]){const C=Math.min(4,$.length);for(let Q=0;Q<C;++Q)q[Q]=$[Q];return q},fromValues:N,ones:y,unitW:U,unitX:b,unitY:T,unitZ:x,zeros:function g(){return[0,0,0,0]}},Symbol.toStringTag,{value:"Module"}))},16190:(Ut,lt,G)=>{G.d(lt,{Z:()=>z}),G(14007);class z{constructor(D){this._array=[],this._stride=D}get array(){return this._array}get index(){return 4*this._array.length/this._stride}get itemSize(){return this._stride}get sizeInBytes(){return 4*this._array.length}reset(){this.array.length=0}toBuffer(){return new Uint32Array(this._array).buffer}static i1616to32(D,c){return 65535&D|c<<16}static i8888to32(D,c,g,y){return 255&D|(255&c)<<8|(255&g)<<16|y<<24}static i8816to32(D,c,g){return 255&D|(255&c)<<8|g<<16}}},17866:(Ut,lt,G)=>{var B,z,N,D;G.d(lt,{Fr:()=>N,_K:()=>z,al:()=>B}),(D=B||(B={}))[D.FILL=1]="FILL",D[D.LINE=2]="LINE",D[D.SYMBOL=3]="SYMBOL",D[D.CIRCLE=4]="CIRCLE",function(D){D[D.BACKGROUND=0]="BACKGROUND",D[D.FILL=1]="FILL",D[D.OUTLINE=2]="OUTLINE",D[D.LINE=3]="LINE",D[D.ICON=4]="ICON",D[D.CIRCLE=5]="CIRCLE",D[D.TEXT=6]="TEXT",D[D.TILEINFO=7]="TILEINFO"}(z||(z={})),function(D){D[D.PAINTER_CHANGED=0]="PAINTER_CHANGED",D[D.LAYOUT_CHANGED=1]="LAYOUT_CHANGED",D[D.LAYER_CHANGED=2]="LAYER_CHANGED",D[D.LAYER_REMOVED=3]="LAYER_REMOVED",D[D.SPRITES_CHANGED=4]="SPRITES_CHANGED"}(N||(N={}))},1884:(Ut,lt,G)=>{G.d(lt,{Et:()=>ve,sj:()=>Ae,Le:()=>Te,_L:()=>Le,$L:()=>Ie,gf:()=>De,jG:()=>Re,nj:()=>Ne});var c,g,p,B=G(45425),z=G(17866),N=G(26128),D=G(16190);(p=c||(c={}))[p.R8_SIGNED=0]="R8_SIGNED",p[p.R8_UNSIGNED=1]="R8_UNSIGNED",p[p.R16_SIGNED=2]="R16_SIGNED",p[p.R16_UNSIGNED=3]="R16_UNSIGNED",p[p.R8G8_SIGNED=4]="R8G8_SIGNED",p[p.R8G8_UNSIGNED=5]="R8G8_UNSIGNED",p[p.R16G16_SIGNED=6]="R16G16_SIGNED",p[p.R16G16_UNSIGNED=7]="R16G16_UNSIGNED",p[p.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED",p[p.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED",p[p.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR",p[p.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY",p[p.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN",function(p){p[p.UNIFORM=0]="UNIFORM",p[p.DATA_DRIVEN=1]="DATA_DRIVEN",p[p.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN",p[p.UNUSED=3]="UNUSED"}(g||(g={}));var y=G(39237),b=G(50205);class T{constructor(e){this._locations=new Map,this._key=e}get key(){return this._key}get type(){return 7&this._key}defines(){return[]}getStride(){return this._layoutInfo||this._buildAttributesInfo(),this._stride}getAttributeLocations(){return 0===this._locations.size&&this._buildAttributesInfo(),this._locations}getLayoutInfo(){return this._layoutInfo||this._buildAttributesInfo(),this._layoutInfo}getEncodingInfos(){return this._propertyEncodingInfo||this._buildAttributesInfo(),this._propertyEncodingInfo}getUniforms(){return this._uniforms||this._buildAttributesInfo(),this._uniforms}getShaderHeader(){return this._shaderHeader||this._buildAttributesInfo(),this._shaderHeader}getShaderMain(){return this._shaderMain||this._buildAttributesInfo(),this._shaderMain}setDataUniforms(e,a,i,s,o){const E=this.getUniforms();for(const h of E){const{name:m,type:v,getValue:A}=h,R=A(i,a,s,o);if(null!==R)switch(v){case"float":e.setUniform1f(m,R);break;case"vec2":e.setUniform2fv(m,R);break;case"vec4":e.setUniform4fv(m,R)}}}encodeAttributes(e,a,i,s){const o=this.attributesInfo(),E=this.getEncodingInfos(),h=[];let m=0,v=0;for(const A of Object.keys(E)){const R=E[A],{type:P,precisionFactor:k,isLayout:ct}=o[A],wt=ct?i.getLayoutProperty(A):i.getPaintProperty(A),dt=wt.interpolator?.getInterpolationRange(a);let It=0;for(const tt of R){const{offset:Z,bufferElementsToAdd:ht}=tt;if(ht>0){for(let Dt=0;Dt<ht;Dt++)h.push(0);m+=v,v=tt.bufferElementsToAdd}const K=s??wt.getValue(dt?dt[It]:a,e);switch(P){case c.R8_SIGNED:case c.R8_UNSIGNED:h[m]|=this._encodeByte(K*(k||1),8*Z);break;case c.R16_SIGNED:case c.R16_UNSIGNED:h[m]|=this._encodeShort(K*(k||1),8*Z);break;case c.R8G8_SIGNED:case c.R8G8_UNSIGNED:h[m]|=this._encodeByte(K*(k||1),8*Z),h[m]|=this._encodeByte(K*(k||1),8*Z+8);break;case c.R16G16_SIGNED:case c.R16G16_UNSIGNED:h[m]|=this._encodeShort(K*(k||1),8*Z),h[m]|=this._encodeShort(K*(k||1),8*Z+16);break;case c.R8G8B8A8_SIGNED:case c.R8G8B8A8_UNSIGNED:h[m]|=this._encodeByte(K*(k||1),8*Z),h[m]|=this._encodeByte(K*(k||1),8*Z+8),h[m]|=this._encodeByte(K*(k||1),8*Z+16),h[m]|=this._encodeByte(K*(k||1),8*Z+24);break;case c.R8G8B8A8_COLOR:h[m]=this._encodeColor(K);break;case c.R16G16B16A16_DASHARRAY:case c.R16G16B16A16_PATTERN:this._encodePattern(m,h,K);break;default:throw new Error("Unsupported encoding type")}It++}}return h}getAtributeState(e){let a=0;const i=3+2*e;return a|=this._bit(i),a|=this._bit(i+1)<<1,a}_buildAttributesInfo(){const e=[],a={},i={};let s=-1;const o=this.attributesInfo(),E=this.attributes();let h=-1;for(const R of E){h++;const P=this.getAtributeState(h);if(P===g.UNIFORM||P===g.UNUSED)continue;const k=o[R],ct=[];a[R]=ct;const wt=k.type;for(let dt=0;dt<P;dt++){const{dataType:It,bytesPerElement:tt,count:Z,normalized:ht}=T._encodingInfo[wt],K=tt*Z,Dt=`${It}-${!0===ht}`;let st=i[Dt],pt=0;if(!st||st.count+Z>4)s++,st={dataIndex:s,count:0,offset:0},4!==Z&&(i[Dt]=st),e.push({location:-1,name:"a_data_"+s,count:Z,type:It,normalized:ht}),pt=Math.ceil(Math.max(K/4,1));else{const ft=e[st.dataIndex];ft.count+=Z,pt=Math.ceil(Math.max(ft.count*tt/4,1))-Math.ceil(Math.max(st.offset/4,1))}ct.push({dataIndex:st.dataIndex,offset:st.offset,bufferElementsToAdd:pt}),st.offset+=K,st.count+=Z}}for(const R of e)switch(R.type){case y.g.BYTE:case y.g.UNSIGNED_BYTE:R.count=4;break;case y.g.SHORT:case y.g.UNSIGNED_SHORT:R.count+=R.count%2}this._buildVertexBufferLayout(e);let m=0;const v=this._layoutInfo.geometry;for(const R of v)this._locations.set(R.name,m++);const A=this._layoutInfo.opacity;if(A)for(const R of A)this._locations.set(R.name,m++);this._buildShaderInfo(e,a),this._propertyEncodingInfo=a}_buildVertexBufferLayout(e){const a={},i=this.geometryInfo();let s=i[0].stride;if(0===e.length)a.geometry=i;else{const o=[];let E=s;for(const h of e)s+=x(h.type)*h.count;for(const h of i)o.push(new b.G(h.name,h.count,h.type,h.offset,s,h.normalized));for(const h of e)o.push(new b.G(h.name,h.count,h.type,E,s,h.normalized)),E+=x(h.type)*h.count;a.geometry=o}this.opacityInfo()&&(a.opacity=this.opacityInfo()),this._layoutInfo=a,this._stride=s}_buildShaderInfo(e,a){let i="\n",s="\n";const o=[];for(const v of e)i+=`attribute ${this._getType(v.count)} ${v.name};\n`;const E=this.attributes(),h=this.attributesInfo();let m=-1;for(const v of E){m++;const{name:A,type:R,precisionFactor:P,isLayout:k}=h[v],ct=P&&1!==P?" * "+1/P:"",{bytesPerElement:wt,count:dt}=T._encodingInfo[R],It=tt=>`a_data_${tt.dataIndex}${U(dt,tt.offset,wt)}`;switch(this.getAtributeState(m)){case g.UNIFORM:{const tt=this._getType(dt),Z=`u_${A}`;o.push({name:Z,type:tt,getValue:(ht,K,Dt,st)=>{const pt=k?ht.getLayoutValue(v,K):ht.getPaintValue(v,K);if(R===c.R16G16B16A16_DASHARRAY){const ft=ht.getDashKey(pt,ht.getLayoutValue("line-cap",K)),zt=st.getMosaicItemPosition(ft,!1);if(null==zt)return null;const{tl:Ft,br:ye}=zt;return[Ft[0],ye[1],ye[0],Ft[1]]}if(R===c.R16G16B16A16_PATTERN){const ft=st.getMosaicItemPosition(pt,!v.includes("line-"));if(null==ft)return null;const{tl:zt,br:Ft}=ft;return[zt[0],Ft[1],Ft[0],zt[1]]}if(R===c.R8G8B8A8_COLOR){const ft=pt[3];return[ft*pt[0],ft*pt[1],ft*pt[2],ft]}return pt}}),i+=`uniform ${tt} ${Z};\n`,s+=`${tt} ${A} = ${Z};\n`}break;case g.DATA_DRIVEN:{const tt=It(a[v][0]);s+=`${this._getType(dt)} ${A} = ${tt}${ct};\n`}break;case g.INTERPOLATED_DATA_DRIVEN:{const tt=`u_t_${A}`;o.push({name:tt,type:"float",getValue:(K,Dt,st,pt)=>(k?K.getLayoutProperty(v):K.getPaintProperty(v)).interpolator.interpolationUniformValue(st,Dt)}),i+=`uniform float ${tt};\n`;const Z=It(a[v][0]),ht=It(a[v][1]);s+=`${this._getType(dt)} ${A} = mix(${Z}${ct}, ${ht}${ct}, ${tt});\n`}}}this._shaderHeader=i,this._shaderMain=s,this._uniforms=o}_bit(e){return(this._key&1<<e)>>e}_getType(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw new Error("Invalid count")}_encodeColor(e){const a=255*e[3];return D.Z.i8888to32(e[0]*a,e[1]*a,e[2]*a,a)}_encodePattern(e,a,i){if(!i?.rect)return;const o=i.rect,E=i.width,h=i.height;a[e]=this._encodeShort(o.x+2,0),a[e]|=this._encodeShort(o.y+2+h,16),a[e+1]=this._encodeShort(o.x+2+E,0),a[e+1]|=this._encodeShort(o.y+2,16)}_encodeByte(e,a){return(255&e)<<a}_encodeShort(e,a){return(65535&e)<<a}}T._encodingInfo={[c.R8_SIGNED]:{dataType:y.g.BYTE,bytesPerElement:1,count:1,normalized:!1},[c.R8_UNSIGNED]:{dataType:y.g.UNSIGNED_BYTE,bytesPerElement:1,count:1,normalized:!1},[c.R16_SIGNED]:{dataType:y.g.SHORT,bytesPerElement:2,count:1,normalized:!1},[c.R16_UNSIGNED]:{dataType:y.g.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[c.R8G8_SIGNED]:{dataType:y.g.BYTE,bytesPerElement:1,count:2,normalized:!1},[c.R8G8_UNSIGNED]:{dataType:y.g.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},[c.R16G16_SIGNED]:{dataType:y.g.SHORT,bytesPerElement:2,count:2,normalized:!1},[c.R16G16_UNSIGNED]:{dataType:y.g.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[c.R8G8B8A8_SIGNED]:{dataType:y.g.BYTE,bytesPerElement:1,count:4,normalized:!1},[c.R8G8B8A8_UNSIGNED]:{dataType:y.g.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!1},[c.R8G8B8A8_COLOR]:{dataType:y.g.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!0},[c.R16G16B16A16_DASHARRAY]:{dataType:y.g.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1},[c.R16G16B16A16_PATTERN]:{dataType:y.g.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}};const x=p=>{switch(p){case y.g.FLOAT:case y.g.INT:case y.g.UNSIGNED_INT:return 4;case y.g.SHORT:case y.g.UNSIGNED_SHORT:case y.g.HALF_FLOAT:return 2;case y.g.BYTE:case y.g.UNSIGNED_BYTE:return 1}},U=(p,e,a)=>{const i=e/a;if(1===p)switch(i){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(2===p)switch(i){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(3===p)switch(i){case 0:return".xyz";case 1:return".yzw"}return""};class F extends T{constructor(e){super(e)}geometryInfo(){return F.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return F.ATTRIBUTES}attributesInfo(){return F.ATTRIBUTES_INFO}}F.ATTRIBUTES=[],F.GEOMETRY_LAYOUT=[new b.G("a_pos",2,y.g.BYTE,0,2)],F.ATTRIBUTES_INFO={};class M extends T{constructor(e){super(e)}geometryInfo(){return M.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return M.ATTRIBUTES}attributesInfo(){return M.ATTRIBUTES_INFO}}M.ATTRIBUTES=["circle-radius","circle-color","circle-opacity","circle-stroke-width","circle-stroke-color","circle-stroke-opacity","circle-blur"],M.GEOMETRY_LAYOUT=[new b.G("a_pos",2,y.g.SHORT,0,4)],M.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:c.R8_UNSIGNED},"circle-color":{name:"color",type:c.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",type:c.R8_UNSIGNED,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:c.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:c.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:c.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:c.R8_UNSIGNED,precisionFactor:32}};class Y extends T{constructor(e){super(e)}geometryInfo(){return Y.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return Y.ATTRIBUTES}attributesInfo(){return Y.ATTRIBUTES_INFO}}Y.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"],Y.GEOMETRY_LAYOUT=[new b.G("a_pos",2,y.g.SHORT,0,4)],Y.ATTRIBUTES_INFO={"fill-color":{name:"color",type:c.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:c.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:c.R16G16B16A16_PATTERN,isOptional:!0}};class H extends T{constructor(e,a){super(e),this._usefillColor=a}geometryInfo(){return H.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return this._usefillColor?H.ATTRIBUTES_FILL:H.ATTRIBUTES_OUTLINE}attributesInfo(){return this._usefillColor?H.ATTRIBUTES_INFO_FILL:H.ATTRIBUTES_INFO_OUTLINE}}H.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"],H.ATTRIBUTES_FILL=["fill-color","fill-opacity"],H.GEOMETRY_LAYOUT=[new b.G("a_pos",2,y.g.SHORT,0,8),new b.G("a_offset",2,y.g.BYTE,4,8),new b.G("a_xnormal",2,y.g.BYTE,6,8)],H.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:c.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:c.R8_UNSIGNED,precisionFactor:100}},H.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:c.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:c.R8_UNSIGNED,precisionFactor:100}};class et extends T{constructor(e){super(e)}geometryInfo(){return et.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return et.ATTRIBUTES}attributesInfo(){return et.ATTRIBUTES_INFO}}et.ATTRIBUTES=["line-blur","line-color","line-gap-width","line-offset","line-opacity","line-width","line-pattern","line-dasharray"],et.GEOMETRY_LAYOUT=[new b.G("a_pos",2,y.g.SHORT,0,16),new b.G("a_extrude_offset",4,y.g.BYTE,4,16),new b.G("a_dir_normal",4,y.g.BYTE,8,16),new b.G("a_accumulatedDistance",2,y.g.UNSIGNED_SHORT,12,16)],et.ATTRIBUTES_INFO={"line-width":{name:"width",type:c.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:c.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:c.R8_SIGNED,precisionFactor:2},"line-color":{name:"color",type:c.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",type:c.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:c.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:c.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:c.R16G16B16A16_DASHARRAY,isOptional:!0}};const mt=[new b.G("a_pos",2,y.g.SHORT,0,16),new b.G("a_vertexOffset",2,y.g.SHORT,4,16),new b.G("a_texAngleRange",4,y.g.UNSIGNED_BYTE,8,16),new b.G("a_levelInfo",4,y.g.UNSIGNED_BYTE,12,16)],Et=[new b.G("a_opacityInfo",1,y.g.UNSIGNED_BYTE,0,1)];class $ extends T{constructor(e){super(e)}geometryInfo(){return mt}opacityInfo(){return Et}attributes(){return $.ATTRIBUTES}attributesInfo(){return $.ATTRIBUTES_INFO}}$.ATTRIBUTES=["icon-color","icon-opacity","icon-halo-blur","icon-halo-color","icon-halo-width","icon-size"],$.ATTRIBUTES_INFO={"icon-color":{name:"color",type:c.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:c.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:c.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:c.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:c.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:c.R8_UNSIGNED,precisionFactor:32,isLayout:!0}};class q extends T{constructor(e){super(e)}geometryInfo(){return mt}opacityInfo(){return Et}attributes(){return q.ATTRIBUTES}attributesInfo(){return q.ATTRIBUTES_INFO}}q.ATTRIBUTES=["text-color","text-opacity","text-halo-blur","text-halo-color","text-halo-width","text-size"],q.ATTRIBUTES_INFO={"text-color":{name:"color",type:c.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:c.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:c.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:c.R8_UNSIGNED,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:c.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:c.R8_UNSIGNED,isLayout:!0}};var C=G(66599),Q=G(70794),vt=G(80247),yt=G(46503);const Rt={kind:"null"},V={kind:"number"},rt={kind:"string"},W={kind:"boolean"},nt={kind:"color"},_t={kind:"object"},at={kind:"value"};function Tt(p,e){return{kind:"array",itemType:p,n:e}}const Vt=[Rt,V,rt,W,nt,_t,Tt(at)];function bt(p){if("array"===p.kind){const e=bt(p.itemType);return"number"==typeof p.n?`array<${e}, ${p.n}>`:"value"===p.itemType.kind?"array":`array<${e}>`}return p.kind}function At(p){if(null===p)return Rt;if("string"==typeof p)return rt;if("boolean"==typeof p)return W;if("number"==typeof p)return V;if(p instanceof C.Z)return nt;if(Array.isArray(p)){let e;for(const a of p){const i=At(a);if(e){if(e!==i){e=at;break}}else e=i}return Tt(e||at,p.length)}return"object"==typeof p?_t:at}function Ot(p,e){if("array"===e.kind)return"array"===p.kind&&(0===p.n&&"value"===p.itemType.kind||Ot(p.itemType,e.itemType))&&("number"!=typeof e.n||e.n===p.n);if("value"===e.kind)for(const a of Vt)if(Ot(p,a))return!0;return e.kind===p.kind}function Gt(p){if(null===p)return"";const e=typeof p;return"string"===e?p:"number"===e||"boolean"===e?String(p):p instanceof C.Z?p.toString():JSON.stringify(p)}class Zt{constructor(e){this._parent=e,this._vars={}}add(e,a){this._vars[e]=a}get(e){return this._vars[e]?this._vars[e]:this._parent?this._parent.get(e):null}}class u{constructor(){this.type=at}static parse(e){if(e.length>1)throw new Error('"id" does not expect arguments');return new u}evaluate(e,a){return e?.id}}class f{constructor(){this.type=rt}static parse(e){if(e.length>1)throw new Error('"geometry-type" does not expect arguments');return new f}evaluate(e,a){if(!e)return null;switch(e.type){case vt.Vl.Point:return"Point";case vt.Vl.LineString:return"LineString";case vt.Vl.Polygon:return"Polygon";default:return null}}}class l{constructor(){this.type=_t}static parse(e){if(e.length>1)throw new Error('"properties" does not expect arguments');return new l}evaluate(e,a){return e?.values}}class _{constructor(){this.type=V}static parse(e){if(e.length>1)throw new Error('"zoom" does not expect arguments');return new _}evaluate(e,a){return a}}class d{constructor(e,a,i){this._lhs=e,this._rhs=a,this._compare=i,this.type=W}static parse(e,a,i){if(3!==e.length&&4!==e.length)throw new Error(`"${e[0]}" expects 2 or 3 arguments`);if(4===e.length)throw new Error(`"${e[0]}" collator not supported`);return new d(L(e[1],a),L(e[2],a),i)}evaluate(e,a){return this._compare(this._lhs.evaluate(e,a),this._rhs.evaluate(e,a))}}class Lt{constructor(e){this._arg=e,this.type=W}static parse(e,a){if(2!==e.length)throw new Error('"!" expects 1 argument');return new Lt(L(e[1],a))}evaluate(e,a){return!this._arg.evaluate(e,a)}}class Nt{constructor(e){this._args=e,this.type=W}static parse(e,a){const i=[];for(let s=1;s<e.length;s++)i.push(L(e[s],a));return new Nt(i)}evaluate(e,a){for(const i of this._args)if(!i.evaluate(e,a))return!1;return!0}}class xt{constructor(e){this._args=e,this.type=W}static parse(e,a){const i=[];for(let s=1;s<e.length;s++)i.push(L(e[s],a));return new xt(i)}evaluate(e,a){for(const i of this._args)if(i.evaluate(e,a))return!0;return!1}}class Kt{constructor(e){this._args=e,this.type=W}static parse(e,a){const i=[];for(let s=1;s<e.length;s++)i.push(L(e[s],a));return new Kt(i)}evaluate(e,a){for(const i of this._args)if(i.evaluate(e,a))return!1;return!0}}class Xt{constructor(e,a,i){this.type=e,this._args=a,this._fallback=i}static parse(e,a,i){if(e.length<4)throw new Error('"case" expects at least 3 arguments');if(e.length%2==1)throw new Error('"case" expects an odd number of arguments');let s;const o=[];for(let h=1;h<e.length-1;h+=2){const m=L(e[h],a),v=L(e[h+1],a,i);s||(s=v.type),o.push({condition:m,output:v})}const E=L(e[e.length-1],a,i);return s||(s=E.type),new Xt(s,o,E)}evaluate(e,a){for(const i of this._args)if(i.condition.evaluate(e,a))return i.output.evaluate(e,a);return this._fallback.evaluate(e,a)}}class Wt{constructor(e,a){this.type=e,this._args=a}static parse(e,a){if(e.length<2)throw new Error('"coalesce" expects at least 1 argument');let i;const s=[];for(let o=1;o<e.length;o++){const E=L(e[o],a);i||(i=E.type),s.push(E)}return new Wt(i,s)}evaluate(e,a){for(const i of this._args){const s=i.evaluate(e,a);if(null!==s)return s}return null}}class qt{constructor(e,a,i,s,o){this.type=e,this._input=a,this._labels=i,this._outputs=s,this._fallback=o}static parse(e,a){if(e.length<3)throw new Error('"match" expects at least 3 arguments');if(e.length%2==0)throw new Error('"case" expects an even number of arguments');let i;const s=L(e[1],a),o=[],E={};let h;for(let m=2;m<e.length-1;m+=2){let v=e[m];Array.isArray(v)||(v=[v]);for(const R of v){const P=typeof R;if("string"!==P&&"number"!==P)throw new Error('"match" requires string or number literal as labels');if(h){if(P!==h)throw new Error('"match" requires labels to have the same type')}else h=P;E[R]=o.length}const A=L(e[m+1],a);i||(i=A.type),o.push(A)}return new qt(i,s,E,o,L(e[e.length-1],a))}evaluate(e,a){const i=this._input.evaluate(e,a);return(this._outputs[this._labels[i]]||this._fallback).evaluate(e,a)}}class gt{constructor(e,a,i,s,o){this._operator=e,this.type=a,this.interpolation=i,this.input=s,this._stops=o}static parse(e,a,i){const s=e[0];if(e.length<5)throw new Error(`"${s}" expects at least 4 arguments`);const o=e[1];if(!Array.isArray(o)||0===o.length)throw new Error(`"${o}" is not a valid interpolation`);switch(o[0]){case"linear":if(1!==o.length)throw new Error("Linear interpolation cannot have parameters");break;case"exponential":if(2!==o.length||"number"!=typeof o[1])throw new Error("Exponential interpolation requires one numeric argument");break;case"cubic-bezier":if(5!==o.length)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(let v=1;v<5;v++){const A=o[v];if("number"!=typeof A||A<0||A>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1")}break;default:throw new Error(`"${e[0]}" unknown interpolation type "${o[0]}"`)}if(e.length%2!=1)throw new Error(`"${s}" expects an even number of arguments`);const E=L(e[2],a,V);let h;"interpolate-hcl"===s||"interpolate-lab"===s?h=nt:i&&"value"!==i.kind&&(h=i);const m=[];for(let v=3;v<e.length;v+=2){const A=e[v];if("number"!=typeof A)throw new Error(`"${s}" requires stop inputs as literal numbers`);if(m.length&&m[m.length-1][0]>=A)throw new Error(`"${s}" requires strictly ascending stop inputs`);const R=L(e[v+1],a,h);h||(h=R.type),m.push([A,R])}if(h&&h!==nt&&h!==V&&("array"!==h.kind||h.itemType!==V))throw new Error(`"${s}" cannot interpolate type ${bt(h)}`);return new gt(s,h,o,E,m)}evaluate(e,a){const i=this._stops;if(1===i.length)return i[0][1].evaluate(e,a);const s=this.input.evaluate(e,a);if(s<=i[0][0])return i[0][1].evaluate(e,a);if(s>=i[i.length-1][0])return i[i.length-1][1].evaluate(e,a);let o=0;for(;++o<i.length&&!(s<i[o][0]););const m=gt.interpolationRatio(this.interpolation,s,i[o-1][0],i[o][0]),v=i[o-1][1].evaluate(e,a),A=i[o][1].evaluate(e,a);if("interpolate"===this._operator){if("array"===this.type.kind&&Array.isArray(v)&&Array.isArray(A))return v.map((R,P)=>(0,N.sX)(R,A[P],m));if("color"===this.type.kind&&v instanceof C.Z&&A instanceof C.Z){const R=new C.Z(v),P=new C.Z(A);return new C.Z([(0,N.sX)(R.r,P.r,m),(0,N.sX)(R.g,P.g,m),(0,N.sX)(R.b,P.b,m),(0,N.sX)(R.a,P.a,m)])}if("number"===this.type.kind&&"number"==typeof v&&"number"==typeof A)return(0,N.sX)(v,A,m);throw new Error(`"${this._operator}" cannot interpolate type ${bt(this.type)}`)}if("interpolate-hcl"===this._operator){const R=(0,Q.sJ)(v),P=(0,Q.sJ)(A),k=P.h-R.h,ct=(0,Q.xr)({h:R.h+m*(k>180||k<-180?k-360*Math.round(k/360):k),c:(0,N.sX)(R.c,P.c,m),l:(0,N.sX)(R.l,P.l,m)});return new C.Z({a:(0,N.sX)(v.a,A.a,m),...ct})}if("interpolate-lab"===this._operator){const R=(0,Q.Y3)(v),P=(0,Q.Y3)(A),k=(0,Q.xr)({l:(0,N.sX)(R.l,P.l,m),a:(0,N.sX)(R.a,P.a,m),b:(0,N.sX)(R.b,P.b,m)});return new C.Z({a:(0,N.sX)(v.a,A.a,m),...k})}throw new Error(`Unexpected operator "${this._operator}"`)}interpolationUniformValue(e,a){const i=this._stops;if(1===i.length||e>=i[i.length-1][0])return 0;let s=0;for(;++s<i.length&&!(e<i[s][0]););return gt.interpolationRatio(this.interpolation,a,i[s-1][0],i[s][0])}getInterpolationRange(e){const a=this._stops;if(1===a.length){const o=a[0][0];return[o,o]}const i=a[a.length-1][0];if(e>=i)return[i,i];let s=0;for(;++s<a.length&&!(e<a[s][0]););return[a[s-1][0],a[s][0]]}static interpolationRatio(e,a,i,s){let o=0;return"linear"===e[0]?o=gt._exponentialInterpolationRatio(a,1,i,s):"exponential"===e[0]?o=gt._exponentialInterpolationRatio(a,e[1],i,s):"cubic-bezier"===e[0]&&(o=(0,yt.n_)(e[1],e[2],e[3],e[4])(gt._exponentialInterpolationRatio(a,1,i,s),1e-5)),o<0?o=0:o>1&&(o=1),o}static _exponentialInterpolationRatio(e,a,i,s){const o=s-i;if(0===o)return 0;const E=e-i;return 1===a?E/o:(a**E-1)/(a**o-1)}}class Jt{constructor(e,a,i){this.type=e,this._input=a,this._stops=i}static parse(e,a){if(e.length<5)throw new Error('"step" expects at least 4 arguments');if(e.length%2!=1)throw new Error('"step" expects an even number of arguments');const i=L(e[1],a,V);let s;const o=[];o.push([-1/0,L(e[2],a)]);for(let E=3;E<e.length;E+=2){const h=e[E];if("number"!=typeof h)throw new Error('"step" requires stop inputs as literal numbers');if(o.length&&o[o.length-1][0]>=h)throw new Error('"step" requires strictly ascending stop inputs');const m=L(e[E+1],a);s||(s=m.type),o.push([h,m])}return new Jt(s,i,o)}evaluate(e,a){const i=this._stops;if(1===i.length)return i[0][1].evaluate(e,a);const s=this._input.evaluate(e,a);let o=0;for(;++o<i.length&&!(s<i[o][0]););return this._stops[o-1][1].evaluate(e,a)}}class Qt{constructor(e,a){this.type=e,this._output=a}static parse(e,a,i){if(e.length<4)throw new Error('"let" expects at least 3 arguments');if(e.length%2==1)throw new Error('"let" expects an odd number of arguments');const s=new Zt(a);for(let E=1;E<e.length-1;E+=2){const h=e[E];if("string"!=typeof h)throw new Error(`"let" requires a string to define variable names - found ${h}`);s.add(h,L(e[E+1],a))}const o=L(e[e.length-1],s,i);return new Qt(o.type,o)}evaluate(e,a){return this._output.evaluate(e,a)}}class te{constructor(e,a){this.type=e,this.output=a}static parse(e,a,i){if(2!==e.length||"string"!=typeof e[1])throw new Error('"var" requires just one literal string argument');const s=a.get(e[1]);if(!s)throw new Error(`${e[1]} must be defined before being used in a "var" expression`);return new te(i||at,s)}evaluate(e,a){return this.output.evaluate(e,a)}}class ee{constructor(e,a,i){this.type=e,this._index=a,this._array=i}static parse(e,a){if(3!==e.length)throw new Error('"at" expects 2 arguments');const i=L(e[1],a,V),s=L(e[2],a);return new ee(s.type.itemType,i,s)}evaluate(e,a){const i=this._index.evaluate(e,a),s=this._array.evaluate(e,a);if(i<0||i>=s.length)throw new Error('"at" index out of bounds');if(i!==Math.floor(i))throw new Error('"at" index must be an integer');return s[i]}}class Ct{constructor(e,a){this._key=e,this._obj=a,this.type=at}static parse(e,a){let i,s;switch(e.length){case 2:return i=L(e[1],a),new Ct(i);case 3:return i=L(e[1],a),s=L(e[2],a),new Ct(i,s);default:throw new Error('"get" expects 1 or 2 arguments')}}evaluate(e,a){const i=this._key.evaluate(e,a);return this._obj?this._obj.evaluate(e,a)[i]:e?.values[i]}}class $t{constructor(e,a){this._key=e,this._obj=a,this.type=W}static parse(e,a){let i,s;switch(e.length){case 2:return i=L(e[1],a),new $t(i);case 3:return i=L(e[1],a),s=L(e[2],a),new $t(i,s);default:throw new Error('"has" expects 1 or 2 arguments')}}evaluate(e,a){const i=this._key.evaluate(e,a);return this._obj?i in this._obj.evaluate(e,a):!!e?.values[i]}}class re{constructor(e,a){this._key=e,this._vals=a,this.type=W}static parse(e,a){if(3!==e.length)throw new Error('"in" expects 2 arguments');return new re(L(e[1],a),L(e[2],a))}evaluate(e,a){const i=this._key.evaluate(e,a);return this._vals.evaluate(e,a).includes(i)}}class Yt{constructor(e,a,i){this._item=e,this._array=a,this._from=i,this.type=V}static parse(e,a){if(e.length<3||e.length>4)throw new Error('"index-of" expects 3 or 4 arguments');const i=L(e[1],a),s=L(e[2],a);if(4===e.length){const o=L(e[3],a,V);return new Yt(i,s,o)}return new Yt(i,s)}evaluate(e,a){const i=this._item.evaluate(e,a),s=this._array.evaluate(e,a);if(this._from){const o=this._from.evaluate(e,a);if(o!==Math.floor(o))throw new Error('"index-of" index must be an integer');return s.indexOf(i,o)}return s.indexOf(i)}}class ne{constructor(e){this._arg=e,this.type=V}static parse(e,a){if(2!==e.length)throw new Error('"length" expects 2 arguments');const i=L(e[1],a);return new ne(i)}evaluate(e,a){const i=this._arg.evaluate(e,a);if("string"==typeof i||Array.isArray(i))return i.length;throw new Error('"length" expects string or array')}}class Ht{constructor(e,a,i,s){this.type=e,this._array=a,this._from=i,this._to=s}static parse(e,a){if(e.length<3||e.length>4)throw new Error('"slice" expects 2 or 3 arguments');const i=L(e[1],a),s=L(e[2],a,V);if(s.type!==V)throw new Error('"slice" index must return a number');if(4===e.length){const o=L(e[3],a,V);if(o.type!==V)throw new Error('"slice" index must return a number');return new Ht(i.type,i,s,o)}return new Ht(i.type,i,s)}evaluate(e,a){const i=this._array.evaluate(e,a);if(!Array.isArray(i)&&"string"!=typeof i)throw new Error('"slice" input must be an array or a string');const s=this._from.evaluate(e,a);if(s<0||s>=i.length)throw new Error('"slice" index out of bounds');if(s!==Math.floor(s))throw new Error('"slice" index must be an integer');if(this._to){const o=this._to.evaluate(e,a);if(o<0||o>=i.length)throw new Error('"slice" index out of bounds');if(o!==Math.floor(o))throw new Error('"slice" index must be an integer');return i.slice(s,o)}return i.slice(s)}}class ae{constructor(){this.type=W}static parse(e){if(1!==e.length)throw new Error('"has-id" expects no arguments');return new ae}evaluate(e,a){return void 0!==e?.id}}class it{constructor(e,a){this._args=e,this._calculate=a,this.type=V}static parse(e,a,i){const s=e.slice(1).map(o=>L(o,a));return new it(s,i)}evaluate(e,a){let i;return this._args&&(i=this._args.map(s=>s.evaluate(e,a))),this._calculate(i)}}let J=(()=>{class p{constructor(a,i){this._args=a,this._calculate=i,this.type=V}static parse(a,i){const s=a.slice(1).map(o=>L(o,i));return new p(s,p.ops[a[0]])}evaluate(a,i){let s;return this._args&&(s=this._args.map(o=>o.evaluate(a,i))),this._calculate(s)}}return p.ops={abs:e=>Math.abs(e[0]),acos:e=>Math.acos(e[0]),asin:e=>Math.asin(e[0]),atan:e=>Math.atan(e[0]),ceil:e=>Math.ceil(e[0]),cos:e=>Math.cos(e[0]),e:()=>Math.E,floor:e=>Math.floor(e[0]),ln:e=>Math.log(e[0]),ln2:()=>Math.LN2,log10:e=>Math.log(e[0])/Math.LN10,log2:e=>Math.log(e[0])/Math.LN2,max:e=>Math.max(...e),min:e=>Math.min(...e),pi:()=>Math.PI,round:e=>Math.round(e[0]),sin:e=>Math.sin(e[0]),sqrt:e=>Math.sqrt(e[0]),tan:e=>Math.tan(e[0])},p})();class ie{constructor(e){this._args=e,this.type=rt}static parse(e,a){return new ie(e.slice(1).map(i=>L(i,a)))}evaluate(e,a){return this._args.map(i=>i.evaluate(e,a)).join("")}}let pe=(()=>{class p{constructor(a,i){this._arg=a,this._calculate=i,this.type=rt}static parse(a,i){if(2!==a.length)throw new Error(`${a[0]} expects 1 argument`);const s=L(a[1],i);return new p(s,p.ops[a[0]])}evaluate(a,i){return this._calculate(this._arg.evaluate(a,i))}}return p.ops={downcase:e=>e.toLowerCase(),upcase:e=>e.toUpperCase()},p})();class se{constructor(e){this._args=e,this.type=nt}static parse(e,a){if(4!==e.length)throw new Error('"rgb" expects 3 arguments');const i=e.slice(1).map(s=>L(s,a));return new se(i)}evaluate(e,a){const i=this._validate(this._args[0].evaluate(e,a)),s=this._validate(this._args[1].evaluate(e,a)),o=this._validate(this._args[2].evaluate(e,a));return new C.Z({r:i,g:s,b:o})}_validate(e){if("number"!=typeof e||e<0||e>255)throw new Error(`${e}: invalid color component`);return Math.round(e)}}class oe{constructor(e){this._args=e,this.type=nt}static parse(e,a){if(5!==e.length)throw new Error('"rgba" expects 4 arguments');const i=e.slice(1).map(s=>L(s,a));return new oe(i)}evaluate(e,a){const i=this._validate(this._args[0].evaluate(e,a)),s=this._validate(this._args[1].evaluate(e,a)),o=this._validate(this._args[2].evaluate(e,a)),E=this._validateAlpha(this._args[3].evaluate(e,a));return new C.Z({r:i,g:s,b:o,a:E})}_validate(e){if("number"!=typeof e||e<0||e>255)throw new Error(`${e}: invalid color component`);return Math.round(e)}_validateAlpha(e){if("number"!=typeof e||e<0||e>1)throw new Error(`${e}: invalid alpha color component`);return e}}class le{constructor(e){this._color=e,this.type=Tt(V,4)}static parse(e,a){if(2!==e.length)throw new Error('"to-rgba" expects 1 argument');const i=L(e[1],a);return new le(i)}evaluate(e,a){return new C.Z(this._color.evaluate(e,a)).toRgba()}}class Pt{constructor(e,a){this.type=e,this._args=a}static parse(e,a){const i=e[0];if(e.length<2)throw new Error(`${i} expects at least one argument`);let s,o=1;if("array"===i){if(e.length>2){switch(e[1]){case"string":s=rt;break;case"number":s=V;break;case"boolean":s=W;break;default:throw new Error('"array" type argument must be string, number or boolean')}o++}else s=at;let h;if(e.length>3){if(h=e[2],null!==h&&("number"!=typeof h||h<0||h!==Math.floor(h)))throw new Error('"array" length argument must be a positive integer literal');o++}s=Tt(s,h)}else switch(i){case"string":s=rt;break;case"number":s=V;break;case"boolean":s=W;break;case"object":s=_t}const E=[];for(;o<e.length;o++){const h=L(e[o],a);E.push(h)}return new Pt(s,E)}evaluate(e,a){let i;for(const s of this._args){const o=s.evaluate(e,a);if(i=At(o),Ot(i,this.type))return o}throw new Error(`Expected ${bt(this.type)} but got ${bt(i)}`)}}let St=(()=>{class p{constructor(a,i){this.type=a,this._args=i}static parse(a,i){const s=a[0],o=p.types[s];if(o===W||o===rt){if(2!==a.length)throw new Error(`${s} expects one argument`)}else if(a.length<2)throw new Error(`${s} expects at least one argument`);const E=[];for(let h=1;h<a.length;h++){const m=L(a[h],i);E.push(m)}return new p(o,E)}evaluate(a,i){if(this.type===W)return!!this._args[0].evaluate(a,i);if(this.type===rt)return Gt(this._args[0].evaluate(a,i));if(this.type===V){for(const s of this._args){const o=Number(s.evaluate(a,i));if(!isNaN(o))return o}return null}if(this.type===nt){for(const s of this._args)try{const o=p.toColor(s.evaluate(a,i));if(o instanceof C.Z)return o}catch{}return null}}static toBoolean(a){return!!a}static toString(a){return Gt(a)}static toNumber(a){const i=Number(a);if(isNaN(i))throw new Error(`"${a}" is not a number`);return i}static toColor(a){if(a instanceof C.Z)return a;if("string"==typeof a){const i=C.Z.fromString(a);if(i)return i;throw new Error(`"${a}" is not a color`)}if(Array.isArray(a))return C.Z.fromArray(a);throw new Error(`"${a}" is not a color`)}}return p.types={"to-boolean":W,"to-color":nt,"to-number":V,"to-string":rt},p})();class ue{constructor(e){this._val=e,this.type=At(e)}static parse(e){if(2!==e.length)throw new Error('"literal" expects 1 argument');return new ue(e[1])}evaluate(e,a){return this._val}}class ce{constructor(e){this._arg=e,this.type=rt}static parse(e,a){if(2!==e.length)throw new Error('"typeof" expects 1 argument');return new ce(L(e[1],a))}evaluate(e,a){return bt(At(this._arg.evaluate(e,a)))}}function L(p,e,a){const i=typeof p;if("string"===i||"boolean"===i||"number"===i||null===p){if(a)switch(a.kind){case"string":"string"!==i&&(p=St.toString(p));break;case"number":"number"!==i&&(p=St.toNumber(p));break;case"color":p=St.toColor(p)}p=["literal",p]}if(!Array.isArray(p)||0===p.length)throw new Error("Expression must be a non empty array");const s=p[0];if("string"!=typeof s)throw new Error("First element of expression must be a string");const o=fe[s];if(void 0===o)throw new Error(`Invalid expression operator "${s}"`);if(!o)throw new Error(`Unimplemented expression operator "${s}"`);return o.parse(p,e,a)}const fe={array:Pt,boolean:Pt,collator:null,format:null,image:null,literal:ue,number:Pt,"number-format":null,object:Pt,string:Pt,"to-boolean":St,"to-color":St,"to-number":St,"to-string":St,typeof:ce,accumulated:null,"feature-state":null,"geometry-type":f,id:u,"line-progress":null,properties:l,at:ee,get:Ct,has:$t,in:re,"index-of":Yt,length:ne,slice:Ht,"!":Lt,"!=":class I extends d{static parse(e,a){return d.parse(e,a,(i,s)=>i!==s)}},"<":class S extends d{static parse(e,a){return d.parse(e,a,(i,s)=>i<s)}},"<=":class O extends d{static parse(e,a){return d.parse(e,a,(i,s)=>i<=s)}},"==":class w extends d{static parse(e,a){return d.parse(e,a,(i,s)=>i===s)}},">":class j extends d{static parse(e,a){return d.parse(e,a,(i,s)=>i>s)}},">=":class ut extends d{static parse(e,a){return d.parse(e,a,(i,s)=>i>=s)}},all:Nt,any:xt,case:Xt,coalesce:Wt,match:qt,within:null,interpolate:gt,"interpolate-hcl":gt,"interpolate-lab":gt,step:Jt,let:Qt,var:te,concat:ie,downcase:pe,"is-supported-script":null,"resolved-locale":null,upcase:pe,rgb:se,rgba:oe,"to-rgba":le,"-":class ge extends it{static parse(e,a){switch(e.length){case 2:return it.parse(e,a,i=>-i[0]);case 3:return it.parse(e,a,i=>i[0]-i[1]);default:throw new Error('"-" expects 1 or 2 arguments')}}},"*":class _e extends it{static parse(e,a){return it.parse(e,a,i=>{let s=1;for(const o of i)s*=o;return s})}},"/":class de extends it{static parse(e,a){if(3===e.length)return it.parse(e,a,i=>i[0]/i[1]);throw new Error('"/" expects 2 arguments')}},"%":class me extends it{static parse(e,a){if(3===e.length)return it.parse(e,a,i=>i[0]%i[1]);throw new Error('"%" expects 2 arguments')}},"^":class Ee extends it{static parse(e,a){if(3===e.length)return it.parse(e,a,i=>i[0]**i[1]);throw new Error('"^" expects 1 or 2 arguments')}},"+":class be extends it{static parse(e,a){return it.parse(e,a,i=>{let s=0;for(const o of i)s+=o;return s})}},abs:J,acos:J,asin:J,atan:J,ceil:J,cos:J,e:J,floor:J,ln:J,ln2:J,log10:J,log2:J,max:J,min:J,pi:J,round:J,sin:J,sqrt:J,tan:J,zoom:_,"heatmap-density":null,"has-id":ae,none:Kt};class ot{constructor(e){this._expression=e}filter(e,a){if(!this._expression)return!0;try{return this._expression.evaluate(e,a)}catch(i){return console.log(i.message),!0}}static createFilter(e){if(!e)return null;this.isLegacyFilter(e)&&(e=this.convertLegacyFilter(e));try{const a=L(e,null,W);return new ot(a)}catch(a){return console.log(a.message),null}}static isLegacyFilter(e){if(!Array.isArray(e)||0===e.length)return!0;switch(e[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return 3===e.length&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"in":return e.length>=3&&"string"==typeof e[1]&&!Array.isArray(e[2]);case"!in":case"none":case"!has":return!0;case"any":case"all":for(let a=1;a<e.length;a++)if(this.isLegacyFilter(e[a]))return!0;return!1;case"has":return 2===e.length&&("$id"===e[1]||"$type"===e[1]);default:return!1}}static convertLegacyFilter(e){if(!Array.isArray(e)||0===e.length)return!0;const a=e[0];if(1===e.length)return"any"!==a;switch(a){case"==":return ot.convertComparison("==",e[1],e[2]);case"!=":return ot.negate(ot.convertComparison("==",e[1],e[2]));case">":case"<":case">=":case"<=":return ot.convertComparison(a,e[1],e[2]);case"in":return ot.convertIn(e[1],e.slice(2));case"!in":return ot.negate(ot.convertIn(e[1],e.slice(2)));case"any":case"all":case"none":return ot.convertCombining(a,e.slice(1));case"has":return ot.convertHas(e[1]);case"!has":return ot.negate(ot.convertHas(e[1]));default:throw new Error("Unexpected legacy filter.")}}static convertComparison(e,a,i){switch(a){case"$type":return[e,["geometry-type"],i];case"$id":return[e,["id"],i];default:return[e,["get",a],i]}}static convertIn(e,a){switch(e){case"$type":return["in",["geometry-type"],["literal",a]];case"$id":return["in",["id"],["literal",a]];default:return["in",["get",e],["literal",a]]}}static convertHas(e){switch(e){case"$type":return!0;case"$id":return["has-id"];default:return["has",e]}}static convertCombining(e,a){return[e].concat(a.map(this.convertLegacyFilter))}static negate(e){return["!",e]}}var X=G(59078);class jt{constructor(e,a){let i;switch(this.isDataDriven=!1,this.interpolator=null,e.type){case"number":case"color":i=!0;break;case"array":i="number"===e.value;break;default:i=!1}if(null==a&&(a=e.default),Array.isArray(a)&&a.length>0&&fe[a[0]]){const o={number:V,color:nt,string:rt,boolean:W,enum:rt};try{const h=L(a,null,"array"===e.type?Tt(o[e.value]||at,e.length):o[e.type]);this.getValue=this._buildExpression(h,e),this.isDataDriven=!0,h instanceof gt&&h.input instanceof _&&(this.interpolator=h)}catch(E){console.log(E.message),this.getValue=this._buildSimple(e.default)}return}i&&"interval"===a.type&&(i=!1);const s=a?.stops&&a.stops.length>0;if(s)for(const o of a.stops)o[1]=this._validate(o[1],e);if(this.isDataDriven=!!a&&!!a.property,this.isDataDriven)if(void 0!==a.default&&(a.default=this._validate(a.default,e)),s)switch(a.type){case"identity":this.getValue=this._buildIdentity(a,e);break;case"categorical":this.getValue=this._buildCategorical(a,e);break;default:this.getValue=i?this._buildInterpolate(a,e):this._buildInterval(a,e)}else this.getValue=this._buildIdentity(a,e);else s?this.getValue=i?this._buildZoomInterpolate(a):this._buildZoomInterval(a):(a=this._validate(a,e),this.getValue=this._buildSimple(a))}_validate(e,a){if("number"===a.type){if(null!=a.minimum&&e<a.minimum)return a.minimum;if(null!=a.maximum&&e>a.maximum)return a.maximum}else"color"===a.type?e=jt._parseColor(e):"enum"===a.type?"string"==typeof e&&(e=a.values.indexOf(e)):"array"===a.type&&"enum"===a.value?e=e.map(i=>"string"==typeof i?a.values.indexOf(i):i):"string"===a.type&&(e=Gt(e));return e}_buildSimple(e){return()=>e}_buildExpression(e,a){return(i,s)=>{try{const o=e.evaluate(s,i);return void 0===o?a.default:this._validate(o,a)}catch(o){return console.log(o.message),a.default}}}_buildIdentity(e,a){return(i,s)=>{let o;return s&&(o=s.values[e.property]),void 0!==o&&(o=this._validate(o,a)),o??(void 0!==e.default?e.default:a.default)}}_buildCategorical(e,a){return(i,s)=>{let o;return s&&(o=s.values[e.property]),o=this._categorical(o,e.stops),void 0!==o?o:void 0!==e.default?e.default:a.default}}_buildInterval(e,a){return(i,s)=>{let o;return s&&(o=s.values[e.property]),"number"==typeof o?this._interval(o,e.stops):void 0!==e.default?e.default:a.default}}_buildInterpolate(e,a){return(i,s)=>{let o;return s&&(o=s.values[e.property]),"number"==typeof o?this._interpolate(o,e.stops,e.base||1):void 0!==e.default?e.default:a.default}}_buildZoomInterpolate(e){return a=>this._interpolate(a,e.stops,e.base||1)}_buildZoomInterval(e){return a=>this._interval(a,e.stops)}_categorical(e,a){const i=a.length;for(let s=0;s<i;s++)if(a[s][0]===e)return a[s][1]}_interval(e,a){const i=a.length;let s=0;for(let o=0;o<i&&a[o][0]<=e;o++)s=o;return a[s][1]}_interpolate(e,a,i){let s,o;const E=a.length;for(let h=0;h<E;h++){const m=a[h];if(!(m[0]<=e)){o=m;break}s=m}if(s&&o){const h=o[0]-s[0],m=e-s[0],v=1===i?m/h:(i**m-1)/(i**h-1);if(Array.isArray(s[1])){const A=s[1],R=o[1],P=[];for(let k=0;k<A.length;k++)P.push((0,N.sX)(A[k],R[k],v));return P}return(0,N.sX)(s[1],o[1],v)}return s?s[1]:o?o[1]:void 0}static _isEmpty(e){for(const a in e)if(e.hasOwnProperty(a))return!1;return!0}static _parseColor(e){return Array.isArray(e)?e:("string"==typeof e&&(e=new C.Z(e)),e instanceof C.Z&&!this._isEmpty(e)?C.Z.toUnitRGBA(e):void 0)}}var Mt,we=G(99657);!function(p){p[p.BUTT=0]="BUTT",p[p.ROUND=1]="ROUND",p[p.SQUARE=2]="SQUARE",p[p.UNKNOWN=4]="UNKNOWN"}(Mt||(Mt={}));class Ie{constructor(e,a,i,s,o,E){this.layer=e,this.feature=a,this.bounds=i,this.normalizationRatio=s,this.normalizationOffsetX=o,this.normalizationOffsetY=E}}class kt{constructor(e,a,i,s){switch(this.type=e,this.typeName=a.type,this.id=a.id,this.source=a.source,this.sourceLayer=a["source-layer"],this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,this.filter=a.filter,this.layout=a.layout,this.paint=a.paint,this.z=i,this.uid=s,e){case X.fR.BACKGROUND:this._layoutDefinition=X.f2.backgroundLayoutDefinition,this._paintDefinition=X.f2.backgroundPaintDefinition;break;case X.fR.FILL:this._layoutDefinition=X.f2.fillLayoutDefinition,this._paintDefinition=X.f2.fillPaintDefinition;break;case X.fR.LINE:this._layoutDefinition=X.f2.lineLayoutDefinition,this._paintDefinition=X.f2.linePaintDefinition;break;case X.fR.SYMBOL:this._layoutDefinition=X.f2.symbolLayoutDefinition,this._paintDefinition=X.f2.symbolPaintDefinition;break;case X.fR.CIRCLE:this._layoutDefinition=X.f2.circleLayoutDefinition,this._paintDefinition=X.f2.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}getFeatureFilter(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=ot.createFilter(this.filter)}getLayoutProperty(e){return this._layoutProperties[e]}getPaintProperty(e){return this._paintProperties[e]}getLayoutValue(e,a,i){let s;const o=this._layoutProperties[e];return o&&(s=o.getValue(a,i)),void 0===s&&(s=this._layoutDefinition[e].default),s}getPaintValue(e,a,i){let s;const o=this._paintProperties[e];return o&&(s=o.getValue(a,i)),void 0===s&&(s=this._paintDefinition[e].default),s}isPainterDataDriven(){const e=this._paintProperties;if(e)for(const a in e)if(e[a].isDataDriven)return!0;return!1}isIntersectingFeature(e,a,i,s,o,E,h){return!1}getFeatureInflatedBounds(e,a,i,s){return null}_parseLayout(e){const a={};for(const i in e){const s=this._layoutDefinition[i];s&&(a[i]=new jt(s,e[i]))}return a}_parsePaint(e){const a={};for(const i in e){const s=this._paintDefinition[i];s&&(a[i]=new jt(s,e[i]))}return a}computeAttributesKey(e,a,i,s){let o=0,E=0;for(const h of a){let m=3;if(!h||h!==s){const v=i[h],{isLayout:A,isOptional:R}=v,P=A?this.getLayoutProperty(h):this.getPaintProperty(h);m=P?.interpolator?2:P?.isDataDriven?1:R&&!P?3:0}E|=m<<o,o+=2}return E<<3|e}}class ve extends kt{constructor(e,a,i,s){super(e,a,i,s),this.backgroundMaterial=new F(this.computeAttributesKey(z._K.BACKGROUND,F.ATTRIBUTES,F.ATTRIBUTES_INFO))}}class Te extends kt{constructor(e,a,i,s){super(e,a,i,s);const o=this.getPaintProperty("fill-color"),E=this.getPaintProperty("fill-opacity"),h=this.getPaintProperty("fill-pattern");this.hasDataDrivenColor=o?.isDataDriven,this.hasDataDrivenOpacity=E?.isDataDriven,this.hasDataDrivenFill=this.hasDataDrivenColor||this.hasDataDrivenOpacity||h?.isDataDriven;const m=this.getPaintProperty("fill-outline-color");this.outlineUsesFillColor=!m,this.hasDataDrivenOutlineColor=m?.isDataDriven,this.hasDataDrivenOutline=m?m.isDataDriven:!!o&&o.isDataDriven,this.hasDataDrivenOutline=(m?this.hasDataDrivenOutlineColor:this.hasDataDrivenColor)||this.hasDataDrivenOpacity,this.fillMaterial=new Y(this.computeAttributesKey(z._K.FILL,Y.ATTRIBUTES,Y.ATTRIBUTES_INFO)),this.outlineMaterial=new H(this.computeAttributesKey(z._K.OUTLINE,this.outlineUsesFillColor?H.ATTRIBUTES_FILL:H.ATTRIBUTES_OUTLINE,this.outlineUsesFillColor?H.ATTRIBUTES_INFO_FILL:H.ATTRIBUTES_INFO_OUTLINE),this.outlineUsesFillColor)}getFeatureInflatedBounds(e,a,i,s){const o=he(e);if(!o)return null;const E=this.getPaintValue("fill-translate",a,e),h=s*Math.max(E[0],E[1]);return o[0]-=h,o[2]-=h,o[1]+=h,o[3]+=h,o}isIntersectingFeature(e,a,i,s,o,E,h){const m=s.getGeometry();if(!m)return!1;const v=8/h.normalizationRatio;e=e/h.normalizationRatio+h.normalizationOffsetX,a=a/h.normalizationRatio+h.normalizationOffsetY;const A=(0,N.Wg)(this.getPaintValue("fill-translate",o,s),this.getPaintValue("fill-translate-anchor",o,s),E,8);return!!(0,N.Of)(e-=v*A.x,a-=v*A.y,m)||(0,N.Z0)(e,a,m,v*i)}}class De extends kt{constructor(e,a,i,s){super(e,a,i,s);const o=this.getPaintProperty("line-pattern");if(this.lineMaterial=new et(this.computeAttributesKey(z._K.LINE,et.ATTRIBUTES,et.ATTRIBUTES_INFO,o?"line-dasharray":"")),this.hasDataDrivenLine=this.getPaintProperty("line-blur")?.isDataDriven||this.getPaintProperty("line-color")?.isDataDriven||this.getPaintProperty("line-gap-width")?.isDataDriven||this.getPaintProperty("line-offset")?.isDataDriven||this.getPaintProperty("line-opacity")?.isDataDriven||this.getPaintProperty("line-pattern")?.isDataDriven||this.getPaintProperty("line-dasharray")?.isDataDriven||this.getLayoutProperty("line-cap")?.isDataDriven||this.getPaintProperty("line-width")?.isDataDriven,this.canUseThinTessellation=!1,!this.hasDataDrivenLine){const E=this.getPaintProperty("line-width");if(!E||"number"==typeof E&&.5*E<we.do){const h=this.getPaintProperty("line-offset");(!h||"number"==typeof h&&0===h)&&(this.canUseThinTessellation=!0)}}}getDashKey(e,a){let i;switch(a){case Mt.BUTT:i="Butt";break;case Mt.ROUND:i="Round";break;case Mt.SQUARE:i="Square";break;default:i="Butt"}return`dasharray-[${e.toString()}]-${i}`}getFeatureInflatedBounds(e,a,i,s){const o=he(e);if(!o)return null;const E=this.getPaintValue("line-translate",a,e),h=s*Math.max(E[0],E[1]);o[0]-=h,o[2]-=h,o[1]+=h,o[3]+=h;const m=s*Math.abs(this.getPaintValue("line-offset",a,e)||0),v=s*(this.getPaintValue("line-width",a,e)/2);return o[0]-=m+v,o[1]-=m+v,o[2]+=m+v,o[3]+=m+v,o}isIntersectingFeature(e,a,i,s,o,E,h){let m=s.getGeometry();if(!m)return!1;const v=8/h.normalizationRatio;e=e/h.normalizationRatio+h.normalizationOffsetX,a=a/h.normalizationRatio+h.normalizationOffsetY;const A=(0,N.Wg)(this.getPaintValue("line-translate",o,s),this.getPaintValue("line-translate-anchor",o,s),E,8);e-=v*A.x,a-=v*A.y;const R=v*this.getPaintValue("line-offset",o,s)||0;0!==R&&(m=(0,N.pK)(m,-R));const P=this.getPaintValue("line-width",o,s);return(0,N.Z0)(e,a,m,v*(i+P/2))}}class Re extends kt{constructor(e,a,i,s){super(e,a,i,s),this.iconMaterial=new $(this.computeAttributesKey(z._K.ICON,$.ATTRIBUTES,$.ATTRIBUTES_INFO)),this.textMaterial=new q(this.computeAttributesKey(z._K.TEXT,q.ATTRIBUTES,q.ATTRIBUTES_INFO)),this.hasDataDrivenIcon=this.getPaintProperty("icon-color")?.isDataDriven||this.getPaintProperty("icon-halo-blur")?.isDataDriven||this.getPaintProperty("icon-halo-color")?.isDataDriven||this.getPaintProperty("icon-halo-width")?.isDataDriven||this.getPaintProperty("icon-opacity")?.isDataDriven||this.getLayoutProperty("icon-size")?.isDataDriven,this.hasDataDrivenText=this.getPaintProperty("text-color")?.isDataDriven||this.getPaintProperty("text-halo-blur")?.isDataDriven||this.getPaintProperty("text-halo-color")?.isDataDriven||this.getPaintProperty("text-halo-width")?.isDataDriven||this.getPaintProperty("text-opacity")?.isDataDriven||this.getLayoutProperty("text-size")?.isDataDriven}}class Ae extends kt{constructor(e,a,i,s){super(e,a,i,s),this.circleMaterial=new M(this.computeAttributesKey(z._K.CIRCLE,M.ATTRIBUTES,M.ATTRIBUTES_INFO))}getFeatureInflatedBounds(e,a,i,s){const o=he(e);if(!o)return null;const E=this.getPaintValue("circle-translate",a,e),h=Math.max(E[0],E[1]);o[0]-=h,o[2]-=h,o[1]+=h,o[3]+=h;const m=s*(8*(this.getPaintValue("circle-radius",a,e)+this.getPaintValue("circle-stroke-width",a,e))/2);return o[0]-=m,o[1]-=m,o[2]+=m,o[3]+=m,o}isIntersectingFeature(e,a,i,s,o,E,h){const m=s.getGeometry();if(!m)return!1;const v=8/h.normalizationRatio;e=e/h.normalizationRatio+h.normalizationOffsetX,a=a/h.normalizationRatio+h.normalizationOffsetY,i*=v;const A=(0,N.Wg)(this.getPaintValue("circle-translate",o,s),this.getPaintValue("circle-translate-anchor",o,s),E,v),R=v*(this.getPaintValue("circle-radius",o,s)+this.getPaintValue("circle-stroke-width",o,s));let P,k;for(const ct of m)if(ct)for(const wt of ct)if(P=wt.x+A.x,k=wt.y+A.y,Math.sqrt((e-P)*(e-P)+(a-k)*(a-k))-i<=R)return!0;return!1}}class Le{constructor(e,a,i){let s;this.allowOverlap=e.getLayoutValue("icon-allow-overlap",a),this.ignorePlacement=e.getLayoutValue("icon-ignore-placement",a),this.keepUpright=e.getLayoutValue("icon-keep-upright",a),this.optional=e.getLayoutValue("icon-optional",a),this.rotationAlignment=e.getLayoutValue("icon-rotation-alignment",a),this.rotationAlignment===X.aF.AUTO&&(this.rotationAlignment=i?X.aF.MAP:X.aF.VIEWPORT),s=e.getLayoutProperty("icon-anchor"),s?.isDataDriven?this._anchorProp=s:this.anchor=e.getLayoutValue("icon-anchor",a),s=e.getLayoutProperty("icon-offset"),s?.isDataDriven?this._offsetProp=s:this.offset=e.getLayoutValue("icon-offset",a),s=e.getLayoutProperty("icon-padding"),s?.isDataDriven?this._paddingProp=s:this.padding=e.getLayoutValue("icon-padding",a),s=e.getLayoutProperty("icon-rotate"),s?.isDataDriven?this._rotateProp=s:this.rotate=e.getLayoutValue("icon-rotate",a),s=e.getLayoutProperty("icon-size"),s?.isDataDriven?this._sizeProp=s:this.size=e.getLayoutValue("icon-size",a)}update(e,a){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,a)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,a)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,a)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,a)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,a))}}class Ne{constructor(e,a,i){let s;this.allowOverlap=e.getLayoutValue("text-allow-overlap",a),this.ignorePlacement=e.getLayoutValue("text-ignore-placement",a),this.keepUpright=e.getLayoutValue("text-keep-upright",a),this.optional=e.getLayoutValue("text-optional",a),this.rotationAlignment=e.getLayoutValue("text-rotation-alignment",a),this.rotationAlignment===X.aF.AUTO&&(this.rotationAlignment=i?X.aF.MAP:X.aF.VIEWPORT),s=e.getLayoutProperty("text-anchor"),s?.isDataDriven?this._anchorProp=s:this.anchor=e.getLayoutValue("text-anchor",a),s=e.getLayoutProperty("text-justify"),s?.isDataDriven?this._justifyProp=s:this.justify=e.getLayoutValue("text-justify",a),s=e.getLayoutProperty("text-letter-spacing"),s?.isDataDriven?this._letterSpacingProp=s:this.letterSpacing=e.getLayoutValue("text-letter-spacing",a),s=e.getLayoutProperty("text-line-height"),s?.isDataDriven?this._lineHeightProp=s:this.lineHeight=e.getLayoutValue("text-line-height",a),s=e.getLayoutProperty("text-max-angle"),s?.isDataDriven?this._maxAngleProp=s:this.maxAngle=e.getLayoutValue("text-max-angle",a),s=e.getLayoutProperty("text-max-width"),s?.isDataDriven?this._maxWidthProp=s:this.maxWidth=e.getLayoutValue("text-max-width",a),s=e.getLayoutProperty("text-offset"),s?.isDataDriven?this._offsetProp=s:this.offset=e.getLayoutValue("text-offset",a),s=e.getLayoutProperty("text-padding"),s?.isDataDriven?this._paddingProp=s:this.padding=e.getLayoutValue("text-padding",a),s=e.getLayoutProperty("text-rotate"),s?.isDataDriven?this._rotateProp=s:this.rotate=e.getLayoutValue("text-rotate",a),s=e.getLayoutProperty("text-size"),s?.isDataDriven?this._sizeProp=s:this.size=e.getLayoutValue("text-size",a),s=e.getLayoutProperty("text-writing-mode"),s?.isDataDriven?this._writingModeProp=s:this.writingMode=e.getLayoutValue("text-writing-mode",a)}update(e,a){this._anchorProp&&(this.anchor=this._anchorProp.getValue(e,a)),this._justifyProp&&(this.justify=this._justifyProp.getValue(e,a)),this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(e,a)),this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(e,a)),this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(e,a)),this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(e,a)),this._offsetProp&&(this.offset=this._offsetProp.getValue(e,a)),this._paddingProp&&(this.padding=this._paddingProp.getValue(e,a)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(e,a)),this._sizeProp&&(this.size=this._sizeProp.getValue(e,a)),this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(e,a))}}function he(p){const e=p?.getGeometry();if(null==e)return null;let a=1/0,i=1/0,s=-1/0,o=-1/0;for(const E of e)if(E)for(const h of E)a=Math.min(a,h.x),i=Math.min(i,h.y),s=Math.max(s,h.x),o=Math.max(o,h.y);return(0,B.al)(a,i,s,o)}},14433:(Ut,lt,G)=>{G.d(lt,{Z:()=>N});var B=G(59078),z=G(1884);class N{constructor(c){if(this._style=c,this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,c.layers||(c.layers=[]),this.version=parseFloat(c.version),this.layers=c.layers.map((g,y,b)=>this._create(g,y,b)).filter(g=>!!g),this.layers)for(let g=0;g<this.layers.length;g++){const y=this.layers[g];this._layerByName[y.id]=y,this._uidToLayer.set(y.uid,y),y.type===B.fR.BACKGROUND&&this.backgroundBucketIds.push(y.id)}this._identifyRefLayers()}isPainterDataDriven(c){const g=this._layerByName[c];return!!g&&g.isPainterDataDriven()}getStyleLayerId(c){return c>=this.layers.length?null:this.layers[c].id}getStyleLayerByUID(c){return this._uidToLayer.get(c)??null}getStyleLayerIndex(c){const g=this._layerByName[c];return g?this.layers.indexOf(g):-1}setStyleLayer(c,g){if(!c?.id)return;const y=this._style;null!=g&&g>=this.layers.length&&(g=this.layers.length-1);let b,T=!0;const x=this._layerByName[c.id];if(x){const U=this.layers.indexOf(x);g||(g=U),g===U?(T=!1,b=N._recreateLayer(c,x),this.layers[g]=b,y.layers[g]=c):(this.layers.splice(U,1),y.layers.splice(U,1),b=this._create(c,g,this.layers),this.layers.splice(g,0,b),y.layers.splice(g,0,c))}else b=this._create(c,g,this.layers),!g||g>=this.layers.length?(this.layers.push(b),y.layers.push(c)):(this.layers.splice(g,0,b),y.layers.splice(g,0,c));this._layerByName[c.id]=b,this._uidToLayer.set(b.uid,b),T&&this._recomputeZValues(),this._identifyRefLayers()}getStyleLayer(c){const g=this._layerByName[c];return g?{type:g.typeName,id:g.id,source:g.source,"source-layer":g.sourceLayer,minzoom:g.minzoom,maxzoom:g.maxzoom,filter:g.filter,layout:g.layout,paint:g.paint}:null}deleteStyleLayer(c){const g=this._layerByName[c];if(g){delete this._layerByName[c],this._uidToLayer.delete(g.uid);const y=this.layers.indexOf(g);this.layers.splice(y,1),this._style.layers.splice(y,1),this._recomputeZValues(),this._identifyRefLayers()}}getLayerById(c){return this._layerByName[c]}getLayoutProperties(c){const g=this._layerByName[c];return g?g.layout:null}getPaintProperties(c){const g=this._layerByName[c];return g?g.paint:null}setPaintProperties(c,g){const y=this._layerByName[c];if(!y)return;const T=N._recreateLayer({type:y.typeName,id:y.id,source:y.source,"source-layer":y.sourceLayer,minzoom:y.minzoom,maxzoom:y.maxzoom,filter:y.filter,layout:y.layout,paint:g},y),x=this.layers.indexOf(y);this.layers[x]=T,this._style.layers[x].paint=g,this._layerByName[y.id]=T,this._uidToLayer.set(y.uid,T)}setLayoutProperties(c,g){const y=this._layerByName[c];if(!y)return;const T=N._recreateLayer({type:y.typeName,id:y.id,source:y.source,"source-layer":y.sourceLayer,minzoom:y.minzoom,maxzoom:y.maxzoom,filter:y.filter,layout:g,paint:y.paint},y),x=this.layers.indexOf(y);this.layers[x]=T,this._style.layers[x].layout=g,this._layerByName[y.id]=T,this._uidToLayer.set(y.uid,T)}setStyleLayerVisibility(c,g){const y=this._layerByName[c];if(!y)return;const b=y.layout||{};b.visibility=g;const x=N._recreateLayer({type:y.typeName,id:y.id,source:y.source,"source-layer":y.sourceLayer,minzoom:y.minzoom,maxzoom:y.maxzoom,filter:y.filter,layout:b,paint:y.paint},y),U=this.layers.indexOf(y);this.layers[U]=x,this._style.layers[U].layout=b,this._layerByName[y.id]=x,this._uidToLayer.set(y.uid,x)}getStyleLayerVisibility(c){const g=this._layerByName[c];return g?g.layout?.visibility??"visible":"none"}_recomputeZValues(){const c=this.layers,g=1/(c.length+1);for(let y=0;y<c.length;y++)c[y].z=1-(1+y)*g}_identifyRefLayers(){const c=[],g=[];let y=0;for(const b of this.layers){const T=b.layout;if(b.type===B.fR.FILL){const x=b;let U=b.source+"|"+b.sourceLayer;U+="|"+(T?.visibility??""),U+="|"+b.minzoom,U+="|"+b.maxzoom,U+="|"+JSON.stringify(b.filter),(x.hasDataDrivenFill||x.hasDataDrivenOutline)&&(U+="|"+y),c.push({key:U,layer:b})}else if(b.type===B.fR.LINE){const x=b,U=b.paint,F=null!=U&&(null!=U["line-pattern"]||null!=U["line-dasharray"]);let M=b.source+"|"+b.sourceLayer;M+="|"+(T?.visibility??""),M+="|"+b.minzoom,M+="|"+b.maxzoom,M+="|"+JSON.stringify(b.filter),M+="|"+(void 0!==T?T["line-cap"]:""),M+="|"+(void 0!==T?T["line-join"]:""),(x.hasDataDrivenLine||F)&&(M+="|"+y),g.push({key:M,layer:b})}++y}this._assignRefLayers(c),this._assignRefLayers(g)}_assignRefLayers(c){let g,y;c.sort((T,x)=>T.key<x.key?-1:T.key>x.key?1:0);const b=c.length;for(let T=0;T<b;T++){const x=c[T];if(x.key===g)x.layer.refLayerId=y;else if(g=x.key,y=x.layer.id,x.layer.type===B.fR.FILL){if(!x.layer.getPaintProperty("fill-outline-color"))for(let U=T+1;U<b;U++){const F=c[U];if(F.key!==g)break;if(F.layer.getPaintProperty("fill-outline-color")){c[T]=F,c[U]=x,y=F.layer.id;break}}}else if(x.layer.type===B.fR.LINE){let U=x.layer;for(let F=T+1;F<b;F++){const M=c[F];if(M.key!==g)break;const Y=M.layer;(U.canUseThinTessellation&&!Y.canUseThinTessellation||!U.canUseThinTessellation&&(Y.getPaintProperty("line-pattern")||Y.getPaintProperty("line-dasharray")))&&(U=Y,c[T]=M,c[F]=x,y=M.layer.id)}}}}_create(c,g,y){const b=1-(1+g)*(1/(y.length+1)),T=this._runningId++;switch(c.type){case"background":return new z.Et(B.fR.BACKGROUND,c,b,T);case"fill":return new z.Le(B.fR.FILL,c,b,T);case"line":return new z.gf(B.fR.LINE,c,b,T);case"symbol":return new z.jG(B.fR.SYMBOL,c,b,T);case"raster":return console.warn(`Unsupported vector tile raster layer ${c.id}`),null;case"circle":return new z.sj(B.fR.CIRCLE,c,b,T)}return null}static _recreateLayer(c,g){switch(c.type){case"background":return new z.Et(B.fR.BACKGROUND,c,g.z,g.uid);case"fill":return new z.Le(B.fR.FILL,c,g.z,g.uid);case"line":return new z.gf(B.fR.LINE,c,g.z,g.uid);case"symbol":return new z.jG(B.fR.SYMBOL,c,g.z,g.uid);case"raster":return console.warn(`Unsupported vector tile raster layer ${c.id}`),null;case"circle":return new z.sj(B.fR.CIRCLE,c,g.z,g.uid)}return null}}}}]);