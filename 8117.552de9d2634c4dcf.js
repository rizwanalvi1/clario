"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[8117,318,5398],{52540:(ne,H,s)=>{s.d(H,{z:()=>M});var A=s(39921);class M{constructor(b,J){this._storage=new A.WJ,this.id="",this.name="",this.size=0,this._storage.maxSize=b,this._storage.register(this),J&&this._storage.registerRemoveFunc("",J)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(b,J,U=1){this._storage.put(this,b,J,U,1)}pop(b){return this._storage.pop(this,b)}get(b){return this._storage.get(this,b)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(b){this._storage.maxSize=b}resetHitRate(){}}},39921:(ne,H,s)=>{s.d(H,{WJ:()=>U,Xq:()=>J});var b,G,A=s(43029);(G=b||(b={}))[G.ALL=0]="ALL",G[G.SOME=1]="SOME";class J{constructor(_,d,p){this.name=_,this._storage=d,this.id=K+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),p&&(this._storage.registerRemoveFunc(this.id,p),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(_){return this._storage.getSize(this,_)}resetHitRate(){this._hit=this._miss=0}put(_,d,p,O=0){this._storage.put(this,_,d,p,O)}pop(_){const d=this._storage.pop(this,_);return void 0===d?++this._miss:++this._hit,d}get(_){const d=this._storage.get(this,_);return void 0===d?++this._miss:++this._hit,d}peek(_){return this._storage.peek(this,_)}updateSize(_,d,p){this._storage.updateSize(this,_,d,p)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class U{get size(){return this._size}constructor(_=10485760){this._maxSize=_,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new A.Z,this._users=new A.Z}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(_){this._users.push(_)}deregister(_){this._users.removeUnordered(_)}registerRemoveFunc(_,d){this._removeFuncs.push([_,d])}deregisterRemoveFunc(_){this._removeFuncs.filterInPlace(d=>d[0]!==_)}get maxSize(){return this._maxSize}set maxSize(_){this._maxSize=Math.max(_,-1),this._checkSize()}getSize(_,d){return this._db.get(_.id+d)?.size??0}put(_,d,p,O,B){const L=this._db.get(d=_.id+d);if(L&&(this._size-=L.size,_.size-=L.size,this._db.delete(d),L.entry!==p&&this._notifyRemove(d,L.entry,L.size,b.ALL)),O>this._maxSize)return void this._notifyRemove(d,p,O,b.ALL);if(void 0===p)return void console.warn("Refusing to cache undefined entry ");if(!O||O<0)return console.warn(`Refusing to cache entry with size ${O} for key ${d}`),void this._notifyRemove(d,p,0,b.ALL);const D=1+Math.max(B,-4)- -3;this._db.set(d,new $(p,O,D)),this._size+=O,_.size+=O,this._checkSize()}updateSize(_,d,p,O){const B=this._db.get(d=_.id+d);if(B&&B.entry===p){for(this._size-=B.size,_.size-=B.size;O>this._maxSize;){const L=this._notifyRemove(d,p,O,b.SOME);if(!(null!=L&&L>0))return void this._db.delete(d);O=L}B.size=O,this._size+=O,_.size+=O,this._checkSize()}}pop(_,d){const p=this._db.get(d=_.id+d);if(p)return this._size-=p.size,_.size-=p.size,this._db.delete(d),++this._hit,p.entry;++this._miss}get(_,d){const p=this._db.get(d=_.id+d);if(void 0!==p)return this._db.delete(d),p.lives=p.lifetime,this._db.set(d,p),++this._hit,p.entry;++this._miss}peek(_,d){const p=this._db.get(_.id+d);return p?++this._hit:++this._miss,p?.entry}get performanceInfo(){const _={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},d={},p=new Array;this._db.forEach((L,D)=>{const h=L.lifetime;p[h]=(p[h]||0)+L.size,this._users.forAll(l=>{const{id:f,name:y}=l;D.startsWith(f)&&(d[y]=(d[y]||0)+L.size)})});const O={};this._users.forAll(L=>{const D=L.name;"hitRate"in L&&"number"==typeof L.hitRate&&!isNaN(L.hitRate)&&L.hitRate>0?(d[D]=d[D]||0,O[D]=Math.round(100*L.hitRate)+"%"):O[D]="0%"});const B=Object.keys(d);B.sort((L,D)=>d[D]-d[L]),B.forEach(L=>_[L]=Math.round(d[L]/2**20)+"MB / "+O[L]);for(let L=p.length-1;L>=0;--L){const D=p[L];D&&(_["Priority "+(L+-3-1)]=Math.round(D/this._size*100)+"%")}return _}resetStats(){this._hit=this._miss=0,this._users.forAll(_=>_.resetHitRate())}clear(_){const d=_.id;this._db.forEach((p,O)=>{O.startsWith(d)&&(this._size-=p.size,this._db.delete(O),this._notifyRemove(O,p.entry,p.size,b.ALL))}),_.size=0}clearAll(){this._db.forEach((_,d)=>this._notifyRemove(d,_.entry,_.size,b.ALL)),this._users.forAll(_=>_.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(_,d,p,O){let B;return this._removeFuncs.some(L=>{if(_.startsWith(L[0])){const D=L[1](d,O,p);return"number"==typeof D&&(B=D),!0}return!1}),B}_checkSize(){this._users.forAll(_=>this._checkSizeLimits(_)),this._checkSizeLimits()}_checkSizeLimits(_){const d=_??this;if(d.maxSize<0||d.size<=d.maxSize)return;const p=_?.id;let O=!0;for(;O;){O=!1;for(const[B,L]of this._db)if(0===L.lifetime&&(!p||B.startsWith(p))){if(this._purgeItem(B,L,_),d.size<=.9*d.maxSize)return;O||=this._db.has(B)}}for(const[B,L]of this._db)if((!p||B.startsWith(p))&&(this._purgeItem(B,L,_),d.size<=.9*d.maxSize))return}_purgeItem(_,d,p=this._users.find(O=>_.startsWith(O.id))){if(this._db.delete(_),d.lives<=1){this._size-=d.size,p&&(p.size-=d.size);const O=this._notifyRemove(_,d.entry,d.size,b.SOME);null!=O&&O>0&&(this._size+=O,p&&(p.size+=O),d.lives=d.lifetime,d.size=O,this._db.set(_,d))}else--d.lives,this._db.set(_,d)}}let K=0;class ${constructor(_,d,p){this.entry=_,this.size=d,this.lifetime=p,this.lives=p}}},657:(ne,H,s)=>{s.d(H,{$c:()=>B,Hg:()=>L,jW:()=>d,uD:()=>p});var A=s(73514),M=s(83944),Y=s(49301);const b=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function J(h){return h instanceof A.Z}function U(h){return h instanceof M.Z?Object.keys(h.items):J(h)?(0,Y.vw)(h).keys():h?Object.keys(h):[]}function K(h,l){return h instanceof M.Z?h.items[l]:h[l]}function G(h){return h?h.declaredClass:null}function _(h,l){const f=h.diff;if(f&&"function"==typeof f)return f(h,l);const y=U(h),T=U(l);if(0===y.length&&0===T.length)return;if(!y.length||!T.length||function $(h,l){return!(!Array.isArray(h)||!Array.isArray(l))&&h.length!==l.length}(h,l))return{type:"complete",oldValue:h,newValue:l};const I=T.filter(R=>!y.includes(R)),g=y.filter(R=>!T.includes(R)),P=y.filter(R=>T.includes(R)&&K(h,R)!==K(l,R)).concat(I,g).sort(),S=G(h);if(S&&b.has(S)&&P.length)return{type:"complete",oldValue:h,newValue:l};let W;const Z=J(h)&&J(l);for(const R of P){const c=K(h,R),E=K(l,R);let x;if((Z||"function"!=typeof c&&"function"!=typeof E)&&c!==E&&(null!=c||null!=E)){if(f&&f[R]&&"function"==typeof f[R])x=f[R]?.(c,E);else if(c instanceof Date&&E instanceof Date){if(c.getTime()===E.getTime())continue;x={type:"complete",oldValue:c,newValue:E}}else x="object"==typeof c&&"object"==typeof E&&G(c)===G(E)?_(c,E):{type:"complete",oldValue:c,newValue:E};null!=x&&(null!=W?W.diff[R]=x:W={type:"partial",diff:{[R]:x}})}}return W}function d(h,l){return p(h,l)}function p(h,l){if(null==h)return!1;const f=l.split(".");let y=h;for(const T of f){if("complete"===y.type)return!0;if("partial"!==y.type)return!1;{const I=y.diff[T];if(!I)return!1;y=I}}return!0}function B(h,l){if(!h)return!1;if("partial"===h.type){const f=Object.keys(h.diff);return 1===f.length&&f[0]===l}return!1}function L(h,l){if("function"!=typeof h&&"function"!=typeof l&&(null!=h||null!=l))return null==h||null==l||"object"==typeof h&&"object"==typeof l&&G(h)!==G(l)?{type:"complete",oldValue:h,newValue:l}:_(h,l)}},15398:(ne,H,s)=>{s.d(H,{A4:()=>Y,L9:()=>b,yV:()=>M});var A=s(25037);class M{}function Y(U){return U instanceof A.ld?U===M.instance:"unknown"===U?.toString().toLowerCase()}function b(U){return Y(U)?M.instance:U}M.instance=new A.vF("Etc/UTC")},66398:(ne,H,s)=>{function M(u){return u?{originPosition:"upper-left"===u.originPosition?"upperLeft":"lower-left"===u.originPosition?"lowerLeft":u.originPosition,scale:u.tolerance?[u.tolerance,u.tolerance,1,1]:[1,1,1,1],translate:null!=u.extent?[u.extent.xmin,u.extent.ymax,u.extent.zmin??0,u.extent.mmin??0]:[0,0,0,0]}:null}function b(u){if(function Y(u){return"lowerLeft"===u.originPosition&&4===u.scale.length&&4===u.translate.length}(u))return u;const{originPosition:i,scale:a,translate:v}=u,z=a[1]??1;return{originPosition:"lowerLeft",scale:[a[0]??1,"lowerLeft"===i?z:-z,a[2]??1,a[3]??1],translate:[v[0]??0,v[1]??0,v[2]??0,v[3]??0]}}function h({scale:u,translate:i},a){return a*u[0]+i[0]}function l({scale:u,translate:i},a){return a*u[1]+i[1]}function f({scale:u,translate:i},a){return(a??0)*u[2]+i[2]}function y({scale:u,translate:i},a){return a?a*u[3]+i[3]:0}function T(u,i){return u&&i?S:u&&!i?g:!u&&i?P:I}s.d(H,{G6:()=>ae,Ie:()=>me,J9:()=>fe,RF:()=>le,U1:()=>_e,vY:()=>M}),s(40637);const I=(u,i)=>{const a=new Array(i.length);if(!i.length)return a;const v=i[0];let F=h(u,v[0]),z=l(u,v[1]);a[0]=[F,z];const{scale:w,originPosition:X}=u,ee=w[0],q="lowerLeft"===X?w[1]:-w[1];for(let Q=1;Q<i.length;Q++){const[N,re]=i[Q];F+=ee*N,z+=q*re,a[Q]=[F,z]}return a},g=(u,i)=>{const a=new Array(i.length);if(!i.length)return a;const v=i[0];let F=h(u,v[0]),z=l(u,v[1]);a[0]=[F,z,f(u,v[2])];const{scale:w,originPosition:X}=u,ee=w[0],q="lowerLeft"===X?w[1]:-w[1];for(let Q=1;Q<i.length;Q++){const[N,re,m]=i[Q];F+=ee*N,z+=q*re,a[Q]=[F,z,f(u,m)]}return a},P=(u,i)=>{const a=new Array(i.length);if(!i.length)return a;const v=i[0];let F=h(u,v[0]),z=l(u,v[1]);a[0]=[F,z,y(u,v[2])];const{scale:w,originPosition:X}=u,ee=w[0],q="lowerLeft"===X?w[1]:-w[1];for(let Q=1;Q<i.length;Q++){const[N,re,m]=i[Q];F+=ee*N,z+=q*re,a[Q]=[F,z,y(u,m)]}return a},S=(u,i)=>{const a=new Array(i.length);if(!i.length)return a;const v=i[0];let F=h(u,v[0]),z=l(u,v[1]);a[0]=[F,z,f(u,v[2]),y(u,v[3])];const{scale:w,originPosition:X}=u,ee=w[0],q="lowerLeft"===X?w[1]:-w[1];for(let Q=1;Q<i.length;Q++){const[N,re,m,C]=i[Q];F+=ee*N,z+=q*re,a[Q]=[F,z,f(u,m),y(u,C)]}return a};function W(u,i,a){const v=new Array(a.length);for(let F=0;F<a.length;F++)v[F]=i(u,a[F]);return v}function le(u,i,a){const v=b(u);return i.x=function J({scale:u,translate:i},a){return Math.round((a-i[0])/u[0])}(v,a.x),i.y=function U({scale:u,translate:i},a){return Math.round((a-i[1])/u[1])}(v,a.y),null!=a.z&&(i.z=function K({scale:u,translate:i},a){return Math.round(((a??0)-i[2])/u[2])}(v,a.z)),null!=a.m&&(i.m=function $({scale:u,translate:i},a){return a?Math.round((a-i[3])/u[3]):0}(v,a.m)),i}function fe(u,i,a,v=a?.hasZ??!1,F=a?.hasM??!1){if(null!=a){const z=b(u);i.points=T(v,F)(z,a.points),i.hasZ=v,i.hasM=F}return i}function _e(u,i,a,v=null!=a?.z,F=null!=a?.m){if(null==a)return i;const z=b(u);return i.x=h(z,a.x),i.y=l(z,a.y),v&&(i.z=f(z,a.z)),F&&(i.m=y(z,a.m)),i}function me(u,i,a,v=a?.hasZ??!1,F=a?.hasM??!1){if(null!=a){const z=b(u);i.rings=W(z,T(v,F),a.rings),i.hasZ=v,i.hasM=F}return i}function ae(u,i,a,v=a?.hasZ??!1,F=a?.hasM??!1){if(null!=a){const z=b(u);i.paths=W(z,T(v,F),a.paths),i.hasZ=v,i.hasM=F}return i}},80059:(ne,H,s)=>{s.r(H),s.d(H,{default:()=>re});var A=s(15861),M=s(50484),b=(s(2189),s(62691)),B=(s(36699),s(12610),s(53722),s(82752),s(28999),s(38748),s(50923),s(42212),s(91963),s(41007)),L=s(3233),D=s(79412),h=s(6785),l=s(80543),f=s(14007),y=s(4703),I=(s(65311),s(10141)),g=s(31709),P=s(95060),S=s(57964),W=s(67016),Z=s(36885),R=s(60324),c=s(93792),E=s(26894),x=s(5391);let j=class extends W.Z{constructor(){var m;super(...arguments),m=this,this.type="geojson",this.refresh=(0,D.Ds)(function(){var C=(0,A.Z)(function*(V){yield m.load();const{extent:se,timeExtent:ue}=yield m._connection.invoke("refresh",V);return m.sourceJSON.extent=se,ue&&(m.sourceJSON.timeInfo.timeExtent=[ue.start,ue.end]),{dataChanged:!0,updates:{extent:m.sourceJSON.extent,timeInfo:m.sourceJSON.timeInfo}}});return function(V){return C.apply(this,arguments)}}())}load(m){return this.addResolvingPromise(this._startWorker(null!=m?m.signal:null)),Promise.resolve(this)}destroy(){this._connection?.close(),this._connection=null}applyEdits(m){return this.load().then(()=>this._applyEdits(m))}openPorts(){return this.load().then(()=>this._connection.openPorts())}queryFeatures(m,C={}){return this.load(C).then(()=>this._connection.invoke("queryFeatures",m?m.toJSON():null,C)).then(V=>c.Z.fromJSON(V))}queryFeaturesJSON(m,C={}){return this.load(C).then(()=>this._connection.invoke("queryFeatures",m?m.toJSON():null,C))}queryFeatureCount(m,C={}){return this.load(C).then(()=>this._connection.invoke("queryFeatureCount",m?m.toJSON():null,C))}queryObjectIds(m,C={}){return this.load(C).then(()=>this._connection.invoke("queryObjectIds",m?m.toJSON():null,C))}queryExtent(m,C={}){return this.load(C).then(()=>this._connection.invoke("queryExtent",m?m.toJSON():null,C)).then(V=>({count:V.count,extent:E.Z.fromJSON(V.extent)}))}querySnapping(m,C={}){return this.load(C).then(()=>this._connection.invoke("querySnapping",m,C))}_applyEdits(m){if(!this._connection)throw new S.Z("geojson-layer-source:edit-failure","Memory source not loaded");const C=this.layer.objectIdField,V=[],se=[],ue=[];if(m.addFeatures)for(const oe of m.addFeatures)V.push(this._serializeFeature(oe));if(m.deleteFeatures)for(const oe of m.deleteFeatures)"objectId"in oe&&null!=oe.objectId?se.push(oe.objectId):"attributes"in oe&&null!=oe.attributes[C]&&se.push(oe.attributes[C]);if(m.updateFeatures)for(const oe of m.updateFeatures)ue.push(this._serializeFeature(oe));return this._connection.invoke("applyEdits",{adds:V,updates:ue,deletes:se}).then(({extent:oe,timeExtent:de,featureEditResults:ye})=>(this.sourceJSON.extent=oe,de&&(this.sourceJSON.timeInfo.timeExtent=[de.start,de.end]),this._createEditsResult(ye)))}_createEditsResult(m){return{addFeatureResults:m.addResults?m.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:m.updateResults?m.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:m.deleteResults?m.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(m){const C=!0===m.success?null:m.error||{code:void 0,description:void 0};return{objectId:m.objectId,globalId:m.globalId,error:C?new S.Z("geojson-layer-source:edit-failure",C.description,{code:C.code}):null}}_serializeFeature(m){const{attributes:C}=m,V=this._geometryForSerialization(m);return V?{geometry:V.toJSON(),attributes:C}:{attributes:C}}_geometryForSerialization(m){const{geometry:C}=m;return null==C?null:"mesh"===C.type||"extent"===C.type?x.Z.fromExtent(C.extent):C}_startWorker(m){var C=this;return(0,A.Z)(function*(){C._connection=yield(0,Z.bA)("GeoJSONSourceWorker",{strategy:(0,f.Z)("feature-layers-workers")?"dedicated":"local",signal:m,registryTarget:C});const{fields:V,spatialReference:se,hasZ:ue,geometryType:oe,objectIdField:de,url:ye,timeInfo:ve,customParameters:Pe}=C.layer,Me="defaults"===C.layer.originOf("spatialReference"),Oe={url:ye,customParameters:Pe,fields:V&&V.map(pe=>pe.toJSON()),geometryType:g.M.toJSON(oe),hasZ:ue,objectIdField:de,timeInfo:ve?ve.toJSON():null,spatialReference:Me?null:se&&se.toJSON()},he=yield C._connection.invoke("load",Oe,{signal:m});for(const pe of he.warnings)y.Z.getLogger(C.layer).warn("#load()",`$${pe.message} (title: '${C.layer.title||"no title"}', id: '${C.layer.id??"no id"}')`,{warning:pe});he.featureErrors.length&&y.Z.getLogger(C.layer).warn("#load()",`Encountered ${he.featureErrors.length} validation errors while loading features. (title: '${C.layer.title||"no title"}', id: '${C.layer.id??"no id"}')`,{errors:he.featureErrors}),C.sourceJSON=he.layerDefinition,C.capabilities=(0,R.MS)(C.sourceJSON.hasZ,!0)})()}};(0,M._)([(0,l.Cb)()],j.prototype,"capabilities",void 0),(0,M._)([(0,l.Cb)()],j.prototype,"type",void 0),(0,M._)([(0,l.Cb)({constructOnly:!0})],j.prototype,"layer",void 0),(0,M._)([(0,l.Cb)()],j.prototype,"sourceJSON",void 0),j=(0,M._)([(0,I.j)("esri.layers.graphics.sources.GeoJSONSource")],j);var te=s(19855),k=s(27426),le=s(12621),ce=s(78601),ie=s(80099),ge=s(32250),Ee=s(70509),fe=s(25836),_e=s(29717),me=s(12522),ae=s(56956),u=s(30457),i=s(81247),a=s(27969),v=s(85295),F=s(40591),z=s(75421),w=s(91866),X=s(33331),ee=s(764),q=s(43814);const Q=(0,a.v)();let N=class extends((0,ge.c)((0,k.N)((0,ce.M)((0,le.b)((0,te.h7)((0,me.n)((0,_e.M)((0,fe.Q)((0,ie.q)((0,Ee.I)((0,L.R)(P.Z)))))))))))){constructor(m){super(m),this.copyright=null,this.dateFieldsTimeZone=null,this.definitionExpression=null,this.displayField=null,this.editingEnabled=!1,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="GeoJSON",this.outFields=null,this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new j({layer:this}),this.spatialReference=q.Z.WGS84,this.templates=null,this.title="GeoJSON",this.type="geojson"}destroy(){this.source?.destroy()}load(m){const C=this.loadFromPortal({supportedTypes:["GeoJson"],supportsData:!1},m).catch(D.r9).then(()=>this.source.load(m)).then(()=>{this.read(this.source.sourceJSON,{origin:"service",url:this.parsedUrl}),this.revert(["objectIdField","fields","timeInfo"],"service"),(0,v.YN)(this.renderer,this.fieldsIndex),(0,v.UF)(this.timeInfo,this.fieldsIndex)});return this.addResolvingPromise(C),Promise.resolve(this)}get capabilities(){return this.source?this.source.capabilities:null}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("capabilities"),(this._get("createQueryVersion")||0)+1}get defaultPopupTemplate(){return this.createPopupTemplate()}get isTable(){return this.loaded&&null==this.geometryType}get parsedUrl(){return this.url?(0,h.mN)(this.url):null}set renderer(m){(0,v.YN)(m,this.fieldsIndex),this._set("renderer",m)}set url(m){if(!m)return void this._set("url",m);const C=(0,h.mN)(m);this._set("url",C.path),C.query&&(this.customParameters={...this.customParameters,...C.query})}applyEdits(m,C){var V=this;return(0,A.Z)(function*(){const{applyEdits:se}=yield s.e(2334).then(s.bind(s,52334));yield V.load();const ue=yield se(V,V.source,m,C);return V.read({extent:V.source.sourceJSON.extent,timeInfo:V.source.sourceJSON.timeInfo},{origin:"service",ignoreDefaults:!0}),ue})()}on(m,C){return super.on(m,C)}createPopupTemplate(m){return(0,X.eZ)(this,m)}createQuery(){const m=new w.Z,C=this.capabilities?.data;m.returnGeometry=!0,C&&C.supportsZ&&(m.returnZ=!0),m.outFields=["*"],m.where=this.definitionExpression||"1=1";const{timeOffset:V,timeExtent:se}=this;return m.timeExtent=null!=V&&null!=se?se.offset(-V.value,V.unit):se||null,m}getFieldDomain(m,C){return this.getField(m)?.domain}getField(m){return this.fieldsIndex.get(m)}queryFeatures(m,C){return this.load().then(()=>this.source.queryFeatures(w.Z.from(m)||this.createQuery(),C)).then(V=>{if(V?.features)for(const se of V.features)se.layer=se.sourceLayer=this;return V})}queryObjectIds(m,C){return this.load().then(()=>this.source.queryObjectIds(w.Z.from(m)||this.createQuery(),C))}queryFeatureCount(m,C){return this.load().then(()=>this.source.queryFeatureCount(w.Z.from(m)||this.createQuery(),C))}queryExtent(m,C){return this.load().then(()=>this.source.queryExtent(w.Z.from(m)||this.createQuery(),C))}hasDataChanged(){var m=this;return(0,A.Z)(function*(){try{const{dataChanged:C,updates:V}=yield m.source.refresh(m.customParameters);return null!=V&&m.read(V,{origin:"service",url:m.parsedUrl,ignoreDefaults:!0}),C}catch{}return!1})()}};(0,M._)([(0,l.Cb)({readOnly:!0,json:{read:!1,write:!1}})],N.prototype,"capabilities",null),(0,M._)([(0,l.Cb)({type:String})],N.prototype,"copyright",void 0),(0,M._)([(0,l.Cb)({readOnly:!0})],N.prototype,"createQueryVersion",null),(0,M._)([(0,l.Cb)((0,ee.mi)("dateFieldsTimeReference"))],N.prototype,"dateFieldsTimeZone",void 0),(0,M._)([(0,l.Cb)({readOnly:!0})],N.prototype,"defaultPopupTemplate",null),(0,M._)([(0,l.Cb)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],N.prototype,"definitionExpression",void 0),(0,M._)([(0,l.Cb)({type:String})],N.prototype,"displayField",void 0),(0,M._)([(0,l.Cb)({type:Boolean})],N.prototype,"editingEnabled",void 0),(0,M._)([(0,l.Cb)(ae.PV)],N.prototype,"elevationInfo",void 0),(0,M._)([(0,l.Cb)({type:[i.Z],json:{name:"layerDefinition.fields",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"fields"}}}})],N.prototype,"fields",void 0),(0,M._)([(0,l.Cb)(Q.fieldsIndex)],N.prototype,"fieldsIndex",void 0),(0,M._)([(0,l.Cb)({type:E.Z,json:{name:"extent"}})],N.prototype,"fullExtent",void 0),(0,M._)([(0,l.Cb)({type:["point","polygon","polyline","multipoint"],json:{read:{reader:g.M.read}}})],N.prototype,"geometryType",void 0),(0,M._)([(0,l.Cb)({type:Boolean})],N.prototype,"hasZ",void 0),(0,M._)([(0,l.Cb)(ae.id)],N.prototype,"id",void 0),(0,M._)([(0,l.Cb)({type:Boolean,readOnly:!0})],N.prototype,"isTable",null),(0,M._)([(0,l.Cb)(ae.iR)],N.prototype,"labelsVisible",void 0),(0,M._)([(0,l.Cb)({type:[F.Z],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:z.r},write:!0}})],N.prototype,"labelingInfo",void 0),(0,M._)([(0,l.Cb)(ae.rn)],N.prototype,"legendEnabled",void 0),(0,M._)([(0,l.Cb)({type:["show","hide"]})],N.prototype,"listMode",void 0),(0,M._)([(0,l.Cb)({type:String,json:{name:"layerDefinition.objectIdField",write:{ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"objectIdField"}}}})],N.prototype,"objectIdField",void 0),(0,M._)([(0,l.Cb)(ae.Oh)],N.prototype,"opacity",void 0),(0,M._)([(0,l.Cb)({type:["GeoJSON"]})],N.prototype,"operationalLayerType",void 0),(0,M._)([(0,l.Cb)(Q.outFields)],N.prototype,"outFields",void 0),(0,M._)([(0,l.Cb)({readOnly:!0})],N.prototype,"parsedUrl",null),(0,M._)([(0,l.Cb)(ae.C_)],N.prototype,"popupEnabled",void 0),(0,M._)([(0,l.Cb)({type:b.Z,json:{name:"popupInfo",write:!0}})],N.prototype,"popupTemplate",void 0),(0,M._)([(0,l.Cb)({types:B.A,json:{name:"layerDefinition.drawingInfo.renderer",write:!0,origins:{service:{name:"drawingInfo.renderer"},"web-scene":{types:B.o}}}})],N.prototype,"renderer",null),(0,M._)([(0,l.Cb)(ae.YI)],N.prototype,"screenSizePerspectiveEnabled",void 0),(0,M._)([(0,l.Cb)({readOnly:!0})],N.prototype,"source",void 0),(0,M._)([(0,l.Cb)({type:q.Z})],N.prototype,"spatialReference",void 0),(0,M._)([(0,l.Cb)({type:[u.Z]})],N.prototype,"templates",void 0),(0,M._)([(0,l.Cb)()],N.prototype,"title",void 0),(0,M._)([(0,l.Cb)({json:{read:!1},readOnly:!0})],N.prototype,"type",void 0),(0,M._)([(0,l.Cb)(ae.HQ)],N.prototype,"url",null),N=(0,M._)([(0,I.j)("esri.layers.GeoJSONLayer")],N);const re=N},85559:(ne,H,s)=>{s.d(H,{g:()=>A});const A={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},60324:(ne,H,s)=>{s.d(H,{Dm:()=>$,Hq:()=>_,MS:()=>d,bU:()=>J});var A=s(14007),M=s(34222),Y=s(85559),b=s(19579);function J(p){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===p||"esriGeometryMultipoint"===p?b.I4:"esriGeometryPolyline"===p?b.ET:b.lF}}}const U=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let K=1;function $(p,O){if((0,A.Z)("esri-csp-restrictions"))return()=>({[O]:null,...p});try{let B=`this${G(O)} = null;`;for(const D in p)B+=`this${G(D)} = ${JSON.stringify(p[D])};`;const L=new Function(`\n      return class AttributesClass$${K++} {\n        constructor() {\n          ${B};\n        }\n      }\n    `)();return()=>new L}catch{return()=>({[O]:null,...p})}}function G(p){return U.test(p)?`.${p}`:`["${p}"]`}function _(p={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,M.d9)(p)}}]}function d(p,O){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:p},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:O,supportsDelete:O,supportsEditing:O,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:O,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:Y.g,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:O,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},27426:(ne,H,s)=>{s.d(H,{N:()=>K});var A=s(50484),M=s(80543),U=(s(14007),s(4703),s(65311),s(10141));const K=$=>{let G=class extends ${constructor(){super(...arguments),this.customParameters=null}};return(0,A._)([(0,M.Cb)({type:Object,json:{write:{overridePolicy:_=>({enabled:!!(_&&Object.keys(_).length>0)})}}})],G.prototype,"customParameters",void 0),G=(0,A._)([(0,U.j)("esri.layers.mixins.CustomParametersMixin")],G),G}},32250:(ne,H,s)=>{s.d(H,{c:()=>p,l:()=>d});var A=s(50484),M=s(71763),Y=s(80543),K=(s(14007),s(4703),s(65311),s(10141)),$=s(35469);const d={type:[$.Z],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:function G(O,B,L){if(!O)return null;const D=O.find(l=>!!l.field);if(!D)return null;const h=new $.Z;return h.read(D,L),[h]}},write:{writer:function _(O,B,L,D){const h=O.find(l=>!!l.field);h&&(0,M.RB)(L,[h.toJSON()],B)}}}},p=O=>{let B=class extends O{constructor(){super(...arguments),this.orderBy=null}};return(0,A._)([(0,Y.Cb)(d)],B.prototype,"orderBy",void 0),B=(0,A._)([(0,K.j)("esri.layers.mixins.OrderedLayer")],B),B}},70509:(ne,H,s)=>{s.d(H,{I:()=>g});var A=s(15861),M=s(50484),Y=s(11931),b=s(26152),J=s(66476),U=s(37636),K=s(57964),$=s(4703),G=s(51172),_=s(79412),d=s(6785),p=s(80543),L=(s(14007),s(65311),s(62185)),D=s(10141),h=s(7547),l=s(85971),f=s(61018),y=s(27835),T=s(57437),I=s(50318);const g=S=>{let W=class extends S{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,G.SC)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(Z){Z!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",Z))}readPortalItem(Z,R,c){if(R.itemId)return new y.default({id:R.itemId,portal:c?.portal})}writePortalItem(Z,R){Z?.id&&(R.itemId=Z.id)}loadFromPortal(Z,R){var c=this;return(0,A.Z)(function*(){if(c.portalItem?.id)try{const{load:E}=yield Promise.all([s.e(2772),s.e(8592),s.e(6964)]).then(s.bind(s,36964));return(0,_.k_)(R),yield E({instance:c,supportedTypes:Z.supportedTypes,validateItem:Z.validateItem,supportsData:Z.supportsData,layerModuleTypeMap:Z.layerModuleTypeMap},R)}catch(E){throw(0,_.D_)(E)||$.Z.getLogger(c).warn(`Failed to load layer (${c.title}, ${c.id}) portal item (${c.portalItem.id})\n  ${E}`),E}})()}finishLoadEditablePortalLayer(Z){var R=this;return(0,A.Z)(function*(){R._set("userHasEditingPrivileges",yield R._fetchUserHasEditingPrivileges(Z).catch(c=>((0,_.r9)(c),!0)))})()}setUserPrivileges(Z,R){var c=this;return(0,A.Z)(function*(){if(!Y.default.userPrivilegesApplied)return c.finishLoadEditablePortalLayer(R);if(c.url)try{const{features:{edit:E,fullEdit:x},content:{updateItem:j}}=yield c._fetchUserPrivileges(Z,R);c._set("userHasEditingPrivileges",E),c._set("userHasFullEditingPrivileges",x),c._set("userHasUpdateItemPrivileges",j)}catch(E){(0,_.r9)(E)}})()}_fetchUserPrivileges(Z,R){var c=this;return(0,A.Z)(function*(){let E=c.portalItem;if(!Z||!E||!E.loaded||E.sourceUrl)return c._fetchFallbackUserPrivileges(R);const x=Z===E.id;if(x&&E.portal.user)return(0,I.Ss)(E);let j,te;if(x)j=E.portal.url;else try{j=yield(0,l.oP)(c.url,R)}catch(ie){(0,_.r9)(ie)}if(!j||!(0,d.Zo)(j,E.portal.url))return c._fetchFallbackUserPrivileges(R);try{const ie=null!=R?R.signal:null;te=yield b.id?.getCredential(`${j}/sharing`,{prompt:!1,signal:ie})}catch(ie){(0,_.r9)(ie)}if(!te)return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}};try{if(x?yield E.reload():(E=new y.default({id:Z,portal:{url:j}}),yield E.load(R)),E.portal.user)return(0,I.Ss)(E)}catch(ie){(0,_.r9)(ie)}return{features:{edit:!0,fullEdit:!1},content:{updateItem:!1}}})()}_fetchFallbackUserPrivileges(Z){var R=this;return(0,A.Z)(function*(){let c=!0;try{c=yield R._fetchUserHasEditingPrivileges(Z)}catch(E){(0,_.r9)(E)}return{features:{edit:c,fullEdit:!1},content:{updateItem:!1}}})()}_fetchUserHasEditingPrivileges(Z){var R=this;return(0,A.Z)(function*(){const c=R.url?b.id?.findCredential(R.url):null;if(!c)return!0;const E=P.credential===c?P.user:yield R._fetchEditingUser(Z);return P.credential=c,P.user=E,null==E?.privileges||E.privileges.includes("features:user:edit")})()}_fetchEditingUser(Z){var R=this;return(0,A.Z)(function*(){const c=R.portalItem?.portal?.user;if(c)return c;const E=b.id?.findServerInfo(R.url??"");if(!E?.owningSystemUrl)return null;const x=`${E.owningSystemUrl}/sharing/rest`,j=f.Z.getDefault();if(j&&j.loaded&&(0,d.Fv)(j.restUrl)===(0,d.Fv)(x))return j.user;const te=`${x}/community/self`,k=null!=Z?Z.signal:null,le=yield(0,U.q6)((0,J.Z)(te,{authMode:"no-prompt",query:{f:"json"},signal:k}));return le.ok?T.Z.fromJSON(le.value.data):null})()}read(Z,R){R&&(R.layer=this),super.read(Z,R)}write(Z,R){const c=R?.portal,E=this.portalItem?.id&&(this.portalItem.portal||f.Z.getDefault());return c&&E&&!(0,d.tm)(E.restUrl,c.restUrl)?(R.messages&&R.messages.push(new K.Z("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(Z,{...R,layer:this})}};return(0,M._)([(0,p.Cb)({type:y.default})],W.prototype,"portalItem",null),(0,M._)([(0,L.r)("web-document","portalItem",["itemId"])],W.prototype,"readPortalItem",null),(0,M._)([(0,h.c)("web-document","portalItem",{itemId:{type:String}})],W.prototype,"writePortalItem",null),(0,M._)([(0,p.Cb)({clonable:!1})],W.prototype,"resourceReferences",void 0),(0,M._)([(0,p.Cb)({type:Boolean,readOnly:!0})],W.prototype,"userHasEditingPrivileges",void 0),(0,M._)([(0,p.Cb)({type:Boolean,readOnly:!0})],W.prototype,"userHasFullEditingPrivileges",void 0),(0,M._)([(0,p.Cb)({type:Boolean,readOnly:!0})],W.prototype,"userHasUpdateItemPrivileges",void 0),W=(0,M._)([(0,D.j)("esri.layers.mixins.PortalLayer")],W),W},P={credential:null,user:null}},25836:(ne,H,s)=>{s.d(H,{Q:()=>R});var A=s(15861),M=s(50484),b=(s(14007),s(4703)),J=s(79412),U=s(80543),K=s(73018),G=(s(65311),s(10141)),_=s(76215),d=s(83944),L=(s(37636),s(57964),s(12926),s(43571));const D=new d.Z,h=new WeakMap;function T(c,E){return Number.isFinite(c)&&Number.isFinite(E)?E<=0?c:T(E,c%E):0}let I=0,g=0;function P(){const c=Date.now();let E=!1;for(const x of D){const j=x.deref();j?j.refreshInterval&&c-(h.get(j)??0)+5>=6e4*j.refreshInterval&&(h.set(j,c),j.refresh(c)):E=!0}if(E)for(let x=D.length-1;x>=0;x--)D.at(x).deref()||D.removeAt(x)}(0,L.EH)(()=>{const c=Date.now();let E=0;for(const x of D){const j=x.deref();j&&(E=T(Math.round(6e4*j.refreshInterval),E),j.refreshInterval?h.get(j)||h.set(j,c):h.delete(j))}if(E!==g){if(g=E,clearInterval(I),0===g)return void(I=0);I=setInterval(P,g)}});const R=c=>{let E=class extends c{constructor(...x){super(...x),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,J.Ds)(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||function l(c){(function y(c){return null!=c&&"object"==typeof c&&"refreshInterval"in c&&"refresh"in c})(c)&&D.push(new WeakRef(c))}(this)},()=>{})}destroy(){!function f(c){const E=D.find(x=>x.deref()===c);E&&D.remove(E)}(this)}castRefreshInterval(x){return x>=.1?x:x<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(x=Date.now()){(0,J.R8)(this._debounceHasDataChanged()).then(j=>{j&&this._set("refreshTimestamp",x),this.emit("refresh",{dataChanged:j})},j=>{b.Z.getLogger(this).error(j),this.emit("refresh",{dataChanged:!1,error:j})})}hasDataChanged(){return(0,A.Z)(function*(){return!0})()}get test(){}};return(0,M._)([(0,U.Cb)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:_.C}}}}})],E.prototype,"refreshInterval",void 0),(0,M._)([(0,K.p)("refreshInterval")],E.prototype,"castRefreshInterval",null),(0,M._)([(0,U.Cb)({readOnly:!0})],E.prototype,"refreshTimestamp",void 0),(0,M._)([(0,U.Cb)({readOnly:!0})],E.prototype,"refreshParameters",null),E=(0,M._)([(0,G.j)("esri.layers.mixins.RefreshableLayer")],E),E}},30457:(ne,H,s)=>{s.d(H,{Z:()=>p});var A=s(50484),M=s(25387),Y=s(84303),b=s(89317),J=s(80543),G=(s(14007),s(4703),s(65311),s(10141));const _=new Y.X({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let d=class extends((0,M.J)(b.wq)){constructor(O){super(O),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};(0,A._)([(0,J.Cb)({json:{write:!0}})],d.prototype,"name",void 0),(0,A._)([(0,J.Cb)({json:{write:!0}})],d.prototype,"description",void 0),(0,A._)([(0,J.Cb)({json:{read:_.read,write:_.write}})],d.prototype,"drawingTool",void 0),(0,A._)([(0,J.Cb)({json:{write:!0}})],d.prototype,"prototype",void 0),(0,A._)([(0,J.Cb)({json:{write:!0}})],d.prototype,"thumbnail",void 0),d=(0,A._)([(0,G.j)("esri.layers.support.FeatureTemplate")],d);const p=d},40100:(ne,H,s)=>{s.d(H,{Z:()=>O});var A=s(57964),M=s(89317),Y=s(4703),b=s(8611),J=s(15398),U=s(85295),K=s(764),$=s(25037);const p=new Map;class O{static fromJSON(f){return new O(f.fields,f.timeZoneByFieldName)}static fromLayer(f){return new O(f.fields??[],h(f))}static fromLayerJSON(f){return new O(f.fields??[],h(f))}constructor(f=[],y){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=f||[],this._timeZoneByFieldName=y?new Map(y):null;const T=[];for(const I of this.fields){const g=I?.name,P=L(g);if(g&&P){const S=B(g);this._fieldsMap.set(g,I),this._fieldsMap.set(S,I),this._normalizedFieldsMap.set(P,I),T.push(`${S}:${I.type}:${this._timeZoneByFieldName?.get(g)}`),(0,U.y2)(I)?(this.dateFields.push(I),this._dateFieldsSet.add(I)):(0,U.H7)(I)&&(this._numericFieldsSet.add(I),this.numericFields.push(I)),(0,U.Dl)(I)||(0,U.Se)(I)||(I.editable=null==I.editable||!!I.editable,I.nullable=null==I.nullable||!!I.nullable)}}T.sort(),this.uid=T.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const f of this.fields)(0,U.Dl)(f)||(0,U.Se)(f)||f.nullable||void 0!==(0,U.os)(f)||this._requiredFields.push(f)}return this._requiredFields}equals(f){return this.uid===f?.uid}has(f){return null!=this.get(f)}get(f){if(!f)return;let y=this._fieldsMap.get(f);return y||(y=this._fieldsMap.get(B(f))??this._normalizedFieldsMap.get(L(f)),y&&this._fieldsMap.set(f,y),y)}getTimeZone(f){const y=this.get(f&&"string"!=typeof f?f.name:f);return y?this._timeZoneByFieldName?this._timeZoneByFieldName.get(y.name):"date"===y.type||"esriFieldTypeDate"===y.type?(Y.Z.getLogger("esri.layers.support.FieldsIndex").error(new A.Z("getTimeZone:no-timezone-information",`no time zone information for field '${y.name}'`)),K.pt):D.has(y.type)?K._4:null:null}getLuxonTimeZone(f){const y=this.getTimeZone(f);return y?y===K._4?J.yV.instance:y===K.pt?$.Qf.utcInstance:(0,b.s1)(p,y,()=>$.vF.create(y)):null}isDateField(f){return this._dateFieldsSet.has(this.get(f))}isTimeOnlyField(f){return(0,U.sX)(this.get(f))}isNumericField(f){return this._numericFieldsSet.has(this.get(f))}normalizeFieldName(f){return this.get(f)?.name??void 0}toJSON(){return{fields:this.fields.map(f=>(0,M.AK)(f)?f.toJSON():f),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function B(l){return l.trim().toLowerCase()}function L(l){return(0,U.q6)(l)?.toLowerCase()??""}const D=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function h(l){const f=new Map;if(!l.fields)return f;const y=!0===l.datesInUnknownTimezone,{timeInfo:T,editFieldsInfo:I}=l,g=(T?"startField"in T?T.startField:T.startTimeField:"")??"",P=(T?"endField"in T?T.endField:T.endTimeField:"")??"",S=function d(l){return"dateFieldsTimeZone"in l}(l)?l.dateFieldsTimeZone??null:l.dateFieldsTimeReference?(0,K.Jv)(l.dateFieldsTimeReference):null,W=I?function G(l){return"timeZone"in l}(I)?I.timeZone??S:I.dateFieldsTimeReference?(0,K.Jv)(I.dateFieldsTimeReference):S??K.pt:null,Z=T?function _(l){return"timeZone"in l}(T)?T.timeZone??S:T.timeReference?(0,K.Jv)(T.timeReference):S:null,R=new Map([[B(I?.creationDateField??""),W],[B(I?.editDateField??""),W],[B(g),Z],[B(P),Z]]);for(const{name:c,type:E}of l.fields)if(D.has(E))f.set(c,K._4);else if("date"!==E&&"esriFieldTypeDate"!==E)f.set(c,null);else if(y)f.set(c,K._4);else{const x=R.get(B(c??""))??S;f.set(c,x)}return f}},35469:(ne,H,s)=>{s.d(H,{Z:()=>p});var G,A=s(50484),M=s(84303),Y=s(89317),b=s(80543),$=(s(14007),s(4703),s(65311),s(10141));const _=new M.X({asc:"ascending",desc:"descending"});let d=G=class extends Y.wq{constructor(O){super(O),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new G({field:this.field,valueExpression:this.valueExpression,order:this.order})}};(0,A._)([(0,b.Cb)({type:String,json:{write:!0}})],d.prototype,"field",void 0),(0,A._)([(0,b.Cb)({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],d.prototype,"valueExpression",void 0),(0,A._)([(0,b.Cb)({type:_.apiValues,json:{type:_.jsonValues,read:_.read,write:_.write}})],d.prototype,"order",void 0),d=G=(0,A._)([(0,$.j)("esri.layers.support.OrderByInfo")],d);const p=d},56761:(ne,H,s)=>{s.d(H,{UG:()=>d,UO:()=>L,YI:()=>B,dI:()=>D,el:()=>I,hV:()=>O,z7:()=>p});var A=s(72578);const M="__begin__",Y="__end__",b=new RegExp(M,"ig"),J=new RegExp(Y,"ig"),U=new RegExp("^"+M,"i"),K=new RegExp(Y+"$","i"),$='"',G=$+" + ",_=" + "+$;function d(g){return g.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function p(g){return g.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function O(g){const P={expression:"",type:"none"};return g.labelExpressionInfo?g.labelExpressionInfo.value?(P.expression=g.labelExpressionInfo.value,P.type="conventional"):g.labelExpressionInfo.expression&&(P.expression=g.labelExpressionInfo.expression,P.type="arcade"):null!=g.labelExpression&&(P.expression=d(g.labelExpression),P.type="conventional"),P}function B(g){const P=O(g);if(!P)return null;switch(P.type){case"conventional":return D(P.expression);case"arcade":return P.expression}return null}function L(g){const P=O(g);if(!P)return null;switch(P.type){case"conventional":return function l(g){return g?.match(h)?.[1].trim()||null}(P.expression);case"arcade":return I(P.expression)}return null}function D(g){let P;return g?(P=(0,A.gx)(g,S=>M+'$feature["'+S+'"]'+Y),P=U.test(P)?P.replace(U,""):$+P,P=K.test(P)?P.replace(K,""):P+$,P=P.replaceAll(b,G).replaceAll(J,_)):P='""',P}const h=/^\s*\{([^}]+)\}\s*$/i,f=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,y=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,T=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function I(g){if(!g)return null;let P=f.exec(g)||y.exec(g);return P?P[1]||P[3]:(P=T.exec(g),P?P[2]:null)}},50318:(ne,H,s)=>{s.d(H,{$o:()=>p,Fj:()=>G,IW:()=>d,Ss:()=>L,_$:()=>$,ck:()=>_,hz:()=>B,qj:()=>K});var A=s(15861),M=s(83821),Y=s(43814),b=s(48230);function U(){return(U=(0,A.Z)(function*(D){const h=D.spatialReference;if(h.isWGS84)return D.clone();if(h.isWebMercator)return(0,b.Sx)(D);const l=Y.Z.WGS84;return yield(0,M.initializeProjection)(h,l),(0,M.project)(D,l)})).apply(this,arguments)}function K(D,h){if(!$(D,h)){const l=D.typeKeywords;l?l.push(h):D.typeKeywords=[h]}}function $(D,h){return!!D.typeKeywords?.includes(h)}function G(D){return $(D,B.HOSTED_SERVICE)}function _(D,h){const l=D.typeKeywords;if(l){const f=l.indexOf(h);f>-1&&l.splice(f,1)}}function d(D,h,l){l?K(D,h):_(D,h)}function p(D){return O.apply(this,arguments)}function O(){return O=(0,A.Z)(function*(D){const h=D.clone().normalize();let l;if(h.length>1)for(const f of h)l?f.width>l.width&&(l=f):l=f;else l=h[0];return function J(D){return U.apply(this,arguments)}(l)}),O.apply(this,arguments)}const B={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function L(D){const{portal:h,isOrgItem:l,itemControl:f}=D,y=h.user?.privileges;let T=!y||y.includes("features:user:edit"),I=!!l&&!!y?.includes("features:user:fullEdit");const g="update"===f||"admin"===f;return g?I=T=!0:I&&(T=!0),{features:{edit:T,fullEdit:I},content:{updateItem:g}}}},96043:(ne,H,s)=>{s.d(H,{AJ:()=>K,If:()=>_,k0:()=>U,uI:()=>G,ul:()=>J,wx:()=>d});var A=s(55117),M=s(55768),Y=s(5710),b=s(23515);const J=2.4;function U(p){return(0,M.Wz)(p*J)}function K(p){return(0,M.F2)(p)/J}function $(p,O,B,L){let{color:D,ratio:h}=O,{color:l,ratio:f}=B;f===h&&(1===f?h-=1e-6:f+=1e-6);const y=(0,A.uZ)((L-h)/(f-h),0,1);(0,Y.l)(p,D.toArray(),l.toArray(),y)}function G(p){const B=new Uint8ClampedArray(2048);if((p=p.filter(({ratio:f})=>f>=0&&f<=1).sort((f,y)=>f.ratio-y.ratio).map(({color:f,ratio:y})=>({color:f,ratio:Math.max(y,.001)}))).length<1)return B;let L=p[0],D=p[0],h=1;const l=(0,b.Ue)();for(let f=0;f<512;f++){const y=(f+.5)/512;for(;y>D.ratio&&h<p.length;)L=D,D=p[h++];$(l,L,D,y),B.set(l,4*f)}return B}function _(p,O,B){const L=Math.sqrt(p**2+O**2)/B;return L>1?0:3/(Math.PI*B**2)*(1-L**2)**2}function d(p){return"function"==typeof p?p:p?O=>+O[p]:()=>1}},93792:(ne,H,s)=>{s.d(H,{Z:()=>f});var D,A=s(50484),M=s(2189),Y=s(35458),b=s(84303),J=s(89317),U=s(34222),K=s(80543),_=(s(14007),s(4703),s(62185)),d=s(10141),p=s(7547),O=s(43814),B=s(40637),L=s(81247);const h=new b.X({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let l=D=class extends J.wq{constructor(y){super(y),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(y,T){const I=O.Z.fromJSON(T.spatialReference),g=[];for(let P=0;P<y.length;P++){const S=y[P],W=Y.Z.fromJSON(S),Z=S.geometry?.spatialReference;null==W.geometry||Z||(W.geometry.spatialReference=I);const R=S.aggregateGeometries,c=W.aggregateGeometries;if(R&&null!=c)for(const E in c){const x=c[E],j=R[E],te=j?.spatialReference;null==x||te||(x.spatialReference=I)}g.push(W)}return g}writeGeometryType(y,T,I,g){if(y)return void h.write(y,T,I,g);const{features:P}=this;if(P)for(const S of P)if(null!=S?.geometry)return void h.write(S.geometry.type,T,I,g)}readQueryGeometry(y,T){if(!y)return null;const I=!!y.spatialReference,g=(0,B.im)(y);return g&&!I&&T.spatialReference&&(g.spatialReference=O.Z.fromJSON(T.spatialReference)),g}writeSpatialReference(y,T){if(y)return void(T.spatialReference=y.toJSON());const{features:I}=this;if(I)for(const g of I)if(g&&null!=g.geometry&&g.geometry.spatialReference)return void(T.spatialReference=g.geometry.spatialReference.toJSON())}clone(){return new D(this.cloneProperties())}cloneProperties(){return(0,U.d9)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(y){const T=this.write();if(T.features&&Array.isArray(y)&&y.length>0)for(let I=0;I<T.features.length;I++){const g=T.features[I];if(g.geometry){const P=y?.[I];g.geometry=P?.toJSON()||g.geometry}}return T}quantize(y){const{scale:[T,I],translate:[g,P]}=y,Z=this.features,R=this._getQuantizationFunction(this.geometryType,c=>Math.round((c-g)/T),c=>Math.round((P-c)/I));for(let c=0,E=Z.length;c<E;c++)R?.(Z[c].geometry)||(Z.splice(c,1),c--,E--);return this.transform=y,this}unquantize(){const{geometryType:y,features:T,transform:I}=this;if(!I)return this;const{translate:[g,P],scale:[S,W]}=I;let c=null,E=null;if(this.hasZ&&null!=I?.scale?.[2]){const{translate:[,,j],scale:[,,te]}=I;c=k=>k*te+j}if(this.hasM&&null!=I?.scale?.[3]){const{translate:[,,,j],scale:[,,,te]}=I;E=k=>null==k?k:k*te+j}const x=this._getHydrationFunction(y,j=>j*S+g,j=>P-j*W,c,E);for(const{geometry:j}of T)null!=j&&x&&x(j);return this.transform=null,this}_quantizePoints(y,T,I){let g,P;const S=[];for(let W=0,Z=y.length;W<Z;W++){const R=y[W];if(W>0){const c=T(R[0]),E=I(R[1]);c===g&&E===P||(S.push([c-g,E-P]),g=c,P=E)}else g=T(R[0]),P=I(R[1]),S.push([g,P])}return S.length>0?S:null}_getQuantizationFunction(y,T,I){return"point"===y?g=>(g.x=T(g.x),g.y=I(g.y),g):"polyline"===y||"polygon"===y?g=>{const P=(0,B.oU)(g)?g.rings:g.paths,S=[];for(let W=0,Z=P.length;W<Z;W++){const c=this._quantizePoints(P[W],T,I);c&&S.push(c)}return S.length>0?((0,B.oU)(g)?g.rings=S:g.paths=S,g):null}:"multipoint"===y?g=>{const P=this._quantizePoints(g.points,T,I);return P&&P.length>0?(g.points=P,g):null}:"extent"===y?g=>g:null}_getHydrationFunction(y,T,I,g,P){return"point"===y?S=>{S.x=T(S.x),S.y=I(S.y),g&&(S.z=g(S.z))}:"polyline"===y||"polygon"===y?S=>{const W=(0,B.oU)(S)?S.rings:S.paths;let Z,R;for(let c=0,E=W.length;c<E;c++){const x=W[c];for(let j=0,te=x.length;j<te;j++){const k=x[j];j>0?(Z+=k[0],R+=k[1]):(Z=k[0],R=k[1]),k[0]=T(Z),k[1]=I(R)}}if(g&&P)for(let c=0,E=W.length;c<E;c++){const x=W[c];for(let j=0,te=x.length;j<te;j++){const k=x[j];k[2]=g(k[2]),k[3]=P(k[3])}}else if(g)for(let c=0,E=W.length;c<E;c++){const x=W[c];for(let j=0,te=x.length;j<te;j++){const k=x[j];k[2]=g(k[2])}}else if(P)for(let c=0,E=W.length;c<E;c++){const x=W[c];for(let j=0,te=x.length;j<te;j++){const k=x[j];k[2]=P(k[2])}}}:"extent"===y?S=>{S.xmin=T(S.xmin),S.ymin=I(S.ymin),S.xmax=T(S.xmax),S.ymax=I(S.ymax),g&&null!=S.zmax&&null!=S.zmin&&(S.zmax=g(S.zmax),S.zmin=g(S.zmin)),P&&null!=S.mmax&&null!=S.mmin&&(S.mmax=P(S.mmax),S.mmin=P(S.mmin))}:"multipoint"===y?S=>{const W=S.points;let Z,R;for(let c=0,E=W.length;c<E;c++){const x=W[c];c>0?(Z+=x[0],R+=x[1]):(Z=x[0],R=x[1]),x[0]=T(Z),x[1]=I(R)}if(g&&P)for(let c=0,E=W.length;c<E;c++){const x=W[c];x[2]=g(x[2]),x[3]=P(x[3])}else if(g)for(let c=0,E=W.length;c<E;c++){const x=W[c];x[2]=g(x[2])}else if(P)for(let c=0,E=W.length;c<E;c++){const x=W[c];x[2]=P(x[2])}}:null}};(0,A._)([(0,K.Cb)({type:String,json:{write:!0}})],l.prototype,"displayFieldName",void 0),(0,A._)([(0,K.Cb)({type:Boolean,json:{write:{overridePolicy:y=>({enabled:y})}}})],l.prototype,"exceededTransferLimit",void 0),(0,A._)([(0,K.Cb)({type:[Y.Z],json:{write:!0}})],l.prototype,"features",void 0),(0,A._)([(0,_.r)("features")],l.prototype,"readFeatures",null),(0,A._)([(0,K.Cb)({type:[L.Z],json:{write:!0}})],l.prototype,"fields",void 0),(0,A._)([(0,K.Cb)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:h.read}}})],l.prototype,"geometryType",void 0),(0,A._)([(0,p.c)("geometryType")],l.prototype,"writeGeometryType",null),(0,A._)([(0,K.Cb)({type:Boolean,json:{write:{overridePolicy:y=>({enabled:y})}}})],l.prototype,"hasM",void 0),(0,A._)([(0,K.Cb)({type:Boolean,json:{write:{overridePolicy:y=>({enabled:y})}}})],l.prototype,"hasZ",void 0),(0,A._)([(0,K.Cb)({types:M.qM,json:{write:!0}})],l.prototype,"queryGeometry",void 0),(0,A._)([(0,_.r)("queryGeometry")],l.prototype,"readQueryGeometry",null),(0,A._)([(0,K.Cb)({type:O.Z,json:{write:!0}})],l.prototype,"spatialReference",void 0),(0,A._)([(0,p.c)("spatialReference")],l.prototype,"writeSpatialReference",null),(0,A._)([(0,K.Cb)({json:{write:!0}})],l.prototype,"transform",void 0),l=D=(0,A._)([(0,d.j)("esri.rest.support.FeatureSet")],l),l.prototype.toJSON.isDefaultToJSON=!0;const f=l}}]);