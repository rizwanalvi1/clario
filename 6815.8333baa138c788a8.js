"use strict";(self.webpackChunkclario_frontend=self.webpackChunkclario_frontend||[]).push([[6815],{36815:(U,g,e)=>{e.r(g),e.d(g,{default:()=>R});var t=e(50484),P=e(83944),C=e(4703),O=(e(14007),e(65311),e(57964),e(10141)),a=e(83124),s=e(15861),l=e(1258),v=e(79412),E=e(38955),c=e(80543);const i=Symbol(),y=b=>{let m=class extends b{constructor(){var u;super(...arguments),u=this,this.layerViews=new P.Z,this._debouncedUpdate=(0,v.Ds)((0,s.Z)(function*(){const{layer:M,parent:S}=u,d=S?.footprintLayerView;let p=[];const f=u._createQuery();if(f&&d){const{features:h}=yield d.queryFeatures(f);u.suspended||(p=h.map(A=>M.acquireLayer(A)))}u.removeHandles(i),u.addHandles(p,i)}))}get creatingLayerViews(){return this.view?.layerViewManager.isCreatingLayerViewsForLayer(this.layer)??!1}isUpdating(){return this.creatingLayerViews||this.layer.updating||this.layerViews.some(u=>u.updating)}enableLayerUpdates(){return(0,l.AL)([this._updatingHandles.addWhen(()=>!1===this.parent?.footprintLayerView?.dataUpdating,()=>this.updateLayers()),this._updatingHandles.add(()=>[this.layer.maximumVisibleSublayers,this.layer.parent?.orderBy,this.parent?.footprintLayerView?.filter,this.parent?.footprintLayerView?.timeExtent,this.suspended],()=>this.updateLayers()),(0,l.kB)(()=>this.removeHandles(i))])}updateLayers(){this.suspended?this.removeHandles(i):this._updatingHandles.addPromise((0,v.R8)(this._debouncedUpdate()).catch(u=>{C.Z.getLogger(this).error(u)}))}_createQuery(){const u=this.parent?.footprintLayerView,M=this.layer?.parent;if(!u||!M||M.destroyed)return null;const{layer:{maximumVisibleSublayers:S},view:{scale:d}}=this;if(!S)return null;const{itemTypeField:p,itemSourceField:f,itemNameField:h,minScaleField:A,maxScaleField:I,objectIdField:B,orderBy:W}=M,V=(0,E._)(`${A} IS NULL OR ${d} <= ${A} OR ${A} = 0`,`${I} IS NULL OR ${d} >= ${I}`),j=W?.find(T=>T.field&&!T.valueExpression),L=u.createQuery();if(L.returnGeometry=!1,L.num=S,L.outFields=[B,f,h],L.where=(0,E._)(L.where,V),null!=this.unsupportedItemTypes){const T=`${p} NOT IN (${this.unsupportedItemTypes.map(K=>`'${K}'`)})`;L.where=(0,E._)(L.where,T)}return j?.field&&(L.orderByFields=[`${j.field} ${"descending"===j.order?"DESC":"ASC"}`],L.outFields.push(j.field)),L}};return(0,t._)([(0,c.Cb)({readOnly:!0})],m.prototype,"creatingLayerViews",null),(0,t._)([(0,c.Cb)()],m.prototype,"layer",void 0),(0,t._)([(0,c.Cb)()],m.prototype,"layerViews",void 0),(0,t._)([(0,c.Cb)({readOnly:!0})],m.prototype,"unsupportedItemTypes",void 0),(0,t._)([(0,c.Cb)()],m.prototype,"parent",void 0),(0,t._)([(0,c.Cb)({readOnly:!0})],m.prototype,"isUpdating",null),m=(0,t._)([(0,O.j)("esri.views.layers.CatalogDynamicGroupLayerView")],m),m};var n=e(50145);let _=class extends(y((0,a.y)(n.Z))){constructor(){super(...arguments),this.unsupportedItemTypes=["Scene Service"],this.layerViews=new P.Z}attach(){this.addAttachHandles([this.layerViews.on("after-changes",()=>this._updateStageChildren()),this.enableLayerUpdates()])}detach(){this.container.removeAllChildren()}update(b){this.updateLayers()}viewChange(){}moveEnd(){this.requestUpdate()}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((b,m)=>this.container.addChildAt(b.container,m))}};_=(0,t._)([(0,O.j)("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],_);const R=_},83124:(U,g,e)=>{e.d(g,{y:()=>M});var i,t=e(50484),P=e(83944),C=e(18626),D=e(57964),o=e(77675),r=e(80543),l=(e(14007),e(4703),e(65311),e(10141)),v=e(85338),E=e(30640),c=e(38954);let y=i=class extends c.Z{constructor(S){super(S),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new i({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"left",void 0),(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"right",void 0),(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"top",void 0),(0,t._)([(0,r.Cb)({type:[Number,String],json:{write:!0}})],y.prototype,"bottom",void 0),y=i=(0,t._)([(0,l.j)("esri.views.layers.support.ClipRect")],y);const n=y;var _=e(87265);let R=class extends c.Z{constructor(S){super(S),this.type="path",this.path=[]}commitVersionProperties(){this.commitProperty("path")}};(0,t._)([(0,r.Cb)({type:[[[Number]]],json:{write:!0}})],R.prototype,"path",void 0),R=(0,t._)([(0,l.j)("esri.views.layers.support.Path")],R);const b=R;var m=e(64579);const u=P.Z.ofType({key:"type",base:null,typeMap:{rect:n,path:b,geometry:_.Z}}),M=S=>{let d=class extends S{constructor(){super(...arguments),this.attached=!1,this.clips=new u,this.highlightOptions=null,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1,this._visibleAtCurrentScale=!0}initialize(){const p=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&p&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new D.Z("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new v.W),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([(0,o.YP)(()=>this.suspended,h=>{this.container&&(this.container.visible=!h)},o.tX),(0,o.YP)(()=>this.updateSuspended,h=>{this.view&&!h&&this.updateRequested&&this.view.requestUpdate()},o.tX),(0,o.YP)(()=>this.layer?.opacity??1,h=>{this.container&&(this.container.opacity=h)},o.tX),(0,o.YP)(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",h=>{this.container&&(this.container.blendMode=h)},o.tX),(0,o.YP)(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,h=>{this.container&&(this.container.effect=h)},o.tX),(0,o.YP)(()=>this.highlightOptions,h=>this.container.highlightOptions=h,o.tX),(0,o.on)(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)},o.tX),(0,o.YP)(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:h,scaleRange:A})=>{const I=(0,m.GB)(A,h);I!==this._visibleAtCurrentScale&&(this._visibleAtCurrentScale=I)},o.tX)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(h=>{h===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){const p=this.view?.spatialReference;return null==p||this.supportsSpatialReference(p)}get updating(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this._updatingHandles?.updating)}get visibleAtCurrentScale(){return this._visibleAtCurrentScale}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.updateSuspended||this.view.requestUpdate())}processUpdate(p){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",p),this.updateRequested&&!this.updateSuspended&&(this.updateRequested=!1,this.update(p))):this.updateRequested=!1}hitTest(p,f){return Promise.resolve(null)}supportsSpatialReference(p){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const p=super.getSuspendInfo(),f=!this.spatialReferenceSupported;return f&&(p.spatialReferenceNotSupported=f),p}addAttachHandles(p){this.addHandles(p,"attach")}};return(0,t._)([(0,r.Cb)()],d.prototype,"attached",void 0),(0,t._)([(0,r.Cb)({type:u,set(p){const f=(0,C.Z)(p,this._get("clips"),u);this._set("clips",f)}})],d.prototype,"clips",void 0),(0,t._)([(0,r.Cb)()],d.prototype,"container",void 0),(0,t._)([(0,r.Cb)({type:E.Z})],d.prototype,"highlightOptions",void 0),(0,t._)([(0,r.Cb)()],d.prototype,"moving",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],d.prototype,"spatialReferenceSupported",null),(0,t._)([(0,r.Cb)({readOnly:!0})],d.prototype,"updateParameters",void 0),(0,t._)([(0,r.Cb)()],d.prototype,"updateRequested",void 0),(0,t._)([(0,r.Cb)()],d.prototype,"updating",null),(0,t._)([(0,r.Cb)()],d.prototype,"view",void 0),(0,t._)([(0,r.Cb)()],d.prototype,"_visibleAtCurrentScale",void 0),(0,t._)([(0,r.Cb)({readOnly:!0})],d.prototype,"visibleAtCurrentScale",null),d=(0,t._)([(0,l.j)("esri.views.2d.layers.LayerView2D")],d),d}},50145:(U,g,e)=>{e.d(g,{Z:()=>y});var t=e(50484),P=e(73514),C=e(88278),D=e(84373),o=e(4703),r=e(51172),O=e(47868),a=e(80543),v=(e(14007),e(65311),e(10141)),E=e(90110),c=e(64579);let i=class extends((0,D.IG)((0,O.v)(C.Z.EventedMixin(P.Z)))){constructor(n){super(n),this._updatingHandles=new E.R,this.layer=null,this.parent=null}initialize(){this.when().catch(n=>{if("layerview:create-error"!==n.name){const _=this.layer&&this.layer.id||"no id",R=this.layer?.title||"no title";o.Z.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${R}', id: '${_}')`,n)}})}destroy(){this._updatingHandles=(0,r.SC)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(n){this._overrideIfSome("visible",n)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){const n=this.view.timeExtent,_=this.layer?.visibilityTimeExtent;return!n||!_||!n.intersection(_).isEmpty}canResume(){const n=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready&&(0,c.Cy)(n)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){const n=this.parent?.suspended?this.parent.suspendInfo:{};return this.view?.ready||(n.viewNotReady=!0),this.layer&&this.layer.loaded||(n.layerNotLoaded=!0),(0,c.Cy)(this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null)&&this.visibleAtCurrentScale||(n.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(n.outsideVisibilityTimeExtent=!0),this.visible||(n.layerInvisible=!0),n}isUpdating(){return!1}};(0,t._)([(0,a.Cb)()],i.prototype,"view",void 0),(0,t._)([(0,a.Cb)()],i.prototype,"fullOpacity",null),(0,t._)([(0,a.Cb)()],i.prototype,"layer",void 0),(0,t._)([(0,a.Cb)()],i.prototype,"parent",void 0),(0,t._)([(0,a.Cb)({readOnly:!0})],i.prototype,"suspended",null),(0,t._)([(0,a.Cb)({readOnly:!0})],i.prototype,"suspendInfo",null),(0,t._)([(0,a.Cb)({readOnly:!0})],i.prototype,"legendEnabled",null),(0,t._)([(0,a.Cb)({type:Boolean,readOnly:!0})],i.prototype,"updating",null),(0,t._)([(0,a.Cb)({readOnly:!0})],i.prototype,"updatingProgress",null),(0,t._)([(0,a.Cb)()],i.prototype,"updateSuspended",null),(0,t._)([(0,a.Cb)()],i.prototype,"visible",null),(0,t._)([(0,a.Cb)({readOnly:!0})],i.prototype,"visibleAtCurrentScale",null),(0,t._)([(0,a.Cb)({readOnly:!0})],i.prototype,"visibleAtCurrentTimeExtent",null),i=(0,t._)([(0,v.j)("esri.views.layers.LayerView")],i);const y=i},38954:(U,g,e)=>{e.d(g,{Z:()=>s});var t=e(50484),P=e(89317),C=e(80543),O=(e(14007),e(4703),e(65311),e(10141));let a=class extends P.wq{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};(0,t._)([(0,C.Cb)({readOnly:!0})],a.prototype,"version",null),a=(0,t._)([(0,O.j)("esri.views.layers.support.ClipArea")],a);const s=a},87265:(U,g,e)=>{e.d(g,{Z:()=>n});var c,t=e(50484),C=(e(2189),e(80543)),O=(e(14007),e(4703),e(65311),e(10141)),a=e(32184),s=e(40637),l=e(38954),v=e(26894),E=e(5391);const i={base:a.Z,key:"type",typeMap:{extent:v.Z,polygon:E.Z}};let y=c=class extends l.Z{constructor(_){super(_),this.type="geometry",this.geometry=null}clone(){return new c({geometry:this.geometry?.clone()??null})}commitVersionProperties(){this.commitProperty("geometry")}};(0,t._)([(0,C.Cb)({types:i,json:{read:s.im,write:!0}})],y.prototype,"geometry",void 0),y=c=(0,t._)([(0,O.j)("esri.views.layers.support.Geometry")],y);const n=y},64579:(U,g,e)=>{function t(s){return s&&"function"==typeof s.highlight}function D(s,l){if(l&&s){const{minScale:v,maxScale:E}=s;if(function o(s,l){return null!=s&&s>0||null!=l&&l>0}(v,E))return function C(s,l,v){return null==s||s>=v&&(0===l||s<=l)}(l,v,E)}return!0}function r(s){return!s?.minScale||!s.maxScale||s.minScale>=s.maxScale}e.d(g,{Cy:()=>r,GB:()=>D,tl:()=>t})}}]);